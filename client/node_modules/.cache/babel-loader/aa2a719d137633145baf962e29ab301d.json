{"ast":null,"code":"var _defineProperty = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/defineProperty\");\nvar _assertThisInitialized = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/assertThisInitialized\");\nvar _construct = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/construct\");\nvar _get = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/get\");\nvar _toArray = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/toArray\");\nvar _toConsumableArray = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/toConsumableArray\");\nvar _slicedToArray = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/slicedToArray\");\nvar _classCallCheck = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/classCallCheck\");\nvar _createClass = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/createClass\");\nvar _possibleConstructorReturn = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/possibleConstructorReturn\");\nvar _getPrototypeOf = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/getPrototypeOf\");\nvar _inherits = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/inherits\");\nvar _wrapNativeSuper = require(\"C:\\\\Users\\\\ASUS VivoBook\\\\Desktop\\\\PI - Copie\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/wrapNativeSuper\");\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e493) { throw _e493; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e494) { didErr = true; err = _e494; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\n/* Mapbox GL JS is Copyright Â© 2020 Mapbox and subject to the Mapbox Terms of Service ((https://www.mapbox.com/legal/tos/). */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.mapboxgl = factory());\n})(this, function () {\n  'use strict';\n\n  /* eslint-disable */\n  var shared, worker, mapboxgl;\n  // define gets called three times: one for each chunk. we rely on the order\n  // they're imported to know which is which\n  function define(_, chunk) {\n    if (!shared) {\n      shared = chunk;\n    } else if (!worker) {\n      worker = chunk;\n    } else {\n      var workerBundleString = \"self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; (\" + shared + \")(sharedChunk); (\" + worker + \")(sharedChunk); self.onerror = null;\";\n      var sharedChunk = {};\n      shared(sharedChunk);\n      mapboxgl = chunk(sharedChunk);\n      if (typeof window !== 'undefined' && window && window.URL && window.URL.createObjectURL) {\n        mapboxgl.workerUrl = window.URL.createObjectURL(new Blob([workerBundleString], {\n          type: 'text/javascript'\n        }));\n      }\n    }\n  }\n  define([\"exports\"], function (t) {\n    \"use strict\";\n\n    var e = \"undefined\" != typeof self ? self : {},\n      r = \"2.14.1\";\n    var n;\n    var i = {\n        API_URL: \"https://api.mapbox.com\",\n        get API_URL_REGEX() {\n          if (null == n) {\n            var _t2 = /^((https?:)?\\/\\/)?([^\\/]+\\.)?mapbox\\.c(n|om)(\\/|\\?|$)/i;\n            try {\n              n = null != process.env.API_URL_REGEX ? new RegExp(process.env.API_URL_REGEX) : _t2;\n            } catch (e) {\n              n = _t2;\n            }\n          }\n          return n;\n        },\n        get API_TILEJSON_REGEX() {\n          return /^((https?:)?\\/\\/)?([^\\/]+\\.)?mapbox\\.c(n|om)(\\/v[0-9]*\\/.*\\.json.*$)/i;\n        },\n        get API_SPRITE_REGEX() {\n          return /^((https?:)?\\/\\/)?([^\\/]+\\.)?mapbox\\.c(n|om)(\\/styles\\/v[0-9]*\\/)(.*\\/sprite.*\\..*$)/i;\n        },\n        get API_FONTS_REGEX() {\n          return /^((https?:)?\\/\\/)?([^\\/]+\\.)?mapbox\\.c(n|om)(\\/fonts\\/v[0-9]*\\/)(.*\\.pbf.*$)/i;\n        },\n        get API_STYLE_REGEX() {\n          return /^((https?:)?\\/\\/)?([^\\/]+\\.)?mapbox\\.c(n|om)(\\/styles\\/v[0-9]*\\/)(.*$)/i;\n        },\n        get API_CDN_URL_REGEX() {\n          return /^((https?:)?\\/\\/)?api\\.mapbox\\.c(n|om)(\\/mapbox-gl-js\\/)(.*$)/i;\n        },\n        get EVENTS_URL() {\n          if (!i.API_URL) return null;\n          try {\n            var _t3 = new URL(i.API_URL);\n            return \"api.mapbox.cn\" === _t3.hostname ? \"https://events.mapbox.cn/events/v2\" : \"api.mapbox.com\" === _t3.hostname ? \"https://events.mapbox.com/events/v2\" : null;\n          } catch (t) {\n            return null;\n          }\n        },\n        SESSION_PATH: \"/map-sessions/v1\",\n        FEEDBACK_URL: \"https://apps.mapbox.com/feedback\",\n        TILE_URL_VERSION: \"v4\",\n        RASTER_URL_PREFIX: \"raster/v1\",\n        REQUIRE_ACCESS_TOKEN: !0,\n        ACCESS_TOKEN: null,\n        MAX_PARALLEL_IMAGE_REQUESTS: 16\n      },\n      s = {\n        supported: !1,\n        testSupport: function testSupport(t) {\n          !l && o && (u ? c(t) : a = t);\n        }\n      };\n    var a,\n      o,\n      l = !1,\n      u = !1;\n    function c(t) {\n      var e = t.createTexture();\n      t.bindTexture(t.TEXTURE_2D, e);\n      try {\n        if (t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.RGBA, t.UNSIGNED_BYTE, o), t.isContextLost()) return;\n        s.supported = !0;\n      } catch (t) {}\n      t.deleteTexture(e), l = !0;\n    }\n    e.document && (o = e.document.createElement(\"img\"), o.onload = function () {\n      a && c(a), a = null, u = !0;\n    }, o.onerror = function () {\n      l = !0, a = null;\n    }, o.src = \"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=\");\n    var h = \"01\";\n    var p = f;\n    function f(t, e, r, n) {\n      this.cx = 3 * t, this.bx = 3 * (r - t) - this.cx, this.ax = 1 - this.cx - this.bx, this.cy = 3 * e, this.by = 3 * (n - e) - this.cy, this.ay = 1 - this.cy - this.by, this.p1x = t, this.p1y = e, this.p2x = r, this.p2y = n;\n    }\n    f.prototype = {\n      sampleCurveX: function sampleCurveX(t) {\n        return ((this.ax * t + this.bx) * t + this.cx) * t;\n      },\n      sampleCurveY: function sampleCurveY(t) {\n        return ((this.ay * t + this.by) * t + this.cy) * t;\n      },\n      sampleCurveDerivativeX: function sampleCurveDerivativeX(t) {\n        return (3 * this.ax * t + 2 * this.bx) * t + this.cx;\n      },\n      solveCurveX: function solveCurveX(t, e) {\n        if (void 0 === e && (e = 1e-6), t < 0) return 0;\n        if (t > 1) return 1;\n        for (var r = t, n = 0; n < 8; n++) {\n          var i = this.sampleCurveX(r) - t;\n          if (Math.abs(i) < e) return r;\n          var s = this.sampleCurveDerivativeX(r);\n          if (Math.abs(s) < 1e-6) break;\n          r -= i / s;\n        }\n        var a = 0,\n          o = 1;\n        for (r = t, n = 0; n < 20 && (i = this.sampleCurveX(r), !(Math.abs(i - t) < e)); n++) t > i ? a = r : o = r, r = .5 * (o - a) + a;\n        return r;\n      },\n      solve: function solve(t, e) {\n        return this.sampleCurveY(this.solveCurveX(t, e));\n      }\n    };\n    var d = y;\n    function y(t, e) {\n      this.x = t, this.y = e;\n    }\n    y.prototype = {\n      clone: function clone() {\n        return new y(this.x, this.y);\n      },\n      add: function add(t) {\n        return this.clone()._add(t);\n      },\n      sub: function sub(t) {\n        return this.clone()._sub(t);\n      },\n      multByPoint: function multByPoint(t) {\n        return this.clone()._multByPoint(t);\n      },\n      divByPoint: function divByPoint(t) {\n        return this.clone()._divByPoint(t);\n      },\n      mult: function mult(t) {\n        return this.clone()._mult(t);\n      },\n      div: function div(t) {\n        return this.clone()._div(t);\n      },\n      rotate: function rotate(t) {\n        return this.clone()._rotate(t);\n      },\n      rotateAround: function rotateAround(t, e) {\n        return this.clone()._rotateAround(t, e);\n      },\n      matMult: function matMult(t) {\n        return this.clone()._matMult(t);\n      },\n      unit: function unit() {\n        return this.clone()._unit();\n      },\n      perp: function perp() {\n        return this.clone()._perp();\n      },\n      round: function round() {\n        return this.clone()._round();\n      },\n      mag: function mag() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n      },\n      equals: function equals(t) {\n        return this.x === t.x && this.y === t.y;\n      },\n      dist: function dist(t) {\n        return Math.sqrt(this.distSqr(t));\n      },\n      distSqr: function distSqr(t) {\n        var e = t.x - this.x,\n          r = t.y - this.y;\n        return e * e + r * r;\n      },\n      angle: function angle() {\n        return Math.atan2(this.y, this.x);\n      },\n      angleTo: function angleTo(t) {\n        return Math.atan2(this.y - t.y, this.x - t.x);\n      },\n      angleWith: function angleWith(t) {\n        return this.angleWithSep(t.x, t.y);\n      },\n      angleWithSep: function angleWithSep(t, e) {\n        return Math.atan2(this.x * e - this.y * t, this.x * t + this.y * e);\n      },\n      _matMult: function _matMult(t) {\n        var e = t[2] * this.x + t[3] * this.y;\n        return this.x = t[0] * this.x + t[1] * this.y, this.y = e, this;\n      },\n      _add: function _add(t) {\n        return this.x += t.x, this.y += t.y, this;\n      },\n      _sub: function _sub(t) {\n        return this.x -= t.x, this.y -= t.y, this;\n      },\n      _mult: function _mult(t) {\n        return this.x *= t, this.y *= t, this;\n      },\n      _div: function _div(t) {\n        return this.x /= t, this.y /= t, this;\n      },\n      _multByPoint: function _multByPoint(t) {\n        return this.x *= t.x, this.y *= t.y, this;\n      },\n      _divByPoint: function _divByPoint(t) {\n        return this.x /= t.x, this.y /= t.y, this;\n      },\n      _unit: function _unit() {\n        return this._div(this.mag()), this;\n      },\n      _perp: function _perp() {\n        var t = this.y;\n        return this.y = this.x, this.x = -t, this;\n      },\n      _rotate: function _rotate(t) {\n        var e = Math.cos(t),\n          r = Math.sin(t),\n          n = r * this.x + e * this.y;\n        return this.x = e * this.x - r * this.y, this.y = n, this;\n      },\n      _rotateAround: function _rotateAround(t, e) {\n        var r = Math.cos(t),\n          n = Math.sin(t),\n          i = e.y + n * (this.x - e.x) + r * (this.y - e.y);\n        return this.x = e.x + r * (this.x - e.x) - n * (this.y - e.y), this.y = i, this;\n      },\n      _round: function _round() {\n        return this.x = Math.round(this.x), this.y = Math.round(this.y), this;\n      }\n    }, y.convert = function (t) {\n      return t instanceof y ? t : Array.isArray(t) ? new y(t[0], t[1]) : t;\n    };\n    var m = Math.PI / 180,\n      g = 180 / Math.PI;\n    function x(t) {\n      return t * m;\n    }\n    function v(t) {\n      return t * g;\n    }\n    var b = [[0, 0], [1, 0], [1, 1], [0, 1]];\n    function w(t) {\n      if (t <= 0) return 0;\n      if (t >= 1) return 1;\n      var e = t * t,\n        r = e * t;\n      return 4 * (t < .5 ? r : 3 * (t - e) + r - .75);\n    }\n    function _(t, e, r, n) {\n      var i = new p(t, e, r, n);\n      return function (t) {\n        return i.solve(t);\n      };\n    }\n    var A = _(.25, .1, .25, 1);\n    function S(t, e, r) {\n      return Math.min(r, Math.max(e, t));\n    }\n    function k(t, e, r) {\n      return (r = S((r - t) / (e - t), 0, 1)) * r * (3 - 2 * r);\n    }\n    function I(t, e, r) {\n      var n = r - e,\n        i = ((t - e) % n + n) % n + e;\n      return i === e ? r : i;\n    }\n    function M(t, e, r) {\n      if (!t.length) return r(null, []);\n      var n = t.length;\n      var i = new Array(t.length);\n      var s = null;\n      t.forEach(function (t, a) {\n        e(t, function (t, e) {\n          t && (s = t), i[a] = e, 0 == --n && r(s, i);\n        });\n      });\n    }\n    function T(t) {\n      var e = [];\n      for (var _r2 in t) e.push(t[_r2]);\n      return e;\n    }\n    function z(t) {\n      for (var _len = arguments.length, e = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        e[_key - 1] = arguments[_key];\n      }\n      for (var _i2 = 0, _e2 = e; _i2 < _e2.length; _i2++) {\n        var _r3 = _e2[_i2];\n        for (var _e3 in _r3) t[_e3] = _r3[_e3];\n      }\n      return t;\n    }\n    var B = 1;\n    function E() {\n      return B++;\n    }\n    function C() {\n      return function t(e) {\n        return e ? (e ^ Math.random() * (16 >> e / 4)).toString(16) : ([1e7] + -[1e3] + -4e3 + -8e3 + -1e11).replace(/[018]/g, t);\n      }();\n    }\n    function P(t) {\n      return t <= 1 ? 1 : Math.pow(2, Math.ceil(Math.log(t) / Math.LN2));\n    }\n    function D(t) {\n      return !!t && /^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t);\n    }\n    function V(t, e) {\n      t.forEach(function (t) {\n        e[t] && (e[t] = e[t].bind(e));\n      });\n    }\n    function L(t, e) {\n      return -1 !== t.indexOf(e, t.length - e.length);\n    }\n    function F(t, e, r) {\n      var n = {};\n      for (var _i3 in t) n[_i3] = e.call(r || this, t[_i3], _i3, t);\n      return n;\n    }\n    function R(t, e, r) {\n      var n = {};\n      for (var _i4 in t) e.call(r || this, t[_i4], _i4, t) && (n[_i4] = t[_i4]);\n      return n;\n    }\n    function j(t) {\n      return Array.isArray(t) ? t.map(j) : \"object\" == typeof t && t ? F(t, j) : t;\n    }\n    var $ = {};\n    function U(t) {\n      $[t] || (\"undefined\" != typeof console && console.warn(t), $[t] = !0);\n    }\n    function O(t, e, r) {\n      return (r.y - t.y) * (e.x - t.x) > (e.y - t.y) * (r.x - t.x);\n    }\n    function q(t) {\n      var e = 0;\n      for (var _r4, _n2, _i5 = 0, _s2 = t.length, _a2 = _s2 - 1; _i5 < _s2; _a2 = _i5++) _r4 = t[_i5], _n2 = t[_a2], e += (_n2.x - _r4.x) * (_r4.y + _n2.y);\n      return e;\n    }\n    function N() {\n      return \"undefined\" != typeof WorkerGlobalScope && \"undefined\" != typeof self && self instanceof WorkerGlobalScope;\n    }\n    function G(t) {\n      var e = {};\n      if (t.replace(/(?:^|(?:\\s*\\,\\s*))([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)(?:\\=(?:([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)|(?:\\\"((?:[^\"\\\\]|\\\\.)*)\\\")))?/g, function (t, r, n, i) {\n        var s = n || i;\n        return e[r] = !s || s.toLowerCase(), \"\";\n      }), e[\"max-age\"]) {\n        var _t4 = parseInt(e[\"max-age\"], 10);\n        isNaN(_t4) ? delete e[\"max-age\"] : e[\"max-age\"] = _t4;\n      }\n      return e;\n    }\n    var Z = null;\n    function X(t) {\n      if (null == Z) {\n        var _e4 = t.navigator ? t.navigator.userAgent : null;\n        Z = !!t.safari || !(!_e4 || !(/\\b(iPad|iPhone|iPod)\\b/.test(_e4) || _e4.match(\"Safari\") && !_e4.match(\"Chrome\")));\n      }\n      return Z;\n    }\n    function K(t) {\n      try {\n        var _r5 = e[t];\n        return _r5.setItem(\"_mapbox_test_\", 1), _r5.removeItem(\"_mapbox_test_\"), !0;\n      } catch (t) {\n        return !1;\n      }\n    }\n    function Y(t, e) {\n      return [t[4 * e], t[4 * e + 1], t[4 * e + 2], t[4 * e + 3]];\n    }\n    var H = \"mapbox-tiles\";\n    var W,\n      J,\n      Q = 500,\n      tt = 50;\n    function et() {\n      try {\n        return e.caches;\n      } catch (t) {}\n    }\n    function rt() {\n      et() && !W && (W = e.caches.open(H));\n    }\n    function nt(t) {\n      var e = t.indexOf(\"?\");\n      if (e < 0) return t;\n      var r = function (t) {\n          var e = t.indexOf(\"?\");\n          return e > 0 ? t.slice(e + 1).split(\"&\") : [];\n        }(t),\n        n = r.filter(function (t) {\n          var e = t.split(\"=\");\n          return \"language\" === e[0] || \"worldview\" === e[0];\n        });\n      return n.length ? \"\".concat(t.slice(0, e), \"?\").concat(n.join(\"&\")) : t.slice(0, e);\n    }\n    var it = 1 / 0;\n    var st = {\n      Unknown: \"Unknown\",\n      Style: \"Style\",\n      Source: \"Source\",\n      Tile: \"Tile\",\n      Glyphs: \"Glyphs\",\n      SpriteImage: \"SpriteImage\",\n      SpriteJSON: \"SpriteJSON\",\n      Image: \"Image\"\n    };\n    \"function\" == typeof Object.freeze && Object.freeze(st);\n    var at = /*#__PURE__*/function (_Error) {\n      _inherits(at, _Error);\n      function at(t, e, r) {\n        var _this;\n        _classCallCheck(this, at);\n        401 === e && gt(r) && (t += \": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes\"), _this = _possibleConstructorReturn(this, _getPrototypeOf(at).call(this, t)), _this.status = e, _this.url = r;\n        return _this;\n      }\n      _createClass(at, [{\n        key: \"toString\",\n        value: function toString() {\n          return \"\".concat(this.name, \": \").concat(this.message, \" (\").concat(this.status, \"): \").concat(this.url);\n        }\n      }]);\n      return at;\n    }(_wrapNativeSuper(Error));\n    var ot = N() ? function () {\n      return self.worker && self.worker.referrer;\n    } : function () {\n      return (\"blob:\" === e.location.protocol ? e.parent : e).location.href;\n    };\n    var lt = function lt(t, r) {\n        if (!(/^file:/.test(n = t.url) || /^file:/.test(ot()) && !/^\\w+:/.test(n))) {\n          if (e.fetch && e.Request && e.AbortController && e.Request.prototype.hasOwnProperty(\"signal\")) return function (t, r) {\n            var n = new e.AbortController(),\n              i = new e.Request(t.url, {\n                method: t.method || \"GET\",\n                body: t.body,\n                credentials: t.credentials,\n                headers: t.headers,\n                referrer: ot(),\n                referrerPolicy: t.referrerPolicy,\n                signal: n.signal\n              });\n            var s = !1,\n              a = !1;\n            var o = (l = i.url).indexOf(\"sku=\") > 0 && gt(l);\n            var l;\n            \"json\" === t.type && i.headers.set(\"Accept\", \"application/json\");\n            var u = function u(n, s, l) {\n                if (a) return;\n                if (n && \"SecurityError\" !== n.message && U(n), s && l) return c(s);\n                var u = Date.now();\n                e.fetch(i).then(function (e) {\n                  if (e.ok) {\n                    var _t5 = o ? e.clone() : null;\n                    return c(e, _t5, u);\n                  }\n                  return r(new at(e.statusText, e.status, t.url));\n                }).catch(function (e) {\n                  \"AbortError\" !== e.name && r(new Error(\"\".concat(e.message, \" \").concat(t.url)));\n                });\n              },\n              c = function c(n, o, l) {\n                (\"arrayBuffer\" === t.type ? n.arrayBuffer() : \"json\" === t.type ? n.json() : n.text()).then(function (t) {\n                  a || (o && l && function (t, r, n) {\n                    if (rt(), !W) return;\n                    var i = {\n                      status: r.status,\n                      statusText: r.statusText,\n                      headers: new e.Headers()\n                    };\n                    r.headers.forEach(function (t, e) {\n                      return i.headers.set(e, t);\n                    });\n                    var s = G(r.headers.get(\"Cache-Control\") || \"\");\n                    if (s[\"no-store\"]) return;\n                    s[\"max-age\"] && i.headers.set(\"Expires\", new Date(n + 1e3 * s[\"max-age\"]).toUTCString());\n                    var a = i.headers.get(\"Expires\");\n                    a && (new Date(a).getTime() - n < 42e4 || function (t, e) {\n                      if (void 0 === J) try {\n                        new Response(new ReadableStream()), J = !0;\n                      } catch (t) {\n                        J = !1;\n                      }\n                      J ? e(t.body) : t.blob().then(e);\n                    }(r, function (r) {\n                      var n = new e.Response(r, i);\n                      rt(), W && W.then(function (e) {\n                        return e.put(nt(t.url), n);\n                      }).catch(function (t) {\n                        return U(t.message);\n                      });\n                    }));\n                  }(i, o, l), s = !0, r(null, t, n.headers.get(\"Cache-Control\"), n.headers.get(\"Expires\")));\n                }).catch(function (t) {\n                  a || r(new Error(t.message));\n                });\n              };\n            return o ? function (t, e) {\n              if (rt(), !W) return e(null);\n              var r = nt(t.url);\n              W.then(function (t) {\n                t.match(r).then(function (n) {\n                  var i = function (t) {\n                    if (!t) return !1;\n                    var e = new Date(t.headers.get(\"Expires\") || 0),\n                      r = G(t.headers.get(\"Cache-Control\") || \"\");\n                    return e > Date.now() && !r[\"no-cache\"];\n                  }(n);\n                  t.delete(r), i && t.put(r, n.clone()), e(null, n, i);\n                }).catch(e);\n              }).catch(e);\n            }(i, u) : u(null, null), {\n              cancel: function cancel() {\n                a = !0, s || n.abort();\n              }\n            };\n          }(t, r);\n          if (N() && self.worker && self.worker.actor) return self.worker.actor.send(\"getResource\", t, r, void 0, !0);\n        }\n        var n;\n        return function (t, r) {\n          var n = new e.XMLHttpRequest();\n          n.open(t.method || \"GET\", t.url, !0), \"arrayBuffer\" === t.type && (n.responseType = \"arraybuffer\");\n          for (var _e5 in t.headers) n.setRequestHeader(_e5, t.headers[_e5]);\n          return \"json\" === t.type && (n.responseType = \"text\", n.setRequestHeader(\"Accept\", \"application/json\")), n.withCredentials = \"include\" === t.credentials, n.onerror = function () {\n            r(new Error(n.statusText));\n          }, n.onload = function () {\n            if ((n.status >= 200 && n.status < 300 || 0 === n.status) && null !== n.response) {\n              var _e6 = n.response;\n              if (\"json\" === t.type) try {\n                _e6 = JSON.parse(n.response);\n              } catch (t) {\n                return r(t);\n              }\n              r(null, _e6, n.getResponseHeader(\"Cache-Control\"), n.getResponseHeader(\"Expires\"));\n            } else r(new at(n.statusText, n.status, t.url));\n          }, n.send(t.body), {\n            cancel: function cancel() {\n              return n.abort();\n            }\n          };\n        }(t, r);\n      },\n      ut = function ut(t, e) {\n        return lt(z(t, {\n          type: \"arrayBuffer\"\n        }), e);\n      };\n    function ct(t) {\n      var r = e.document.createElement(\"a\");\n      return r.href = t, r.protocol === e.document.location.protocol && r.host === e.document.location.host;\n    }\n    var ht = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=\";\n    var pt, ft;\n    pt = [], ft = 0;\n    var dt = function dt(t, r) {\n        if (s.supported && (t.headers || (t.headers = {}), t.headers.accept = \"image/webp,*/*\"), ft >= i.MAX_PARALLEL_IMAGE_REQUESTS) {\n          var _e7 = {\n            requestParameters: t,\n            callback: r,\n            cancelled: !1,\n            cancel: function cancel() {\n              this.cancelled = !0;\n            }\n          };\n          return pt.push(_e7), _e7;\n        }\n        ft++;\n        var n = !1;\n        var a = function a() {\n            if (!n) for (n = !0, ft--; pt.length && ft < i.MAX_PARALLEL_IMAGE_REQUESTS;) {\n              var _t6 = pt.shift(),\n                _e8 = _t6.requestParameters,\n                _r6 = _t6.callback,\n                _n3 = _t6.cancelled;\n              _n3 || (_t6.cancel = dt(_e8, _r6).cancel);\n            }\n          },\n          o = ut(t, function (t, n, i, s) {\n            a(), t ? r(t) : n && (e.createImageBitmap ? function (t, r) {\n              var n = new e.Blob([new Uint8Array(t)], {\n                type: \"image/png\"\n              });\n              e.createImageBitmap(n).then(function (t) {\n                r(null, t);\n              }).catch(function (t) {\n                r(new Error(\"Could not load image because of \".concat(t.message, \". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.\")));\n              });\n            }(n, function (t, e) {\n              return r(t, e, i, s);\n            }) : function (t, r) {\n              var n = new e.Image(),\n                i = e.URL;\n              n.onload = function () {\n                r(null, n), i.revokeObjectURL(n.src), n.onload = null, e.requestAnimationFrame(function () {\n                  n.src = ht;\n                });\n              }, n.onerror = function () {\n                return r(new Error(\"Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.\"));\n              };\n              var s = new e.Blob([new Uint8Array(t)], {\n                type: \"image/png\"\n              });\n              n.src = t.byteLength ? i.createObjectURL(s) : ht;\n            }(n, function (t, e) {\n              return r(t, e, i, s);\n            }));\n          });\n        return {\n          cancel: function cancel() {\n            o.cancel(), a();\n          }\n        };\n      },\n      yt = \"NO_ACCESS_TOKEN\";\n    function mt(t) {\n      return 0 === t.indexOf(\"mapbox:\");\n    }\n    function gt(t) {\n      return i.API_URL_REGEX.test(t);\n    }\n    function xt(t) {\n      return i.API_CDN_URL_REGEX.test(t);\n    }\n    function vt(t) {\n      return i.API_STYLE_REGEX.test(t) && !bt(t);\n    }\n    function bt(t) {\n      return i.API_SPRITE_REGEX.test(t);\n    }\n    var wt = /^(\\w+):\\/\\/([^/?]*)(\\/[^?]+)?\\??(.+)?/;\n    function _t(t) {\n      var e = t.match(wt);\n      if (!e) throw new Error(\"Unable to parse URL object\");\n      return {\n        protocol: e[1],\n        authority: e[2],\n        path: e[3] || \"/\",\n        params: e[4] ? e[4].split(\"&\") : []\n      };\n    }\n    function At(t) {\n      var e = t.params.length ? \"?\".concat(t.params.join(\"&\")) : \"\";\n      return \"\".concat(t.protocol, \"://\").concat(t.authority).concat(t.path).concat(e);\n    }\n    function St(t) {\n      if (!t) return null;\n      var r = t.split(\".\");\n      if (!r || 3 !== r.length) return null;\n      try {\n        return JSON.parse(decodeURIComponent(e.atob(r[1]).split(\"\").map(function (t) {\n          return \"%\" + (\"00\" + t.charCodeAt(0).toString(16)).slice(-2);\n        }).join(\"\")));\n      } catch (t) {\n        return null;\n      }\n    }\n    var kt = /*#__PURE__*/function () {\n      function kt(t) {\n        _classCallCheck(this, kt);\n        this.type = t, this.anonId = null, this.eventData = {}, this.queue = [], this.pendingRequest = null;\n      }\n      _createClass(kt, [{\n        key: \"getStorageKey\",\n        value: function getStorageKey(t) {\n          var r = St(i.ACCESS_TOKEN);\n          var n = \"\";\n          return n = r && r.u ? e.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g, function (t, e) {\n            return String.fromCharCode(Number(\"0x\" + e));\n          })) : i.ACCESS_TOKEN || \"\", t ? \"mapbox.eventData.\".concat(t, \":\").concat(n) : \"mapbox.eventData:\".concat(n);\n        }\n      }, {\n        key: \"fetchEventData\",\n        value: function fetchEventData() {\n          var t = K(\"localStorage\"),\n            r = this.getStorageKey(),\n            n = this.getStorageKey(\"uuid\");\n          if (t) try {\n            var _t7 = e.localStorage.getItem(r);\n            _t7 && (this.eventData = JSON.parse(_t7));\n            var _i6 = e.localStorage.getItem(n);\n            _i6 && (this.anonId = _i6);\n          } catch (t) {\n            U(\"Unable to read from LocalStorage\");\n          }\n        }\n      }, {\n        key: \"saveEventData\",\n        value: function saveEventData() {\n          var t = K(\"localStorage\"),\n            r = this.getStorageKey(),\n            n = this.getStorageKey(\"uuid\");\n          if (t) try {\n            e.localStorage.setItem(n, this.anonId), Object.keys(this.eventData).length >= 1 && e.localStorage.setItem(r, JSON.stringify(this.eventData));\n          } catch (t) {\n            U(\"Unable to write to LocalStorage\");\n          }\n        }\n      }, {\n        key: \"processRequests\",\n        value: function processRequests(t) {}\n      }, {\n        key: \"postEvent\",\n        value: function postEvent(t, e, r, n) {\n          var _this2 = this;\n          if (!i.EVENTS_URL) return;\n          var s = _t(i.EVENTS_URL);\n          s.params.push(\"access_token=\".concat(n || i.ACCESS_TOKEN || \"\"));\n          var a = {\n              event: this.type,\n              created: new Date(t).toISOString()\n            },\n            o = e ? z(a, e) : a,\n            l = {\n              url: At(s),\n              headers: {\n                \"Content-Type\": \"text/plain\"\n              },\n              body: JSON.stringify([o])\n            };\n          this.pendingRequest = function (t, e) {\n            return lt(z(t, {\n              method: \"POST\"\n            }), e);\n          }(l, function (t) {\n            _this2.pendingRequest = null, r(t), _this2.saveEventData(), _this2.processRequests(n);\n          });\n        }\n      }, {\n        key: \"queueRequest\",\n        value: function queueRequest(t, e) {\n          this.queue.push(t), this.processRequests(e);\n        }\n      }]);\n      return kt;\n    }();\n    var It = new ( /*#__PURE__*/function (_kt) {\n        _inherits(_class, _kt);\n        function _class(t) {\n          var _this3;\n          _classCallCheck(this, _class);\n          _this3 = _possibleConstructorReturn(this, _getPrototypeOf(_class).call(this, \"appUserTurnstile\")), _this3._customAccessToken = t;\n          return _this3;\n        }\n        _createClass(_class, [{\n          key: \"postTurnstileEvent\",\n          value: function postTurnstileEvent(t, e) {\n            i.EVENTS_URL && i.ACCESS_TOKEN && Array.isArray(t) && t.some(function (t) {\n              return mt(t) || gt(t);\n            }) && this.queueRequest(Date.now(), e);\n          }\n        }, {\n          key: \"processRequests\",\n          value: function processRequests(t) {\n            var _this4 = this;\n            if (this.pendingRequest || 0 === this.queue.length) return;\n            this.anonId && this.eventData.lastSuccess && this.eventData.tokenU || this.fetchEventData();\n            var e = St(i.ACCESS_TOKEN),\n              n = e ? e.u : i.ACCESS_TOKEN;\n            var s = n !== this.eventData.tokenU;\n            D(this.anonId) || (this.anonId = C(), s = !0);\n            var a = this.queue.shift();\n            if (this.eventData.lastSuccess) {\n              var _t8 = new Date(this.eventData.lastSuccess),\n                _e9 = new Date(a),\n                _r7 = (a - this.eventData.lastSuccess) / 864e5;\n              s = s || _r7 >= 1 || _r7 < -1 || _t8.getDate() !== _e9.getDate();\n            } else s = !0;\n            s ? this.postEvent(a, {\n              sdkIdentifier: \"mapbox-gl-js\",\n              sdkVersion: r,\n              skuId: h,\n              \"enabled.telemetry\": !1,\n              userId: this.anonId\n            }, function (t) {\n              t || (_this4.eventData.lastSuccess = a, _this4.eventData.tokenU = n);\n            }, t) : this.processRequests();\n          }\n        }]);\n        return _class;\n      }(kt))(),\n      Mt = It.postTurnstileEvent.bind(It),\n      Tt = new ( /*#__PURE__*/function (_kt2) {\n        _inherits(_class2, _kt2);\n        function _class2() {\n          var _this5;\n          _classCallCheck(this, _class2);\n          _this5 = _possibleConstructorReturn(this, _getPrototypeOf(_class2).call(this, \"map.load\")), _this5.success = {}, _this5.skuToken = \"\";\n          return _this5;\n        }\n        _createClass(_class2, [{\n          key: \"postMapLoadEvent\",\n          value: function postMapLoadEvent(t, e, r, n) {\n            this.skuToken = e, this.errorCb = n, i.EVENTS_URL && (r || i.ACCESS_TOKEN ? this.queueRequest({\n              id: t,\n              timestamp: Date.now()\n            }, r) : this.errorCb(new Error(yt)));\n          }\n        }, {\n          key: \"processRequests\",\n          value: function processRequests(t) {\n            var _this6 = this;\n            if (this.pendingRequest || 0 === this.queue.length) return;\n            var _this$queue$shift = this.queue.shift(),\n              e = _this$queue$shift.id,\n              n = _this$queue$shift.timestamp;\n            e && this.success[e] || (this.anonId || this.fetchEventData(), D(this.anonId) || (this.anonId = C()), this.postEvent(n, {\n              sdkIdentifier: \"mapbox-gl-js\",\n              sdkVersion: r,\n              skuId: h,\n              skuToken: this.skuToken,\n              userId: this.anonId\n            }, function (t) {\n              t ? _this6.errorCb(t) : e && (_this6.success[e] = !0);\n            }, t));\n          }\n        }]);\n        return _class2;\n      }(kt))(),\n      zt = Tt.postMapLoadEvent.bind(Tt),\n      Bt = new ( /*#__PURE__*/function (_kt3) {\n        _inherits(_class3, _kt3);\n        function _class3() {\n          _classCallCheck(this, _class3);\n          return _possibleConstructorReturn(this, _getPrototypeOf(_class3).call(this, \"gljs.performance\"));\n        }\n        _createClass(_class3, [{\n          key: \"postPerformanceEvent\",\n          value: function postPerformanceEvent(t, e) {\n            i.EVENTS_URL && (t || i.ACCESS_TOKEN) && this.queueRequest({\n              timestamp: Date.now(),\n              performanceData: e\n            }, t);\n          }\n        }, {\n          key: \"processRequests\",\n          value: function processRequests(t) {\n            if (this.pendingRequest || 0 === this.queue.length) return;\n            var _this$queue$shift2 = this.queue.shift(),\n              n = _this$queue$shift2.timestamp,\n              i = _this$queue$shift2.performanceData,\n              s = function (t) {\n                var n = e.performance.getEntriesByType(\"resource\"),\n                  i = e.performance.getEntriesByType(\"mark\"),\n                  s = function (t) {\n                    var e = {};\n                    if (t) for (var _r8 in t) if (\"other\" !== _r8) {\n                      var _iterator = _createForOfIteratorHelper(t[_r8]),\n                        _step;\n                      try {\n                        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                          var _n4 = _step.value;\n                          var _t9 = \"\".concat(_r8, \"ResolveRangeMin\"),\n                            _i7 = \"\".concat(_r8, \"ResolveRangeMax\"),\n                            _s3 = \"\".concat(_r8, \"RequestCount\"),\n                            _a3 = \"\".concat(_r8, \"RequestCachedCount\");\n                          e[_t9] = Math.min(e[_t9] || 1 / 0, _n4.startTime), e[_i7] = Math.max(e[_i7] || -1 / 0, _n4.responseEnd);\n                          var _o2 = function _o2(t) {\n                            void 0 === e[t] && (e[t] = 0), ++e[t];\n                          };\n                          void 0 !== _n4.transferSize && 0 === _n4.transferSize && _o2(_a3), _o2(_s3);\n                        }\n                      } catch (err) {\n                        _iterator.e(err);\n                      } finally {\n                        _iterator.f();\n                      }\n                    }\n                    return e;\n                  }(function (t, e) {\n                    var r = {};\n                    if (t) {\n                      var _iterator2 = _createForOfIteratorHelper(t),\n                        _step2;\n                      try {\n                        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                          var _n5 = _step2.value;\n                          var _t10 = e(_n5);\n                          void 0 === r[_t10] && (r[_t10] = []), r[_t10].push(_n5);\n                        }\n                      } catch (err) {\n                        _iterator2.e(err);\n                      } finally {\n                        _iterator2.f();\n                      }\n                    }\n                    return r;\n                  }(n, Ft)),\n                  a = e.devicePixelRatio,\n                  o = e.navigator.connection || e.navigator.mozConnection || e.navigator.webkitConnection,\n                  l = {\n                    counters: [],\n                    metadata: [],\n                    attributes: []\n                  },\n                  u = function u(t, e, r) {\n                    null != r && t.push({\n                      name: e,\n                      value: r.toString()\n                    });\n                  };\n                for (var _t11 in s) u(l.counters, _t11, s[_t11]);\n                if (t.interactionRange[0] !== 1 / 0 && t.interactionRange[1] !== -1 / 0 && (u(l.counters, \"interactionRangeMin\", t.interactionRange[0]), u(l.counters, \"interactionRangeMax\", t.interactionRange[1])), i) {\n                  var _loop = function _loop() {\n                    var t = _Object$keys[_i8];\n                    var e = Vt[t],\n                      r = i.find(function (t) {\n                        return t.name === e;\n                      });\n                    r && u(l.counters, e, r.startTime);\n                  };\n                  for (var _i8 = 0, _Object$keys = Object.keys(Vt); _i8 < _Object$keys.length; _i8++) {\n                    _loop();\n                  }\n                }\n                return u(l.counters, \"visibilityHidden\", t.visibilityHidden), u(l.attributes, \"style\", function (t) {\n                  if (t) {\n                    var _iterator3 = _createForOfIteratorHelper(t),\n                      _step3;\n                    try {\n                      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                        var _e10 = _step3.value;\n                        var _t12 = _e10.name.split(\"?\")[0];\n                        if (vt(_t12)) {\n                          var _e11 = _t12.split(\"/\").slice(-2);\n                          if (2 === _e11.length) return \"mapbox://styles/\".concat(_e11[0], \"/\").concat(_e11[1]);\n                        }\n                      }\n                    } catch (err) {\n                      _iterator3.e(err);\n                    } finally {\n                      _iterator3.f();\n                    }\n                  }\n                }(n)), u(l.attributes, \"terrainEnabled\", t.terrainEnabled ? \"true\" : \"false\"), u(l.attributes, \"fogEnabled\", t.fogEnabled ? \"true\" : \"false\"), u(l.attributes, \"projection\", t.projection), u(l.attributes, \"zoom\", t.zoom), u(l.metadata, \"devicePixelRatio\", a), u(l.metadata, \"connectionEffectiveType\", o ? o.effectiveType : void 0), u(l.metadata, \"navigatorUserAgent\", e.navigator.userAgent), u(l.metadata, \"screenWidth\", e.screen.width), u(l.metadata, \"screenHeight\", e.screen.height), u(l.metadata, \"windowWidth\", e.innerWidth), u(l.metadata, \"windowHeight\", e.innerHeight), u(l.metadata, \"mapWidth\", t.width / a), u(l.metadata, \"mapHeight\", t.height / a), u(l.metadata, \"webglRenderer\", t.renderer), u(l.metadata, \"webglVendor\", t.vendor), u(l.metadata, \"sdkVersion\", r), u(l.metadata, \"sdkIdentifier\", \"mapbox-gl-js\"), l;\n              }(i);\n            var _iterator4 = _createForOfIteratorHelper(s.metadata),\n              _step4;\n            try {\n              for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n                var _t13 = _step4.value;\n              }\n            } catch (err) {\n              _iterator4.e(err);\n            } finally {\n              _iterator4.f();\n            }\n            var _iterator5 = _createForOfIteratorHelper(s.counters),\n              _step5;\n            try {\n              for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n                var _t14 = _step5.value;\n              }\n            } catch (err) {\n              _iterator5.e(err);\n            } finally {\n              _iterator5.f();\n            }\n            var _iterator6 = _createForOfIteratorHelper(s.attributes),\n              _step6;\n            try {\n              for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n                var _t15 = _step6.value;\n              }\n            } catch (err) {\n              _iterator6.e(err);\n            } finally {\n              _iterator6.f();\n            }\n            this.postEvent(n, s, function () {}, t);\n          }\n        }]);\n        return _class3;\n      }(kt))(),\n      Et = Bt.postPerformanceEvent.bind(Bt),\n      Ct = new ( /*#__PURE__*/function (_kt4) {\n        _inherits(_class4, _kt4);\n        function _class4() {\n          var _this7;\n          _classCallCheck(this, _class4);\n          _this7 = _possibleConstructorReturn(this, _getPrototypeOf(_class4).call(this, \"map.auth\")), _this7.success = {}, _this7.skuToken = \"\";\n          return _this7;\n        }\n        _createClass(_class4, [{\n          key: \"getSession\",\n          value: function getSession(t, e, r, n) {\n            var _this8 = this;\n            if (!i.API_URL || !i.SESSION_PATH) return;\n            var s = _t(i.API_URL + i.SESSION_PATH);\n            s.params.push(\"sku=\".concat(e || \"\")), s.params.push(\"access_token=\".concat(n || i.ACCESS_TOKEN || \"\"));\n            var a = {\n              url: At(s),\n              headers: {\n                \"Content-Type\": \"text/plain\"\n              }\n            };\n            this.pendingRequest = function (t, e) {\n              return lt(z(t, {\n                method: \"GET\"\n              }), e);\n            }(a, function (t) {\n              _this8.pendingRequest = null, r(t), _this8.saveEventData(), _this8.processRequests(n);\n            });\n          }\n        }, {\n          key: \"getSessionAPI\",\n          value: function getSessionAPI(t, e, r, n) {\n            this.skuToken = e, this.errorCb = n, i.SESSION_PATH && i.API_URL && (r || i.ACCESS_TOKEN ? this.queueRequest({\n              id: t,\n              timestamp: Date.now()\n            }, r) : this.errorCb(new Error(yt)));\n          }\n        }, {\n          key: \"processRequests\",\n          value: function processRequests(t) {\n            var _this9 = this;\n            if (this.pendingRequest || 0 === this.queue.length) return;\n            var _this$queue$shift3 = this.queue.shift(),\n              e = _this$queue$shift3.id,\n              r = _this$queue$shift3.timestamp;\n            e && this.success[e] || this.getSession(r, this.skuToken, function (t) {\n              t ? _this9.errorCb(t) : e && (_this9.success[e] = !0);\n            }, t);\n          }\n        }]);\n        return _class4;\n      }(kt))(),\n      Pt = Ct.getSessionAPI.bind(Ct),\n      Dt = new Set(),\n      Vt = {\n        create: \"create\",\n        load: \"load\",\n        fullLoad: \"fullLoad\"\n      },\n      Lt = {\n        mark: function mark(t) {\n          e.performance.mark(t);\n        },\n        measure: function measure(t, r, n) {\n          e.performance.measure(t, r, n);\n        }\n      };\n    function Ft(t) {\n      var e = t.name.split(\"?\")[0];\n      return xt(e) && e.includes(\"mapbox-gl.js\") ? \"javascript\" : xt(e) && e.includes(\"mapbox-gl.css\") ? \"css\" : function (t) {\n        return i.API_FONTS_REGEX.test(t);\n      }(e) ? \"fontRange\" : bt(e) ? \"sprite\" : vt(e) ? \"style\" : function (t) {\n        return i.API_TILEJSON_REGEX.test(t);\n      }(e) ? \"tilejson\" : \"other\";\n    }\n    var Rt = e.performance;\n    function jt(t) {\n      var e = t ? t.url.toString() : void 0;\n      return Rt.getEntriesByName(e);\n    }\n    var $t, Ut, Ot, qt;\n    var Nt = {\n      now: function now() {\n        return void 0 !== Ot ? Ot : e.performance.now();\n      },\n      setNow: function setNow(t) {\n        Ot = t;\n      },\n      restoreNow: function restoreNow() {\n        Ot = void 0;\n      },\n      frame: function frame(t) {\n        var r = e.requestAnimationFrame(t);\n        return {\n          cancel: function cancel() {\n            return e.cancelAnimationFrame(r);\n          }\n        };\n      },\n      getImageData: function getImageData(t) {\n        var r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n        var n = t.width,\n          i = t.height;\n        qt || (qt = e.document.createElement(\"canvas\"));\n        var s = qt.getContext(\"2d\", {\n          willReadFrequently: !0\n        });\n        if (!s) throw new Error(\"failed to create canvas 2d context\");\n        return (n > qt.width || i > qt.height) && (qt.width = n, qt.height = i), s.clearRect(-r, -r, n + 2 * r, i + 2 * r), s.drawImage(t, 0, 0, n, i), s.getImageData(-r, -r, n + 2 * r, i + 2 * r);\n      },\n      resolveURL: function resolveURL(t) {\n        return $t || ($t = e.document.createElement(\"a\")), $t.href = t, $t.href;\n      },\n      get devicePixelRatio() {\n        return e.devicePixelRatio;\n      },\n      get prefersReducedMotion() {\n        return !!e.matchMedia && (null == Ut && (Ut = e.matchMedia(\"(prefers-reduced-motion: reduce)\")), Ut.matches);\n      }\n    };\n    function Gt(t, e, r) {\n      r[t] && -1 !== r[t].indexOf(e) || (r[t] = r[t] || [], r[t].push(e));\n    }\n    function Zt(t, e, r) {\n      if (r && r[t]) {\n        var _n6 = r[t].indexOf(e);\n        -1 !== _n6 && r[t].splice(_n6, 1);\n      }\n    }\n    var Xt = function Xt(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      _classCallCheck(this, Xt);\n      z(this, e), this.type = t;\n    };\n    var Kt = /*#__PURE__*/function (_Xt) {\n      _inherits(Kt, _Xt);\n      function Kt(t) {\n        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        _classCallCheck(this, Kt);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Kt).call(this, \"error\", z({\n          error: t\n        }, e)));\n      }\n      return Kt;\n    }(Xt);\n    var Yt = /*#__PURE__*/function () {\n      function Yt() {\n        _classCallCheck(this, Yt);\n      }\n      _createClass(Yt, [{\n        key: \"on\",\n        value: function on(t, e) {\n          return this._listeners = this._listeners || {}, Gt(t, e, this._listeners), this;\n        }\n      }, {\n        key: \"off\",\n        value: function off(t, e) {\n          return Zt(t, e, this._listeners), Zt(t, e, this._oneTimeListeners), this;\n        }\n      }, {\n        key: \"once\",\n        value: function once(t, e) {\n          var _this10 = this;\n          return e ? (this._oneTimeListeners = this._oneTimeListeners || {}, Gt(t, e, this._oneTimeListeners), this) : new Promise(function (e) {\n            return _this10.once(t, e);\n          });\n        }\n      }, {\n        key: \"fire\",\n        value: function fire(t, e) {\n          \"string\" == typeof t && (t = new Xt(t, e || {}));\n          var r = t.type;\n          if (this.listens(r)) {\n            t.target = this;\n            var _e12 = this._listeners && this._listeners[r] ? this._listeners[r].slice() : [];\n            var _iterator7 = _createForOfIteratorHelper(_e12),\n              _step7;\n            try {\n              for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n                var _r9 = _step7.value;\n                _r9.call(this, t);\n              }\n            } catch (err) {\n              _iterator7.e(err);\n            } finally {\n              _iterator7.f();\n            }\n            var _n7 = this._oneTimeListeners && this._oneTimeListeners[r] ? this._oneTimeListeners[r].slice() : [];\n            var _iterator8 = _createForOfIteratorHelper(_n7),\n              _step8;\n            try {\n              for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n                var _e13 = _step8.value;\n                Zt(r, _e13, this._oneTimeListeners), _e13.call(this, t);\n              }\n            } catch (err) {\n              _iterator8.e(err);\n            } finally {\n              _iterator8.f();\n            }\n            var _i9 = this._eventedParent;\n            _i9 && (z(t, \"function\" == typeof this._eventedParentData ? this._eventedParentData() : this._eventedParentData), _i9.fire(t));\n          } else t instanceof Kt && console.error(t.error);\n          return this;\n        }\n      }, {\n        key: \"listens\",\n        value: function listens(t) {\n          return !!(this._listeners && this._listeners[t] && this._listeners[t].length > 0 || this._oneTimeListeners && this._oneTimeListeners[t] && this._oneTimeListeners[t].length > 0 || this._eventedParent && this._eventedParent.listens(t));\n        }\n      }, {\n        key: \"setEventedParent\",\n        value: function setEventedParent(t, e) {\n          return this._eventedParent = t, this._eventedParentData = e, this;\n        }\n      }]);\n      return Yt;\n    }();\n    var Ht = JSON.parse('{\"$version\":8,\"$root\":{\"version\":{\"required\":true,\"type\":\"enum\",\"values\":[8]},\"name\":{\"type\":\"string\"},\"metadata\":{\"type\":\"*\"},\"center\":{\"type\":\"array\",\"value\":\"number\"},\"zoom\":{\"type\":\"number\"},\"bearing\":{\"type\":\"number\",\"default\":0,\"period\":360,\"units\":\"degrees\"},\"pitch\":{\"type\":\"number\",\"default\":0,\"units\":\"degrees\"},\"light\":{\"type\":\"light\"},\"terrain\":{\"type\":\"terrain\"},\"fog\":{\"type\":\"fog\"},\"sources\":{\"required\":true,\"type\":\"sources\"},\"sprite\":{\"type\":\"string\"},\"glyphs\":{\"type\":\"string\"},\"transition\":{\"type\":\"transition\"},\"projection\":{\"type\":\"projection\"},\"layers\":{\"required\":true,\"type\":\"array\",\"value\":\"layer\"}},\"sources\":{\"*\":{\"type\":\"source\"}},\"source\":[\"source_vector\",\"source_raster\",\"source_raster_dem\",\"source_geojson\",\"source_video\",\"source_image\"],\"source_vector\":{\"type\":{\"required\":true,\"type\":\"enum\",\"values\":{\"vector\":{}}},\"url\":{\"type\":\"string\"},\"tiles\":{\"type\":\"array\",\"value\":\"string\"},\"bounds\":{\"type\":\"array\",\"value\":\"number\",\"length\":4,\"default\":[-180,-85.051129,180,85.051129]},\"scheme\":{\"type\":\"enum\",\"values\":{\"xyz\":{},\"tms\":{}},\"default\":\"xyz\"},\"minzoom\":{\"type\":\"number\",\"default\":0},\"maxzoom\":{\"type\":\"number\",\"default\":22},\"attribution\":{\"type\":\"string\"},\"promoteId\":{\"type\":\"promoteId\"},\"volatile\":{\"type\":\"boolean\",\"default\":false},\"*\":{\"type\":\"*\"}},\"source_raster\":{\"type\":{\"required\":true,\"type\":\"enum\",\"values\":{\"raster\":{}}},\"url\":{\"type\":\"string\"},\"tiles\":{\"type\":\"array\",\"value\":\"string\"},\"bounds\":{\"type\":\"array\",\"value\":\"number\",\"length\":4,\"default\":[-180,-85.051129,180,85.051129]},\"minzoom\":{\"type\":\"number\",\"default\":0},\"maxzoom\":{\"type\":\"number\",\"default\":22},\"tileSize\":{\"type\":\"number\",\"default\":512,\"units\":\"pixels\"},\"scheme\":{\"type\":\"enum\",\"values\":{\"xyz\":{},\"tms\":{}},\"default\":\"xyz\"},\"attribution\":{\"type\":\"string\"},\"volatile\":{\"type\":\"boolean\",\"default\":false},\"*\":{\"type\":\"*\"}},\"source_raster_dem\":{\"type\":{\"required\":true,\"type\":\"enum\",\"values\":{\"raster-dem\":{}}},\"url\":{\"type\":\"string\"},\"tiles\":{\"type\":\"array\",\"value\":\"string\"},\"bounds\":{\"type\":\"array\",\"value\":\"number\",\"length\":4,\"default\":[-180,-85.051129,180,85.051129]},\"minzoom\":{\"type\":\"number\",\"default\":0},\"maxzoom\":{\"type\":\"number\",\"default\":22},\"tileSize\":{\"type\":\"number\",\"default\":512,\"units\":\"pixels\"},\"attribution\":{\"type\":\"string\"},\"encoding\":{\"type\":\"enum\",\"values\":{\"terrarium\":{},\"mapbox\":{}},\"default\":\"mapbox\"},\"volatile\":{\"type\":\"boolean\",\"default\":false},\"*\":{\"type\":\"*\"}},\"source_geojson\":{\"type\":{\"required\":true,\"type\":\"enum\",\"values\":{\"geojson\":{}}},\"data\":{\"type\":\"*\"},\"maxzoom\":{\"type\":\"number\",\"default\":18},\"attribution\":{\"type\":\"string\"},\"buffer\":{\"type\":\"number\",\"default\":128,\"maximum\":512,\"minimum\":0},\"filter\":{\"type\":\"*\"},\"tolerance\":{\"type\":\"number\",\"default\":0.375},\"cluster\":{\"type\":\"boolean\",\"default\":false},\"clusterRadius\":{\"type\":\"number\",\"default\":50,\"minimum\":0},\"clusterMaxZoom\":{\"type\":\"number\"},\"clusterMinPoints\":{\"type\":\"number\"},\"clusterProperties\":{\"type\":\"*\"},\"lineMetrics\":{\"type\":\"boolean\",\"default\":false},\"generateId\":{\"type\":\"boolean\",\"default\":false},\"promoteId\":{\"type\":\"promoteId\"}},\"source_video\":{\"type\":{\"required\":true,\"type\":\"enum\",\"values\":{\"video\":{}}},\"urls\":{\"required\":true,\"type\":\"array\",\"value\":\"string\"},\"coordinates\":{\"required\":true,\"type\":\"array\",\"length\":4,\"value\":{\"type\":\"array\",\"length\":2,\"value\":\"number\"}}},\"source_image\":{\"type\":{\"required\":true,\"type\":\"enum\",\"values\":{\"image\":{}}},\"url\":{\"required\":true,\"type\":\"string\"},\"coordinates\":{\"required\":true,\"type\":\"array\",\"length\":4,\"value\":{\"type\":\"array\",\"length\":2,\"value\":\"number\"}}},\"layer\":{\"id\":{\"type\":\"string\",\"required\":true},\"type\":{\"type\":\"enum\",\"values\":{\"fill\":{},\"line\":{},\"symbol\":{},\"circle\":{},\"heatmap\":{},\"fill-extrusion\":{},\"raster\":{},\"hillshade\":{},\"background\":{},\"sky\":{}},\"required\":true},\"metadata\":{\"type\":\"*\"},\"source\":{\"type\":\"string\"},\"source-layer\":{\"type\":\"string\"},\"minzoom\":{\"type\":\"number\",\"minimum\":0,\"maximum\":24},\"maxzoom\":{\"type\":\"number\",\"minimum\":0,\"maximum\":24},\"filter\":{\"type\":\"filter\"},\"layout\":{\"type\":\"layout\"},\"paint\":{\"type\":\"paint\"}},\"layout\":[\"layout_fill\",\"layout_line\",\"layout_circle\",\"layout_heatmap\",\"layout_fill-extrusion\",\"layout_symbol\",\"layout_raster\",\"layout_hillshade\",\"layout_background\",\"layout_sky\"],\"layout_background\":{\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_sky\":{\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_fill\":{\"fill-sort-key\":{\"type\":\"number\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_circle\":{\"circle-sort-key\":{\"type\":\"number\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_heatmap\":{\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_fill-extrusion\":{\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"},\"fill-extrusion-edge-radius\":{\"type\":\"number\",\"private\":true,\"default\":0,\"minimum\":0,\"maximum\":1,\"property-type\":\"constant\"}},\"layout_line\":{\"line-cap\":{\"type\":\"enum\",\"values\":{\"butt\":{},\"round\":{},\"square\":{}},\"default\":\"butt\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"line-join\":{\"type\":\"enum\",\"values\":{\"bevel\":{},\"round\":{},\"miter\":{}},\"default\":\"miter\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"line-miter-limit\":{\"type\":\"number\",\"default\":2,\"requires\":[{\"line-join\":\"miter\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-round-limit\":{\"type\":\"number\",\"default\":1.05,\"requires\":[{\"line-join\":\"round\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-sort-key\":{\"type\":\"number\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_symbol\":{\"symbol-placement\":{\"type\":\"enum\",\"values\":{\"point\":{},\"line\":{},\"line-center\":{}},\"default\":\"point\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"symbol-spacing\":{\"type\":\"number\",\"default\":250,\"minimum\":1,\"units\":\"pixels\",\"requires\":[{\"symbol-placement\":\"line\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"symbol-avoid-edges\":{\"type\":\"boolean\",\"default\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"symbol-sort-key\":{\"type\":\"number\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"symbol-z-order\":{\"type\":\"enum\",\"values\":{\"auto\":{},\"viewport-y\":{},\"source\":{}},\"default\":\"auto\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-allow-overlap\":{\"type\":\"boolean\",\"default\":false,\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-ignore-placement\":{\"type\":\"boolean\",\"default\":false,\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-optional\":{\"type\":\"boolean\",\"default\":false,\"requires\":[\"icon-image\",\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-rotation-alignment\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{},\"auto\":{}},\"default\":\"auto\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-size\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"units\":\"factor of the original icon size\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-text-fit\":{\"type\":\"enum\",\"values\":{\"none\":{},\"width\":{},\"height\":{},\"both\":{}},\"default\":\"none\",\"requires\":[\"icon-image\",\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-text-fit-padding\":{\"type\":\"array\",\"value\":\"number\",\"length\":4,\"default\":[0,0,0,0],\"units\":\"pixels\",\"requires\":[\"icon-image\",\"text-field\",{\"icon-text-fit\":[\"both\",\"width\",\"height\"]}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-image\":{\"type\":\"resolvedImage\",\"tokens\":true,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-rotate\":{\"type\":\"number\",\"default\":0,\"period\":360,\"units\":\"degrees\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-padding\":{\"type\":\"number\",\"default\":2,\"minimum\":0,\"units\":\"pixels\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-keep-upright\":{\"type\":\"boolean\",\"default\":false,\"requires\":[\"icon-image\",{\"icon-rotation-alignment\":\"map\"},{\"symbol-placement\":[\"line\",\"line-center\"]}],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-offset\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-anchor\":{\"type\":\"enum\",\"values\":{\"center\":{},\"left\":{},\"right\":{},\"top\":{},\"bottom\":{},\"top-left\":{},\"top-right\":{},\"bottom-left\":{},\"bottom-right\":{}},\"default\":\"center\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"icon-pitch-alignment\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{},\"auto\":{}},\"default\":\"auto\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-pitch-alignment\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{},\"auto\":{}},\"default\":\"auto\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-rotation-alignment\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{},\"auto\":{}},\"default\":\"auto\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-field\":{\"type\":\"formatted\",\"default\":\"\",\"tokens\":true,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-font\":{\"type\":\"array\",\"value\":\"string\",\"default\":[\"Open Sans Regular\",\"Arial Unicode MS Regular\"],\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-size\":{\"type\":\"number\",\"default\":16,\"minimum\":0,\"units\":\"pixels\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-max-width\":{\"type\":\"number\",\"default\":10,\"minimum\":0,\"units\":\"ems\",\"requires\":[\"text-field\",{\"symbol-placement\":[\"point\"]}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-line-height\":{\"type\":\"number\",\"default\":1.2,\"units\":\"ems\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-letter-spacing\":{\"type\":\"number\",\"default\":0,\"units\":\"ems\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-justify\":{\"type\":\"enum\",\"values\":{\"auto\":{},\"left\":{},\"center\":{},\"right\":{}},\"default\":\"center\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-radial-offset\":{\"type\":\"number\",\"units\":\"ems\",\"default\":0,\"requires\":[\"text-field\"],\"property-type\":\"data-driven\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]}},\"text-variable-anchor\":{\"type\":\"array\",\"value\":\"enum\",\"values\":{\"center\":{},\"left\":{},\"right\":{},\"top\":{},\"bottom\":{},\"top-left\":{},\"top-right\":{},\"bottom-left\":{},\"bottom-right\":{}},\"requires\":[\"text-field\",{\"symbol-placement\":[\"point\"]}],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-anchor\":{\"type\":\"enum\",\"values\":{\"center\":{},\"left\":{},\"right\":{},\"top\":{},\"bottom\":{},\"top-left\":{},\"top-right\":{},\"bottom-left\":{},\"bottom-right\":{}},\"default\":\"center\",\"requires\":[\"text-field\",{\"!\":\"text-variable-anchor\"}],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-max-angle\":{\"type\":\"number\",\"default\":45,\"units\":\"degrees\",\"requires\":[\"text-field\",{\"symbol-placement\":[\"line\",\"line-center\"]}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-writing-mode\":{\"type\":\"array\",\"value\":\"enum\",\"values\":{\"horizontal\":{},\"vertical\":{}},\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-rotate\":{\"type\":\"number\",\"default\":0,\"period\":360,\"units\":\"degrees\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-padding\":{\"type\":\"number\",\"default\":2,\"minimum\":0,\"units\":\"pixels\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-keep-upright\":{\"type\":\"boolean\",\"default\":true,\"requires\":[\"text-field\",{\"text-rotation-alignment\":\"map\"},{\"symbol-placement\":[\"line\",\"line-center\"]}],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-transform\":{\"type\":\"enum\",\"values\":{\"none\":{},\"uppercase\":{},\"lowercase\":{}},\"default\":\"none\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-offset\":{\"type\":\"array\",\"value\":\"number\",\"units\":\"ems\",\"length\":2,\"default\":[0,0],\"requires\":[\"text-field\",{\"!\":\"text-radial-offset\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"text-allow-overlap\":{\"type\":\"boolean\",\"default\":false,\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-ignore-placement\":{\"type\":\"boolean\",\"default\":false,\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-optional\":{\"type\":\"boolean\",\"default\":false,\"requires\":[\"text-field\",\"icon-image\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_raster\":{\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"layout_hillshade\":{\"visibility\":{\"type\":\"enum\",\"values\":{\"visible\":{},\"none\":{}},\"default\":\"visible\",\"property-type\":\"constant\"}},\"filter\":{\"type\":\"array\",\"value\":\"*\"},\"filter_symbol\":{\"type\":\"boolean\",\"default\":false,\"transition\":false,\"property-type\":\"data-driven\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\",\"pitch\",\"distance-from-center\"]}},\"filter_fill\":{\"type\":\"boolean\",\"default\":false,\"transition\":false,\"property-type\":\"data-driven\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]}},\"filter_line\":{\"type\":\"boolean\",\"default\":false,\"transition\":false,\"property-type\":\"data-driven\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]}},\"filter_circle\":{\"type\":\"boolean\",\"default\":false,\"transition\":false,\"property-type\":\"data-driven\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]}},\"filter_fill-extrusion\":{\"type\":\"boolean\",\"default\":false,\"transition\":false,\"property-type\":\"data-driven\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]}},\"filter_heatmap\":{\"type\":\"boolean\",\"default\":false,\"transition\":false,\"property-type\":\"data-driven\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]}},\"filter_operator\":{\"type\":\"enum\",\"values\":{\"==\":{},\"!=\":{},\">\":{},\">=\":{},\"<\":{},\"<=\":{},\"in\":{},\"!in\":{},\"all\":{},\"any\":{},\"none\":{},\"has\":{},\"!has\":{},\"within\":{}}},\"geometry_type\":{\"type\":\"enum\",\"values\":{\"Point\":{},\"LineString\":{},\"Polygon\":{}}},\"function\":{\"expression\":{\"type\":\"expression\"},\"stops\":{\"type\":\"array\",\"value\":\"function_stop\"},\"base\":{\"type\":\"number\",\"default\":1,\"minimum\":0},\"property\":{\"type\":\"string\",\"default\":\"$zoom\"},\"type\":{\"type\":\"enum\",\"values\":{\"identity\":{},\"exponential\":{},\"interval\":{},\"categorical\":{}},\"default\":\"exponential\"},\"colorSpace\":{\"type\":\"enum\",\"values\":{\"rgb\":{},\"lab\":{},\"hcl\":{}},\"default\":\"rgb\"},\"default\":{\"type\":\"*\",\"required\":false}},\"function_stop\":{\"type\":\"array\",\"minimum\":0,\"maximum\":24,\"value\":[\"number\",\"color\"],\"length\":2},\"expression\":{\"type\":\"array\",\"value\":\"*\",\"minimum\":1},\"fog\":{\"range\":{\"type\":\"array\",\"default\":[0.5,10],\"minimum\":-20,\"maximum\":20,\"length\":2,\"value\":\"number\",\"property-type\":\"data-constant\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]}},\"color\":{\"type\":\"color\",\"property-type\":\"data-constant\",\"default\":\"#ffffff\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true},\"high-color\":{\"type\":\"color\",\"property-type\":\"data-constant\",\"default\":\"#245cdf\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true},\"space-color\":{\"type\":\"color\",\"property-type\":\"data-constant\",\"default\":[\"interpolate\",[\"linear\"],[\"zoom\"],4,\"#010b19\",7,\"#367ab9\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true},\"horizon-blend\":{\"type\":\"number\",\"property-type\":\"data-constant\",\"default\":[\"interpolate\",[\"linear\"],[\"zoom\"],4,0.2,7,0.1],\"minimum\":0,\"maximum\":1,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true},\"star-intensity\":{\"type\":\"number\",\"property-type\":\"data-constant\",\"default\":[\"interpolate\",[\"linear\"],[\"zoom\"],5,0.35,6,0],\"minimum\":0,\"maximum\":1,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true}},\"light\":{\"anchor\":{\"type\":\"enum\",\"default\":\"viewport\",\"values\":{\"map\":{},\"viewport\":{}},\"property-type\":\"data-constant\",\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]}},\"position\":{\"type\":\"array\",\"default\":[1.15,210,30],\"length\":3,\"value\":\"number\",\"property-type\":\"data-constant\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]}},\"color\":{\"type\":\"color\",\"property-type\":\"data-constant\",\"default\":\"#ffffff\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true},\"intensity\":{\"type\":\"number\",\"property-type\":\"data-constant\",\"default\":0.5,\"minimum\":0,\"maximum\":1,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true}},\"projection\":{\"name\":{\"type\":\"enum\",\"values\":{\"albers\":{},\"equalEarth\":{},\"equirectangular\":{},\"lambertConformalConic\":{},\"mercator\":{},\"naturalEarth\":{},\"winkelTripel\":{},\"globe\":{}},\"default\":\"mercator\",\"required\":true},\"center\":{\"type\":\"array\",\"length\":2,\"value\":\"number\",\"property-type\":\"data-constant\",\"minimum\":[-180,-90],\"maximum\":[180,90],\"transition\":false,\"requires\":[{\"name\":[\"albers\",\"lambertConformalConic\"]}]},\"parallels\":{\"type\":\"array\",\"length\":2,\"value\":\"number\",\"property-type\":\"data-constant\",\"minimum\":[-90,-90],\"maximum\":[90,90],\"transition\":false,\"requires\":[{\"name\":[\"albers\",\"lambertConformalConic\"]}]}},\"terrain\":{\"source\":{\"type\":\"string\",\"required\":true},\"exaggeration\":{\"type\":\"number\",\"property-type\":\"data-constant\",\"default\":1,\"minimum\":0,\"maximum\":1000,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true,\"requires\":[\"source\"]}},\"paint\":[\"paint_fill\",\"paint_line\",\"paint_circle\",\"paint_heatmap\",\"paint_fill-extrusion\",\"paint_symbol\",\"paint_raster\",\"paint_hillshade\",\"paint_background\",\"paint_sky\"],\"paint_fill\":{\"fill-antialias\":{\"type\":\"boolean\",\"default\":true,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"requires\":[{\"!\":\"fill-pattern\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-outline-color\":{\"type\":\"color\",\"transition\":true,\"requires\":[{\"!\":\"fill-pattern\"},{\"fill-antialias\":true}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-translate\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-translate-anchor\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"map\",\"requires\":[\"fill-translate\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-pattern\":{\"type\":\"resolvedImage\",\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"}},\"paint_fill-extrusion\":{\"fill-extrusion-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-extrusion-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"requires\":[{\"!\":\"fill-extrusion-pattern\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-extrusion-translate\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-extrusion-translate-anchor\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"map\",\"requires\":[\"fill-extrusion-translate\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-extrusion-pattern\":{\"type\":\"resolvedImage\",\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"fill-extrusion-height\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"units\":\"meters\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-extrusion-base\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"units\":\"meters\",\"transition\":true,\"requires\":[\"fill-extrusion-height\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"fill-extrusion-vertical-gradient\":{\"type\":\"boolean\",\"default\":true,\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"fill-extrusion-ambient-occlusion-intensity\":{\"property-type\":\"data-constant\",\"type\":\"number\",\"private\":true,\"default\":0,\"minimum\":0,\"maximum\":1,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true},\"fill-extrusion-ambient-occlusion-radius\":{\"property-type\":\"data-constant\",\"type\":\"number\",\"private\":true,\"default\":3,\"minimum\":0,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"transition\":true,\"requires\":[\"fill-extrusion-edge-radius\"]}},\"paint_line\":{\"line-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"requires\":[{\"!\":\"line-pattern\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-translate\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-translate-anchor\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"map\",\"requires\":[\"line-translate\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"line-width\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-gap-width\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-offset\":{\"type\":\"number\",\"default\":0,\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-blur\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"line-dasharray\":{\"type\":\"array\",\"value\":\"number\",\"minimum\":0,\"transition\":false,\"units\":\"line widths\",\"requires\":[{\"!\":\"line-pattern\"}],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"line-pattern\":{\"type\":\"resolvedImage\",\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\",\"feature\"]},\"property-type\":\"data-driven\"},\"line-gradient\":{\"type\":\"color\",\"transition\":false,\"requires\":[{\"!\":\"line-pattern\"},{\"source\":\"geojson\",\"has\":{\"lineMetrics\":true}}],\"expression\":{\"interpolated\":true,\"parameters\":[\"line-progress\"]},\"property-type\":\"color-ramp\"},\"line-trim-offset\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"minimum\":[0,0],\"maximum\":[1,1],\"transition\":false,\"requires\":[{\"source\":\"geojson\",\"has\":{\"lineMetrics\":true}}],\"property-type\":\"constant\"}},\"paint_circle\":{\"circle-radius\":{\"type\":\"number\",\"default\":5,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-blur\":{\"type\":\"number\",\"default\":0,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-translate\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-translate-anchor\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"map\",\"requires\":[\"circle-translate\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-pitch-scale\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"map\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-pitch-alignment\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"viewport\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"circle-stroke-width\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-stroke-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"circle-stroke-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"}},\"paint_heatmap\":{\"heatmap-radius\":{\"type\":\"number\",\"default\":30,\"minimum\":1,\"transition\":true,\"units\":\"pixels\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"heatmap-weight\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"transition\":false,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"heatmap-intensity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"heatmap-color\":{\"type\":\"color\",\"default\":[\"interpolate\",[\"linear\"],[\"heatmap-density\"],0,\"rgba(0, 0, 255, 0)\",0.1,\"royalblue\",0.3,\"cyan\",0.5,\"lime\",0.7,\"yellow\",1,\"red\"],\"transition\":false,\"expression\":{\"interpolated\":true,\"parameters\":[\"heatmap-density\"]},\"property-type\":\"color-ramp\"},\"heatmap-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"}},\"paint_symbol\":{\"icon-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-halo-color\":{\"type\":\"color\",\"default\":\"rgba(0, 0, 0, 0)\",\"transition\":true,\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-halo-width\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-halo-blur\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"icon-translate\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"transition\":true,\"units\":\"pixels\",\"requires\":[\"icon-image\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"icon-translate-anchor\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"map\",\"requires\":[\"icon-image\",\"icon-translate\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"overridable\":true,\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-halo-color\":{\"type\":\"color\",\"default\":\"rgba(0, 0, 0, 0)\",\"transition\":true,\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-halo-width\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-halo-blur\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"transition\":true,\"units\":\"pixels\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\",\"feature\",\"feature-state\"]},\"property-type\":\"data-driven\"},\"text-translate\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"default\":[0,0],\"transition\":true,\"units\":\"pixels\",\"requires\":[\"text-field\"],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"text-translate-anchor\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"map\",\"requires\":[\"text-field\",\"text-translate\"],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"}},\"paint_raster\":{\"raster-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-hue-rotate\":{\"type\":\"number\",\"default\":0,\"period\":360,\"transition\":true,\"units\":\"degrees\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-brightness-min\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-brightness-max\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-saturation\":{\"type\":\"number\",\"default\":0,\"minimum\":-1,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-contrast\":{\"type\":\"number\",\"default\":0,\"minimum\":-1,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-resampling\":{\"type\":\"enum\",\"values\":{\"linear\":{},\"nearest\":{}},\"default\":\"linear\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"raster-fade-duration\":{\"type\":\"number\",\"default\":300,\"minimum\":0,\"transition\":false,\"units\":\"milliseconds\",\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"}},\"paint_hillshade\":{\"hillshade-illumination-direction\":{\"type\":\"number\",\"default\":335,\"minimum\":0,\"maximum\":359,\"transition\":false,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-illumination-anchor\":{\"type\":\"enum\",\"values\":{\"map\":{},\"viewport\":{}},\"default\":\"viewport\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-exaggeration\":{\"type\":\"number\",\"default\":0.5,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-shadow-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-highlight-color\":{\"type\":\"color\",\"default\":\"#FFFFFF\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"hillshade-accent-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"}},\"paint_background\":{\"background-color\":{\"type\":\"color\",\"default\":\"#000000\",\"transition\":true,\"requires\":[{\"!\":\"background-pattern\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"background-pattern\":{\"type\":\"resolvedImage\",\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"background-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"}},\"paint_sky\":{\"sky-type\":{\"type\":\"enum\",\"values\":{\"gradient\":{},\"atmosphere\":{}},\"default\":\"atmosphere\",\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"sky-atmosphere-sun\":{\"type\":\"array\",\"value\":\"number\",\"length\":2,\"units\":\"degrees\",\"minimum\":[0,0],\"maximum\":[360,180],\"transition\":false,\"requires\":[{\"sky-type\":\"atmosphere\"}],\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"sky-atmosphere-sun-intensity\":{\"type\":\"number\",\"requires\":[{\"sky-type\":\"atmosphere\"}],\"default\":10,\"minimum\":0,\"maximum\":100,\"transition\":false,\"property-type\":\"data-constant\"},\"sky-gradient-center\":{\"type\":\"array\",\"requires\":[{\"sky-type\":\"gradient\"}],\"value\":\"number\",\"default\":[0,0],\"length\":2,\"units\":\"degrees\",\"minimum\":[0,0],\"maximum\":[360,180],\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"sky-gradient-radius\":{\"type\":\"number\",\"requires\":[{\"sky-type\":\"gradient\"}],\"default\":90,\"minimum\":0,\"maximum\":180,\"transition\":false,\"expression\":{\"interpolated\":false,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"},\"sky-gradient\":{\"type\":\"color\",\"default\":[\"interpolate\",[\"linear\"],[\"sky-radial-progress\"],0.8,\"#87ceeb\",1,\"white\"],\"transition\":false,\"requires\":[{\"sky-type\":\"gradient\"}],\"expression\":{\"interpolated\":true,\"parameters\":[\"sky-radial-progress\"]},\"property-type\":\"color-ramp\"},\"sky-atmosphere-halo-color\":{\"type\":\"color\",\"default\":\"white\",\"transition\":false,\"requires\":[{\"sky-type\":\"atmosphere\"}],\"property-type\":\"data-constant\"},\"sky-atmosphere-color\":{\"type\":\"color\",\"default\":\"white\",\"transition\":false,\"requires\":[{\"sky-type\":\"atmosphere\"}],\"property-type\":\"data-constant\"},\"sky-opacity\":{\"type\":\"number\",\"default\":1,\"minimum\":0,\"maximum\":1,\"transition\":true,\"expression\":{\"interpolated\":true,\"parameters\":[\"zoom\"]},\"property-type\":\"data-constant\"}},\"transition\":{\"duration\":{\"type\":\"number\",\"default\":300,\"minimum\":0,\"units\":\"milliseconds\"},\"delay\":{\"type\":\"number\",\"default\":0,\"minimum\":0,\"units\":\"milliseconds\"}},\"property-type\":{\"data-driven\":{\"type\":\"property-type\"},\"color-ramp\":{\"type\":\"property-type\"},\"data-constant\":{\"type\":\"property-type\"},\"constant\":{\"type\":\"property-type\"}},\"promoteId\":{\"*\":{\"type\":\"string\"}}}');\n    function Wt(t) {\n      for (var _len2 = arguments.length, e = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        e[_key2 - 1] = arguments[_key2];\n      }\n      for (var _i10 = 0, _e14 = e; _i10 < _e14.length; _i10++) {\n        var _r10 = _e14[_i10];\n        for (var _e15 in _r10) t[_e15] = _r10[_e15];\n      }\n      return t;\n    }\n    function Jt(t) {\n      return t instanceof Number || t instanceof String || t instanceof Boolean ? t.valueOf() : t;\n    }\n    function Qt(t) {\n      if (Array.isArray(t)) return t.map(Qt);\n      if (t instanceof Object && !(t instanceof Number || t instanceof String || t instanceof Boolean)) {\n        var _e16 = {};\n        for (var _r11 in t) _e16[_r11] = Qt(t[_r11]);\n        return _e16;\n      }\n      return Jt(t);\n    }\n    var te = /*#__PURE__*/function (_Error2) {\n      _inherits(te, _Error2);\n      function te(t, e) {\n        var _this11;\n        _classCallCheck(this, te);\n        _this11 = _possibleConstructorReturn(this, _getPrototypeOf(te).call(this, e)), _this11.message = e, _this11.key = t;\n        return _this11;\n      }\n      return te;\n    }(_wrapNativeSuper(Error));\n    var ee = te;\n    var re = /*#__PURE__*/function () {\n      function re(t) {\n        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n        _classCallCheck(this, re);\n        this.parent = t, this.bindings = {};\n        var _iterator9 = _createForOfIteratorHelper(e),\n          _step9;\n        try {\n          for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n            var _step9$value = _slicedToArray(_step9.value, 2),\n              _t16 = _step9$value[0],\n              _r12 = _step9$value[1];\n            this.bindings[_t16] = _r12;\n          }\n        } catch (err) {\n          _iterator9.e(err);\n        } finally {\n          _iterator9.f();\n        }\n      }\n      _createClass(re, [{\n        key: \"concat\",\n        value: function concat(t) {\n          return new re(this, t);\n        }\n      }, {\n        key: \"get\",\n        value: function get(t) {\n          if (this.bindings[t]) return this.bindings[t];\n          if (this.parent) return this.parent.get(t);\n          throw new Error(\"\".concat(t, \" not found in scope.\"));\n        }\n      }, {\n        key: \"has\",\n        value: function has(t) {\n          return !!this.bindings[t] || !!this.parent && this.parent.has(t);\n        }\n      }]);\n      return re;\n    }();\n    var ne = re;\n    var ie = {\n        kind: \"null\"\n      },\n      se = {\n        kind: \"number\"\n      },\n      ae = {\n        kind: \"string\"\n      },\n      oe = {\n        kind: \"boolean\"\n      },\n      le = {\n        kind: \"color\"\n      },\n      ue = {\n        kind: \"object\"\n      },\n      ce = {\n        kind: \"value\"\n      },\n      he = {\n        kind: \"collator\"\n      },\n      pe = {\n        kind: \"formatted\"\n      },\n      fe = {\n        kind: \"resolvedImage\"\n      };\n    function de(t, e) {\n      return {\n        kind: \"array\",\n        itemType: t,\n        N: e\n      };\n    }\n    function ye(t) {\n      if (\"array\" === t.kind) {\n        var _e17 = ye(t.itemType);\n        return \"number\" == typeof t.N ? \"array<\".concat(_e17, \", \").concat(t.N, \">\") : \"value\" === t.itemType.kind ? \"array\" : \"array<\".concat(_e17, \">\");\n      }\n      return t.kind;\n    }\n    var me = [ie, se, ae, oe, le, pe, ue, de(ce), fe];\n    function ge(t, e) {\n      if (\"error\" === e.kind) return null;\n      if (\"array\" === t.kind) {\n        if (\"array\" === e.kind && (0 === e.N && \"value\" === e.itemType.kind || !ge(t.itemType, e.itemType)) && (\"number\" != typeof t.N || t.N === e.N)) return null;\n      } else {\n        if (t.kind === e.kind) return null;\n        if (\"value\" === t.kind) for (var _i11 = 0, _me = me; _i11 < _me.length; _i11++) {\n          var _t17 = _me[_i11];\n          if (!ge(_t17, e)) return null;\n        }\n      }\n      return \"Expected \".concat(ye(t), \" but found \").concat(ye(e), \" instead.\");\n    }\n    function xe(t, e) {\n      return e.some(function (e) {\n        return e.kind === t.kind;\n      });\n    }\n    function ve(t, e) {\n      return e.some(function (e) {\n        return \"null\" === e ? null === t : \"array\" === e ? Array.isArray(t) : \"object\" === e ? t && !Array.isArray(t) && \"object\" == typeof t : e === typeof t;\n      });\n    }\n    var be,\n      we = {\n        transparent: [0, 0, 0, 0],\n        aliceblue: [240, 248, 255, 1],\n        antiquewhite: [250, 235, 215, 1],\n        aqua: [0, 255, 255, 1],\n        aquamarine: [127, 255, 212, 1],\n        azure: [240, 255, 255, 1],\n        beige: [245, 245, 220, 1],\n        bisque: [255, 228, 196, 1],\n        black: [0, 0, 0, 1],\n        blanchedalmond: [255, 235, 205, 1],\n        blue: [0, 0, 255, 1],\n        blueviolet: [138, 43, 226, 1],\n        brown: [165, 42, 42, 1],\n        burlywood: [222, 184, 135, 1],\n        cadetblue: [95, 158, 160, 1],\n        chartreuse: [127, 255, 0, 1],\n        chocolate: [210, 105, 30, 1],\n        coral: [255, 127, 80, 1],\n        cornflowerblue: [100, 149, 237, 1],\n        cornsilk: [255, 248, 220, 1],\n        crimson: [220, 20, 60, 1],\n        cyan: [0, 255, 255, 1],\n        darkblue: [0, 0, 139, 1],\n        darkcyan: [0, 139, 139, 1],\n        darkgoldenrod: [184, 134, 11, 1],\n        darkgray: [169, 169, 169, 1],\n        darkgreen: [0, 100, 0, 1],\n        darkgrey: [169, 169, 169, 1],\n        darkkhaki: [189, 183, 107, 1],\n        darkmagenta: [139, 0, 139, 1],\n        darkolivegreen: [85, 107, 47, 1],\n        darkorange: [255, 140, 0, 1],\n        darkorchid: [153, 50, 204, 1],\n        darkred: [139, 0, 0, 1],\n        darksalmon: [233, 150, 122, 1],\n        darkseagreen: [143, 188, 143, 1],\n        darkslateblue: [72, 61, 139, 1],\n        darkslategray: [47, 79, 79, 1],\n        darkslategrey: [47, 79, 79, 1],\n        darkturquoise: [0, 206, 209, 1],\n        darkviolet: [148, 0, 211, 1],\n        deeppink: [255, 20, 147, 1],\n        deepskyblue: [0, 191, 255, 1],\n        dimgray: [105, 105, 105, 1],\n        dimgrey: [105, 105, 105, 1],\n        dodgerblue: [30, 144, 255, 1],\n        firebrick: [178, 34, 34, 1],\n        floralwhite: [255, 250, 240, 1],\n        forestgreen: [34, 139, 34, 1],\n        fuchsia: [255, 0, 255, 1],\n        gainsboro: [220, 220, 220, 1],\n        ghostwhite: [248, 248, 255, 1],\n        gold: [255, 215, 0, 1],\n        goldenrod: [218, 165, 32, 1],\n        gray: [128, 128, 128, 1],\n        green: [0, 128, 0, 1],\n        greenyellow: [173, 255, 47, 1],\n        grey: [128, 128, 128, 1],\n        honeydew: [240, 255, 240, 1],\n        hotpink: [255, 105, 180, 1],\n        indianred: [205, 92, 92, 1],\n        indigo: [75, 0, 130, 1],\n        ivory: [255, 255, 240, 1],\n        khaki: [240, 230, 140, 1],\n        lavender: [230, 230, 250, 1],\n        lavenderblush: [255, 240, 245, 1],\n        lawngreen: [124, 252, 0, 1],\n        lemonchiffon: [255, 250, 205, 1],\n        lightblue: [173, 216, 230, 1],\n        lightcoral: [240, 128, 128, 1],\n        lightcyan: [224, 255, 255, 1],\n        lightgoldenrodyellow: [250, 250, 210, 1],\n        lightgray: [211, 211, 211, 1],\n        lightgreen: [144, 238, 144, 1],\n        lightgrey: [211, 211, 211, 1],\n        lightpink: [255, 182, 193, 1],\n        lightsalmon: [255, 160, 122, 1],\n        lightseagreen: [32, 178, 170, 1],\n        lightskyblue: [135, 206, 250, 1],\n        lightslategray: [119, 136, 153, 1],\n        lightslategrey: [119, 136, 153, 1],\n        lightsteelblue: [176, 196, 222, 1],\n        lightyellow: [255, 255, 224, 1],\n        lime: [0, 255, 0, 1],\n        limegreen: [50, 205, 50, 1],\n        linen: [250, 240, 230, 1],\n        magenta: [255, 0, 255, 1],\n        maroon: [128, 0, 0, 1],\n        mediumaquamarine: [102, 205, 170, 1],\n        mediumblue: [0, 0, 205, 1],\n        mediumorchid: [186, 85, 211, 1],\n        mediumpurple: [147, 112, 219, 1],\n        mediumseagreen: [60, 179, 113, 1],\n        mediumslateblue: [123, 104, 238, 1],\n        mediumspringgreen: [0, 250, 154, 1],\n        mediumturquoise: [72, 209, 204, 1],\n        mediumvioletred: [199, 21, 133, 1],\n        midnightblue: [25, 25, 112, 1],\n        mintcream: [245, 255, 250, 1],\n        mistyrose: [255, 228, 225, 1],\n        moccasin: [255, 228, 181, 1],\n        navajowhite: [255, 222, 173, 1],\n        navy: [0, 0, 128, 1],\n        oldlace: [253, 245, 230, 1],\n        olive: [128, 128, 0, 1],\n        olivedrab: [107, 142, 35, 1],\n        orange: [255, 165, 0, 1],\n        orangered: [255, 69, 0, 1],\n        orchid: [218, 112, 214, 1],\n        palegoldenrod: [238, 232, 170, 1],\n        palegreen: [152, 251, 152, 1],\n        paleturquoise: [175, 238, 238, 1],\n        palevioletred: [219, 112, 147, 1],\n        papayawhip: [255, 239, 213, 1],\n        peachpuff: [255, 218, 185, 1],\n        peru: [205, 133, 63, 1],\n        pink: [255, 192, 203, 1],\n        plum: [221, 160, 221, 1],\n        powderblue: [176, 224, 230, 1],\n        purple: [128, 0, 128, 1],\n        rebeccapurple: [102, 51, 153, 1],\n        red: [255, 0, 0, 1],\n        rosybrown: [188, 143, 143, 1],\n        royalblue: [65, 105, 225, 1],\n        saddlebrown: [139, 69, 19, 1],\n        salmon: [250, 128, 114, 1],\n        sandybrown: [244, 164, 96, 1],\n        seagreen: [46, 139, 87, 1],\n        seashell: [255, 245, 238, 1],\n        sienna: [160, 82, 45, 1],\n        silver: [192, 192, 192, 1],\n        skyblue: [135, 206, 235, 1],\n        slateblue: [106, 90, 205, 1],\n        slategray: [112, 128, 144, 1],\n        slategrey: [112, 128, 144, 1],\n        snow: [255, 250, 250, 1],\n        springgreen: [0, 255, 127, 1],\n        steelblue: [70, 130, 180, 1],\n        tan: [210, 180, 140, 1],\n        teal: [0, 128, 128, 1],\n        thistle: [216, 191, 216, 1],\n        tomato: [255, 99, 71, 1],\n        turquoise: [64, 224, 208, 1],\n        violet: [238, 130, 238, 1],\n        wheat: [245, 222, 179, 1],\n        white: [255, 255, 255, 1],\n        whitesmoke: [245, 245, 245, 1],\n        yellow: [255, 255, 0, 1],\n        yellowgreen: [154, 205, 50, 1]\n      };\n    function _e(t) {\n      return (t = Math.round(t)) < 0 ? 0 : t > 255 ? 255 : t;\n    }\n    function Ae(t) {\n      return _e(\"%\" === t[t.length - 1] ? parseFloat(t) / 100 * 255 : parseInt(t));\n    }\n    function Se(t) {\n      return (e = \"%\" === t[t.length - 1] ? parseFloat(t) / 100 : parseFloat(t)) < 0 ? 0 : e > 1 ? 1 : e;\n      var e;\n    }\n    function ke(t, e, r) {\n      return r < 0 ? r += 1 : r > 1 && (r -= 1), 6 * r < 1 ? t + (e - t) * r * 6 : 2 * r < 1 ? e : 3 * r < 2 ? t + (e - t) * (2 / 3 - r) * 6 : t;\n    }\n    try {\n      be = {}.parseCSSColor = function (t) {\n        var e,\n          r = t.replace(/ /g, \"\").toLowerCase();\n        if (r in we) return we[r].slice();\n        if (\"#\" === r[0]) return 4 === r.length ? (e = parseInt(r.substr(1), 16)) >= 0 && e <= 4095 ? [(3840 & e) >> 4 | (3840 & e) >> 8, 240 & e | (240 & e) >> 4, 15 & e | (15 & e) << 4, 1] : null : 7 === r.length && (e = parseInt(r.substr(1), 16)) >= 0 && e <= 16777215 ? [(16711680 & e) >> 16, (65280 & e) >> 8, 255 & e, 1] : null;\n        var n = r.indexOf(\"(\"),\n          i = r.indexOf(\")\");\n        if (-1 !== n && i + 1 === r.length) {\n          var s = r.substr(0, n),\n            a = r.substr(n + 1, i - (n + 1)).split(\",\"),\n            o = 1;\n          switch (s) {\n            case \"rgba\":\n              if (4 !== a.length) return null;\n              o = Se(a.pop());\n            case \"rgb\":\n              return 3 !== a.length ? null : [Ae(a[0]), Ae(a[1]), Ae(a[2]), o];\n            case \"hsla\":\n              if (4 !== a.length) return null;\n              o = Se(a.pop());\n            case \"hsl\":\n              if (3 !== a.length) return null;\n              var l = (parseFloat(a[0]) % 360 + 360) % 360 / 360,\n                u = Se(a[1]),\n                c = Se(a[2]),\n                h = c <= .5 ? c * (u + 1) : c + u - c * u,\n                p = 2 * c - h;\n              return [_e(255 * ke(p, h, l + 1 / 3)), _e(255 * ke(p, h, l)), _e(255 * ke(p, h, l - 1 / 3)), o];\n            default:\n              return null;\n          }\n        }\n        return null;\n      };\n    } catch (t) {}\n    var Ie = /*#__PURE__*/function () {\n      function Ie(t, e, r) {\n        var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n        _classCallCheck(this, Ie);\n        this.r = t, this.g = e, this.b = r, this.a = n;\n      }\n      _createClass(Ie, [{\n        key: \"toString\",\n        value: function toString() {\n          var _this$toArray = this.toArray(),\n            _this$toArray2 = _slicedToArray(_this$toArray, 4),\n            t = _this$toArray2[0],\n            e = _this$toArray2[1],\n            r = _this$toArray2[2],\n            n = _this$toArray2[3];\n          return \"rgba(\".concat(Math.round(t), \",\").concat(Math.round(e), \",\").concat(Math.round(r), \",\").concat(n, \")\");\n        }\n      }, {\n        key: \"toArray\",\n        value: function toArray() {\n          var t = this.r,\n            e = this.g,\n            r = this.b,\n            n = this.a;\n          return 0 === n ? [0, 0, 0, 0] : [255 * t / n, 255 * e / n, 255 * r / n, n];\n        }\n      }, {\n        key: \"toArray01\",\n        value: function toArray01() {\n          var t = this.r,\n            e = this.g,\n            r = this.b,\n            n = this.a;\n          return 0 === n ? [0, 0, 0, 0] : [t / n, e / n, r / n, n];\n        }\n      }, {\n        key: \"toArray01PremultipliedAlpha\",\n        value: function toArray01PremultipliedAlpha() {\n          var t = this.r,\n            e = this.g,\n            r = this.b,\n            n = this.a;\n          return [t, e, r, n];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t) {\n          if (!t) return;\n          if (t instanceof Ie) return t;\n          if (\"string\" != typeof t) return;\n          var e = be(t);\n          return e ? new Ie(e[0] / 255 * e[3], e[1] / 255 * e[3], e[2] / 255 * e[3], e[3]) : void 0;\n        }\n      }]);\n      return Ie;\n    }();\n    Ie.black = new Ie(0, 0, 0, 1), Ie.white = new Ie(1, 1, 1, 1), Ie.transparent = new Ie(0, 0, 0, 0), Ie.red = new Ie(1, 0, 0, 1), Ie.blue = new Ie(0, 0, 1, 1);\n    var Me = Ie;\n    var Te = /*#__PURE__*/function () {\n      function Te(t, e, r) {\n        _classCallCheck(this, Te);\n        this.sensitivity = t ? e ? \"variant\" : \"case\" : e ? \"accent\" : \"base\", this.locale = r, this.collator = new Intl.Collator(this.locale ? this.locale : [], {\n          sensitivity: this.sensitivity,\n          usage: \"search\"\n        });\n      }\n      _createClass(Te, [{\n        key: \"compare\",\n        value: function compare(t, e) {\n          return this.collator.compare(t, e);\n        }\n      }, {\n        key: \"resolvedLocale\",\n        value: function resolvedLocale() {\n          return new Intl.Collator(this.locale ? this.locale : []).resolvedOptions().locale;\n        }\n      }]);\n      return Te;\n    }();\n    var ze = function ze(t, e, r, n, i) {\n      _classCallCheck(this, ze);\n      this.text = t.normalize ? t.normalize() : t, this.image = e, this.scale = r, this.fontStack = n, this.textColor = i;\n    };\n    var Be = /*#__PURE__*/function () {\n      function Be(t) {\n        _classCallCheck(this, Be);\n        this.sections = t;\n      }\n      _createClass(Be, [{\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return 0 === this.sections.length || !this.sections.some(function (t) {\n            return 0 !== t.text.length || t.image && 0 !== t.image.name.length;\n          });\n        }\n      }, {\n        key: \"toString\",\n        value: function toString() {\n          return 0 === this.sections.length ? \"\" : this.sections.map(function (t) {\n            return t.text;\n          }).join(\"\");\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = [\"format\"];\n          var _iterator10 = _createForOfIteratorHelper(this.sections),\n            _step10;\n          try {\n            for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n              var _e18 = _step10.value;\n              if (_e18.image) {\n                t.push([\"image\", _e18.image.name]);\n                continue;\n              }\n              t.push(_e18.text);\n              var _r13 = {};\n              _e18.fontStack && (_r13[\"text-font\"] = [\"literal\", _e18.fontStack.split(\",\")]), _e18.scale && (_r13[\"font-scale\"] = _e18.scale), _e18.textColor && (_r13[\"text-color\"] = [\"rgba\"].concat(_e18.textColor.toArray())), t.push(_r13);\n            }\n          } catch (err) {\n            _iterator10.e(err);\n          } finally {\n            _iterator10.f();\n          }\n          return t;\n        }\n      }], [{\n        key: \"fromString\",\n        value: function fromString(t) {\n          return new Be([new ze(t, null, null, null, null)]);\n        }\n      }, {\n        key: \"factory\",\n        value: function factory(t) {\n          return t instanceof Be ? t : Be.fromString(t);\n        }\n      }]);\n      return Be;\n    }();\n    var Ee = /*#__PURE__*/function () {\n      function Ee(t) {\n        _classCallCheck(this, Ee);\n        this.name = t.name, this.available = t.available;\n      }\n      _createClass(Ee, [{\n        key: \"toString\",\n        value: function toString() {\n          return this.name;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return [\"image\", this.name];\n        }\n      }], [{\n        key: \"fromString\",\n        value: function fromString(t) {\n          return t ? new Ee({\n            name: t,\n            available: !1\n          }) : null;\n        }\n      }]);\n      return Ee;\n    }();\n    function Ce(t, e, r, n) {\n      return \"number\" == typeof t && t >= 0 && t <= 255 && \"number\" == typeof e && e >= 0 && e <= 255 && \"number\" == typeof r && r >= 0 && r <= 255 ? void 0 === n || \"number\" == typeof n && n >= 0 && n <= 1 ? null : \"Invalid rgba value [\".concat([t, e, r, n].join(\", \"), \"]: 'a' must be between 0 and 1.\") : \"Invalid rgba value [\".concat((\"number\" == typeof n ? [t, e, r, n] : [t, e, r]).join(\", \"), \"]: 'r', 'g', and 'b' must be between 0 and 255.\");\n    }\n    function Pe(t) {\n      if (null === t) return !0;\n      if (\"string\" == typeof t) return !0;\n      if (\"boolean\" == typeof t) return !0;\n      if (\"number\" == typeof t) return !0;\n      if (t instanceof Me) return !0;\n      if (t instanceof Te) return !0;\n      if (t instanceof Be) return !0;\n      if (t instanceof Ee) return !0;\n      if (Array.isArray(t)) {\n        var _iterator11 = _createForOfIteratorHelper(t),\n          _step11;\n        try {\n          for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n            var _e19 = _step11.value;\n            if (!Pe(_e19)) return !1;\n          }\n        } catch (err) {\n          _iterator11.e(err);\n        } finally {\n          _iterator11.f();\n        }\n        return !0;\n      }\n      if (\"object\" == typeof t) {\n        for (var _e20 in t) if (!Pe(t[_e20])) return !1;\n        return !0;\n      }\n      return !1;\n    }\n    function De(t) {\n      if (null === t) return ie;\n      if (\"string\" == typeof t) return ae;\n      if (\"boolean\" == typeof t) return oe;\n      if (\"number\" == typeof t) return se;\n      if (t instanceof Me) return le;\n      if (t instanceof Te) return he;\n      if (t instanceof Be) return pe;\n      if (t instanceof Ee) return fe;\n      if (Array.isArray(t)) {\n        var _e21 = t.length;\n        var _r14;\n        var _iterator12 = _createForOfIteratorHelper(t),\n          _step12;\n        try {\n          for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n            var _e22 = _step12.value;\n            var _t18 = De(_e22);\n            if (_r14) {\n              if (_r14 === _t18) continue;\n              _r14 = ce;\n              break;\n            }\n            _r14 = _t18;\n          }\n        } catch (err) {\n          _iterator12.e(err);\n        } finally {\n          _iterator12.f();\n        }\n        return de(_r14 || ce, _e21);\n      }\n      return ue;\n    }\n    function Ve(t) {\n      var e = typeof t;\n      return null === t ? \"\" : \"string\" === e || \"number\" === e || \"boolean\" === e ? String(t) : t instanceof Me || t instanceof Be || t instanceof Ee ? t.toString() : JSON.stringify(t);\n    }\n    var Le = /*#__PURE__*/function () {\n      function Le(t, e) {\n        _classCallCheck(this, Le);\n        this.type = t, this.value = e;\n      }\n      _createClass(Le, [{\n        key: \"evaluate\",\n        value: function evaluate() {\n          return this.value;\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild() {}\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !0;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return \"array\" === this.type.kind || \"object\" === this.type.kind ? [\"literal\", this.value] : this.value instanceof Me ? [\"rgba\"].concat(this.value.toArray()) : this.value instanceof Be ? this.value.serialize() : this.value;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (2 !== t.length) return e.error(\"'literal' expression requires exactly one argument, but found \".concat(t.length - 1, \" instead.\"));\n          if (!Pe(t[1])) return e.error(\"invalid value\");\n          var r = t[1];\n          var n = De(r);\n          var i = e.expectedType;\n          return \"array\" !== n.kind || 0 !== n.N || !i || \"array\" !== i.kind || \"number\" == typeof i.N && 0 !== i.N || (n = i), new Le(n, r);\n        }\n      }]);\n      return Le;\n    }();\n    var Fe = Le,\n      Re = /*#__PURE__*/function () {\n        function Re(t) {\n          _classCallCheck(this, Re);\n          this.name = \"ExpressionEvaluationError\", this.message = t;\n        }\n        _createClass(Re, [{\n          key: \"toJSON\",\n          value: function toJSON() {\n            return this.message;\n          }\n        }]);\n        return Re;\n      }();\n    var je = {\n      string: ae,\n      number: se,\n      boolean: oe,\n      object: ue\n    };\n    var $e = /*#__PURE__*/function () {\n      function $e(t, e) {\n        _classCallCheck(this, $e);\n        this.type = t, this.args = e;\n      }\n      _createClass($e, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          for (var _e23 = 0; _e23 < this.args.length; _e23++) {\n            var _r15 = this.args[_e23].evaluate(t);\n            if (!ge(this.type, De(_r15))) return _r15;\n            if (_e23 === this.args.length - 1) throw new Re(\"Expected value to be of type \".concat(ye(this.type), \", but found \").concat(ye(De(_r15)), \" instead.\"));\n          }\n          return null;\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          this.args.forEach(t);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.args.every(function (t) {\n            return t.outputDefined();\n          });\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = this.type,\n            e = [t.kind];\n          if (\"array\" === t.kind) {\n            var _r16 = t.itemType;\n            if (\"string\" === _r16.kind || \"number\" === _r16.kind || \"boolean\" === _r16.kind) {\n              e.push(_r16.kind);\n              var _n8 = t.N;\n              (\"number\" == typeof _n8 || this.args.length > 1) && e.push(_n8);\n            }\n          }\n          return e.concat(this.args.map(function (t) {\n            return t.serialize();\n          }));\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length < 2) return e.error(\"Expected at least one argument.\");\n          var r,\n            n = 1;\n          var i = t[0];\n          if (\"array\" === i) {\n            var _i12, _s4;\n            if (t.length > 2) {\n              var _r17 = t[1];\n              if (\"string\" != typeof _r17 || !(_r17 in je) || \"object\" === _r17) return e.error('The item type argument of \"array\" must be one of string, number, boolean', 1);\n              _i12 = je[_r17], n++;\n            } else _i12 = ce;\n            if (t.length > 3) {\n              if (null !== t[2] && (\"number\" != typeof t[2] || t[2] < 0 || t[2] !== Math.floor(t[2]))) return e.error('The length argument to \"array\" must be a positive integer literal', 2);\n              _s4 = t[2], n++;\n            }\n            r = de(_i12, _s4);\n          } else r = je[i];\n          var s = [];\n          for (; n < t.length; n++) {\n            var _r18 = e.parse(t[n], n, ce);\n            if (!_r18) return null;\n            s.push(_r18);\n          }\n          return new $e(r, s);\n        }\n      }]);\n      return $e;\n    }();\n    var Ue = $e;\n    var Oe = /*#__PURE__*/function () {\n      function Oe(t) {\n        _classCallCheck(this, Oe);\n        this.type = pe, this.sections = t;\n      }\n      _createClass(Oe, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          return new Be(this.sections.map(function (e) {\n            var r = e.content.evaluate(t);\n            return De(r) === fe ? new ze(\"\", r, null, null, null) : new ze(Ve(r), null, e.scale ? e.scale.evaluate(t) : null, e.font ? e.font.evaluate(t).join(\",\") : null, e.textColor ? e.textColor.evaluate(t) : null);\n          }));\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          var _iterator13 = _createForOfIteratorHelper(this.sections),\n            _step13;\n          try {\n            for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {\n              var _e24 = _step13.value;\n              t(_e24.content), _e24.scale && t(_e24.scale), _e24.font && t(_e24.font), _e24.textColor && t(_e24.textColor);\n            }\n          } catch (err) {\n            _iterator13.e(err);\n          } finally {\n            _iterator13.f();\n          }\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = [\"format\"];\n          var _iterator14 = _createForOfIteratorHelper(this.sections),\n            _step14;\n          try {\n            for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {\n              var _e25 = _step14.value;\n              t.push(_e25.content.serialize());\n              var _r19 = {};\n              _e25.scale && (_r19[\"font-scale\"] = _e25.scale.serialize()), _e25.font && (_r19[\"text-font\"] = _e25.font.serialize()), _e25.textColor && (_r19[\"text-color\"] = _e25.textColor.serialize()), t.push(_r19);\n            }\n          } catch (err) {\n            _iterator14.e(err);\n          } finally {\n            _iterator14.f();\n          }\n          return t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length < 2) return e.error(\"Expected at least one argument.\");\n          var r = t[1];\n          if (!Array.isArray(r) && \"object\" == typeof r) return e.error(\"First argument must be an image or text section.\");\n          var n = [];\n          var i = !1;\n          for (var _r20 = 1; _r20 <= t.length - 1; ++_r20) {\n            var _s5 = t[_r20];\n            if (i && \"object\" == typeof _s5 && !Array.isArray(_s5)) {\n              i = !1;\n              var _t19 = null;\n              if (_s5[\"font-scale\"] && (_t19 = e.parse(_s5[\"font-scale\"], 1, se), !_t19)) return null;\n              var _r21 = null;\n              if (_s5[\"text-font\"] && (_r21 = e.parse(_s5[\"text-font\"], 1, de(ae)), !_r21)) return null;\n              var _a4 = null;\n              if (_s5[\"text-color\"] && (_a4 = e.parse(_s5[\"text-color\"], 1, le), !_a4)) return null;\n              var _o3 = n[n.length - 1];\n              _o3.scale = _t19, _o3.font = _r21, _o3.textColor = _a4;\n            } else {\n              var _s6 = e.parse(t[_r20], 1, ce);\n              if (!_s6) return null;\n              var _a5 = _s6.type.kind;\n              if (\"string\" !== _a5 && \"value\" !== _a5 && \"null\" !== _a5 && \"resolvedImage\" !== _a5) return e.error(\"Formatted text type must be 'string', 'value', 'image' or 'null'.\");\n              i = !0, n.push({\n                content: _s6,\n                scale: null,\n                font: null,\n                textColor: null\n              });\n            }\n          }\n          return new Oe(n);\n        }\n      }]);\n      return Oe;\n    }();\n    var qe = /*#__PURE__*/function () {\n      function qe(t) {\n        _classCallCheck(this, qe);\n        this.type = fe, this.input = t;\n      }\n      _createClass(qe, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.input.evaluate(t),\n            r = Ee.fromString(e);\n          return r && t.availableImages && (r.available = t.availableImages.indexOf(e) > -1), r;\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.input);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return [\"image\", this.input.serialize()];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (2 !== t.length) return e.error(\"Expected two arguments.\");\n          var r = e.parse(t[1], 1, ae);\n          return r ? new qe(r) : e.error(\"No image name provided.\");\n        }\n      }]);\n      return qe;\n    }();\n    var Ne = {\n      \"to-boolean\": oe,\n      \"to-color\": le,\n      \"to-number\": se,\n      \"to-string\": ae\n    };\n    var Ge = /*#__PURE__*/function () {\n      function Ge(t, e) {\n        _classCallCheck(this, Ge);\n        this.type = t, this.args = e;\n      }\n      _createClass(Ge, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          if (\"boolean\" === this.type.kind) return Boolean(this.args[0].evaluate(t));\n          if (\"color\" === this.type.kind) {\n            var _e26, _r22;\n            var _iterator15 = _createForOfIteratorHelper(this.args),\n              _step15;\n            try {\n              for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {\n                var _n9 = _step15.value;\n                if (_e26 = _n9.evaluate(t), _r22 = null, _e26 instanceof Me) return _e26;\n                if (\"string\" == typeof _e26) {\n                  var _r23 = t.parseColor(_e26);\n                  if (_r23) return _r23;\n                } else if (Array.isArray(_e26) && (_r22 = _e26.length < 3 || _e26.length > 4 ? \"Invalid rbga value \".concat(JSON.stringify(_e26), \": expected an array containing either three or four numeric values.\") : Ce(_e26[0], _e26[1], _e26[2], _e26[3]), !_r22)) return new Me(_e26[0] / 255, _e26[1] / 255, _e26[2] / 255, _e26[3]);\n              }\n            } catch (err) {\n              _iterator15.e(err);\n            } finally {\n              _iterator15.f();\n            }\n            throw new Re(_r22 || \"Could not parse color from value '\".concat(\"string\" == typeof _e26 ? _e26 : String(JSON.stringify(_e26)), \"'\"));\n          }\n          if (\"number\" === this.type.kind) {\n            var _e27 = null;\n            var _iterator16 = _createForOfIteratorHelper(this.args),\n              _step16;\n            try {\n              for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {\n                var _r24 = _step16.value;\n                if (_e27 = _r24.evaluate(t), null === _e27) return 0;\n                var _n10 = Number(_e27);\n                if (!isNaN(_n10)) return _n10;\n              }\n            } catch (err) {\n              _iterator16.e(err);\n            } finally {\n              _iterator16.f();\n            }\n            throw new Re(\"Could not convert \".concat(JSON.stringify(_e27), \" to number.\"));\n          }\n          return \"formatted\" === this.type.kind ? Be.fromString(Ve(this.args[0].evaluate(t))) : \"resolvedImage\" === this.type.kind ? Ee.fromString(Ve(this.args[0].evaluate(t))) : Ve(this.args[0].evaluate(t));\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          this.args.forEach(t);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.args.every(function (t) {\n            return t.outputDefined();\n          });\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          if (\"formatted\" === this.type.kind) return new Oe([{\n            content: this.args[0],\n            scale: null,\n            font: null,\n            textColor: null\n          }]).serialize();\n          if (\"resolvedImage\" === this.type.kind) return new qe(this.args[0]).serialize();\n          var t = [\"to-\".concat(this.type.kind)];\n          return this.eachChild(function (e) {\n            t.push(e.serialize());\n          }), t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length < 2) return e.error(\"Expected at least one argument.\");\n          var r = t[0];\n          if ((\"to-boolean\" === r || \"to-string\" === r) && 2 !== t.length) return e.error(\"Expected one argument.\");\n          var n = Ne[r],\n            i = [];\n          for (var _r25 = 1; _r25 < t.length; _r25++) {\n            var _n11 = e.parse(t[_r25], _r25, ce);\n            if (!_n11) return null;\n            i.push(_n11);\n          }\n          return new Ge(n, i);\n        }\n      }]);\n      return Ge;\n    }();\n    var Ze = Ge;\n    var Xe = [\"Unknown\", \"Point\", \"LineString\", \"Polygon\"];\n    var Ke = /*#__PURE__*/function () {\n      function Ke() {\n        _classCallCheck(this, Ke);\n        this.globals = null, this.feature = null, this.featureState = null, this.formattedSection = null, this._parseColorCache = {}, this.availableImages = null, this.canonical = null, this.featureTileCoord = null, this.featureDistanceData = null;\n      }\n      _createClass(Ke, [{\n        key: \"id\",\n        value: function id() {\n          return this.feature && void 0 !== this.feature.id ? this.feature.id : null;\n        }\n      }, {\n        key: \"geometryType\",\n        value: function geometryType() {\n          return this.feature ? \"number\" == typeof this.feature.type ? Xe[this.feature.type] : this.feature.type : null;\n        }\n      }, {\n        key: \"geometry\",\n        value: function geometry() {\n          return this.feature && \"geometry\" in this.feature ? this.feature.geometry : null;\n        }\n      }, {\n        key: \"canonicalID\",\n        value: function canonicalID() {\n          return this.canonical;\n        }\n      }, {\n        key: \"properties\",\n        value: function properties() {\n          return this.feature && this.feature.properties || {};\n        }\n      }, {\n        key: \"distanceFromCenter\",\n        value: function distanceFromCenter() {\n          if (this.featureTileCoord && this.featureDistanceData) {\n            var _t20 = this.featureDistanceData.center,\n              _e28 = this.featureDistanceData.scale,\n              _this$featureTileCoor = this.featureTileCoord,\n              _r26 = _this$featureTileCoor.x,\n              _n12 = _this$featureTileCoor.y;\n            return this.featureDistanceData.bearing[0] * (_r26 * _e28 - _t20[0]) + this.featureDistanceData.bearing[1] * (_n12 * _e28 - _t20[1]);\n          }\n          return 0;\n        }\n      }, {\n        key: \"parseColor\",\n        value: function parseColor(t) {\n          var e = this._parseColorCache[t];\n          return e || (e = this._parseColorCache[t] = Me.parse(t)), e;\n        }\n      }]);\n      return Ke;\n    }();\n    var Ye = /*#__PURE__*/function () {\n      function Ye(t, e, r, n) {\n        _classCallCheck(this, Ye);\n        this.name = t, this.type = e, this._evaluate = r, this.args = n;\n      }\n      _createClass(Ye, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          return this._evaluate(t, this.args);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          this.args.forEach(t);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return [this.name].concat(this.args.map(function (t) {\n            return t.serialize();\n          }));\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          var _e$errors;\n          var r = t[0],\n            n = Ye.definitions[r];\n          if (!n) return e.error(\"Unknown expression \\\"\".concat(r, \"\\\". If you wanted a literal array, use [\\\"literal\\\", [...]].\"), 0);\n          var i = Array.isArray(n) ? n[0] : n.type,\n            s = Array.isArray(n) ? [[n[1], n[2]]] : n.overloads,\n            a = s.filter(function (_ref) {\n              var _ref2 = _slicedToArray(_ref, 1),\n                e = _ref2[0];\n              return !Array.isArray(e) || e.length === t.length - 1;\n            });\n          var o = null;\n          var _iterator17 = _createForOfIteratorHelper(a),\n            _step17;\n          try {\n            for (_iterator17.s(); !(_step17 = _iterator17.n()).done;) {\n              var _step17$value = _slicedToArray(_step17.value, 2),\n                _n14 = _step17$value[0],\n                _s7 = _step17$value[1];\n              o = new _r(e.registry, e.path, null, e.scope);\n              var _a6 = [];\n              var _l2 = !1;\n              for (var _e29 = 1; _e29 < t.length; _e29++) {\n                var _r29 = t[_e29],\n                  _i14 = Array.isArray(_n14) ? _n14[_e29 - 1] : _n14.type,\n                  _s8 = o.parse(_r29, 1 + _a6.length, _i14);\n                if (!_s8) {\n                  _l2 = !0;\n                  break;\n                }\n                _a6.push(_s8);\n              }\n              if (!_l2) if (Array.isArray(_n14) && _n14.length !== _a6.length) o.error(\"Expected \".concat(_n14.length, \" arguments, but found \").concat(_a6.length, \" instead.\"));else {\n                for (var _t21 = 0; _t21 < _a6.length; _t21++) {\n                  var _e30 = Array.isArray(_n14) ? _n14[_t21] : _n14.type,\n                    _r30 = _a6[_t21];\n                  o.concat(_t21 + 1).checkSubtype(_e30, _r30.type);\n                }\n                if (0 === o.errors.length) return new Ye(r, i, _s7, _a6);\n              }\n            }\n          } catch (err) {\n            _iterator17.e(err);\n          } finally {\n            _iterator17.f();\n          }\n          if (1 === a.length) (_e$errors = e.errors).push.apply(_e$errors, _toConsumableArray(o.errors));else {\n            var _r27 = (a.length ? a : s).map(function (_ref3) {\n                var _ref4 = _slicedToArray(_ref3, 1),\n                  t = _ref4[0];\n                return e = t, Array.isArray(e) ? \"(\".concat(e.map(ye).join(\", \"), \")\") : \"(\".concat(ye(e.type), \"...)\");\n                var e;\n              }).join(\" | \"),\n              _n13 = [];\n            for (var _r28 = 1; _r28 < t.length; _r28++) {\n              var _i13 = e.parse(t[_r28], 1 + _n13.length);\n              if (!_i13) return null;\n              _n13.push(ye(_i13.type));\n            }\n            e.error(\"Expected arguments of type \".concat(_r27, \", but found (\").concat(_n13.join(\", \"), \") instead.\"));\n          }\n          return null;\n        }\n      }, {\n        key: \"register\",\n        value: function register(t, e) {\n          Ye.definitions = e;\n          for (var _r31 in e) t[_r31] = Ye;\n        }\n      }]);\n      return Ye;\n    }();\n    var He = Ye;\n    var We = /*#__PURE__*/function () {\n      function We(t, e, r) {\n        _classCallCheck(this, We);\n        this.type = he, this.locale = r, this.caseSensitive = t, this.diacriticSensitive = e;\n      }\n      _createClass(We, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          return new Te(this.caseSensitive.evaluate(t), this.diacriticSensitive.evaluate(t), this.locale ? this.locale.evaluate(t) : null);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.caseSensitive), t(this.diacriticSensitive), this.locale && t(this.locale);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = {};\n          return t[\"case-sensitive\"] = this.caseSensitive.serialize(), t[\"diacritic-sensitive\"] = this.diacriticSensitive.serialize(), this.locale && (t.locale = this.locale.serialize()), [\"collator\", t];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (2 !== t.length) return e.error(\"Expected one argument.\");\n          var r = t[1];\n          if (\"object\" != typeof r || Array.isArray(r)) return e.error(\"Collator options argument must be an object.\");\n          var n = e.parse(void 0 !== r[\"case-sensitive\"] && r[\"case-sensitive\"], 1, oe);\n          if (!n) return null;\n          var i = e.parse(void 0 !== r[\"diacritic-sensitive\"] && r[\"diacritic-sensitive\"], 1, oe);\n          if (!i) return null;\n          var s = null;\n          return r.locale && (s = e.parse(r.locale, 1, ae), !s) ? null : new We(n, i, s);\n        }\n      }]);\n      return We;\n    }();\n    var Je = 8192;\n    function Qe(t, e) {\n      t[0] = Math.min(t[0], e[0]), t[1] = Math.min(t[1], e[1]), t[2] = Math.max(t[2], e[0]), t[3] = Math.max(t[3], e[1]);\n    }\n    function tr(t, e) {\n      return !(t[0] <= e[0] || t[2] >= e[2] || t[1] <= e[1] || t[3] >= e[3]);\n    }\n    function er(t, e) {\n      var r = (180 + t[0]) / 360,\n        n = (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t[1] * Math.PI / 360))) / 360,\n        i = Math.pow(2, e.z);\n      return [Math.round(r * i * Je), Math.round(n * i * Je)];\n    }\n    function rr(t, e, r) {\n      var n = t[0] - e[0],\n        i = t[1] - e[1],\n        s = t[0] - r[0],\n        a = t[1] - r[1];\n      return n * a - s * i == 0 && n * s <= 0 && i * a <= 0;\n    }\n    function nr(t, e) {\n      var r = !1;\n      for (var _a7 = 0, _o4 = e.length; _a7 < _o4; _a7++) {\n        var _o5 = e[_a7];\n        for (var _e31 = 0, _a8 = _o5.length; _e31 < _a8 - 1; _e31++) {\n          if (rr(t, _o5[_e31], _o5[_e31 + 1])) return !1;\n          (i = _o5[_e31])[1] > (n = t)[1] != (s = _o5[_e31 + 1])[1] > n[1] && n[0] < (s[0] - i[0]) * (n[1] - i[1]) / (s[1] - i[1]) + i[0] && (r = !r);\n        }\n      }\n      var n, i, s;\n      return r;\n    }\n    function ir(t, e) {\n      for (var _r32 = 0; _r32 < e.length; _r32++) if (nr(t, e[_r32])) return !0;\n      return !1;\n    }\n    function sr(t, e, r, n) {\n      var i = n[0] - r[0],\n        s = n[1] - r[1],\n        a = (t[0] - r[0]) * s - i * (t[1] - r[1]),\n        o = (e[0] - r[0]) * s - i * (e[1] - r[1]);\n      return a > 0 && o < 0 || a < 0 && o > 0;\n    }\n    function ar(t, e, r) {\n      var _iterator18 = _createForOfIteratorHelper(r),\n        _step18;\n      try {\n        for (_iterator18.s(); !(_step18 = _iterator18.n()).done;) {\n          var _u2 = _step18.value;\n          for (var _r33 = 0; _r33 < _u2.length - 1; ++_r33) if (0 != (o = [(a = _u2[_r33 + 1])[0] - (s = _u2[_r33])[0], a[1] - s[1]])[0] * (l = [(i = e)[0] - (n = t)[0], i[1] - n[1]])[1] - o[1] * l[0] && sr(n, i, s, a) && sr(s, a, n, i)) return !0;\n        }\n      } catch (err) {\n        _iterator18.e(err);\n      } finally {\n        _iterator18.f();\n      }\n      var n, i, s, a, o, l;\n      return !1;\n    }\n    function or(t, e) {\n      for (var _r34 = 0; _r34 < t.length; ++_r34) if (!nr(t[_r34], e)) return !1;\n      for (var _r35 = 0; _r35 < t.length - 1; ++_r35) if (ar(t[_r35], t[_r35 + 1], e)) return !1;\n      return !0;\n    }\n    function lr(t, e) {\n      for (var _r36 = 0; _r36 < e.length; _r36++) if (or(t, e[_r36])) return !0;\n      return !1;\n    }\n    function ur(t, e, r) {\n      var n = [];\n      for (var _i15 = 0; _i15 < t.length; _i15++) {\n        var _s9 = [];\n        for (var _n15 = 0; _n15 < t[_i15].length; _n15++) {\n          var _a9 = er(t[_i15][_n15], r);\n          Qe(e, _a9), _s9.push(_a9);\n        }\n        n.push(_s9);\n      }\n      return n;\n    }\n    function cr(t, e, r) {\n      var n = [];\n      for (var _i16 = 0; _i16 < t.length; _i16++) {\n        var _s10 = ur(t[_i16], e, r);\n        n.push(_s10);\n      }\n      return n;\n    }\n    function hr(t, e, r, n) {\n      if (t[0] < r[0] || t[0] > r[2]) {\n        var _e32 = .5 * n;\n        var _i17 = t[0] - r[0] > _e32 ? -n : r[0] - t[0] > _e32 ? n : 0;\n        0 === _i17 && (_i17 = t[0] - r[2] > _e32 ? -n : r[2] - t[0] > _e32 ? n : 0), t[0] += _i17;\n      }\n      Qe(e, t);\n    }\n    function pr(t, e, r, n) {\n      var i = Math.pow(2, n.z) * Je,\n        s = [n.x * Je, n.y * Je],\n        a = [];\n      if (!t) return a;\n      var _iterator19 = _createForOfIteratorHelper(t),\n        _step19;\n      try {\n        for (_iterator19.s(); !(_step19 = _iterator19.n()).done;) {\n          var _n16 = _step19.value;\n          var _iterator20 = _createForOfIteratorHelper(_n16),\n            _step20;\n          try {\n            for (_iterator20.s(); !(_step20 = _iterator20.n()).done;) {\n              var _t22 = _step20.value;\n              var _n17 = [_t22.x + s[0], _t22.y + s[1]];\n              hr(_n17, e, r, i), a.push(_n17);\n            }\n          } catch (err) {\n            _iterator20.e(err);\n          } finally {\n            _iterator20.f();\n          }\n        }\n      } catch (err) {\n        _iterator19.e(err);\n      } finally {\n        _iterator19.f();\n      }\n      return a;\n    }\n    function fr(t, e, r, n) {\n      var i = Math.pow(2, n.z) * Je,\n        s = [n.x * Je, n.y * Je],\n        a = [];\n      if (!t) return a;\n      var _iterator21 = _createForOfIteratorHelper(t),\n        _step21;\n      try {\n        for (_iterator21.s(); !(_step21 = _iterator21.n()).done;) {\n          var _r37 = _step21.value;\n          var _t24 = [];\n          var _iterator24 = _createForOfIteratorHelper(_r37),\n            _step24;\n          try {\n            for (_iterator24.s(); !(_step24 = _iterator24.n()).done;) {\n              var _n19 = _step24.value;\n              var _r38 = [_n19.x + s[0], _n19.y + s[1]];\n              Qe(e, _r38), _t24.push(_r38);\n            }\n          } catch (err) {\n            _iterator24.e(err);\n          } finally {\n            _iterator24.f();\n          }\n          a.push(_t24);\n        }\n      } catch (err) {\n        _iterator21.e(err);\n      } finally {\n        _iterator21.f();\n      }\n      if (e[2] - e[0] <= i / 2) {\n        (o = e)[0] = o[1] = 1 / 0, o[2] = o[3] = -1 / 0;\n        var _iterator22 = _createForOfIteratorHelper(a),\n          _step22;\n        try {\n          for (_iterator22.s(); !(_step22 = _iterator22.n()).done;) {\n            var _t23 = _step22.value;\n            var _iterator23 = _createForOfIteratorHelper(_t23),\n              _step23;\n            try {\n              for (_iterator23.s(); !(_step23 = _iterator23.n()).done;) {\n                var _n18 = _step23.value;\n                hr(_n18, e, r, i);\n              }\n            } catch (err) {\n              _iterator23.e(err);\n            } finally {\n              _iterator23.f();\n            }\n          }\n        } catch (err) {\n          _iterator22.e(err);\n        } finally {\n          _iterator22.f();\n        }\n      }\n      var o;\n      return a;\n    }\n    var dr = /*#__PURE__*/function () {\n      function dr(t, e) {\n        _classCallCheck(this, dr);\n        this.type = oe, this.geojson = t, this.geometries = e;\n      }\n      _createClass(dr, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          if (null != t.geometry() && null != t.canonicalID()) {\n            if (\"Point\" === t.geometryType()) return function (t, e) {\n              var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],\n                n = [1 / 0, 1 / 0, -1 / 0, -1 / 0],\n                i = t.canonicalID();\n              if (!i) return !1;\n              if (\"Polygon\" === e.type) {\n                var _s11 = ur(e.coordinates, n, i),\n                  _a10 = pr(t.geometry(), r, n, i);\n                if (!tr(r, n)) return !1;\n                var _iterator25 = _createForOfIteratorHelper(_a10),\n                  _step25;\n                try {\n                  for (_iterator25.s(); !(_step25 = _iterator25.n()).done;) {\n                    var _t25 = _step25.value;\n                    if (!nr(_t25, _s11)) return !1;\n                  }\n                } catch (err) {\n                  _iterator25.e(err);\n                } finally {\n                  _iterator25.f();\n                }\n              }\n              if (\"MultiPolygon\" === e.type) {\n                var _s12 = cr(e.coordinates, n, i),\n                  _a11 = pr(t.geometry(), r, n, i);\n                if (!tr(r, n)) return !1;\n                var _iterator26 = _createForOfIteratorHelper(_a11),\n                  _step26;\n                try {\n                  for (_iterator26.s(); !(_step26 = _iterator26.n()).done;) {\n                    var _t26 = _step26.value;\n                    if (!ir(_t26, _s12)) return !1;\n                  }\n                } catch (err) {\n                  _iterator26.e(err);\n                } finally {\n                  _iterator26.f();\n                }\n              }\n              return !0;\n            }(t, this.geometries);\n            if (\"LineString\" === t.geometryType()) return function (t, e) {\n              var r = [1 / 0, 1 / 0, -1 / 0, -1 / 0],\n                n = [1 / 0, 1 / 0, -1 / 0, -1 / 0],\n                i = t.canonicalID();\n              if (!i) return !1;\n              if (\"Polygon\" === e.type) {\n                var _s13 = ur(e.coordinates, n, i),\n                  _a12 = fr(t.geometry(), r, n, i);\n                if (!tr(r, n)) return !1;\n                var _iterator27 = _createForOfIteratorHelper(_a12),\n                  _step27;\n                try {\n                  for (_iterator27.s(); !(_step27 = _iterator27.n()).done;) {\n                    var _t27 = _step27.value;\n                    if (!or(_t27, _s13)) return !1;\n                  }\n                } catch (err) {\n                  _iterator27.e(err);\n                } finally {\n                  _iterator27.f();\n                }\n              }\n              if (\"MultiPolygon\" === e.type) {\n                var _s14 = cr(e.coordinates, n, i),\n                  _a13 = fr(t.geometry(), r, n, i);\n                if (!tr(r, n)) return !1;\n                var _iterator28 = _createForOfIteratorHelper(_a13),\n                  _step28;\n                try {\n                  for (_iterator28.s(); !(_step28 = _iterator28.n()).done;) {\n                    var _t28 = _step28.value;\n                    if (!lr(_t28, _s14)) return !1;\n                  }\n                } catch (err) {\n                  _iterator28.e(err);\n                } finally {\n                  _iterator28.f();\n                }\n              }\n              return !0;\n            }(t, this.geometries);\n          }\n          return !1;\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild() {}\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !0;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return [\"within\", this.geojson];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (2 !== t.length) return e.error(\"'within' expression requires exactly one argument, but found \".concat(t.length - 1, \" instead.\"));\n          if (Pe(t[1])) {\n            var _e33 = t[1];\n            if (\"FeatureCollection\" === _e33.type) for (var _t29 = 0; _t29 < _e33.features.length; ++_t29) {\n              var _r39 = _e33.features[_t29].geometry.type;\n              if (\"Polygon\" === _r39 || \"MultiPolygon\" === _r39) return new dr(_e33, _e33.features[_t29].geometry);\n            } else if (\"Feature\" === _e33.type) {\n              var _t30 = _e33.geometry.type;\n              if (\"Polygon\" === _t30 || \"MultiPolygon\" === _t30) return new dr(_e33, _e33.geometry);\n            } else if (\"Polygon\" === _e33.type || \"MultiPolygon\" === _e33.type) return new dr(_e33, _e33);\n          }\n          return e.error(\"'within' expression requires valid geojson object that contains polygon geometry type.\");\n        }\n      }]);\n      return dr;\n    }();\n    var yr = dr;\n    function mr(t) {\n      if (t instanceof He) {\n        if (\"get\" === t.name && 1 === t.args.length) return !1;\n        if (\"feature-state\" === t.name) return !1;\n        if (\"has\" === t.name && 1 === t.args.length) return !1;\n        if (\"properties\" === t.name || \"geometry-type\" === t.name || \"id\" === t.name) return !1;\n        if (/^filter-/.test(t.name)) return !1;\n      }\n      if (t instanceof yr) return !1;\n      var e = !0;\n      return t.eachChild(function (t) {\n        e && !mr(t) && (e = !1);\n      }), e;\n    }\n    function gr(t) {\n      if (t instanceof He && \"feature-state\" === t.name) return !1;\n      var e = !0;\n      return t.eachChild(function (t) {\n        e && !gr(t) && (e = !1);\n      }), e;\n    }\n    function xr(t, e) {\n      if (t instanceof He && e.indexOf(t.name) >= 0) return !1;\n      var r = !0;\n      return t.eachChild(function (t) {\n        r && !xr(t, e) && (r = !1);\n      }), r;\n    }\n    var vr = /*#__PURE__*/function () {\n      function vr(t, e) {\n        _classCallCheck(this, vr);\n        this.type = e.type, this.name = t, this.boundExpression = e;\n      }\n      _createClass(vr, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          return this.boundExpression.evaluate(t);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild() {}\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return [\"var\", this.name];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (2 !== t.length || \"string\" != typeof t[1]) return e.error(\"'var' expression requires exactly one string literal argument.\");\n          var r = t[1];\n          return e.scope.has(r) ? new vr(r, e.scope.get(r)) : e.error(\"Unknown variable \\\"\".concat(r, \"\\\". Make sure \\\"\").concat(r, \"\\\" has been bound in an enclosing \\\"let\\\" expression before using it.\"), 1);\n        }\n      }]);\n      return vr;\n    }();\n    var br = vr;\n    var wr = /*#__PURE__*/function () {\n      function wr(t) {\n        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n        var r = arguments.length > 2 ? arguments[2] : undefined;\n        var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new ne();\n        var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];\n        _classCallCheck(this, wr);\n        this.registry = t, this.path = e, this.key = e.map(function (t) {\n          return \"[\".concat(t, \"]\");\n        }).join(\"\"), this.scope = n, this.errors = i, this.expectedType = r;\n      }\n      _createClass(wr, [{\n        key: \"parse\",\n        value: function parse(t, e, r, n) {\n          var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n          return e ? this.concat(e, r, n)._parse(t, i) : this._parse(t, i);\n        }\n      }, {\n        key: \"_parse\",\n        value: function _parse(t, e) {\n          function r(t, e, r) {\n            return \"assert\" === r ? new Ue(e, [t]) : \"coerce\" === r ? new Ze(e, [t]) : t;\n          }\n          if (null !== t && \"string\" != typeof t && \"boolean\" != typeof t && \"number\" != typeof t || (t = [\"literal\", t]), Array.isArray(t)) {\n            if (0 === t.length) return this.error('Expected an array with at least one element. If you wanted a literal array, use [\"literal\", []].');\n            var _n20 = t[0];\n            if (\"string\" != typeof _n20) return this.error(\"Expression name must be a string, but found \".concat(typeof _n20, \" instead. If you wanted a literal array, use [\\\"literal\\\", [...]].\"), 0), null;\n            var _i18 = this.registry[_n20];\n            if (_i18) {\n              var _n21 = _i18.parse(t, this);\n              if (!_n21) return null;\n              if (this.expectedType) {\n                var _t31 = this.expectedType,\n                  _i19 = _n21.type;\n                if (\"string\" !== _t31.kind && \"number\" !== _t31.kind && \"boolean\" !== _t31.kind && \"object\" !== _t31.kind && \"array\" !== _t31.kind || \"value\" !== _i19.kind) {\n                  if (\"color\" !== _t31.kind && \"formatted\" !== _t31.kind && \"resolvedImage\" !== _t31.kind || \"value\" !== _i19.kind && \"string\" !== _i19.kind) {\n                    if (this.checkSubtype(_t31, _i19)) return null;\n                  } else _n21 = r(_n21, _t31, e.typeAnnotation || \"coerce\");\n                } else _n21 = r(_n21, _t31, e.typeAnnotation || \"assert\");\n              }\n              if (!(_n21 instanceof Fe) && \"resolvedImage\" !== _n21.type.kind && Ar(_n21)) {\n                var _t32 = new Ke();\n                try {\n                  _n21 = new Fe(_n21.type, _n21.evaluate(_t32));\n                } catch (t) {\n                  return this.error(t.message), null;\n                }\n              }\n              return _n21;\n            }\n            return this.error(\"Unknown expression \\\"\".concat(_n20, \"\\\". If you wanted a literal array, use [\\\"literal\\\", [...]].\"), 0);\n          }\n          return this.error(void 0 === t ? \"'undefined' value invalid. Use null instead.\" : \"object\" == typeof t ? 'Bare objects invalid. Use [\"literal\", {...}] instead.' : \"Expected an array, but found \".concat(typeof t, \" instead.\"));\n        }\n      }, {\n        key: \"concat\",\n        value: function concat(t, e, r) {\n          var n = \"number\" == typeof t ? this.path.concat(t) : this.path,\n            i = r ? this.scope.concat(r) : this.scope;\n          return new wr(this.registry, n, e || null, i, this.errors);\n        }\n      }, {\n        key: \"error\",\n        value: function error(t) {\n          for (var _len3 = arguments.length, e = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n            e[_key3 - 1] = arguments[_key3];\n          }\n          var r = \"\".concat(this.key).concat(e.map(function (t) {\n            return \"[\".concat(t, \"]\");\n          }).join(\"\"));\n          this.errors.push(new ee(r, t));\n        }\n      }, {\n        key: \"checkSubtype\",\n        value: function checkSubtype(t, e) {\n          var r = ge(t, e);\n          return r && this.error(r), r;\n        }\n      }]);\n      return wr;\n    }();\n    var _r = wr;\n    function Ar(t) {\n      if (t instanceof br) return Ar(t.boundExpression);\n      if (t instanceof He && \"error\" === t.name) return !1;\n      if (t instanceof We) return !1;\n      if (t instanceof yr) return !1;\n      var e = t instanceof Ze || t instanceof Ue;\n      var r = !0;\n      return t.eachChild(function (t) {\n        r = e ? r && Ar(t) : r && t instanceof Fe;\n      }), !!r && mr(t) && xr(t, [\"zoom\", \"heatmap-density\", \"line-progress\", \"sky-radial-progress\", \"accumulated\", \"is-supported-script\", \"pitch\", \"distance-from-center\"]);\n    }\n    function Sr(t, e) {\n      var r = t.length - 1;\n      var n,\n        i,\n        s = 0,\n        a = r,\n        o = 0;\n      for (; s <= a;) if (o = Math.floor((s + a) / 2), n = t[o], i = t[o + 1], n <= e) {\n        if (o === r || e < i) return o;\n        s = o + 1;\n      } else {\n        if (!(n > e)) throw new Re(\"Input is not a number.\");\n        a = o - 1;\n      }\n      return 0;\n    }\n    var kr = /*#__PURE__*/function () {\n      function kr(t, e, r) {\n        _classCallCheck(this, kr);\n        this.type = t, this.input = e, this.labels = [], this.outputs = [];\n        var _iterator29 = _createForOfIteratorHelper(r),\n          _step29;\n        try {\n          for (_iterator29.s(); !(_step29 = _iterator29.n()).done;) {\n            var _step29$value = _slicedToArray(_step29.value, 2),\n              _t33 = _step29$value[0],\n              _e34 = _step29$value[1];\n            this.labels.push(_t33), this.outputs.push(_e34);\n          }\n        } catch (err) {\n          _iterator29.e(err);\n        } finally {\n          _iterator29.f();\n        }\n      }\n      _createClass(kr, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.labels,\n            r = this.outputs;\n          if (1 === e.length) return r[0].evaluate(t);\n          var n = this.input.evaluate(t);\n          if (n <= e[0]) return r[0].evaluate(t);\n          var i = e.length;\n          return n >= e[i - 1] ? r[i - 1].evaluate(t) : r[Sr(e, n)].evaluate(t);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.input);\n          var _iterator30 = _createForOfIteratorHelper(this.outputs),\n            _step30;\n          try {\n            for (_iterator30.s(); !(_step30 = _iterator30.n()).done;) {\n              var _e35 = _step30.value;\n              t(_e35);\n            }\n          } catch (err) {\n            _iterator30.e(err);\n          } finally {\n            _iterator30.f();\n          }\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.outputs.every(function (t) {\n            return t.outputDefined();\n          });\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = [\"step\", this.input.serialize()];\n          for (var _e36 = 0; _e36 < this.labels.length; _e36++) _e36 > 0 && t.push(this.labels[_e36]), t.push(this.outputs[_e36].serialize());\n          return t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length - 1 < 4) return e.error(\"Expected at least 4 arguments, but found only \".concat(t.length - 1, \".\"));\n          if ((t.length - 1) % 2 != 0) return e.error(\"Expected an even number of arguments.\");\n          var r = e.parse(t[1], 1, se);\n          if (!r) return null;\n          var n = [];\n          var i = null;\n          e.expectedType && \"value\" !== e.expectedType.kind && (i = e.expectedType);\n          for (var _r40 = 1; _r40 < t.length; _r40 += 2) {\n            var _s15 = 1 === _r40 ? -1 / 0 : t[_r40],\n              _a14 = t[_r40 + 1],\n              _o6 = _r40,\n              _l3 = _r40 + 1;\n            if (\"number\" != typeof _s15) return e.error('Input/output pairs for \"step\" expressions must be defined using literal numeric values (not computed expressions) for the input values.', _o6);\n            if (n.length && n[n.length - 1][0] >= _s15) return e.error('Input/output pairs for \"step\" expressions must be arranged with input values in strictly ascending order.', _o6);\n            var _u3 = e.parse(_a14, _l3, i);\n            if (!_u3) return null;\n            i = i || _u3.type, n.push([_s15, _u3]);\n          }\n          return new kr(i, r, n);\n        }\n      }]);\n      return kr;\n    }();\n    var Ir = kr;\n    function Mr(t, e, r) {\n      return t * (1 - r) + e * r;\n    }\n    var Tr = Object.freeze({\n      __proto__: null,\n      number: Mr,\n      color: function color(t, e, r) {\n        return new Me(Mr(t.r, e.r, r), Mr(t.g, e.g, r), Mr(t.b, e.b, r), Mr(t.a, e.a, r));\n      },\n      array: function array(t, e, r) {\n        return t.map(function (t, n) {\n          return Mr(t, e[n], r);\n        });\n      }\n    });\n    var zr = .95047,\n      Br = 1.08883,\n      Er = 4 / 29,\n      Cr = 6 / 29,\n      Pr = 3 * Cr * Cr,\n      Dr = Math.PI / 180,\n      Vr = 180 / Math.PI;\n    function Lr(t) {\n      return t > .008856451679035631 ? Math.pow(t, 1 / 3) : t / Pr + Er;\n    }\n    function Fr(t) {\n      return t > Cr ? t * t * t : Pr * (t - Er);\n    }\n    function Rr(t) {\n      return 255 * (t <= .0031308 ? 12.92 * t : 1.055 * Math.pow(t, 1 / 2.4) - .055);\n    }\n    function jr(t) {\n      return (t /= 255) <= .04045 ? t / 12.92 : Math.pow((t + .055) / 1.055, 2.4);\n    }\n    function $r(t) {\n      var e = jr(t.r),\n        r = jr(t.g),\n        n = jr(t.b),\n        i = Lr((.4124564 * e + .3575761 * r + .1804375 * n) / zr),\n        s = Lr((.2126729 * e + .7151522 * r + .072175 * n) / 1);\n      return {\n        l: 116 * s - 16,\n        a: 500 * (i - s),\n        b: 200 * (s - Lr((.0193339 * e + .119192 * r + .9503041 * n) / Br)),\n        alpha: t.a\n      };\n    }\n    function Ur(t) {\n      var e = (t.l + 16) / 116,\n        r = isNaN(t.a) ? e : e + t.a / 500,\n        n = isNaN(t.b) ? e : e - t.b / 200;\n      return e = 1 * Fr(e), r = zr * Fr(r), n = Br * Fr(n), new Me(Rr(3.2404542 * r - 1.5371385 * e - .4985314 * n), Rr(-.969266 * r + 1.8760108 * e + .041556 * n), Rr(.0556434 * r - .2040259 * e + 1.0572252 * n), t.alpha);\n    }\n    function Or(t, e, r) {\n      var n = e - t;\n      return t + r * (n > 180 || n < -180 ? n - 360 * Math.round(n / 360) : n);\n    }\n    var qr = {\n        forward: $r,\n        reverse: Ur,\n        interpolate: function interpolate(t, e, r) {\n          return {\n            l: Mr(t.l, e.l, r),\n            a: Mr(t.a, e.a, r),\n            b: Mr(t.b, e.b, r),\n            alpha: Mr(t.alpha, e.alpha, r)\n          };\n        }\n      },\n      Nr = {\n        forward: function forward(t) {\n          var _$r = $r(t),\n            e = _$r.l,\n            r = _$r.a,\n            n = _$r.b,\n            i = Math.atan2(n, r) * Vr;\n          return {\n            h: i < 0 ? i + 360 : i,\n            c: Math.sqrt(r * r + n * n),\n            l: e,\n            alpha: t.a\n          };\n        },\n        reverse: function reverse(t) {\n          var e = t.h * Dr,\n            r = t.c;\n          return Ur({\n            l: t.l,\n            a: Math.cos(e) * r,\n            b: Math.sin(e) * r,\n            alpha: t.alpha\n          });\n        },\n        interpolate: function interpolate(t, e, r) {\n          return {\n            h: Or(t.h, e.h, r),\n            c: Mr(t.c, e.c, r),\n            l: Mr(t.l, e.l, r),\n            alpha: Mr(t.alpha, e.alpha, r)\n          };\n        }\n      };\n    var Gr = Object.freeze({\n      __proto__: null,\n      lab: qr,\n      hcl: Nr\n    });\n    var Zr = /*#__PURE__*/function () {\n      function Zr(t, e, r, n, i) {\n        _classCallCheck(this, Zr);\n        this.type = t, this.operator = e, this.interpolation = r, this.input = n, this.labels = [], this.outputs = [];\n        var _iterator31 = _createForOfIteratorHelper(i),\n          _step31;\n        try {\n          for (_iterator31.s(); !(_step31 = _iterator31.n()).done;) {\n            var _step31$value = _slicedToArray(_step31.value, 2),\n              _t34 = _step31$value[0],\n              _e37 = _step31$value[1];\n            this.labels.push(_t34), this.outputs.push(_e37);\n          }\n        } catch (err) {\n          _iterator31.e(err);\n        } finally {\n          _iterator31.f();\n        }\n      }\n      _createClass(Zr, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.labels,\n            r = this.outputs;\n          if (1 === e.length) return r[0].evaluate(t);\n          var n = this.input.evaluate(t);\n          if (n <= e[0]) return r[0].evaluate(t);\n          var i = e.length;\n          if (n >= e[i - 1]) return r[i - 1].evaluate(t);\n          var s = Sr(e, n),\n            a = Zr.interpolationFactor(this.interpolation, n, e[s], e[s + 1]),\n            o = r[s].evaluate(t),\n            l = r[s + 1].evaluate(t);\n          return \"interpolate\" === this.operator ? Tr[this.type.kind.toLowerCase()](o, l, a) : \"interpolate-hcl\" === this.operator ? Nr.reverse(Nr.interpolate(Nr.forward(o), Nr.forward(l), a)) : qr.reverse(qr.interpolate(qr.forward(o), qr.forward(l), a));\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.input);\n          var _iterator32 = _createForOfIteratorHelper(this.outputs),\n            _step32;\n          try {\n            for (_iterator32.s(); !(_step32 = _iterator32.n()).done;) {\n              var _e38 = _step32.value;\n              t(_e38);\n            }\n          } catch (err) {\n            _iterator32.e(err);\n          } finally {\n            _iterator32.f();\n          }\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.outputs.every(function (t) {\n            return t.outputDefined();\n          });\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t;\n          t = \"linear\" === this.interpolation.name ? [\"linear\"] : \"exponential\" === this.interpolation.name ? 1 === this.interpolation.base ? [\"linear\"] : [\"exponential\", this.interpolation.base] : [\"cubic-bezier\"].concat(this.interpolation.controlPoints);\n          var e = [this.operator, t, this.input.serialize()];\n          for (var _t35 = 0; _t35 < this.labels.length; _t35++) e.push(this.labels[_t35], this.outputs[_t35].serialize());\n          return e;\n        }\n      }], [{\n        key: \"interpolationFactor\",\n        value: function interpolationFactor(t, e, r, n) {\n          var i = 0;\n          if (\"exponential\" === t.name) i = Xr(e, t.base, r, n);else if (\"linear\" === t.name) i = Xr(e, 1, r, n);else if (\"cubic-bezier\" === t.name) {\n            var _s16 = t.controlPoints;\n            i = new p(_s16[0], _s16[1], _s16[2], _s16[3]).solve(Xr(e, 1, r, n));\n          }\n          return i;\n        }\n      }, {\n        key: \"parse\",\n        value: function parse(t, e) {\n          var _t36 = _toArray(t),\n            r = _t36[0],\n            n = _t36[1],\n            i = _t36[2],\n            s = _t36.slice(3);\n          if (!Array.isArray(n) || 0 === n.length) return e.error(\"Expected an interpolation type expression.\", 1);\n          if (\"linear\" === n[0]) n = {\n            name: \"linear\"\n          };else if (\"exponential\" === n[0]) {\n            var _t37 = n[1];\n            if (\"number\" != typeof _t37) return e.error(\"Exponential interpolation requires a numeric base.\", 1, 1);\n            n = {\n              name: \"exponential\",\n              base: _t37\n            };\n          } else {\n            if (\"cubic-bezier\" !== n[0]) return e.error(\"Unknown interpolation type \".concat(String(n[0])), 1, 0);\n            {\n              var _t38 = n.slice(1);\n              if (4 !== _t38.length || _t38.some(function (t) {\n                return \"number\" != typeof t || t < 0 || t > 1;\n              })) return e.error(\"Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.\", 1);\n              n = {\n                name: \"cubic-bezier\",\n                controlPoints: _t38\n              };\n            }\n          }\n          if (t.length - 1 < 4) return e.error(\"Expected at least 4 arguments, but found only \".concat(t.length - 1, \".\"));\n          if ((t.length - 1) % 2 != 0) return e.error(\"Expected an even number of arguments.\");\n          if (i = e.parse(i, 2, se), !i) return null;\n          var a = [];\n          var o = null;\n          \"interpolate-hcl\" === r || \"interpolate-lab\" === r ? o = le : e.expectedType && \"value\" !== e.expectedType.kind && (o = e.expectedType);\n          for (var _t39 = 0; _t39 < s.length; _t39 += 2) {\n            var _r41 = s[_t39],\n              _n22 = s[_t39 + 1],\n              _i20 = _t39 + 3,\n              _l4 = _t39 + 4;\n            if (\"number\" != typeof _r41) return e.error('Input/output pairs for \"interpolate\" expressions must be defined using literal numeric values (not computed expressions) for the input values.', _i20);\n            if (a.length && a[a.length - 1][0] >= _r41) return e.error('Input/output pairs for \"interpolate\" expressions must be arranged with input values in strictly ascending order.', _i20);\n            var _u4 = e.parse(_n22, _l4, o);\n            if (!_u4) return null;\n            o = o || _u4.type, a.push([_r41, _u4]);\n          }\n          return \"number\" === o.kind || \"color\" === o.kind || \"array\" === o.kind && \"number\" === o.itemType.kind && \"number\" == typeof o.N ? new Zr(o, r, n, i, a) : e.error(\"Type \".concat(ye(o), \" is not interpolatable.\"));\n        }\n      }]);\n      return Zr;\n    }();\n    function Xr(t, e, r, n) {\n      var i = n - r,\n        s = t - r;\n      return 0 === i ? 0 : 1 === e ? s / i : (Math.pow(e, s) - 1) / (Math.pow(e, i) - 1);\n    }\n    var Kr = Zr;\n    var Yr = /*#__PURE__*/function () {\n      function Yr(t, e) {\n        _classCallCheck(this, Yr);\n        this.type = t, this.args = e;\n      }\n      _createClass(Yr, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e,\n            r = null,\n            n = 0;\n          var _iterator33 = _createForOfIteratorHelper(this.args),\n            _step33;\n          try {\n            for (_iterator33.s(); !(_step33 = _iterator33.n()).done;) {\n              var _i21 = _step33.value;\n              if (n++, r = _i21.evaluate(t), r && r instanceof Ee && !r.available && (e || (e = r), r = null, n === this.args.length)) return e;\n              if (null !== r) break;\n            }\n          } catch (err) {\n            _iterator33.e(err);\n          } finally {\n            _iterator33.f();\n          }\n          return r;\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          this.args.forEach(t);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.args.every(function (t) {\n            return t.outputDefined();\n          });\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = [\"coalesce\"];\n          return this.eachChild(function (e) {\n            t.push(e.serialize());\n          }), t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length < 2) return e.error(\"Expectected at least one argument.\");\n          var r = null;\n          var n = e.expectedType;\n          n && \"value\" !== n.kind && (r = n);\n          var i = [];\n          var _iterator34 = _createForOfIteratorHelper(t.slice(1)),\n            _step34;\n          try {\n            for (_iterator34.s(); !(_step34 = _iterator34.n()).done;) {\n              var _n23 = _step34.value;\n              var _t40 = e.parse(_n23, 1 + i.length, r, void 0, {\n                typeAnnotation: \"omit\"\n              });\n              if (!_t40) return null;\n              r = r || _t40.type, i.push(_t40);\n            }\n          } catch (err) {\n            _iterator34.e(err);\n          } finally {\n            _iterator34.f();\n          }\n          var s = n && i.some(function (t) {\n            return ge(n, t.type);\n          });\n          return new Yr(s ? ce : r, i);\n        }\n      }]);\n      return Yr;\n    }();\n    var Hr = Yr;\n    var Wr = /*#__PURE__*/function () {\n      function Wr(t, e) {\n        _classCallCheck(this, Wr);\n        this.type = e.type, this.bindings = [].concat(t), this.result = e;\n      }\n      _createClass(Wr, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          return this.result.evaluate(t);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          var _iterator35 = _createForOfIteratorHelper(this.bindings),\n            _step35;\n          try {\n            for (_iterator35.s(); !(_step35 = _iterator35.n()).done;) {\n              var _e39 = _step35.value;\n              t(_e39[1]);\n            }\n          } catch (err) {\n            _iterator35.e(err);\n          } finally {\n            _iterator35.f();\n          }\n          t(this.result);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.result.outputDefined();\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = [\"let\"];\n          var _iterator36 = _createForOfIteratorHelper(this.bindings),\n            _step36;\n          try {\n            for (_iterator36.s(); !(_step36 = _iterator36.n()).done;) {\n              var _step36$value = _slicedToArray(_step36.value, 2),\n                _e40 = _step36$value[0],\n                _r42 = _step36$value[1];\n              t.push(_e40, _r42.serialize());\n            }\n          } catch (err) {\n            _iterator36.e(err);\n          } finally {\n            _iterator36.f();\n          }\n          return t.push(this.result.serialize()), t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length < 4) return e.error(\"Expected at least 3 arguments, but found \".concat(t.length - 1, \" instead.\"));\n          var r = [];\n          for (var _n24 = 1; _n24 < t.length - 1; _n24 += 2) {\n            var _i22 = t[_n24];\n            if (\"string\" != typeof _i22) return e.error(\"Expected string, but found \".concat(typeof _i22, \" instead.\"), _n24);\n            if (/[^a-zA-Z0-9_]/.test(_i22)) return e.error(\"Variable names must contain only alphanumeric characters or '_'.\", _n24);\n            var _s17 = e.parse(t[_n24 + 1], _n24 + 1);\n            if (!_s17) return null;\n            r.push([_i22, _s17]);\n          }\n          var n = e.parse(t[t.length - 1], t.length - 1, e.expectedType, r);\n          return n ? new Wr(r, n) : null;\n        }\n      }]);\n      return Wr;\n    }();\n    var Jr = Wr;\n    var Qr = /*#__PURE__*/function () {\n      function Qr(t, e, r) {\n        _classCallCheck(this, Qr);\n        this.type = t, this.index = e, this.input = r;\n      }\n      _createClass(Qr, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.index.evaluate(t),\n            r = this.input.evaluate(t);\n          if (e < 0) throw new Re(\"Array index out of bounds: \".concat(e, \" < 0.\"));\n          if (e >= r.length) throw new Re(\"Array index out of bounds: \".concat(e, \" > \").concat(r.length - 1, \".\"));\n          if (e !== Math.floor(e)) throw new Re(\"Array index must be an integer, but found \".concat(e, \" instead.\"));\n          return r[e];\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.index), t(this.input);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return [\"at\", this.index.serialize(), this.input.serialize()];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (3 !== t.length) return e.error(\"Expected 2 arguments, but found \".concat(t.length - 1, \" instead.\"));\n          var r = e.parse(t[1], 1, se),\n            n = e.parse(t[2], 2, de(e.expectedType || ce));\n          return r && n ? new Qr(n.type.itemType, r, n) : null;\n        }\n      }]);\n      return Qr;\n    }();\n    var tn = Qr;\n    var en = /*#__PURE__*/function () {\n      function en(t, e) {\n        _classCallCheck(this, en);\n        this.type = oe, this.needle = t, this.haystack = e;\n      }\n      _createClass(en, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.needle.evaluate(t),\n            r = this.haystack.evaluate(t);\n          if (null == r) return !1;\n          if (!ve(e, [\"boolean\", \"string\", \"number\", \"null\"])) throw new Re(\"Expected first argument to be of type boolean, string, number or null, but found \".concat(ye(De(e)), \" instead.\"));\n          if (!ve(r, [\"string\", \"array\"])) throw new Re(\"Expected second argument to be of type array or string, but found \".concat(ye(De(r)), \" instead.\"));\n          return r.indexOf(e) >= 0;\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.needle), t(this.haystack);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !0;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return [\"in\", this.needle.serialize(), this.haystack.serialize()];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (3 !== t.length) return e.error(\"Expected 2 arguments, but found \".concat(t.length - 1, \" instead.\"));\n          var r = e.parse(t[1], 1, ce),\n            n = e.parse(t[2], 2, ce);\n          return r && n ? xe(r.type, [oe, ae, se, ie, ce]) ? new en(r, n) : e.error(\"Expected first argument to be of type boolean, string, number or null, but found \".concat(ye(r.type), \" instead\")) : null;\n        }\n      }]);\n      return en;\n    }();\n    var rn = en;\n    var nn = /*#__PURE__*/function () {\n      function nn(t, e, r) {\n        _classCallCheck(this, nn);\n        this.type = se, this.needle = t, this.haystack = e, this.fromIndex = r;\n      }\n      _createClass(nn, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.needle.evaluate(t),\n            r = this.haystack.evaluate(t);\n          if (!ve(e, [\"boolean\", \"string\", \"number\", \"null\"])) throw new Re(\"Expected first argument to be of type boolean, string, number or null, but found \".concat(ye(De(e)), \" instead.\"));\n          if (!ve(r, [\"string\", \"array\"])) throw new Re(\"Expected second argument to be of type array or string, but found \".concat(ye(De(r)), \" instead.\"));\n          if (this.fromIndex) {\n            var _n25 = this.fromIndex.evaluate(t);\n            return r.indexOf(e, _n25);\n          }\n          return r.indexOf(e);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.needle), t(this.haystack), this.fromIndex && t(this.fromIndex);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          if (null != this.fromIndex && void 0 !== this.fromIndex) {\n            var _t41 = this.fromIndex.serialize();\n            return [\"index-of\", this.needle.serialize(), this.haystack.serialize(), _t41];\n          }\n          return [\"index-of\", this.needle.serialize(), this.haystack.serialize()];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length <= 2 || t.length >= 5) return e.error(\"Expected 3 or 4 arguments, but found \".concat(t.length - 1, \" instead.\"));\n          var r = e.parse(t[1], 1, ce),\n            n = e.parse(t[2], 2, ce);\n          if (!r || !n) return null;\n          if (!xe(r.type, [oe, ae, se, ie, ce])) return e.error(\"Expected first argument to be of type boolean, string, number or null, but found \".concat(ye(r.type), \" instead\"));\n          if (4 === t.length) {\n            var _i23 = e.parse(t[3], 3, se);\n            return _i23 ? new nn(r, n, _i23) : null;\n          }\n          return new nn(r, n);\n        }\n      }]);\n      return nn;\n    }();\n    var sn = nn;\n    var an = /*#__PURE__*/function () {\n      function an(t, e, r, n, i, s) {\n        _classCallCheck(this, an);\n        this.inputType = t, this.type = e, this.input = r, this.cases = n, this.outputs = i, this.otherwise = s;\n      }\n      _createClass(an, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.input.evaluate(t);\n          return (De(e) === this.inputType && this.outputs[this.cases[e]] || this.otherwise).evaluate(t);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.input), this.outputs.forEach(t), t(this.otherwise);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.outputs.every(function (t) {\n            return t.outputDefined();\n          }) && this.otherwise.outputDefined();\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var _this12 = this;\n          var t = [\"match\", this.input.serialize()],\n            e = Object.keys(this.cases).sort(),\n            r = [],\n            n = {};\n          var _iterator37 = _createForOfIteratorHelper(e),\n            _step37;\n          try {\n            for (_iterator37.s(); !(_step37 = _iterator37.n()).done;) {\n              var _t42 = _step37.value;\n              var _e42 = n[this.cases[_t42]];\n              void 0 === _e42 ? (n[this.cases[_t42]] = r.length, r.push([this.cases[_t42], [_t42]])) : r[_e42][1].push(_t42);\n            }\n          } catch (err) {\n            _iterator37.e(err);\n          } finally {\n            _iterator37.f();\n          }\n          var i = function i(t) {\n            return \"number\" === _this12.inputType.kind ? Number(t) : t;\n          };\n          for (var _i24 = 0, _r43 = r; _i24 < _r43.length; _i24++) {\n            var _r43$_i = _slicedToArray(_r43[_i24], 2),\n              _e41 = _r43$_i[0],\n              _n26 = _r43$_i[1];\n            t.push(1 === _n26.length ? i(_n26[0]) : _n26.map(i)), t.push(this.outputs[_e41].serialize());\n          }\n          return t.push(this.otherwise.serialize()), t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length < 5) return e.error(\"Expected at least 4 arguments, but found only \".concat(t.length - 1, \".\"));\n          if (t.length % 2 != 1) return e.error(\"Expected an even number of arguments.\");\n          var r, n;\n          e.expectedType && \"value\" !== e.expectedType.kind && (n = e.expectedType);\n          var i = {},\n            s = [];\n          for (var _a15 = 2; _a15 < t.length - 1; _a15 += 2) {\n            var _o7 = t[_a15];\n            var _l5 = t[_a15 + 1];\n            Array.isArray(_o7) || (_o7 = [_o7]);\n            var _u5 = e.concat(_a15);\n            if (0 === _o7.length) return _u5.error(\"Expected at least one branch label.\");\n            var _iterator38 = _createForOfIteratorHelper(_o7),\n              _step38;\n            try {\n              for (_iterator38.s(); !(_step38 = _iterator38.n()).done;) {\n                var _t43 = _step38.value;\n                if (\"number\" != typeof _t43 && \"string\" != typeof _t43) return _u5.error(\"Branch labels must be numbers or strings.\");\n                if (\"number\" == typeof _t43 && Math.abs(_t43) > Number.MAX_SAFE_INTEGER) return _u5.error(\"Branch labels must be integers no larger than \".concat(Number.MAX_SAFE_INTEGER, \".\"));\n                if (\"number\" == typeof _t43 && Math.floor(_t43) !== _t43) return _u5.error(\"Numeric branch labels must be integer values.\");\n                if (r) {\n                  if (_u5.checkSubtype(r, De(_t43))) return null;\n                } else r = De(_t43);\n                if (void 0 !== i[String(_t43)]) return _u5.error(\"Branch labels must be unique.\");\n                i[String(_t43)] = s.length;\n              }\n            } catch (err) {\n              _iterator38.e(err);\n            } finally {\n              _iterator38.f();\n            }\n            var _c2 = e.parse(_l5, _a15, n);\n            if (!_c2) return null;\n            n = n || _c2.type, s.push(_c2);\n          }\n          var a = e.parse(t[1], 1, ce);\n          if (!a) return null;\n          var o = e.parse(t[t.length - 1], t.length - 1, n);\n          return o ? \"value\" !== a.type.kind && e.concat(1).checkSubtype(r, a.type) ? null : new an(r, n, a, i, s, o) : null;\n        }\n      }]);\n      return an;\n    }();\n    var on = an;\n    var ln = /*#__PURE__*/function () {\n      function ln(t, e, r) {\n        _classCallCheck(this, ln);\n        this.type = t, this.branches = e, this.otherwise = r;\n      }\n      _createClass(ln, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var _iterator39 = _createForOfIteratorHelper(this.branches),\n            _step39;\n          try {\n            for (_iterator39.s(); !(_step39 = _iterator39.n()).done;) {\n              var _step39$value = _slicedToArray(_step39.value, 2),\n                _e43 = _step39$value[0],\n                _r44 = _step39$value[1];\n              if (_e43.evaluate(t)) return _r44.evaluate(t);\n            }\n          } catch (err) {\n            _iterator39.e(err);\n          } finally {\n            _iterator39.f();\n          }\n          return this.otherwise.evaluate(t);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          var _iterator40 = _createForOfIteratorHelper(this.branches),\n            _step40;\n          try {\n            for (_iterator40.s(); !(_step40 = _iterator40.n()).done;) {\n              var _step40$value = _slicedToArray(_step40.value, 2),\n                _e44 = _step40$value[0],\n                _r45 = _step40$value[1];\n              t(_e44), t(_r45);\n            }\n          } catch (err) {\n            _iterator40.e(err);\n          } finally {\n            _iterator40.f();\n          }\n          t(this.otherwise);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return this.branches.every(function (_ref5) {\n            var _ref6 = _slicedToArray(_ref5, 2),\n              t = _ref6[0],\n              e = _ref6[1];\n            return e.outputDefined();\n          }) && this.otherwise.outputDefined();\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = [\"case\"];\n          return this.eachChild(function (e) {\n            t.push(e.serialize());\n          }), t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length < 4) return e.error(\"Expected at least 3 arguments, but found only \".concat(t.length - 1, \".\"));\n          if (t.length % 2 != 0) return e.error(\"Expected an odd number of arguments.\");\n          var r;\n          e.expectedType && \"value\" !== e.expectedType.kind && (r = e.expectedType);\n          var n = [];\n          for (var _i25 = 1; _i25 < t.length - 1; _i25 += 2) {\n            var _s18 = e.parse(t[_i25], _i25, oe);\n            if (!_s18) return null;\n            var _a16 = e.parse(t[_i25 + 1], _i25 + 1, r);\n            if (!_a16) return null;\n            n.push([_s18, _a16]), r = r || _a16.type;\n          }\n          var i = e.parse(t[t.length - 1], t.length - 1, r);\n          return i ? new ln(r, n, i) : null;\n        }\n      }]);\n      return ln;\n    }();\n    var un = ln;\n    var cn = /*#__PURE__*/function () {\n      function cn(t, e, r, n) {\n        _classCallCheck(this, cn);\n        this.type = t, this.input = e, this.beginIndex = r, this.endIndex = n;\n      }\n      _createClass(cn, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.input.evaluate(t),\n            r = this.beginIndex.evaluate(t);\n          if (!ve(e, [\"string\", \"array\"])) throw new Re(\"Expected first argument to be of type array or string, but found \".concat(ye(De(e)), \" instead.\"));\n          if (this.endIndex) {\n            var _n27 = this.endIndex.evaluate(t);\n            return e.slice(r, _n27);\n          }\n          return e.slice(r);\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.input), t(this.beginIndex), this.endIndex && t(this.endIndex);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          if (null != this.endIndex && void 0 !== this.endIndex) {\n            var _t44 = this.endIndex.serialize();\n            return [\"slice\", this.input.serialize(), this.beginIndex.serialize(), _t44];\n          }\n          return [\"slice\", this.input.serialize(), this.beginIndex.serialize()];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (t.length <= 2 || t.length >= 5) return e.error(\"Expected 3 or 4 arguments, but found \".concat(t.length - 1, \" instead.\"));\n          var r = e.parse(t[1], 1, ce),\n            n = e.parse(t[2], 2, se);\n          if (!r || !n) return null;\n          if (!xe(r.type, [de(ce), ae, ce])) return e.error(\"Expected first argument to be of type array or string, but found \".concat(ye(r.type), \" instead\"));\n          if (4 === t.length) {\n            var _i26 = e.parse(t[3], 3, se);\n            return _i26 ? new cn(r.type, r, n, _i26) : null;\n          }\n          return new cn(r.type, r, n);\n        }\n      }]);\n      return cn;\n    }();\n    var hn = cn;\n    function pn(t, e) {\n      return \"==\" === t || \"!=\" === t ? \"boolean\" === e.kind || \"string\" === e.kind || \"number\" === e.kind || \"null\" === e.kind || \"value\" === e.kind : \"string\" === e.kind || \"number\" === e.kind || \"value\" === e.kind;\n    }\n    function fn(t, e, r, n) {\n      return 0 === n.compare(e, r);\n    }\n    function dn(t, e, r) {\n      var n = \"==\" !== t && \"!=\" !== t;\n      return /*#__PURE__*/function () {\n        function i(t, e, r) {\n          _classCallCheck(this, i);\n          this.type = oe, this.lhs = t, this.rhs = e, this.collator = r, this.hasUntypedArgument = \"value\" === t.type.kind || \"value\" === e.type.kind;\n        }\n        _createClass(i, [{\n          key: \"evaluate\",\n          value: function evaluate(i) {\n            var s = this.lhs.evaluate(i),\n              a = this.rhs.evaluate(i);\n            if (n && this.hasUntypedArgument) {\n              var _e45 = De(s),\n                _r46 = De(a);\n              if (_e45.kind !== _r46.kind || \"string\" !== _e45.kind && \"number\" !== _e45.kind) throw new Re(\"Expected arguments for \\\"\".concat(t, \"\\\" to be (string, string) or (number, number), but found (\").concat(_e45.kind, \", \").concat(_r46.kind, \") instead.\"));\n            }\n            if (this.collator && !n && this.hasUntypedArgument) {\n              var _t45 = De(s),\n                _r47 = De(a);\n              if (\"string\" !== _t45.kind || \"string\" !== _r47.kind) return e(i, s, a);\n            }\n            return this.collator ? r(i, s, a, this.collator.evaluate(i)) : e(i, s, a);\n          }\n        }, {\n          key: \"eachChild\",\n          value: function eachChild(t) {\n            t(this.lhs), t(this.rhs), this.collator && t(this.collator);\n          }\n        }, {\n          key: \"outputDefined\",\n          value: function outputDefined() {\n            return !0;\n          }\n        }, {\n          key: \"serialize\",\n          value: function serialize() {\n            var e = [t];\n            return this.eachChild(function (t) {\n              e.push(t.serialize());\n            }), e;\n          }\n        }], [{\n          key: \"parse\",\n          value: function parse(t, e) {\n            if (3 !== t.length && 4 !== t.length) return e.error(\"Expected two or three arguments.\");\n            var r = t[0];\n            var s = e.parse(t[1], 1, ce);\n            if (!s) return null;\n            if (!pn(r, s.type)) return e.concat(1).error(\"\\\"\".concat(r, \"\\\" comparisons are not supported for type '\").concat(ye(s.type), \"'.\"));\n            var a = e.parse(t[2], 2, ce);\n            if (!a) return null;\n            if (!pn(r, a.type)) return e.concat(2).error(\"\\\"\".concat(r, \"\\\" comparisons are not supported for type '\").concat(ye(a.type), \"'.\"));\n            if (s.type.kind !== a.type.kind && \"value\" !== s.type.kind && \"value\" !== a.type.kind) return e.error(\"Cannot compare types '\".concat(ye(s.type), \"' and '\").concat(ye(a.type), \"'.\"));\n            n && (\"value\" === s.type.kind && \"value\" !== a.type.kind ? s = new Ue(a.type, [s]) : \"value\" !== s.type.kind && \"value\" === a.type.kind && (a = new Ue(s.type, [a])));\n            var o = null;\n            if (4 === t.length) {\n              if (\"string\" !== s.type.kind && \"string\" !== a.type.kind && \"value\" !== s.type.kind && \"value\" !== a.type.kind) return e.error(\"Cannot use collator to compare non-string types.\");\n              if (o = e.parse(t[3], 3, he), !o) return null;\n            }\n            return new i(s, a, o);\n          }\n        }]);\n        return i;\n      }();\n    }\n    var yn = dn(\"==\", function (t, e, r) {\n        return e === r;\n      }, fn),\n      mn = dn(\"!=\", function (t, e, r) {\n        return e !== r;\n      }, function (t, e, r, n) {\n        return !fn(0, e, r, n);\n      }),\n      gn = dn(\"<\", function (t, e, r) {\n        return e < r;\n      }, function (t, e, r, n) {\n        return n.compare(e, r) < 0;\n      }),\n      xn = dn(\">\", function (t, e, r) {\n        return e > r;\n      }, function (t, e, r, n) {\n        return n.compare(e, r) > 0;\n      }),\n      vn = dn(\"<=\", function (t, e, r) {\n        return e <= r;\n      }, function (t, e, r, n) {\n        return n.compare(e, r) <= 0;\n      }),\n      bn = dn(\">=\", function (t, e, r) {\n        return e >= r;\n      }, function (t, e, r, n) {\n        return n.compare(e, r) >= 0;\n      });\n    var wn = /*#__PURE__*/function () {\n      function wn(t, e, r, n, i, s) {\n        _classCallCheck(this, wn);\n        this.type = ae, this.number = t, this.locale = e, this.currency = r, this.unit = n, this.minFractionDigits = i, this.maxFractionDigits = s;\n      }\n      _createClass(wn, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          return new Intl.NumberFormat(this.locale ? this.locale.evaluate(t) : [], {\n            style: (this.currency ? \"currency\" : this.unit && \"unit\") || \"decimal\",\n            currency: this.currency ? this.currency.evaluate(t) : void 0,\n            unit: this.unit ? this.unit.evaluate(t) : void 0,\n            minimumFractionDigits: this.minFractionDigits ? this.minFractionDigits.evaluate(t) : void 0,\n            maximumFractionDigits: this.maxFractionDigits ? this.maxFractionDigits.evaluate(t) : void 0\n          }).format(this.number.evaluate(t));\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.number), this.locale && t(this.locale), this.currency && t(this.currency), this.unit && t(this.unit), this.minFractionDigits && t(this.minFractionDigits), this.maxFractionDigits && t(this.maxFractionDigits);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = {};\n          return this.locale && (t.locale = this.locale.serialize()), this.currency && (t.currency = this.currency.serialize()), this.unit && (t.unit = this.unit.serialize()), this.minFractionDigits && (t[\"min-fraction-digits\"] = this.minFractionDigits.serialize()), this.maxFractionDigits && (t[\"max-fraction-digits\"] = this.maxFractionDigits.serialize()), [\"number-format\", this.number.serialize(), t];\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (3 !== t.length) return e.error(\"Expected two arguments.\");\n          var r = e.parse(t[1], 1, se);\n          if (!r) return null;\n          var n = t[2];\n          if (\"object\" != typeof n || Array.isArray(n)) return e.error(\"NumberFormat options argument must be an object.\");\n          var i = null;\n          if (n.locale && (i = e.parse(n.locale, 1, ae), !i)) return null;\n          var s = null;\n          if (n.currency && (s = e.parse(n.currency, 1, ae), !s)) return null;\n          var a = null;\n          if (n.unit && (a = e.parse(n.unit, 1, ae), !a)) return null;\n          var o = null;\n          if (n[\"min-fraction-digits\"] && (o = e.parse(n[\"min-fraction-digits\"], 1, se), !o)) return null;\n          var l = null;\n          return n[\"max-fraction-digits\"] && (l = e.parse(n[\"max-fraction-digits\"], 1, se), !l) ? null : new wn(r, i, s, a, o, l);\n        }\n      }]);\n      return wn;\n    }();\n    var _n = /*#__PURE__*/function () {\n      function _n(t) {\n        _classCallCheck(this, _n);\n        this.type = se, this.input = t;\n      }\n      _createClass(_n, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          var e = this.input.evaluate(t);\n          if (\"string\" == typeof e) return e.length;\n          if (Array.isArray(e)) return e.length;\n          throw new Re(\"Expected value to be of type string or array, but found \".concat(ye(De(e)), \" instead.\"));\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          t(this.input);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = [\"length\"];\n          return this.eachChild(function (e) {\n            t.push(e.serialize());\n          }), t;\n        }\n      }], [{\n        key: \"parse\",\n        value: function parse(t, e) {\n          if (2 !== t.length) return e.error(\"Expected 1 argument, but found \".concat(t.length - 1, \" instead.\"));\n          var r = e.parse(t[1], 1);\n          return r ? \"array\" !== r.type.kind && \"string\" !== r.type.kind && \"value\" !== r.type.kind ? e.error(\"Expected argument of type string or array, but found \".concat(ye(r.type), \" instead.\")) : new _n(r) : null;\n        }\n      }]);\n      return _n;\n    }();\n    var An = {\n      \"==\": yn,\n      \"!=\": mn,\n      \">\": xn,\n      \"<\": gn,\n      \">=\": bn,\n      \"<=\": vn,\n      array: Ue,\n      at: tn,\n      boolean: Ue,\n      case: un,\n      coalesce: Hr,\n      collator: We,\n      format: Oe,\n      image: qe,\n      in: rn,\n      \"index-of\": sn,\n      interpolate: Kr,\n      \"interpolate-hcl\": Kr,\n      \"interpolate-lab\": Kr,\n      length: _n,\n      let: Jr,\n      literal: Fe,\n      match: on,\n      number: Ue,\n      \"number-format\": wn,\n      object: Ue,\n      slice: hn,\n      step: Ir,\n      string: Ue,\n      \"to-boolean\": Ze,\n      \"to-color\": Ze,\n      \"to-number\": Ze,\n      \"to-string\": Ze,\n      var: br,\n      within: yr\n    };\n    function Sn(t, _ref7) {\n      var _ref8 = _slicedToArray(_ref7, 4),\n        e = _ref8[0],\n        r = _ref8[1],\n        n = _ref8[2],\n        i = _ref8[3];\n      e = e.evaluate(t), r = r.evaluate(t), n = n.evaluate(t);\n      var s = i ? i.evaluate(t) : 1,\n        a = Ce(e, r, n, s);\n      if (a) throw new Re(a);\n      return new Me(e / 255 * s, r / 255 * s, n / 255 * s, s);\n    }\n    function kn(t, e) {\n      return t in e;\n    }\n    function In(t, e) {\n      var r = e[t];\n      return void 0 === r ? null : r;\n    }\n    function Mn(t) {\n      return {\n        type: t\n      };\n    }\n    He.register(An, {\n      error: [{\n        kind: \"error\"\n      }, [ae], function (t, _ref9) {\n        var _ref10 = _slicedToArray(_ref9, 1),\n          e = _ref10[0];\n        throw new Re(e.evaluate(t));\n      }],\n      typeof: [ae, [ce], function (t, _ref11) {\n        var _ref12 = _slicedToArray(_ref11, 1),\n          e = _ref12[0];\n        return ye(De(e.evaluate(t)));\n      }],\n      \"to-rgba\": [de(se, 4), [le], function (t, _ref13) {\n        var _ref14 = _slicedToArray(_ref13, 1),\n          e = _ref14[0];\n        return e.evaluate(t).toArray();\n      }],\n      rgb: [le, [se, se, se], Sn],\n      rgba: [le, [se, se, se, se], Sn],\n      has: {\n        type: oe,\n        overloads: [[[ae], function (t, _ref15) {\n          var _ref16 = _slicedToArray(_ref15, 1),\n            e = _ref16[0];\n          return kn(e.evaluate(t), t.properties());\n        }], [[ae, ue], function (t, _ref17) {\n          var _ref18 = _slicedToArray(_ref17, 2),\n            e = _ref18[0],\n            r = _ref18[1];\n          return kn(e.evaluate(t), r.evaluate(t));\n        }]]\n      },\n      get: {\n        type: ce,\n        overloads: [[[ae], function (t, _ref19) {\n          var _ref20 = _slicedToArray(_ref19, 1),\n            e = _ref20[0];\n          return In(e.evaluate(t), t.properties());\n        }], [[ae, ue], function (t, _ref21) {\n          var _ref22 = _slicedToArray(_ref21, 2),\n            e = _ref22[0],\n            r = _ref22[1];\n          return In(e.evaluate(t), r.evaluate(t));\n        }]]\n      },\n      \"feature-state\": [ce, [ae], function (t, _ref23) {\n        var _ref24 = _slicedToArray(_ref23, 1),\n          e = _ref24[0];\n        return In(e.evaluate(t), t.featureState || {});\n      }],\n      properties: [ue, [], function (t) {\n        return t.properties();\n      }],\n      \"geometry-type\": [ae, [], function (t) {\n        return t.geometryType();\n      }],\n      id: [ce, [], function (t) {\n        return t.id();\n      }],\n      zoom: [se, [], function (t) {\n        return t.globals.zoom;\n      }],\n      pitch: [se, [], function (t) {\n        return t.globals.pitch || 0;\n      }],\n      \"distance-from-center\": [se, [], function (t) {\n        return t.distanceFromCenter();\n      }],\n      \"heatmap-density\": [se, [], function (t) {\n        return t.globals.heatmapDensity || 0;\n      }],\n      \"line-progress\": [se, [], function (t) {\n        return t.globals.lineProgress || 0;\n      }],\n      \"sky-radial-progress\": [se, [], function (t) {\n        return t.globals.skyRadialProgress || 0;\n      }],\n      accumulated: [ce, [], function (t) {\n        return void 0 === t.globals.accumulated ? null : t.globals.accumulated;\n      }],\n      \"+\": [se, Mn(se), function (t, e) {\n        var r = 0;\n        var _iterator41 = _createForOfIteratorHelper(e),\n          _step41;\n        try {\n          for (_iterator41.s(); !(_step41 = _iterator41.n()).done;) {\n            var _n28 = _step41.value;\n            r += _n28.evaluate(t);\n          }\n        } catch (err) {\n          _iterator41.e(err);\n        } finally {\n          _iterator41.f();\n        }\n        return r;\n      }],\n      \"*\": [se, Mn(se), function (t, e) {\n        var r = 1;\n        var _iterator42 = _createForOfIteratorHelper(e),\n          _step42;\n        try {\n          for (_iterator42.s(); !(_step42 = _iterator42.n()).done;) {\n            var _n29 = _step42.value;\n            r *= _n29.evaluate(t);\n          }\n        } catch (err) {\n          _iterator42.e(err);\n        } finally {\n          _iterator42.f();\n        }\n        return r;\n      }],\n      \"-\": {\n        type: se,\n        overloads: [[[se, se], function (t, _ref25) {\n          var _ref26 = _slicedToArray(_ref25, 2),\n            e = _ref26[0],\n            r = _ref26[1];\n          return e.evaluate(t) - r.evaluate(t);\n        }], [[se], function (t, _ref27) {\n          var _ref28 = _slicedToArray(_ref27, 1),\n            e = _ref28[0];\n          return -e.evaluate(t);\n        }]]\n      },\n      \"/\": [se, [se, se], function (t, _ref29) {\n        var _ref30 = _slicedToArray(_ref29, 2),\n          e = _ref30[0],\n          r = _ref30[1];\n        return e.evaluate(t) / r.evaluate(t);\n      }],\n      \"%\": [se, [se, se], function (t, _ref31) {\n        var _ref32 = _slicedToArray(_ref31, 2),\n          e = _ref32[0],\n          r = _ref32[1];\n        return e.evaluate(t) % r.evaluate(t);\n      }],\n      ln2: [se, [], function () {\n        return Math.LN2;\n      }],\n      pi: [se, [], function () {\n        return Math.PI;\n      }],\n      e: [se, [], function () {\n        return Math.E;\n      }],\n      \"^\": [se, [se, se], function (t, _ref33) {\n        var _ref34 = _slicedToArray(_ref33, 2),\n          e = _ref34[0],\n          r = _ref34[1];\n        return Math.pow(e.evaluate(t), r.evaluate(t));\n      }],\n      sqrt: [se, [se], function (t, _ref35) {\n        var _ref36 = _slicedToArray(_ref35, 1),\n          e = _ref36[0];\n        return Math.sqrt(e.evaluate(t));\n      }],\n      log10: [se, [se], function (t, _ref37) {\n        var _ref38 = _slicedToArray(_ref37, 1),\n          e = _ref38[0];\n        return Math.log(e.evaluate(t)) / Math.LN10;\n      }],\n      ln: [se, [se], function (t, _ref39) {\n        var _ref40 = _slicedToArray(_ref39, 1),\n          e = _ref40[0];\n        return Math.log(e.evaluate(t));\n      }],\n      log2: [se, [se], function (t, _ref41) {\n        var _ref42 = _slicedToArray(_ref41, 1),\n          e = _ref42[0];\n        return Math.log(e.evaluate(t)) / Math.LN2;\n      }],\n      sin: [se, [se], function (t, _ref43) {\n        var _ref44 = _slicedToArray(_ref43, 1),\n          e = _ref44[0];\n        return Math.sin(e.evaluate(t));\n      }],\n      cos: [se, [se], function (t, _ref45) {\n        var _ref46 = _slicedToArray(_ref45, 1),\n          e = _ref46[0];\n        return Math.cos(e.evaluate(t));\n      }],\n      tan: [se, [se], function (t, _ref47) {\n        var _ref48 = _slicedToArray(_ref47, 1),\n          e = _ref48[0];\n        return Math.tan(e.evaluate(t));\n      }],\n      asin: [se, [se], function (t, _ref49) {\n        var _ref50 = _slicedToArray(_ref49, 1),\n          e = _ref50[0];\n        return Math.asin(e.evaluate(t));\n      }],\n      acos: [se, [se], function (t, _ref51) {\n        var _ref52 = _slicedToArray(_ref51, 1),\n          e = _ref52[0];\n        return Math.acos(e.evaluate(t));\n      }],\n      atan: [se, [se], function (t, _ref53) {\n        var _ref54 = _slicedToArray(_ref53, 1),\n          e = _ref54[0];\n        return Math.atan(e.evaluate(t));\n      }],\n      min: [se, Mn(se), function (t, e) {\n        return Math.min.apply(Math, _toConsumableArray(e.map(function (e) {\n          return e.evaluate(t);\n        })));\n      }],\n      max: [se, Mn(se), function (t, e) {\n        return Math.max.apply(Math, _toConsumableArray(e.map(function (e) {\n          return e.evaluate(t);\n        })));\n      }],\n      abs: [se, [se], function (t, _ref55) {\n        var _ref56 = _slicedToArray(_ref55, 1),\n          e = _ref56[0];\n        return Math.abs(e.evaluate(t));\n      }],\n      round: [se, [se], function (t, _ref57) {\n        var _ref58 = _slicedToArray(_ref57, 1),\n          e = _ref58[0];\n        var r = e.evaluate(t);\n        return r < 0 ? -Math.round(-r) : Math.round(r);\n      }],\n      floor: [se, [se], function (t, _ref59) {\n        var _ref60 = _slicedToArray(_ref59, 1),\n          e = _ref60[0];\n        return Math.floor(e.evaluate(t));\n      }],\n      ceil: [se, [se], function (t, _ref61) {\n        var _ref62 = _slicedToArray(_ref61, 1),\n          e = _ref62[0];\n        return Math.ceil(e.evaluate(t));\n      }],\n      \"filter-==\": [oe, [ae, ce], function (t, _ref63) {\n        var _ref64 = _slicedToArray(_ref63, 2),\n          e = _ref64[0],\n          r = _ref64[1];\n        return t.properties()[e.value] === r.value;\n      }],\n      \"filter-id-==\": [oe, [ce], function (t, _ref65) {\n        var _ref66 = _slicedToArray(_ref65, 1),\n          e = _ref66[0];\n        return t.id() === e.value;\n      }],\n      \"filter-type-==\": [oe, [ae], function (t, _ref67) {\n        var _ref68 = _slicedToArray(_ref67, 1),\n          e = _ref68[0];\n        return t.geometryType() === e.value;\n      }],\n      \"filter-<\": [oe, [ae, ce], function (t, _ref69) {\n        var _ref70 = _slicedToArray(_ref69, 2),\n          e = _ref70[0],\n          r = _ref70[1];\n        var n = t.properties()[e.value],\n          i = r.value;\n        return typeof n == typeof i && n < i;\n      }],\n      \"filter-id-<\": [oe, [ce], function (t, _ref71) {\n        var _ref72 = _slicedToArray(_ref71, 1),\n          e = _ref72[0];\n        var r = t.id(),\n          n = e.value;\n        return typeof r == typeof n && r < n;\n      }],\n      \"filter->\": [oe, [ae, ce], function (t, _ref73) {\n        var _ref74 = _slicedToArray(_ref73, 2),\n          e = _ref74[0],\n          r = _ref74[1];\n        var n = t.properties()[e.value],\n          i = r.value;\n        return typeof n == typeof i && n > i;\n      }],\n      \"filter-id->\": [oe, [ce], function (t, _ref75) {\n        var _ref76 = _slicedToArray(_ref75, 1),\n          e = _ref76[0];\n        var r = t.id(),\n          n = e.value;\n        return typeof r == typeof n && r > n;\n      }],\n      \"filter-<=\": [oe, [ae, ce], function (t, _ref77) {\n        var _ref78 = _slicedToArray(_ref77, 2),\n          e = _ref78[0],\n          r = _ref78[1];\n        var n = t.properties()[e.value],\n          i = r.value;\n        return typeof n == typeof i && n <= i;\n      }],\n      \"filter-id-<=\": [oe, [ce], function (t, _ref79) {\n        var _ref80 = _slicedToArray(_ref79, 1),\n          e = _ref80[0];\n        var r = t.id(),\n          n = e.value;\n        return typeof r == typeof n && r <= n;\n      }],\n      \"filter->=\": [oe, [ae, ce], function (t, _ref81) {\n        var _ref82 = _slicedToArray(_ref81, 2),\n          e = _ref82[0],\n          r = _ref82[1];\n        var n = t.properties()[e.value],\n          i = r.value;\n        return typeof n == typeof i && n >= i;\n      }],\n      \"filter-id->=\": [oe, [ce], function (t, _ref83) {\n        var _ref84 = _slicedToArray(_ref83, 1),\n          e = _ref84[0];\n        var r = t.id(),\n          n = e.value;\n        return typeof r == typeof n && r >= n;\n      }],\n      \"filter-has\": [oe, [ce], function (t, _ref85) {\n        var _ref86 = _slicedToArray(_ref85, 1),\n          e = _ref86[0];\n        return e.value in t.properties();\n      }],\n      \"filter-has-id\": [oe, [], function (t) {\n        return null !== t.id() && void 0 !== t.id();\n      }],\n      \"filter-type-in\": [oe, [de(ae)], function (t, _ref87) {\n        var _ref88 = _slicedToArray(_ref87, 1),\n          e = _ref88[0];\n        return e.value.indexOf(t.geometryType()) >= 0;\n      }],\n      \"filter-id-in\": [oe, [de(ce)], function (t, _ref89) {\n        var _ref90 = _slicedToArray(_ref89, 1),\n          e = _ref90[0];\n        return e.value.indexOf(t.id()) >= 0;\n      }],\n      \"filter-in-small\": [oe, [ae, de(ce)], function (t, _ref91) {\n        var _ref92 = _slicedToArray(_ref91, 2),\n          e = _ref92[0],\n          r = _ref92[1];\n        return r.value.indexOf(t.properties()[e.value]) >= 0;\n      }],\n      \"filter-in-large\": [oe, [ae, de(ce)], function (t, _ref93) {\n        var _ref94 = _slicedToArray(_ref93, 2),\n          e = _ref94[0],\n          r = _ref94[1];\n        return function (t, e, r, n) {\n          for (; r <= n;) {\n            var _i27 = r + n >> 1;\n            if (e[_i27] === t) return !0;\n            e[_i27] > t ? n = _i27 - 1 : r = _i27 + 1;\n          }\n          return !1;\n        }(t.properties()[e.value], r.value, 0, r.value.length - 1);\n      }],\n      all: {\n        type: oe,\n        overloads: [[[oe, oe], function (t, _ref95) {\n          var _ref96 = _slicedToArray(_ref95, 2),\n            e = _ref96[0],\n            r = _ref96[1];\n          return e.evaluate(t) && r.evaluate(t);\n        }], [Mn(oe), function (t, e) {\n          var _iterator43 = _createForOfIteratorHelper(e),\n            _step43;\n          try {\n            for (_iterator43.s(); !(_step43 = _iterator43.n()).done;) {\n              var _r48 = _step43.value;\n              if (!_r48.evaluate(t)) return !1;\n            }\n          } catch (err) {\n            _iterator43.e(err);\n          } finally {\n            _iterator43.f();\n          }\n          return !0;\n        }]]\n      },\n      any: {\n        type: oe,\n        overloads: [[[oe, oe], function (t, _ref97) {\n          var _ref98 = _slicedToArray(_ref97, 2),\n            e = _ref98[0],\n            r = _ref98[1];\n          return e.evaluate(t) || r.evaluate(t);\n        }], [Mn(oe), function (t, e) {\n          var _iterator44 = _createForOfIteratorHelper(e),\n            _step44;\n          try {\n            for (_iterator44.s(); !(_step44 = _iterator44.n()).done;) {\n              var _r49 = _step44.value;\n              if (_r49.evaluate(t)) return !0;\n            }\n          } catch (err) {\n            _iterator44.e(err);\n          } finally {\n            _iterator44.f();\n          }\n          return !1;\n        }]]\n      },\n      \"!\": [oe, [oe], function (t, _ref99) {\n        var _ref100 = _slicedToArray(_ref99, 1),\n          e = _ref100[0];\n        return !e.evaluate(t);\n      }],\n      \"is-supported-script\": [oe, [ae], function (t, _ref101) {\n        var _ref102 = _slicedToArray(_ref101, 1),\n          e = _ref102[0];\n        var r = t.globals && t.globals.isSupportedScript;\n        return !r || r(e.evaluate(t));\n      }],\n      upcase: [ae, [ae], function (t, _ref103) {\n        var _ref104 = _slicedToArray(_ref103, 1),\n          e = _ref104[0];\n        return e.evaluate(t).toUpperCase();\n      }],\n      downcase: [ae, [ae], function (t, _ref105) {\n        var _ref106 = _slicedToArray(_ref105, 1),\n          e = _ref106[0];\n        return e.evaluate(t).toLowerCase();\n      }],\n      concat: [ae, Mn(ce), function (t, e) {\n        return e.map(function (e) {\n          return Ve(e.evaluate(t));\n        }).join(\"\");\n      }],\n      \"resolved-locale\": [ae, [he], function (t, _ref107) {\n        var _ref108 = _slicedToArray(_ref107, 1),\n          e = _ref108[0];\n        return e.evaluate(t).resolvedLocale();\n      }]\n    });\n    var Tn = An;\n    function zn(t) {\n      return {\n        result: \"success\",\n        value: t\n      };\n    }\n    function Bn(t) {\n      return {\n        result: \"error\",\n        value: t\n      };\n    }\n    function En(t) {\n      return \"data-driven\" === t[\"property-type\"];\n    }\n    function Cn(t) {\n      return !!t.expression && t.expression.parameters.indexOf(\"zoom\") > -1;\n    }\n    function Pn(t) {\n      return !!t.expression && t.expression.interpolated;\n    }\n    function Dn(t) {\n      return t instanceof Number ? \"number\" : t instanceof String ? \"string\" : t instanceof Boolean ? \"boolean\" : Array.isArray(t) ? \"array\" : null === t ? \"null\" : typeof t;\n    }\n    function Vn(t) {\n      return \"object\" == typeof t && null !== t && !Array.isArray(t);\n    }\n    function Ln(t) {\n      return t;\n    }\n    function Fn(t, e) {\n      var r = \"color\" === e.type,\n        n = t.stops && \"object\" == typeof t.stops[0][0],\n        i = n || !(n || void 0 !== t.property),\n        s = t.type || (Pn(e) ? \"exponential\" : \"interval\");\n      if (r && ((t = Wt({}, t)).stops && (t.stops = t.stops.map(function (t) {\n        return [t[0], Me.parse(t[1])];\n      })), t.default = Me.parse(t.default ? t.default : e.default)), t.colorSpace && \"rgb\" !== t.colorSpace && !Gr[t.colorSpace]) throw new Error(\"Unknown color space: \".concat(t.colorSpace));\n      var a, o, l;\n      if (\"exponential\" === s) a = Un;else if (\"interval\" === s) a = $n;else if (\"categorical\" === s) {\n        a = jn, o = Object.create(null);\n        var _iterator45 = _createForOfIteratorHelper(t.stops),\n          _step45;\n        try {\n          for (_iterator45.s(); !(_step45 = _iterator45.n()).done;) {\n            var _e46 = _step45.value;\n            o[_e46[0]] = _e46[1];\n          }\n        } catch (err) {\n          _iterator45.e(err);\n        } finally {\n          _iterator45.f();\n        }\n        l = typeof t.stops[0][0];\n      } else {\n        if (\"identity\" !== s) throw new Error(\"Unknown function type \\\"\".concat(s, \"\\\"\"));\n        a = On;\n      }\n      if (n) {\n        var _r50 = {},\n          _n30 = [];\n        for (var _e47 = 0; _e47 < t.stops.length; _e47++) {\n          var _i28 = t.stops[_e47],\n            _s19 = _i28[0].zoom;\n          void 0 === _r50[_s19] && (_r50[_s19] = {\n            zoom: _s19,\n            type: t.type,\n            property: t.property,\n            default: t.default,\n            stops: []\n          }, _n30.push(_s19)), _r50[_s19].stops.push([_i28[0].value, _i28[1]]);\n        }\n        var _i29 = [];\n        for (var _i30 = 0, _n31 = _n30; _i30 < _n31.length; _i30++) {\n          var _t46 = _n31[_i30];\n          _i29.push([_r50[_t46].zoom, Fn(_r50[_t46], e)]);\n        }\n        var _s20 = {\n          name: \"linear\"\n        };\n        return {\n          kind: \"composite\",\n          interpolationType: _s20,\n          interpolationFactor: Kr.interpolationFactor.bind(void 0, _s20),\n          zoomStops: _i29.map(function (t) {\n            return t[0];\n          }),\n          evaluate: function evaluate(_ref109, n) {\n            var r = _ref109.zoom;\n            return Un({\n              stops: _i29,\n              base: t.base\n            }, e, r).evaluate(r, n);\n          }\n        };\n      }\n      if (i) {\n        var _r51 = \"exponential\" === s ? {\n          name: \"exponential\",\n          base: void 0 !== t.base ? t.base : 1\n        } : null;\n        return {\n          kind: \"camera\",\n          interpolationType: _r51,\n          interpolationFactor: Kr.interpolationFactor.bind(void 0, _r51),\n          zoomStops: t.stops.map(function (t) {\n            return t[0];\n          }),\n          evaluate: function evaluate(_ref110) {\n            var r = _ref110.zoom;\n            return a(t, e, r, o, l);\n          }\n        };\n      }\n      return {\n        kind: \"source\",\n        evaluate: function evaluate(r, n) {\n          var i = n && n.properties ? n.properties[t.property] : void 0;\n          return void 0 === i ? Rn(t.default, e.default) : a(t, e, i, o, l);\n        }\n      };\n    }\n    function Rn(t, e, r) {\n      return void 0 !== t ? t : void 0 !== e ? e : void 0 !== r ? r : void 0;\n    }\n    function jn(t, e, r, n, i) {\n      return Rn(typeof r === i ? n[r] : void 0, t.default, e.default);\n    }\n    function $n(t, e, r) {\n      if (\"number\" !== Dn(r)) return Rn(t.default, e.default);\n      var n = t.stops.length;\n      if (1 === n) return t.stops[0][1];\n      if (r <= t.stops[0][0]) return t.stops[0][1];\n      if (r >= t.stops[n - 1][0]) return t.stops[n - 1][1];\n      var i = Sr(t.stops.map(function (t) {\n        return t[0];\n      }), r);\n      return t.stops[i][1];\n    }\n    function Un(t, e, r) {\n      var n = void 0 !== t.base ? t.base : 1;\n      if (\"number\" !== Dn(r)) return Rn(t.default, e.default);\n      var i = t.stops.length;\n      if (1 === i) return t.stops[0][1];\n      if (r <= t.stops[0][0]) return t.stops[0][1];\n      if (r >= t.stops[i - 1][0]) return t.stops[i - 1][1];\n      var s = Sr(t.stops.map(function (t) {\n          return t[0];\n        }), r),\n        a = function (t, e, r, n) {\n          var i = n - r,\n            s = t - r;\n          return 0 === i ? 0 : 1 === e ? s / i : (Math.pow(e, s) - 1) / (Math.pow(e, i) - 1);\n        }(r, n, t.stops[s][0], t.stops[s + 1][0]),\n        o = t.stops[s][1],\n        l = t.stops[s + 1][1];\n      var u = Tr[e.type] || Ln;\n      if (t.colorSpace && \"rgb\" !== t.colorSpace) {\n        var _e48 = Gr[t.colorSpace];\n        u = function u(t, r) {\n          return _e48.reverse(_e48.interpolate(_e48.forward(t), _e48.forward(r), a));\n        };\n      }\n      return \"function\" == typeof o.evaluate ? {\n        evaluate: function evaluate() {\n          for (var _len4 = arguments.length, t = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n            t[_key4] = arguments[_key4];\n          }\n          var e = o.evaluate.apply(void 0, t),\n            r = l.evaluate.apply(void 0, t);\n          if (void 0 !== e && void 0 !== r) return u(e, r, a);\n        }\n      } : u(o, l, a);\n    }\n    function On(t, e, r) {\n      return \"color\" === e.type ? r = Me.parse(r) : \"formatted\" === e.type ? r = Be.fromString(r.toString()) : \"resolvedImage\" === e.type ? r = Ee.fromString(r.toString()) : Dn(r) === e.type || \"enum\" === e.type && e.values[r] || (r = void 0), Rn(r, t.default, e.default);\n    }\n    var qn = /*#__PURE__*/function () {\n      function qn(t, e) {\n        _classCallCheck(this, qn);\n        this.expression = t, this._warningHistory = {}, this._evaluator = new Ke(), this._defaultValue = e ? function (t) {\n          return \"color\" === t.type && (Vn(t.default) || Array.isArray(t.default)) ? new Me(0, 0, 0, 0) : \"color\" === t.type ? Me.parse(t.default) || null : void 0 === t.default ? null : t.default;\n        }(e) : null, this._enumValues = e && \"enum\" === e.type ? e.values : null;\n      }\n      _createClass(qn, [{\n        key: \"evaluateWithoutErrorHandling\",\n        value: function evaluateWithoutErrorHandling(t, e, r, n, i, s, a, o) {\n          return this._evaluator.globals = t, this._evaluator.feature = e, this._evaluator.featureState = r, this._evaluator.canonical = n || null, this._evaluator.availableImages = i || null, this._evaluator.formattedSection = s, this._evaluator.featureTileCoord = a || null, this._evaluator.featureDistanceData = o || null, this.expression.evaluate(this._evaluator);\n        }\n      }, {\n        key: \"evaluate\",\n        value: function evaluate(t, e, r, n, i, s, a, o) {\n          this._evaluator.globals = t, this._evaluator.feature = e || null, this._evaluator.featureState = r || null, this._evaluator.canonical = n || null, this._evaluator.availableImages = i || null, this._evaluator.formattedSection = s || null, this._evaluator.featureTileCoord = a || null, this._evaluator.featureDistanceData = o || null;\n          try {\n            var _t47 = this.expression.evaluate(this._evaluator);\n            if (null == _t47 || \"number\" == typeof _t47 && _t47 != _t47) return this._defaultValue;\n            if (this._enumValues && !(_t47 in this._enumValues)) throw new Re(\"Expected value to be one of \".concat(Object.keys(this._enumValues).map(function (t) {\n              return JSON.stringify(t);\n            }).join(\", \"), \", but found \").concat(JSON.stringify(_t47), \" instead.\"));\n            return _t47;\n          } catch (t) {\n            return this._warningHistory[t.message] || (this._warningHistory[t.message] = !0, \"undefined\" != typeof console && console.warn(t.message)), this._defaultValue;\n          }\n        }\n      }]);\n      return qn;\n    }();\n    function Nn(t) {\n      return Array.isArray(t) && t.length > 0 && \"string\" == typeof t[0] && t[0] in Tn;\n    }\n    function Gn(t, e) {\n      var r = new _r(Tn, [], e ? function (t) {\n          var e = {\n            color: le,\n            string: ae,\n            number: se,\n            enum: ae,\n            boolean: oe,\n            formatted: pe,\n            resolvedImage: fe\n          };\n          return \"array\" === t.type ? de(e[t.value] || ce, t.length) : e[t.type];\n        }(e) : void 0),\n        n = r.parse(t, void 0, void 0, void 0, e && \"string\" === e.type ? {\n          typeAnnotation: \"coerce\"\n        } : void 0);\n      return n ? zn(new qn(n, e)) : Bn(r.errors);\n    }\n    var Zn = /*#__PURE__*/function () {\n      function Zn(t, e) {\n        _classCallCheck(this, Zn);\n        this.kind = t, this._styleExpression = e, this.isStateDependent = \"constant\" !== t && !gr(e.expression);\n      }\n      _createClass(Zn, [{\n        key: \"evaluateWithoutErrorHandling\",\n        value: function evaluateWithoutErrorHandling(t, e, r, n, i, s) {\n          return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, n, i, s);\n        }\n      }, {\n        key: \"evaluate\",\n        value: function evaluate(t, e, r, n, i, s) {\n          return this._styleExpression.evaluate(t, e, r, n, i, s);\n        }\n      }]);\n      return Zn;\n    }();\n    var Xn = /*#__PURE__*/function () {\n      function Xn(t, e, r, n) {\n        _classCallCheck(this, Xn);\n        this.kind = t, this.zoomStops = r, this._styleExpression = e, this.isStateDependent = \"camera\" !== t && !gr(e.expression), this.interpolationType = n;\n      }\n      _createClass(Xn, [{\n        key: \"evaluateWithoutErrorHandling\",\n        value: function evaluateWithoutErrorHandling(t, e, r, n, i, s) {\n          return this._styleExpression.evaluateWithoutErrorHandling(t, e, r, n, i, s);\n        }\n      }, {\n        key: \"evaluate\",\n        value: function evaluate(t, e, r, n, i, s) {\n          return this._styleExpression.evaluate(t, e, r, n, i, s);\n        }\n      }, {\n        key: \"interpolationFactor\",\n        value: function interpolationFactor(t, e, r) {\n          return this.interpolationType ? Kr.interpolationFactor(this.interpolationType, t, e, r) : 0;\n        }\n      }]);\n      return Xn;\n    }();\n    function Kn(t, e) {\n      if (\"error\" === (t = Gn(t, e)).result) return t;\n      var r = t.value.expression,\n        n = mr(r);\n      if (!n && !En(e)) return Bn([new ee(\"\", \"data expressions not supported\")]);\n      var i = xr(r, [\"zoom\", \"pitch\", \"distance-from-center\"]);\n      if (!i && !Cn(e)) return Bn([new ee(\"\", \"zoom expressions not supported\")]);\n      var s = Hn(r);\n      return s || i ? s instanceof ee ? Bn([s]) : s instanceof Kr && !Pn(e) ? Bn([new ee(\"\", '\"interpolate\" expressions cannot be used with this property')]) : zn(s ? new Xn(n ? \"camera\" : \"composite\", t.value, s.labels, s instanceof Kr ? s.interpolation : void 0) : new Zn(n ? \"constant\" : \"source\", t.value)) : Bn([new ee(\"\", '\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.')]);\n    }\n    var Yn = /*#__PURE__*/function () {\n      function Yn(t, e) {\n        _classCallCheck(this, Yn);\n        this._parameters = t, this._specification = e, Wt(this, Fn(this._parameters, this._specification));\n      }\n      _createClass(Yn, null, [{\n        key: \"deserialize\",\n        value: function deserialize(t) {\n          return new Yn(t._parameters, t._specification);\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize(t) {\n          return {\n            _parameters: t._parameters,\n            _specification: t._specification\n          };\n        }\n      }]);\n      return Yn;\n    }();\n    function Hn(t) {\n      var e = null;\n      if (t instanceof Jr) e = Hn(t.result);else if (t instanceof Hr) {\n        var _iterator46 = _createForOfIteratorHelper(t.args),\n          _step46;\n        try {\n          for (_iterator46.s(); !(_step46 = _iterator46.n()).done;) {\n            var _r52 = _step46.value;\n            if (e = Hn(_r52), e) break;\n          }\n        } catch (err) {\n          _iterator46.e(err);\n        } finally {\n          _iterator46.f();\n        }\n      } else (t instanceof Ir || t instanceof Kr) && t.input instanceof He && \"zoom\" === t.input.name && (e = t);\n      return e instanceof ee || t.eachChild(function (t) {\n        var r = Hn(t);\n        r instanceof ee ? e = r : !e && r ? e = new ee(\"\", '\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.') : e && r && e !== r && (e = new ee(\"\", 'Only one zoom-based \"step\" or \"interpolate\" subexpression may be used in an expression.'));\n      }), e;\n    }\n    var Wn = function Wn(t, e, r, n) {\n      _classCallCheck(this, Wn);\n      this.message = (t ? \"\".concat(t, \": \") : \"\") + r, n && (this.identifier = n), null != e && e.__line__ && (this.line = e.__line__);\n    };\n    function Jn(t) {\n      var e = t.key,\n        r = t.value,\n        n = t.valueSpec || {},\n        i = t.objectElementValidators || {},\n        s = t.style,\n        a = t.styleSpec;\n      var o = [];\n      var l = Dn(r);\n      if (\"object\" !== l) return [new Wn(e, r, \"object expected, \".concat(l, \" found\"))];\n      for (var _t48 in r) {\n        var _l6 = _t48.split(\".\")[0],\n          _u6 = n[_l6] || n[\"*\"];\n        var _c3 = void 0;\n        i[_l6] ? _c3 = i[_l6] : n[_l6] ? _c3 = Ci : i[\"*\"] ? _c3 = i[\"*\"] : n[\"*\"] && (_c3 = Ci), _c3 ? o = o.concat(_c3({\n          key: (e ? \"\".concat(e, \".\") : e) + _t48,\n          value: r[_t48],\n          valueSpec: _u6,\n          style: s,\n          styleSpec: a,\n          object: r,\n          objectKey: _t48\n        }, r)) : o.push(new Wn(e, r[_t48], \"unknown property \\\"\".concat(_t48, \"\\\"\")));\n      }\n      for (var _t49 in n) i[_t49] || n[_t49].required && void 0 === n[_t49].default && void 0 === r[_t49] && o.push(new Wn(e, r, \"missing required property \\\"\".concat(_t49, \"\\\"\")));\n      return o;\n    }\n    function Qn(t) {\n      var e = t.value,\n        r = t.valueSpec,\n        n = t.style,\n        i = t.styleSpec,\n        s = t.key,\n        a = t.arrayElementValidator || Ci;\n      if (\"array\" !== Dn(e)) return [new Wn(s, e, \"array expected, \".concat(Dn(e), \" found\"))];\n      if (r.length && e.length !== r.length) return [new Wn(s, e, \"array length \".concat(r.length, \" expected, length \").concat(e.length, \" found\"))];\n      if (r[\"min-length\"] && e.length < r[\"min-length\"]) return [new Wn(s, e, \"array length at least \".concat(r[\"min-length\"], \" expected, length \").concat(e.length, \" found\"))];\n      var o = {\n        type: r.value,\n        values: r.values,\n        minimum: r.minimum,\n        maximum: r.maximum,\n        function: void 0\n      };\n      i.$version < 7 && (o.function = r.function), \"object\" === Dn(r.value) && (o = r.value);\n      var l = [];\n      for (var _t50 = 0; _t50 < e.length; _t50++) l = l.concat(a({\n        array: e,\n        arrayIndex: _t50,\n        value: e[_t50],\n        valueSpec: o,\n        style: n,\n        styleSpec: i,\n        key: \"\".concat(s, \"[\").concat(_t50, \"]\")\n      }));\n      return l;\n    }\n    function ti(t) {\n      var e = t.key,\n        r = t.value,\n        n = t.valueSpec;\n      var i = Dn(r);\n      if (\"number\" === i && r != r && (i = \"NaN\"), \"number\" !== i) return [new Wn(e, r, \"number expected, \".concat(i, \" found\"))];\n      if (\"minimum\" in n) {\n        var _i31 = n.minimum;\n        if (\"array\" === Dn(n.minimum) && (_i31 = n.minimum[t.arrayIndex]), r < _i31) return [new Wn(e, r, \"\".concat(r, \" is less than the minimum value \").concat(_i31))];\n      }\n      if (\"maximum\" in n) {\n        var _i32 = n.maximum;\n        if (\"array\" === Dn(n.maximum) && (_i32 = n.maximum[t.arrayIndex]), r > _i32) return [new Wn(e, r, \"\".concat(r, \" is greater than the maximum value \").concat(_i32))];\n      }\n      return [];\n    }\n    function ei(t) {\n      var e = t.valueSpec,\n        r = Jt(t.value.type);\n      var n,\n        i,\n        s,\n        a = {};\n      var o = \"categorical\" !== r && void 0 === t.value.property,\n        l = !o,\n        u = \"array\" === Dn(t.value.stops) && \"array\" === Dn(t.value.stops[0]) && \"object\" === Dn(t.value.stops[0][0]),\n        c = Jn({\n          key: t.key,\n          value: t.value,\n          valueSpec: t.styleSpec.function,\n          style: t.style,\n          styleSpec: t.styleSpec,\n          objectElementValidators: {\n            stops: function stops(t) {\n              if (\"identity\" === r) return [new Wn(t.key, t.value, 'identity function may not have a \"stops\" property')];\n              var e = [];\n              var n = t.value;\n              return e = e.concat(Qn({\n                key: t.key,\n                value: n,\n                valueSpec: t.valueSpec,\n                style: t.style,\n                styleSpec: t.styleSpec,\n                arrayElementValidator: h\n              })), \"array\" === Dn(n) && 0 === n.length && e.push(new Wn(t.key, n, \"array must have at least one stop\")), e;\n            },\n            default: function _default(t) {\n              return Ci({\n                key: t.key,\n                value: t.value,\n                valueSpec: e,\n                style: t.style,\n                styleSpec: t.styleSpec\n              });\n            }\n          }\n        });\n      return \"identity\" === r && o && c.push(new Wn(t.key, t.value, 'missing required property \"property\"')), \"identity\" === r || t.value.stops || c.push(new Wn(t.key, t.value, 'missing required property \"stops\"')), \"exponential\" === r && t.valueSpec.expression && !Pn(t.valueSpec) && c.push(new Wn(t.key, t.value, \"exponential functions not supported\")), t.styleSpec.$version >= 8 && (l && !En(t.valueSpec) ? c.push(new Wn(t.key, t.value, \"property functions not supported\")) : o && !Cn(t.valueSpec) && c.push(new Wn(t.key, t.value, \"zoom functions not supported\"))), \"categorical\" !== r && !u || void 0 !== t.value.property || c.push(new Wn(t.key, t.value, '\"property\" property is required')), c;\n      function h(t) {\n        var r = [];\n        var n = t.value,\n          o = t.key;\n        if (\"array\" !== Dn(n)) return [new Wn(o, n, \"array expected, \".concat(Dn(n), \" found\"))];\n        if (2 !== n.length) return [new Wn(o, n, \"array length 2 expected, length \".concat(n.length, \" found\"))];\n        if (u) {\n          if (\"object\" !== Dn(n[0])) return [new Wn(o, n, \"object expected, \".concat(Dn(n[0]), \" found\"))];\n          if (void 0 === n[0].zoom) return [new Wn(o, n, \"object stop key must have zoom\")];\n          if (void 0 === n[0].value) return [new Wn(o, n, \"object stop key must have value\")];\n          var _e49 = Jt(n[0].zoom);\n          if (\"number\" != typeof _e49) return [new Wn(o, n[0].zoom, \"stop zoom values must be numbers\")];\n          if (s && s > _e49) return [new Wn(o, n[0].zoom, \"stop zoom values must appear in ascending order\")];\n          _e49 !== s && (s = _e49, i = void 0, a = {}), r = r.concat(Jn({\n            key: \"\".concat(o, \"[0]\"),\n            value: n[0],\n            valueSpec: {\n              zoom: {}\n            },\n            style: t.style,\n            styleSpec: t.styleSpec,\n            objectElementValidators: {\n              zoom: ti,\n              value: p\n            }\n          }));\n        } else r = r.concat(p({\n          key: \"\".concat(o, \"[0]\"),\n          value: n[0],\n          valueSpec: {},\n          style: t.style,\n          styleSpec: t.styleSpec\n        }, n));\n        return Nn(Qt(n[1])) ? r.concat([new Wn(\"\".concat(o, \"[1]\"), n[1], \"expressions are not allowed in function stops.\")]) : r.concat(Ci({\n          key: \"\".concat(o, \"[1]\"),\n          value: n[1],\n          valueSpec: e,\n          style: t.style,\n          styleSpec: t.styleSpec\n        }));\n      }\n      function p(t, s) {\n        var o = Dn(t.value),\n          l = Jt(t.value),\n          u = null !== t.value ? t.value : s;\n        if (n) {\n          if (o !== n) return [new Wn(t.key, u, \"\".concat(o, \" stop domain type must match previous stop domain type \").concat(n))];\n        } else n = o;\n        if (\"number\" !== o && \"string\" !== o && \"boolean\" !== o && \"number\" != typeof l && \"string\" != typeof l && \"boolean\" != typeof l) return [new Wn(t.key, u, \"stop domain value must be a number, string, or boolean\")];\n        if (\"number\" !== o && \"categorical\" !== r) {\n          var _n32 = \"number expected, \".concat(o, \" found\");\n          return En(e) && void 0 === r && (_n32 += '\\nIf you intended to use a categorical function, specify `\"type\": \"categorical\"`.'), [new Wn(t.key, u, _n32)];\n        }\n        return \"categorical\" !== r || \"number\" !== o || \"number\" == typeof l && isFinite(l) && Math.floor(l) === l ? \"categorical\" !== r && \"number\" === o && \"number\" == typeof l && \"number\" == typeof i && void 0 !== i && l < i ? [new Wn(t.key, u, \"stop domain values must appear in ascending order\")] : (i = l, \"categorical\" === r && l in a ? [new Wn(t.key, u, \"stop domain values must be unique\")] : (a[l] = !0, [])) : [new Wn(t.key, u, \"integer expected, found \".concat(String(l)))];\n      }\n    }\n    function ri(t) {\n      var e = (\"property\" === t.expressionContext ? Kn : Gn)(Qt(t.value), t.valueSpec);\n      if (\"error\" === e.result) return e.value.map(function (e) {\n        return new Wn(\"\".concat(t.key).concat(e.key), t.value, e.message);\n      });\n      var r = e.value.expression || e.value._styleExpression.expression;\n      if (\"property\" === t.expressionContext && \"text-font\" === t.propertyKey && !r.outputDefined()) return [new Wn(t.key, t.value, \"Invalid data expression for \\\"\".concat(t.propertyKey, \"\\\". Output values must be contained as literals within the expression.\"))];\n      if (\"property\" === t.expressionContext && \"layout\" === t.propertyType && !gr(r)) return [new Wn(t.key, t.value, '\"feature-state\" data expressions are not supported with layout properties.')];\n      if (\"filter\" === t.expressionContext) return ni(r, t);\n      if (t.expressionContext && 0 === t.expressionContext.indexOf(\"cluster\")) {\n        if (!xr(r, [\"zoom\", \"feature-state\"])) return [new Wn(t.key, t.value, '\"zoom\" and \"feature-state\" expressions are not supported with cluster properties.')];\n        if (\"cluster-initial\" === t.expressionContext && !mr(r)) return [new Wn(t.key, t.value, \"Feature data expressions are not supported with initial expression part of cluster properties.\")];\n      }\n      return [];\n    }\n    function ni(t, e) {\n      var r = new Set([\"zoom\", \"feature-state\", \"pitch\", \"distance-from-center\"]);\n      if (e.valueSpec && e.valueSpec.expression) {\n        var _iterator47 = _createForOfIteratorHelper(e.valueSpec.expression.parameters),\n          _step47;\n        try {\n          for (_iterator47.s(); !(_step47 = _iterator47.n()).done;) {\n            var _t51 = _step47.value;\n            r.delete(_t51);\n          }\n        } catch (err) {\n          _iterator47.e(err);\n        } finally {\n          _iterator47.f();\n        }\n      }\n      if (0 === r.size) return [];\n      var n = [];\n      return t instanceof He && r.has(t.name) ? [new Wn(e.key, e.value, \"[\\\"\".concat(t.name, \"\\\"] expression is not supported in a filter for a \").concat(e.object.type, \" layer with id: \").concat(e.object.id))] : (t.eachChild(function (t) {\n        n.push.apply(n, _toConsumableArray(ni(t, e)));\n      }), n);\n    }\n    function ii(t) {\n      var e = t.key,\n        r = t.value,\n        n = t.valueSpec,\n        i = [];\n      return Array.isArray(n.values) ? -1 === n.values.indexOf(Jt(r)) && i.push(new Wn(e, r, \"expected one of [\".concat(n.values.join(\", \"), \"], \").concat(JSON.stringify(r), \" found\"))) : -1 === Object.keys(n.values).indexOf(Jt(r)) && i.push(new Wn(e, r, \"expected one of [\".concat(Object.keys(n.values).join(\", \"), \"], \").concat(JSON.stringify(r), \" found\"))), i;\n    }\n    function si(t) {\n      if (!0 === t || !1 === t) return !0;\n      if (!Array.isArray(t) || 0 === t.length) return !1;\n      switch (t[0]) {\n        case \"has\":\n          return t.length >= 2 && \"$id\" !== t[1] && \"$type\" !== t[1];\n        case \"in\":\n          return t.length >= 3 && (\"string\" != typeof t[1] || Array.isArray(t[2]));\n        case \"!in\":\n        case \"!has\":\n        case \"none\":\n          return !1;\n        case \"==\":\n        case \"!=\":\n        case \">\":\n        case \">=\":\n        case \"<\":\n        case \"<=\":\n          return 3 !== t.length || Array.isArray(t[1]) || Array.isArray(t[2]);\n        case \"any\":\n        case \"all\":\n          var _iterator48 = _createForOfIteratorHelper(t.slice(1)),\n            _step48;\n          try {\n            for (_iterator48.s(); !(_step48 = _iterator48.n()).done;) {\n              var _e50 = _step48.value;\n              if (!si(_e50) && \"boolean\" != typeof _e50) return !1;\n            }\n          } catch (err) {\n            _iterator48.e(err);\n          } finally {\n            _iterator48.f();\n          }\n          return !0;\n        default:\n          return !0;\n      }\n    }\n    function ai(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"fill\";\n      if (null == t) return {\n        filter: function filter() {\n          return !0;\n        },\n        needGeometry: !1,\n        needFeature: !1\n      };\n      si(t) || (t = fi(t));\n      var r = t;\n      var n = !0;\n      try {\n        n = function (t) {\n          if (!ui(t)) return t;\n          var e = Qt(t);\n          return li(e), e = oi(e), e;\n        }(r);\n      } catch (t) {\n        console.warn(\"Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\\nand paste the contents of this message in the report.\\nThank you!\\nFilter Expression:\\n\".concat(JSON.stringify(r, null, 2), \"\\n        \"));\n      }\n      var i = Ht[\"filter_\".concat(e)],\n        s = Gn(n, i);\n      var a = null;\n      if (\"error\" === s.result) throw new Error(s.value.map(function (t) {\n        return \"\".concat(t.key, \": \").concat(t.message);\n      }).join(\", \"));\n      a = function a(t, e, r) {\n        return s.value.evaluate(t, e, {}, r);\n      };\n      var o = null,\n        l = null;\n      if (n !== r) {\n        var _t52 = Gn(r, i);\n        if (\"error\" === _t52.result) throw new Error(_t52.value.map(function (t) {\n          return \"\".concat(t.key, \": \").concat(t.message);\n        }).join(\", \"));\n        o = function o(e, r, n, i, s) {\n          return _t52.value.evaluate(e, r, {}, n, void 0, void 0, i, s);\n        }, l = !mr(_t52.value.expression);\n      }\n      return {\n        filter: a,\n        dynamicFilter: o || void 0,\n        needGeometry: pi(n),\n        needFeature: !!l\n      };\n    }\n    function oi(t) {\n      if (!Array.isArray(t)) return t;\n      var e = function (t) {\n        if (ci.has(t[0])) for (var _e51 = 1; _e51 < t.length; _e51++) if (ui(t[_e51])) return !0;\n        return t;\n      }(t);\n      return !0 === e ? e : e.map(function (t) {\n        return oi(t);\n      });\n    }\n    function li(t) {\n      var e = !1;\n      var r = [];\n      if (\"case\" === t[0]) {\n        for (var _n33 = 1; _n33 < t.length - 1; _n33 += 2) e = e || ui(t[_n33]), r.push(t[_n33 + 1]);\n        r.push(t[t.length - 1]);\n      } else if (\"match\" === t[0]) {\n        e = e || ui(t[1]);\n        for (var _e52 = 2; _e52 < t.length - 1; _e52 += 2) r.push(t[_e52 + 1]);\n        r.push(t[t.length - 1]);\n      } else if (\"step\" === t[0]) {\n        e = e || ui(t[1]);\n        for (var _e53 = 1; _e53 < t.length - 1; _e53 += 2) r.push(t[_e53 + 1]);\n      }\n      e && (t.length = 0, t.push.apply(t, [\"any\"].concat(r)));\n      for (var _e54 = 1; _e54 < t.length; _e54++) li(t[_e54]);\n    }\n    function ui(t) {\n      if (!Array.isArray(t)) return !1;\n      if (\"pitch\" === (e = t[0]) || \"distance-from-center\" === e) return !0;\n      var e;\n      for (var _e55 = 1; _e55 < t.length; _e55++) if (ui(t[_e55])) return !0;\n      return !1;\n    }\n    var ci = new Set([\"in\", \"==\", \"!=\", \">\", \">=\", \"<\", \"<=\", \"to-boolean\"]);\n    function hi(t, e) {\n      return t < e ? -1 : t > e ? 1 : 0;\n    }\n    function pi(t) {\n      if (!Array.isArray(t)) return !1;\n      if (\"within\" === t[0]) return !0;\n      for (var _e56 = 1; _e56 < t.length; _e56++) if (pi(t[_e56])) return !0;\n      return !1;\n    }\n    function fi(t) {\n      if (!t) return !0;\n      var e = t[0];\n      return t.length <= 1 ? \"any\" !== e : \"==\" === e ? di(t[1], t[2], \"==\") : \"!=\" === e ? gi(di(t[1], t[2], \"==\")) : \"<\" === e || \">\" === e || \"<=\" === e || \">=\" === e ? di(t[1], t[2], e) : \"any\" === e ? (r = t.slice(1), [\"any\"].concat(r.map(fi))) : \"all\" === e ? [\"all\"].concat(t.slice(1).map(fi)) : \"none\" === e ? [\"all\"].concat(t.slice(1).map(fi).map(gi)) : \"in\" === e ? yi(t[1], t.slice(2)) : \"!in\" === e ? gi(yi(t[1], t.slice(2))) : \"has\" === e ? mi(t[1]) : \"!has\" === e ? gi(mi(t[1])) : \"within\" !== e || t;\n      var r;\n    }\n    function di(t, e, r) {\n      switch (t) {\n        case \"$type\":\n          return [\"filter-type-\".concat(r), e];\n        case \"$id\":\n          return [\"filter-id-\".concat(r), e];\n        default:\n          return [\"filter-\".concat(r), t, e];\n      }\n    }\n    function yi(t, e) {\n      if (0 === e.length) return !1;\n      switch (t) {\n        case \"$type\":\n          return [\"filter-type-in\", [\"literal\", e]];\n        case \"$id\":\n          return [\"filter-id-in\", [\"literal\", e]];\n        default:\n          return e.length > 200 && !e.some(function (t) {\n            return typeof t != typeof e[0];\n          }) ? [\"filter-in-large\", t, [\"literal\", e.sort(hi)]] : [\"filter-in-small\", t, [\"literal\", e]];\n      }\n    }\n    function mi(t) {\n      switch (t) {\n        case \"$type\":\n          return !0;\n        case \"$id\":\n          return [\"filter-has-id\"];\n        default:\n          return [\"filter-has\", t];\n      }\n    }\n    function gi(t) {\n      return [\"!\", t];\n    }\n    function xi(t) {\n      return si(Qt(t.value)) ? ri(Wt({}, t, {\n        expressionContext: \"filter\",\n        valueSpec: t.styleSpec[\"filter_\".concat(t.layerType || \"fill\")]\n      })) : vi(t);\n    }\n    function vi(t) {\n      var e = t.value,\n        r = t.key;\n      if (\"array\" !== Dn(e)) return [new Wn(r, e, \"array expected, \".concat(Dn(e), \" found\"))];\n      var n = t.styleSpec;\n      var i,\n        s = [];\n      if (e.length < 1) return [new Wn(r, e, \"filter array must have at least 1 element\")];\n      switch (s = s.concat(ii({\n        key: \"\".concat(r, \"[0]\"),\n        value: e[0],\n        valueSpec: n.filter_operator,\n        style: t.style,\n        styleSpec: t.styleSpec\n      })), Jt(e[0])) {\n        case \"<\":\n        case \"<=\":\n        case \">\":\n        case \">=\":\n          e.length >= 2 && \"$type\" === Jt(e[1]) && s.push(new Wn(r, e, \"\\\"$type\\\" cannot be use with operator \\\"\".concat(e[0], \"\\\"\")));\n        case \"==\":\n        case \"!=\":\n          3 !== e.length && s.push(new Wn(r, e, \"filter array for operator \\\"\".concat(e[0], \"\\\" must have 3 elements\")));\n        case \"in\":\n        case \"!in\":\n          e.length >= 2 && (i = Dn(e[1]), \"string\" !== i && s.push(new Wn(\"\".concat(r, \"[1]\"), e[1], \"string expected, \".concat(i, \" found\"))));\n          for (var _a17 = 2; _a17 < e.length; _a17++) i = Dn(e[_a17]), \"$type\" === Jt(e[1]) ? s = s.concat(ii({\n            key: \"\".concat(r, \"[\").concat(_a17, \"]\"),\n            value: e[_a17],\n            valueSpec: n.geometry_type,\n            style: t.style,\n            styleSpec: t.styleSpec\n          })) : \"string\" !== i && \"number\" !== i && \"boolean\" !== i && s.push(new Wn(\"\".concat(r, \"[\").concat(_a17, \"]\"), e[_a17], \"string, number, or boolean expected, \".concat(i, \" found\")));\n          break;\n        case \"any\":\n        case \"all\":\n        case \"none\":\n          for (var _n34 = 1; _n34 < e.length; _n34++) s = s.concat(vi({\n            key: \"\".concat(r, \"[\").concat(_n34, \"]\"),\n            value: e[_n34],\n            style: t.style,\n            styleSpec: t.styleSpec\n          }));\n          break;\n        case \"has\":\n        case \"!has\":\n          i = Dn(e[1]), 2 !== e.length ? s.push(new Wn(r, e, \"filter array for \\\"\".concat(e[0], \"\\\" operator must have 2 elements\"))) : \"string\" !== i && s.push(new Wn(\"\".concat(r, \"[1]\"), e[1], \"string expected, \".concat(i, \" found\")));\n          break;\n        case \"within\":\n          i = Dn(e[1]), 2 !== e.length ? s.push(new Wn(r, e, \"filter array for \\\"\".concat(e[0], \"\\\" operator must have 2 elements\"))) : \"object\" !== i && s.push(new Wn(\"\".concat(r, \"[1]\"), e[1], \"object expected, \".concat(i, \" found\")));\n      }\n      return s;\n    }\n    function bi(t, e) {\n      var r = t.key,\n        n = t.style,\n        i = t.styleSpec,\n        s = t.value,\n        a = t.objectKey,\n        o = i[\"\".concat(e, \"_\").concat(t.layerType)];\n      if (!o) return [];\n      var l = a.match(/^(.*)-transition$/);\n      if (\"paint\" === e && l && o[l[1]] && o[l[1]].transition) return Ci({\n        key: r,\n        value: s,\n        valueSpec: i.transition,\n        style: n,\n        styleSpec: i\n      });\n      var u = t.valueSpec || o[a];\n      if (!u) return [new Wn(r, s, \"unknown property \\\"\".concat(a, \"\\\"\"))];\n      var c;\n      if (\"string\" === Dn(s) && En(u) && !u.tokens && (c = /^{([^}]+)}$/.exec(s))) {\n        var _t53 = \"`{ \\\"type\\\": \\\"identity\\\", \\\"property\\\": \".concat(c ? JSON.stringify(c[1]) : '\"_\"', \" }`\");\n        return [new Wn(r, s, \"\\\"\".concat(a, \"\\\" does not support interpolation syntax\\nUse an identity property function instead: \").concat(_t53, \".\"))];\n      }\n      var h = [];\n      return \"symbol\" === t.layerType && (\"text-field\" === a && n && !n.glyphs && h.push(new Wn(r, s, 'use of \"text-field\" requires a style \"glyphs\" property')), \"text-font\" === a && Vn(Qt(s)) && \"identity\" === Jt(s.type) && h.push(new Wn(r, s, '\"text-font\" does not support identity functions'))), h.concat(Ci({\n        key: t.key,\n        value: s,\n        valueSpec: u,\n        style: n,\n        styleSpec: i,\n        expressionContext: \"property\",\n        propertyType: e,\n        propertyKey: a\n      }));\n    }\n    function wi(t) {\n      return bi(t, \"paint\");\n    }\n    function _i(t) {\n      return bi(t, \"layout\");\n    }\n    function Ai(t) {\n      var e = [];\n      var r = t.value,\n        n = t.key,\n        i = t.style,\n        s = t.styleSpec;\n      r.type || r.ref || e.push(new Wn(n, r, 'either \"type\" or \"ref\" is required'));\n      var a = Jt(r.type);\n      var o = Jt(r.ref);\n      if (r.id) {\n        var _s21 = Jt(r.id);\n        for (var _a18 = 0; _a18 < t.arrayIndex; _a18++) {\n          var _t54 = i.layers[_a18];\n          Jt(_t54.id) === _s21 && e.push(new Wn(n, r.id, \"duplicate layer id \\\"\".concat(r.id, \"\\\", previously used at line \").concat(_t54.id.__line__)));\n        }\n      }\n      if (\"ref\" in r) {\n        var _t55;\n        [\"type\", \"source\", \"source-layer\", \"filter\", \"layout\"].forEach(function (t) {\n          t in r && e.push(new Wn(n, r[t], \"\\\"\".concat(t, \"\\\" is prohibited for ref layers\")));\n        }), i.layers.forEach(function (e) {\n          Jt(e.id) === o && (_t55 = e);\n        }), _t55 ? _t55.ref ? e.push(new Wn(n, r.ref, \"ref cannot reference another ref layer\")) : a = Jt(_t55.type) : \"string\" == typeof o && e.push(new Wn(n, r.ref, \"ref layer \\\"\".concat(o, \"\\\" not found\")));\n      } else if (\"background\" !== a && \"sky\" !== a) if (r.source) {\n        var _t56 = i.sources && i.sources[r.source],\n          _s22 = _t56 && Jt(_t56.type);\n        _t56 ? \"vector\" === _s22 && \"raster\" === a ? e.push(new Wn(n, r.source, \"layer \\\"\".concat(r.id, \"\\\" requires a raster source\"))) : \"raster\" === _s22 && \"raster\" !== a ? e.push(new Wn(n, r.source, \"layer \\\"\".concat(r.id, \"\\\" requires a vector source\"))) : \"vector\" !== _s22 || r[\"source-layer\"] ? \"raster-dem\" === _s22 && \"hillshade\" !== a ? e.push(new Wn(n, r.source, \"raster-dem source can only be used with layer type 'hillshade'.\")) : \"line\" !== a || !r.paint || !r.paint[\"line-gradient\"] && !r.paint[\"line-trim-offset\"] || \"geojson\" === _s22 && _t56.lineMetrics || e.push(new Wn(n, r, \"layer \\\"\".concat(r.id, \"\\\" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.\"))) : e.push(new Wn(n, r, \"layer \\\"\".concat(r.id, \"\\\" must specify a \\\"source-layer\\\"\"))) : e.push(new Wn(n, r.source, \"source \\\"\".concat(r.source, \"\\\" not found\")));\n      } else e.push(new Wn(n, r, 'missing required property \"source\"'));\n      return e = e.concat(Jn({\n        key: n,\n        value: r,\n        valueSpec: s.layer,\n        style: t.style,\n        styleSpec: t.styleSpec,\n        objectElementValidators: {\n          \"*\": function _() {\n            return [];\n          },\n          type: function type() {\n            return Ci({\n              key: \"\".concat(n, \".type\"),\n              value: r.type,\n              valueSpec: s.layer.type,\n              style: t.style,\n              styleSpec: t.styleSpec,\n              object: r,\n              objectKey: \"type\"\n            });\n          },\n          filter: function filter(t) {\n            return xi(Wt({\n              layerType: a\n            }, t));\n          },\n          layout: function layout(t) {\n            return Jn({\n              layer: r,\n              key: t.key,\n              value: t.value,\n              valueSpec: {},\n              style: t.style,\n              styleSpec: t.styleSpec,\n              objectElementValidators: {\n                \"*\": function _(t) {\n                  return _i(Wt({\n                    layerType: a\n                  }, t));\n                }\n              }\n            });\n          },\n          paint: function paint(t) {\n            return Jn({\n              layer: r,\n              key: t.key,\n              value: t.value,\n              valueSpec: {},\n              style: t.style,\n              styleSpec: t.styleSpec,\n              objectElementValidators: {\n                \"*\": function _(t) {\n                  return wi(Wt({\n                    layerType: a\n                  }, t));\n                }\n              }\n            });\n          }\n        }\n      })), e;\n    }\n    function Si(t) {\n      var e = t.value,\n        r = t.key,\n        n = Dn(e);\n      return \"string\" !== n ? [new Wn(r, e, \"string expected, \".concat(n, \" found\"))] : [];\n    }\n    var ki = {\n      promoteId: function promoteId(_ref111) {\n        var t = _ref111.key,\n          e = _ref111.value;\n        if (\"string\" === Dn(e)) return Si({\n          key: t,\n          value: e\n        });\n        {\n          var _r53 = [];\n          for (var _n35 in e) _r53.push.apply(_r53, _toConsumableArray(Si({\n            key: \"\".concat(t, \".\").concat(_n35),\n            value: e[_n35]\n          })));\n          return _r53;\n        }\n      }\n    };\n    function Ii(t) {\n      var e = t.value,\n        r = t.key,\n        n = t.styleSpec,\n        i = t.style;\n      if (!e.type) return [new Wn(r, e, '\"type\" is required')];\n      var s = Jt(e.type);\n      var a;\n      switch (s) {\n        case \"vector\":\n        case \"raster\":\n        case \"raster-dem\":\n          return a = Jn({\n            key: r,\n            value: e,\n            valueSpec: n[\"source_\".concat(s.replace(\"-\", \"_\"))],\n            style: t.style,\n            styleSpec: n,\n            objectElementValidators: ki\n          }), a;\n        case \"geojson\":\n          if (a = Jn({\n            key: r,\n            value: e,\n            valueSpec: n.source_geojson,\n            style: i,\n            styleSpec: n,\n            objectElementValidators: ki\n          }), e.cluster) for (var _t57 in e.clusterProperties) {\n            var _a19, _a20;\n            var _e$clusterProperties$ = _slicedToArray(e.clusterProperties[_t57], 2),\n              _n36 = _e$clusterProperties$[0],\n              _i33 = _e$clusterProperties$[1],\n              _s23 = \"string\" == typeof _n36 ? [_n36, [\"accumulated\"], [\"get\", _t57]] : _n36;\n            (_a19 = a).push.apply(_a19, _toConsumableArray(ri({\n              key: \"\".concat(r, \".\").concat(_t57, \".map\"),\n              value: _i33,\n              expressionContext: \"cluster-map\"\n            }))), (_a20 = a).push.apply(_a20, _toConsumableArray(ri({\n              key: \"\".concat(r, \".\").concat(_t57, \".reduce\"),\n              value: _s23,\n              expressionContext: \"cluster-reduce\"\n            })));\n          }\n          return a;\n        case \"video\":\n          return Jn({\n            key: r,\n            value: e,\n            valueSpec: n.source_video,\n            style: i,\n            styleSpec: n\n          });\n        case \"image\":\n          return Jn({\n            key: r,\n            value: e,\n            valueSpec: n.source_image,\n            style: i,\n            styleSpec: n\n          });\n        case \"canvas\":\n          return [new Wn(r, null, \"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.\", \"source.canvas\")];\n        default:\n          return ii({\n            key: \"\".concat(r, \".type\"),\n            value: e.type,\n            valueSpec: {\n              values: Mi(n)\n            },\n            style: i,\n            styleSpec: n\n          });\n      }\n    }\n    function Mi(t) {\n      return t.source.reduce(function (e, r) {\n        var n = t[r];\n        return \"enum\" === n.type.type && (e = e.concat(Object.keys(n.type.values))), e;\n      }, []);\n    }\n    function Ti(t) {\n      var e = t.value,\n        r = t.styleSpec,\n        n = r.light,\n        i = t.style;\n      var s = [];\n      var a = Dn(e);\n      if (void 0 === e) return s;\n      if (\"object\" !== a) return s = s.concat([new Wn(\"light\", e, \"object expected, \".concat(a, \" found\"))]), s;\n      for (var _t58 in e) {\n        var _a21 = _t58.match(/^(.*)-transition$/);\n        s = s.concat(_a21 && n[_a21[1]] && n[_a21[1]].transition ? Ci({\n          key: _t58,\n          value: e[_t58],\n          valueSpec: r.transition,\n          style: i,\n          styleSpec: r\n        }) : n[_t58] ? Ci({\n          key: _t58,\n          value: e[_t58],\n          valueSpec: n[_t58],\n          style: i,\n          styleSpec: r\n        }) : [new Wn(_t58, e[_t58], \"unknown property \\\"\".concat(_t58, \"\\\"\"))]);\n      }\n      return s;\n    }\n    function zi(t) {\n      var e = t.value,\n        r = t.key,\n        n = t.style,\n        i = t.styleSpec,\n        s = i.terrain;\n      var a = [];\n      var o = Dn(e);\n      if (void 0 === e) return a;\n      if (\"object\" !== o) return a = a.concat([new Wn(\"terrain\", e, \"object expected, \".concat(o, \" found\"))]), a;\n      for (var _t59 in e) {\n        var _r54 = _t59.match(/^(.*)-transition$/);\n        a = a.concat(_r54 && s[_r54[1]] && s[_r54[1]].transition ? Ci({\n          key: _t59,\n          value: e[_t59],\n          valueSpec: i.transition,\n          style: n,\n          styleSpec: i\n        }) : s[_t59] ? Ci({\n          key: _t59,\n          value: e[_t59],\n          valueSpec: s[_t59],\n          style: n,\n          styleSpec: i\n        }) : [new Wn(_t59, e[_t59], \"unknown property \\\"\".concat(_t59, \"\\\"\"))]);\n      }\n      if (e.source) {\n        var _t60 = n.sources && n.sources[e.source],\n          _i34 = _t60 && Jt(_t60.type);\n        _t60 ? \"raster-dem\" !== _i34 && a.push(new Wn(r, e.source, \"terrain cannot be used with a source of type \".concat(String(_i34), \", it only be used with a \\\"raster-dem\\\" source type\"))) : a.push(new Wn(r, e.source, \"source \\\"\".concat(e.source, \"\\\" not found\")));\n      } else a.push(new Wn(r, e, 'terrain is missing required property \"source\"'));\n      return a;\n    }\n    function Bi(t) {\n      var e = t.value,\n        r = t.style,\n        n = t.styleSpec,\n        i = n.fog;\n      var s = [];\n      var a = Dn(e);\n      if (void 0 === e) return s;\n      if (\"object\" !== a) return s = s.concat([new Wn(\"fog\", e, \"object expected, \".concat(a, \" found\"))]), s;\n      for (var _t61 in e) {\n        var _a22 = _t61.match(/^(.*)-transition$/);\n        s = s.concat(_a22 && i[_a22[1]] && i[_a22[1]].transition ? Ci({\n          key: _t61,\n          value: e[_t61],\n          valueSpec: n.transition,\n          style: r,\n          styleSpec: n\n        }) : i[_t61] ? Ci({\n          key: _t61,\n          value: e[_t61],\n          valueSpec: i[_t61],\n          style: r,\n          styleSpec: n\n        }) : [new Wn(_t61, e[_t61], \"unknown property \\\"\".concat(_t61, \"\\\"\"))]);\n      }\n      return s;\n    }\n    var Ei = {\n      \"*\": function _() {\n        return [];\n      },\n      array: Qn,\n      boolean: function boolean(t) {\n        var e = t.value,\n          r = t.key,\n          n = Dn(e);\n        return \"boolean\" !== n ? [new Wn(r, e, \"boolean expected, \".concat(n, \" found\"))] : [];\n      },\n      number: ti,\n      color: function color(t) {\n        var e = t.key,\n          r = t.value,\n          n = Dn(r);\n        return \"string\" !== n ? [new Wn(e, r, \"color expected, \".concat(n, \" found\"))] : null === be(r) ? [new Wn(e, r, \"color expected, \\\"\".concat(r, \"\\\" found\"))] : [];\n      },\n      enum: ii,\n      filter: xi,\n      function: ei,\n      layer: Ai,\n      object: Jn,\n      source: Ii,\n      light: Ti,\n      terrain: zi,\n      fog: Bi,\n      string: Si,\n      formatted: function formatted(t) {\n        return 0 === Si(t).length ? [] : ri(t);\n      },\n      resolvedImage: function resolvedImage(t) {\n        return 0 === Si(t).length ? [] : ri(t);\n      },\n      projection: function projection(t) {\n        var e = t.value,\n          r = t.styleSpec,\n          n = r.projection,\n          i = t.style;\n        var s = [];\n        var a = Dn(e);\n        if (\"object\" === a) for (var _t62 in e) s = s.concat(Ci({\n          key: _t62,\n          value: e[_t62],\n          valueSpec: n[_t62],\n          style: i,\n          styleSpec: r\n        }));else \"string\" !== a && (s = s.concat([new Wn(\"projection\", e, \"object or string expected, \".concat(a, \" found\"))]));\n        return s;\n      }\n    };\n    function Ci(t) {\n      var e = t.value,\n        r = t.valueSpec,\n        n = t.styleSpec;\n      return r.expression && Vn(Jt(e)) ? ei(t) : r.expression && Nn(Qt(e)) ? ri(t) : r.type && Ei[r.type] ? Ei[r.type](t) : Jn(Wt({}, t, {\n        valueSpec: r.type ? n[r.type] : r\n      }));\n    }\n    function Pi(t) {\n      var e = t.value,\n        r = t.key,\n        n = Si(t);\n      return n.length || (-1 === e.indexOf(\"{fontstack}\") && n.push(new Wn(r, e, '\"glyphs\" url must include a \"{fontstack}\" token')), -1 === e.indexOf(\"{range}\") && n.push(new Wn(r, e, '\"glyphs\" url must include a \"{range}\" token'))), n;\n    }\n    function Di(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Ht;\n      return Fi(Ci({\n        key: \"\",\n        value: t,\n        valueSpec: e.$root,\n        styleSpec: e,\n        style: t,\n        objectElementValidators: {\n          glyphs: Pi,\n          \"*\": function _() {\n            return [];\n          }\n        }\n      }));\n    }\n    var Vi = function Vi(t) {\n        return Fi(wi(t));\n      },\n      Li = function Li(t) {\n        return Fi(_i(t));\n      };\n    function Fi(t) {\n      return t.slice().sort(function (t, e) {\n        return t.line && e.line ? t.line - e.line : 0;\n      });\n    }\n    function Ri(t, e) {\n      var r = !1;\n      if (e && e.length) {\n        var _iterator49 = _createForOfIteratorHelper(e),\n          _step49;\n        try {\n          for (_iterator49.s(); !(_step49 = _iterator49.n()).done;) {\n            var _n37 = _step49.value;\n            t.fire(new Kt(new Error(_n37.message))), r = !0;\n          }\n        } catch (err) {\n          _iterator49.e(err);\n        } finally {\n          _iterator49.f();\n        }\n      }\n      return r;\n    }\n    var ji = $i;\n    function $i(t, e, r) {\n      var n = this.cells = [];\n      if (t instanceof ArrayBuffer) {\n        this.arrayBuffer = t;\n        var i = new Int32Array(this.arrayBuffer);\n        t = i[0], this.d = (e = i[1]) + 2 * (r = i[2]);\n        for (var s = 0; s < this.d * this.d; s++) {\n          var a = i[3 + s],\n            o = i[3 + s + 1];\n          n.push(a === o ? null : i.subarray(a, o));\n        }\n        var l = i[3 + n.length + 1];\n        this.keys = i.subarray(i[3 + n.length], l), this.bboxes = i.subarray(l), this.insert = this._insertReadonly;\n      } else {\n        this.d = e + 2 * r;\n        for (var u = 0; u < this.d * this.d; u++) n.push([]);\n        this.keys = [], this.bboxes = [];\n      }\n      this.n = e, this.extent = t, this.padding = r, this.scale = e / t, this.uid = 0;\n      var c = r / e * t;\n      this.min = -c, this.max = t + c;\n    }\n    $i.prototype.insert = function (t, e, r, n, i) {\n      this._forEachCell(e, r, n, i, this._insertCell, this.uid++), this.keys.push(t), this.bboxes.push(e), this.bboxes.push(r), this.bboxes.push(n), this.bboxes.push(i);\n    }, $i.prototype._insertReadonly = function () {\n      throw \"Cannot insert into a GridIndex created from an ArrayBuffer.\";\n    }, $i.prototype._insertCell = function (t, e, r, n, i, s) {\n      this.cells[i].push(s);\n    }, $i.prototype.query = function (t, e, r, n, i) {\n      var s = this.min,\n        a = this.max;\n      if (t <= s && e <= s && a <= r && a <= n && !i) return Array.prototype.slice.call(this.keys);\n      var o = [];\n      return this._forEachCell(t, e, r, n, this._queryCell, o, {}, i), o;\n    }, $i.prototype._queryCell = function (t, e, r, n, i, s, a, o) {\n      var l = this.cells[i];\n      if (null !== l) for (var u = this.keys, c = this.bboxes, h = 0; h < l.length; h++) {\n        var p = l[h];\n        if (void 0 === a[p]) {\n          var f = 4 * p;\n          (o ? o(c[f + 0], c[f + 1], c[f + 2], c[f + 3]) : t <= c[f + 2] && e <= c[f + 3] && r >= c[f + 0] && n >= c[f + 1]) ? (a[p] = !0, s.push(u[p])) : a[p] = !1;\n        }\n      }\n    }, $i.prototype._forEachCell = function (t, e, r, n, i, s, a, o) {\n      for (var l = this._convertToCellCoord(t), u = this._convertToCellCoord(e), c = this._convertToCellCoord(r), h = this._convertToCellCoord(n), p = l; p <= c; p++) for (var f = u; f <= h; f++) {\n        var d = this.d * f + p;\n        if ((!o || o(this._convertFromCellCoord(p), this._convertFromCellCoord(f), this._convertFromCellCoord(p + 1), this._convertFromCellCoord(f + 1))) && i.call(this, t, e, r, n, d, s, a, o)) return;\n      }\n    }, $i.prototype._convertFromCellCoord = function (t) {\n      return (t - this.padding) / this.scale;\n    }, $i.prototype._convertToCellCoord = function (t) {\n      return Math.max(0, Math.min(this.d - 1, Math.floor(t * this.scale) + this.padding));\n    }, $i.prototype.toArrayBuffer = function () {\n      if (this.arrayBuffer) return this.arrayBuffer;\n      for (var t = this.cells, e = 3 + this.cells.length + 1 + 1, r = 0, n = 0; n < this.cells.length; n++) r += this.cells[n].length;\n      var i = new Int32Array(e + r + this.keys.length + this.bboxes.length);\n      i[0] = this.extent, i[1] = this.n, i[2] = this.padding;\n      for (var s = e, a = 0; a < t.length; a++) {\n        var o = t[a];\n        i[3 + a] = s, i.set(o, s), s += o.length;\n      }\n      return i[3 + t.length] = s, i.set(this.keys, s), i[3 + t.length + 1] = s += this.keys.length, i.set(this.bboxes, s), s += this.bboxes.length, i.buffer;\n    };\n    var Ui = {};\n    function Oi(t, e) {\n      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      Object.defineProperty(t, \"_classRegistryKey\", {\n        value: e,\n        writeable: !1\n      }), Ui[e] = {\n        klass: t,\n        omit: r.omit || []\n      };\n    }\n    Oi(Object, \"Object\"), ji.serialize = function (t, e) {\n      var r = t.toArrayBuffer();\n      return e && e.push(r), {\n        buffer: r\n      };\n    }, ji.deserialize = function (t) {\n      return new ji(t.buffer);\n    }, Object.defineProperty(ji, \"name\", {\n      value: \"Grid\"\n    }), Oi(ji, \"Grid\"), Oi(Me, \"Color\"), Oi(Error, \"Error\"), Oi(at, \"AJAXError\"), Oi(Ee, \"ResolvedImage\"), Oi(Yn, \"StylePropertyFunction\"), Oi(qn, \"StyleExpression\", {\n      omit: [\"_evaluator\"]\n    }), Oi(Xn, \"ZoomDependentExpression\"), Oi(Zn, \"ZoomConstantExpression\"), Oi(He, \"CompoundExpression\", {\n      omit: [\"_evaluate\"]\n    });\n    for (var _t63 in Tn) Ui[Tn[_t63]._classRegistryKey] || Oi(Tn[_t63], \"Expression\".concat(_t63));\n    function qi(t) {\n      return t && \"undefined\" != typeof ArrayBuffer && (t instanceof ArrayBuffer || t.constructor && \"ArrayBuffer\" === t.constructor.name);\n    }\n    function Ni(t) {\n      return e.ImageBitmap && t instanceof e.ImageBitmap;\n    }\n    function Gi(t, r) {\n      if (null == t || \"boolean\" == typeof t || \"number\" == typeof t || \"string\" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp) return t;\n      if (qi(t) || Ni(t)) return r && r.push(t), t;\n      if (ArrayBuffer.isView(t)) {\n        var _e57 = t;\n        return r && r.push(_e57.buffer), _e57;\n      }\n      if (t instanceof e.ImageData) return r && r.push(t.data.buffer), t;\n      if (Array.isArray(t)) {\n        var _e58 = [];\n        var _iterator50 = _createForOfIteratorHelper(t),\n          _step50;\n        try {\n          for (_iterator50.s(); !(_step50 = _iterator50.n()).done;) {\n            var _n38 = _step50.value;\n            _e58.push(Gi(_n38, r));\n          }\n        } catch (err) {\n          _iterator50.e(err);\n        } finally {\n          _iterator50.f();\n        }\n        return _e58;\n      }\n      if (\"object\" == typeof t) {\n        var _e59 = t.constructor,\n          _n39 = _e59._classRegistryKey;\n        if (!_n39) throw new Error(\"can't serialize object of unregistered class \".concat(_n39));\n        var _i35 = _e59.serialize ? _e59.serialize(t, r) : {};\n        if (!_e59.serialize) {\n          for (var _e60 in t) t.hasOwnProperty(_e60) && (Ui[_n39].omit.indexOf(_e60) >= 0 || (_i35[_e60] = Gi(t[_e60], r)));\n          t instanceof Error && (_i35.message = t.message);\n        }\n        if (_i35.$name) throw new Error(\"$name property is reserved for worker serialization logic.\");\n        return \"Object\" !== _n39 && (_i35.$name = _n39), _i35;\n      }\n      throw new Error(\"can't serialize object of type \" + typeof t);\n    }\n    function Zi(t) {\n      if (null == t || \"boolean\" == typeof t || \"number\" == typeof t || \"string\" == typeof t || t instanceof Boolean || t instanceof Number || t instanceof String || t instanceof Date || t instanceof RegExp || qi(t) || Ni(t) || ArrayBuffer.isView(t) || t instanceof e.ImageData) return t;\n      if (Array.isArray(t)) return t.map(Zi);\n      if (\"object\" == typeof t) {\n        var _e61 = t.$name || \"Object\",\n          _r55 = Ui[_e61].klass;\n        if (!_r55) throw new Error(\"can't deserialize unregistered class \".concat(_e61));\n        if (_r55.deserialize) return _r55.deserialize(t);\n        var _n40 = Object.create(_r55.prototype);\n        for (var _i36 = 0, _Object$keys2 = Object.keys(t); _i36 < _Object$keys2.length; _i36++) {\n          var _e62 = _Object$keys2[_i36];\n          \"$name\" !== _e62 && (_n40[_e62] = Zi(t[_e62]));\n        }\n        return _n40;\n      }\n      throw new Error(\"can't deserialize object of type \" + typeof t);\n    }\n    var Xi = function Xi(t) {\n        return t >= 1536 && t <= 1791;\n      },\n      Ki = function Ki(t) {\n        return t >= 1872 && t <= 1919;\n      },\n      Yi = function Yi(t) {\n        return t >= 2208 && t <= 2303;\n      },\n      Hi = function Hi(t) {\n        return t >= 11904 && t <= 12031;\n      },\n      Wi = function Wi(t) {\n        return t >= 12032 && t <= 12255;\n      },\n      Ji = function Ji(t) {\n        return t >= 12272 && t <= 12287;\n      },\n      Qi = function Qi(t) {\n        return t >= 12288 && t <= 12351;\n      },\n      ts = function ts(t) {\n        return t >= 12352 && t <= 12447;\n      },\n      es = function es(t) {\n        return t >= 12448 && t <= 12543;\n      },\n      rs = function rs(t) {\n        return t >= 12544 && t <= 12591;\n      },\n      ns = function ns(t) {\n        return t >= 12704 && t <= 12735;\n      },\n      is = function is(t) {\n        return t >= 12736 && t <= 12783;\n      },\n      ss = function ss(t) {\n        return t >= 12784 && t <= 12799;\n      },\n      as = function as(t) {\n        return t >= 12800 && t <= 13055;\n      },\n      os = function os(t) {\n        return t >= 13056 && t <= 13311;\n      },\n      ls = function ls(t) {\n        return t >= 13312 && t <= 19903;\n      },\n      us = function us(t) {\n        return t >= 19968 && t <= 40959;\n      },\n      cs = function cs(t) {\n        return t >= 40960 && t <= 42127;\n      },\n      hs = function hs(t) {\n        return t >= 42128 && t <= 42191;\n      },\n      ps = function ps(t) {\n        return t >= 44032 && t <= 55215;\n      },\n      fs = function fs(t) {\n        return t >= 63744 && t <= 64255;\n      },\n      ds = function ds(t) {\n        return t >= 64336 && t <= 65023;\n      },\n      ys = function ys(t) {\n        return t >= 65040 && t <= 65055;\n      },\n      ms = function ms(t) {\n        return t >= 65072 && t <= 65103;\n      },\n      gs = function gs(t) {\n        return t >= 65104 && t <= 65135;\n      },\n      xs = function xs(t) {\n        return t >= 65136 && t <= 65279;\n      },\n      vs = function vs(t) {\n        return t >= 65280 && t <= 65519;\n      };\n    function bs(t) {\n      var _iterator51 = _createForOfIteratorHelper(t),\n        _step51;\n      try {\n        for (_iterator51.s(); !(_step51 = _iterator51.n()).done;) {\n          var _e63 = _step51.value;\n          if (As(_e63.charCodeAt(0))) return !0;\n        }\n      } catch (err) {\n        _iterator51.e(err);\n      } finally {\n        _iterator51.f();\n      }\n      return !1;\n    }\n    function ws(t) {\n      var _iterator52 = _createForOfIteratorHelper(t),\n        _step52;\n      try {\n        for (_iterator52.s(); !(_step52 = _iterator52.n()).done;) {\n          var _e64 = _step52.value;\n          if (!_s(_e64.charCodeAt(0))) return !1;\n        }\n      } catch (err) {\n        _iterator52.e(err);\n      } finally {\n        _iterator52.f();\n      }\n      return !0;\n    }\n    function _s(t) {\n      return !(Xi(t) || Ki(t) || Yi(t) || ds(t) || xs(t));\n    }\n    function As(t) {\n      return !(746 !== t && 747 !== t && (t < 4352 || !(ns(t) || rs(t) || ms(t) && !(t >= 65097 && t <= 65103) || fs(t) || os(t) || Hi(t) || is(t) || !(!Qi(t) || t >= 12296 && t <= 12305 || t >= 12308 && t <= 12319 || 12336 === t) || ls(t) || us(t) || as(t) || function (t) {\n        return t >= 12592 && t <= 12687;\n      }(t) || function (t) {\n        return t >= 43360 && t <= 43391;\n      }(t) || function (t) {\n        return t >= 55216 && t <= 55295;\n      }(t) || function (t) {\n        return t >= 4352 && t <= 4607;\n      }(t) || ps(t) || ts(t) || Ji(t) || function (t) {\n        return t >= 12688 && t <= 12703;\n      }(t) || Wi(t) || ss(t) || es(t) && 12540 !== t || !(!vs(t) || 65288 === t || 65289 === t || 65293 === t || t >= 65306 && t <= 65310 || 65339 === t || 65341 === t || 65343 === t || t >= 65371 && t <= 65503 || 65507 === t || t >= 65512 && t <= 65519) || !(!gs(t) || t >= 65112 && t <= 65118 || t >= 65123 && t <= 65126) || function (t) {\n        return t >= 5120 && t <= 5759;\n      }(t) || function (t) {\n        return t >= 6320 && t <= 6399;\n      }(t) || ys(t) || function (t) {\n        return t >= 19904 && t <= 19967;\n      }(t) || cs(t) || hs(t))));\n    }\n    function Ss(t) {\n      return !(As(t) || function (t) {\n        return !!(function (t) {\n          return t >= 128 && t <= 255;\n        }(t) && (167 === t || 169 === t || 174 === t || 177 === t || 188 === t || 189 === t || 190 === t || 215 === t || 247 === t) || function (t) {\n          return t >= 8192 && t <= 8303;\n        }(t) && (8214 === t || 8224 === t || 8225 === t || 8240 === t || 8241 === t || 8251 === t || 8252 === t || 8258 === t || 8263 === t || 8264 === t || 8265 === t || 8273 === t) || function (t) {\n          return t >= 8448 && t <= 8527;\n        }(t) || function (t) {\n          return t >= 8528 && t <= 8591;\n        }(t) || function (t) {\n          return t >= 8960 && t <= 9215;\n        }(t) && (t >= 8960 && t <= 8967 || t >= 8972 && t <= 8991 || t >= 8996 && t <= 9e3 || 9003 === t || t >= 9085 && t <= 9114 || t >= 9150 && t <= 9165 || 9167 === t || t >= 9169 && t <= 9179 || t >= 9186 && t <= 9215) || function (t) {\n          return t >= 9216 && t <= 9279;\n        }(t) && 9251 !== t || function (t) {\n          return t >= 9280 && t <= 9311;\n        }(t) || function (t) {\n          return t >= 9312 && t <= 9471;\n        }(t) || function (t) {\n          return t >= 9632 && t <= 9727;\n        }(t) || function (t) {\n          return t >= 9728 && t <= 9983;\n        }(t) && !(t >= 9754 && t <= 9759) || function (t) {\n          return t >= 11008 && t <= 11263;\n        }(t) && (t >= 11026 && t <= 11055 || t >= 11088 && t <= 11097 || t >= 11192 && t <= 11243) || Qi(t) || es(t) || function (t) {\n          return t >= 57344 && t <= 63743;\n        }(t) || ms(t) || gs(t) || vs(t) || 8734 === t || 8756 === t || 8757 === t || t >= 9984 && t <= 10087 || t >= 10102 && t <= 10131 || 65532 === t || 65533 === t);\n      }(t));\n    }\n    function ks(t) {\n      return t >= 1424 && t <= 2303 || ds(t) || xs(t);\n    }\n    function Is(t, e) {\n      return !(!e && ks(t) || t >= 2304 && t <= 3583 || t >= 3840 && t <= 4255 || function (t) {\n        return t >= 6016 && t <= 6143;\n      }(t));\n    }\n    function Ms(t) {\n      var _iterator53 = _createForOfIteratorHelper(t),\n        _step53;\n      try {\n        for (_iterator53.s(); !(_step53 = _iterator53.n()).done;) {\n          var _e65 = _step53.value;\n          if (ks(_e65.charCodeAt(0))) return !0;\n        }\n      } catch (err) {\n        _iterator53.e(err);\n      } finally {\n        _iterator53.f();\n      }\n      return !1;\n    }\n    var Ts = \"deferred\",\n      zs = \"loading\",\n      Bs = \"loaded\";\n    var Es = null,\n      Cs = \"unavailable\",\n      Ps = null;\n    var Ds = function Ds(t) {\n      t && \"string\" == typeof t && t.indexOf(\"NetworkError\") > -1 && (Cs = \"error\"), Es && Es(t);\n    };\n    function Vs() {\n      Ls.fire(new Xt(\"pluginStateChange\", {\n        pluginStatus: Cs,\n        pluginURL: Ps\n      }));\n    }\n    var Ls = new Yt(),\n      Fs = function Fs() {\n        return Cs;\n      },\n      Rs = function Rs() {\n        if (Cs !== Ts || !Ps) throw new Error(\"rtl-text-plugin cannot be downloaded unless a pluginURL is specified\");\n        Cs = zs, Vs(), Ps && ut({\n          url: Ps\n        }, function (t) {\n          t ? Ds(t) : (Cs = Bs, Vs());\n        });\n      },\n      js = {\n        applyArabicShaping: null,\n        processBidirectionalText: null,\n        processStyledBidirectionalText: null,\n        isLoaded: function isLoaded() {\n          return Cs === Bs || null != js.applyArabicShaping;\n        },\n        isLoading: function isLoading() {\n          return Cs === zs;\n        },\n        setState: function setState(t) {\n          Cs = t.pluginStatus, Ps = t.pluginURL;\n        },\n        isParsed: function isParsed() {\n          return null != js.applyArabicShaping && null != js.processBidirectionalText && null != js.processStyledBidirectionalText;\n        },\n        getPluginURL: function getPluginURL() {\n          return Ps;\n        }\n      };\n    var $s = /*#__PURE__*/function () {\n      function $s(t, e) {\n        _classCallCheck(this, $s);\n        this.zoom = t, e ? (this.now = e.now, this.fadeDuration = e.fadeDuration, this.transition = e.transition, this.pitch = e.pitch) : (this.now = 0, this.fadeDuration = 0, this.transition = {}, this.pitch = 0);\n      }\n      _createClass($s, [{\n        key: \"isSupportedScript\",\n        value: function isSupportedScript(t) {\n          return function (t, e) {\n            var _iterator54 = _createForOfIteratorHelper(t),\n              _step54;\n            try {\n              for (_iterator54.s(); !(_step54 = _iterator54.n()).done;) {\n                var _r56 = _step54.value;\n                if (!Is(_r56.charCodeAt(0), e)) return !1;\n              }\n            } catch (err) {\n              _iterator54.e(err);\n            } finally {\n              _iterator54.f();\n            }\n            return !0;\n          }(t, js.isLoaded());\n        }\n      }]);\n      return $s;\n    }();\n    var Us = /*#__PURE__*/function () {\n      function Us(t, e) {\n        _classCallCheck(this, Us);\n        this.property = t, this.value = e, this.expression = function (t, e) {\n          if (Vn(t)) return new Yn(t, e);\n          if (Nn(t)) {\n            var _r57 = Kn(t, e);\n            if (\"error\" === _r57.result) throw new Error(_r57.value.map(function (t) {\n              return \"\".concat(t.key, \": \").concat(t.message);\n            }).join(\", \"));\n            return _r57.value;\n          }\n          {\n            var _r58 = t;\n            return \"string\" == typeof t && \"color\" === e.type && (_r58 = Me.parse(t)), {\n              kind: \"constant\",\n              evaluate: function evaluate() {\n                return _r58;\n              }\n            };\n          }\n        }(void 0 === e ? t.specification.default : e, t.specification);\n      }\n      _createClass(Us, [{\n        key: \"isDataDriven\",\n        value: function isDataDriven() {\n          return \"source\" === this.expression.kind || \"composite\" === this.expression.kind;\n        }\n      }, {\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e, r) {\n          return this.property.possiblyEvaluate(this, t, e, r);\n        }\n      }]);\n      return Us;\n    }();\n    var Os = /*#__PURE__*/function () {\n      function Os(t) {\n        _classCallCheck(this, Os);\n        this.property = t, this.value = new Us(t, void 0);\n      }\n      _createClass(Os, [{\n        key: \"transitioned\",\n        value: function transitioned(t, e) {\n          return new Ns(this.property, this.value, e, z({}, t.transition, this.transition), t.now);\n        }\n      }, {\n        key: \"untransitioned\",\n        value: function untransitioned() {\n          return new Ns(this.property, this.value, null, {}, 0);\n        }\n      }]);\n      return Os;\n    }();\n    var qs = /*#__PURE__*/function () {\n      function qs(t) {\n        _classCallCheck(this, qs);\n        this._properties = t, this._values = Object.create(t.defaultTransitionablePropertyValues);\n      }\n      _createClass(qs, [{\n        key: \"getValue\",\n        value: function getValue(t) {\n          return j(this._values[t].value.value);\n        }\n      }, {\n        key: \"setValue\",\n        value: function setValue(t, e) {\n          this._values.hasOwnProperty(t) || (this._values[t] = new Os(this._values[t].property)), this._values[t].value = new Us(this._values[t].property, null === e ? void 0 : j(e));\n        }\n      }, {\n        key: \"getTransition\",\n        value: function getTransition(t) {\n          return j(this._values[t].transition);\n        }\n      }, {\n        key: \"setTransition\",\n        value: function setTransition(t, e) {\n          this._values.hasOwnProperty(t) || (this._values[t] = new Os(this._values[t].property)), this._values[t].transition = j(e) || void 0;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = {};\n          for (var _i37 = 0, _Object$keys3 = Object.keys(this._values); _i37 < _Object$keys3.length; _i37++) {\n            var _e66 = _Object$keys3[_i37];\n            var _r59 = this.getValue(_e66);\n            void 0 !== _r59 && (t[_e66] = _r59);\n            var _n41 = this.getTransition(_e66);\n            void 0 !== _n41 && (t[\"\".concat(_e66, \"-transition\")] = _n41);\n          }\n          return t;\n        }\n      }, {\n        key: \"transitioned\",\n        value: function transitioned(t, e) {\n          var r = new Gs(this._properties);\n          for (var _i38 = 0, _Object$keys4 = Object.keys(this._values); _i38 < _Object$keys4.length; _i38++) {\n            var _n42 = _Object$keys4[_i38];\n            r._values[_n42] = this._values[_n42].transitioned(t, e._values[_n42]);\n          }\n          return r;\n        }\n      }, {\n        key: \"untransitioned\",\n        value: function untransitioned() {\n          var t = new Gs(this._properties);\n          for (var _i39 = 0, _Object$keys5 = Object.keys(this._values); _i39 < _Object$keys5.length; _i39++) {\n            var _e67 = _Object$keys5[_i39];\n            t._values[_e67] = this._values[_e67].untransitioned();\n          }\n          return t;\n        }\n      }]);\n      return qs;\n    }();\n    var Ns = /*#__PURE__*/function () {\n      function Ns(t, e, r, n, i) {\n        _classCallCheck(this, Ns);\n        var s = n.delay || 0,\n          a = n.duration || 0;\n        i = i || 0, this.property = t, this.value = e, this.begin = i + s, this.end = this.begin + a, t.specification.transition && (n.delay || n.duration) && (this.prior = r);\n      }\n      _createClass(Ns, [{\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e, r) {\n          var n = t.now || 0,\n            i = this.value.possiblyEvaluate(t, e, r),\n            s = this.prior;\n          if (s) {\n            if (n > this.end) return this.prior = null, i;\n            if (this.value.isDataDriven()) return this.prior = null, i;\n            if (n < this.begin) return s.possiblyEvaluate(t, e, r);\n            {\n              var _a23 = (n - this.begin) / (this.end - this.begin);\n              return this.property.interpolate(s.possiblyEvaluate(t, e, r), i, w(_a23));\n            }\n          }\n          return i;\n        }\n      }]);\n      return Ns;\n    }();\n    var Gs = /*#__PURE__*/function () {\n      function Gs(t) {\n        _classCallCheck(this, Gs);\n        this._properties = t, this._values = Object.create(t.defaultTransitioningPropertyValues);\n      }\n      _createClass(Gs, [{\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e, r) {\n          var n = new Ks(this._properties);\n          for (var _i40 = 0, _Object$keys6 = Object.keys(this._values); _i40 < _Object$keys6.length; _i40++) {\n            var _i41 = _Object$keys6[_i40];\n            n._values[_i41] = this._values[_i41].possiblyEvaluate(t, e, r);\n          }\n          return n;\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          for (var _i42 = 0, _Object$keys7 = Object.keys(this._values); _i42 < _Object$keys7.length; _i42++) {\n            var _t64 = _Object$keys7[_i42];\n            if (this._values[_t64].prior) return !0;\n          }\n          return !1;\n        }\n      }]);\n      return Gs;\n    }();\n    var Zs = /*#__PURE__*/function () {\n      function Zs(t) {\n        _classCallCheck(this, Zs);\n        this._properties = t, this._values = Object.create(t.defaultPropertyValues);\n      }\n      _createClass(Zs, [{\n        key: \"getValue\",\n        value: function getValue(t) {\n          return j(this._values[t].value);\n        }\n      }, {\n        key: \"setValue\",\n        value: function setValue(t, e) {\n          this._values[t] = new Us(this._values[t].property, null === e ? void 0 : j(e));\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = {};\n          for (var _i43 = 0, _Object$keys8 = Object.keys(this._values); _i43 < _Object$keys8.length; _i43++) {\n            var _e68 = _Object$keys8[_i43];\n            var _r60 = this.getValue(_e68);\n            void 0 !== _r60 && (t[_e68] = _r60);\n          }\n          return t;\n        }\n      }, {\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e, r) {\n          var n = new Ks(this._properties);\n          for (var _i44 = 0, _Object$keys9 = Object.keys(this._values); _i44 < _Object$keys9.length; _i44++) {\n            var _i45 = _Object$keys9[_i44];\n            n._values[_i45] = this._values[_i45].possiblyEvaluate(t, e, r);\n          }\n          return n;\n        }\n      }]);\n      return Zs;\n    }();\n    var Xs = /*#__PURE__*/function () {\n      function Xs(t, e, r) {\n        _classCallCheck(this, Xs);\n        this.property = t, this.value = e, this.parameters = r;\n      }\n      _createClass(Xs, [{\n        key: \"isConstant\",\n        value: function isConstant() {\n          return \"constant\" === this.value.kind;\n        }\n      }, {\n        key: \"constantOr\",\n        value: function constantOr(t) {\n          return \"constant\" === this.value.kind ? this.value.value : t;\n        }\n      }, {\n        key: \"evaluate\",\n        value: function evaluate(t, e, r, n) {\n          return this.property.evaluate(this.value, this.parameters, t, e, r, n);\n        }\n      }]);\n      return Xs;\n    }();\n    var Ks = /*#__PURE__*/function () {\n      function Ks(t) {\n        _classCallCheck(this, Ks);\n        this._properties = t, this._values = Object.create(t.defaultPossiblyEvaluatedValues);\n      }\n      _createClass(Ks, [{\n        key: \"get\",\n        value: function get(t) {\n          return this._values[t];\n        }\n      }]);\n      return Ks;\n    }();\n    var Ys = /*#__PURE__*/function () {\n      function Ys(t) {\n        _classCallCheck(this, Ys);\n        this.specification = t;\n      }\n      _createClass(Ys, [{\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e) {\n          return t.expression.evaluate(e);\n        }\n      }, {\n        key: \"interpolate\",\n        value: function interpolate(t, e, r) {\n          var n = Tr[this.specification.type];\n          return n ? n(t, e, r) : t;\n        }\n      }]);\n      return Ys;\n    }();\n    var Hs = /*#__PURE__*/function () {\n      function Hs(t, e) {\n        _classCallCheck(this, Hs);\n        this.specification = t, this.overrides = e;\n      }\n      _createClass(Hs, [{\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e, r, n) {\n          return new Xs(this, \"constant\" === t.expression.kind || \"camera\" === t.expression.kind ? {\n            kind: \"constant\",\n            value: t.expression.evaluate(e, null, {}, r, n)\n          } : t.expression, e);\n        }\n      }, {\n        key: \"interpolate\",\n        value: function interpolate(t, e, r) {\n          if (\"constant\" !== t.value.kind || \"constant\" !== e.value.kind) return t;\n          if (void 0 === t.value.value || void 0 === e.value.value) return new Xs(this, {\n            kind: \"constant\",\n            value: void 0\n          }, t.parameters);\n          var n = Tr[this.specification.type];\n          return n ? new Xs(this, {\n            kind: \"constant\",\n            value: n(t.value.value, e.value.value, r)\n          }, t.parameters) : t;\n        }\n      }, {\n        key: \"evaluate\",\n        value: function evaluate(t, e, r, n, i, s) {\n          return \"constant\" === t.kind ? t.value : t.evaluate(e, r, n, i, s);\n        }\n      }]);\n      return Hs;\n    }();\n    var Ws = /*#__PURE__*/function () {\n      function Ws(t) {\n        _classCallCheck(this, Ws);\n        this.specification = t;\n      }\n      _createClass(Ws, [{\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e, r, n) {\n          return !!t.expression.evaluate(e, null, {}, r, n);\n        }\n      }, {\n        key: \"interpolate\",\n        value: function interpolate() {\n          return !1;\n        }\n      }]);\n      return Ws;\n    }();\n    var Js = function Js(t) {\n      _classCallCheck(this, Js);\n      this.properties = t, this.defaultPropertyValues = {}, this.defaultTransitionablePropertyValues = {}, this.defaultTransitioningPropertyValues = {}, this.defaultPossiblyEvaluatedValues = {}, this.overridableProperties = [];\n      var e = new $s(0, {});\n      for (var _r61 in t) {\n        var _n43 = t[_r61];\n        _n43.specification.overridable && this.overridableProperties.push(_r61);\n        var _i46 = this.defaultPropertyValues[_r61] = new Us(_n43, void 0),\n          _s24 = this.defaultTransitionablePropertyValues[_r61] = new Os(_n43);\n        this.defaultTransitioningPropertyValues[_r61] = _s24.untransitioned(), this.defaultPossiblyEvaluatedValues[_r61] = _i46.possiblyEvaluate(e);\n      }\n    };\n    function Qs(t, e) {\n      return 256 * (t = S(Math.floor(t), 0, 255)) + S(Math.floor(e), 0, 255);\n    }\n    Oi(Hs, \"DataDrivenProperty\"), Oi(Ys, \"DataConstantProperty\"), Oi(Ws, \"ColorRampProperty\");\n    var ta = {\n      Int8: Int8Array,\n      Uint8: Uint8Array,\n      Int16: Int16Array,\n      Uint16: Uint16Array,\n      Int32: Int32Array,\n      Uint32: Uint32Array,\n      Float32: Float32Array\n    };\n    var ea = function ea(t, e) {\n      _classCallCheck(this, ea);\n      this._structArray = t, this._pos1 = e * this.size, this._pos2 = this._pos1 / 2, this._pos4 = this._pos1 / 4, this._pos8 = this._pos1 / 8;\n    };\n    var ra = /*#__PURE__*/function () {\n      function ra() {\n        _classCallCheck(this, ra);\n        this.isTransferred = !1, this.capacity = -1, this.resize(0);\n      }\n      _createClass(ra, [{\n        key: \"_trim\",\n        value: function _trim() {\n          this.length !== this.capacity && (this.capacity = this.length, this.arrayBuffer = this.arrayBuffer.slice(0, this.length * this.bytesPerElement), this._refreshViews());\n        }\n      }, {\n        key: \"clear\",\n        value: function clear() {\n          this.length = 0;\n        }\n      }, {\n        key: \"resize\",\n        value: function resize(t) {\n          this.reserve(t), this.length = t;\n        }\n      }, {\n        key: \"reserve\",\n        value: function reserve(t) {\n          if (t > this.capacity) {\n            this.capacity = Math.max(t, Math.floor(5 * this.capacity), 128), this.arrayBuffer = new ArrayBuffer(this.capacity * this.bytesPerElement);\n            var _e69 = this.uint8;\n            this._refreshViews(), _e69 && this.uint8.set(_e69);\n          }\n        }\n      }, {\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          throw new Error(\"_refreshViews() must be implemented by each concrete StructArray layout\");\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.int8 = this.uint8 = this.int16 = this.uint16 = this.int32 = this.uint32 = this.float32 = null, this.arrayBuffer = null;\n        }\n      }], [{\n        key: \"serialize\",\n        value: function serialize(t, e) {\n          return t._trim(), e && (t.isTransferred = !0, e.push(t.arrayBuffer)), {\n            length: t.length,\n            arrayBuffer: t.arrayBuffer\n          };\n        }\n      }, {\n        key: \"deserialize\",\n        value: function deserialize(t) {\n          var e = Object.create(this.prototype);\n          return e.arrayBuffer = t.arrayBuffer, e.length = t.length, e.capacity = t.arrayBuffer.byteLength / e.bytesPerElement, e._refreshViews(), e;\n        }\n      }]);\n      return ra;\n    }();\n    function na(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var r = 0,\n        n = 0;\n      return {\n        members: t.map(function (t) {\n          var i = ta[t.type].BYTES_PER_ELEMENT,\n            s = r = ia(r, Math.max(e, i)),\n            a = t.components || 1;\n          return n = Math.max(n, i), r += i * a, {\n            name: t.name,\n            type: t.type,\n            components: a,\n            offset: s\n          };\n        }),\n        size: ia(r, Math.max(n, e)),\n        alignment: e\n      };\n    }\n    function ia(t, e) {\n      return Math.ceil(t / e) * e;\n    }\n    var sa = /*#__PURE__*/function (_ra) {\n      _inherits(sa, _ra);\n      function sa() {\n        _classCallCheck(this, sa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(sa).apply(this, arguments));\n      }\n      _createClass(sa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e) {\n          var r = this.length;\n          return this.resize(r + 1), this.emplace(r, t, e);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r) {\n          var n = 2 * t;\n          return this.int16[n + 0] = e, this.int16[n + 1] = r, t;\n        }\n      }]);\n      return sa;\n    }(ra);\n    sa.prototype.bytesPerElement = 4, Oi(sa, \"StructArrayLayout2i4\");\n    var aa = /*#__PURE__*/function (_ra2) {\n      _inherits(aa, _ra2);\n      function aa() {\n        _classCallCheck(this, aa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(aa).apply(this, arguments));\n      }\n      _createClass(aa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r) {\n          var n = this.length;\n          return this.resize(n + 1), this.emplace(n, t, e, r);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n) {\n          var i = 3 * t;\n          return this.int16[i + 0] = e, this.int16[i + 1] = r, this.int16[i + 2] = n, t;\n        }\n      }]);\n      return aa;\n    }(ra);\n    aa.prototype.bytesPerElement = 6, Oi(aa, \"StructArrayLayout3i6\");\n    var oa = /*#__PURE__*/function (_ra3) {\n      _inherits(oa, _ra3);\n      function oa() {\n        _classCallCheck(this, oa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(oa).apply(this, arguments));\n      }\n      _createClass(oa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n) {\n          var i = this.length;\n          return this.resize(i + 1), this.emplace(i, t, e, r, n);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i) {\n          var s = 4 * t;\n          return this.int16[s + 0] = e, this.int16[s + 1] = r, this.int16[s + 2] = n, this.int16[s + 3] = i, t;\n        }\n      }]);\n      return oa;\n    }(ra);\n    oa.prototype.bytesPerElement = 8, Oi(oa, \"StructArrayLayout4i8\");\n    var la = /*#__PURE__*/function (_ra4) {\n      _inherits(la, _ra4);\n      function la() {\n        _classCallCheck(this, la);\n        return _possibleConstructorReturn(this, _getPrototypeOf(la).apply(this, arguments));\n      }\n      _createClass(la, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s, a) {\n          var o = this.length;\n          return this.resize(o + 1), this.emplace(o, t, e, r, n, i, s, a);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a, o) {\n          var l = 6 * t,\n            u = 12 * t,\n            c = 3 * t;\n          return this.int16[l + 0] = e, this.int16[l + 1] = r, this.uint8[u + 4] = n, this.uint8[u + 5] = i, this.uint8[u + 6] = s, this.uint8[u + 7] = a, this.float32[c + 2] = o, t;\n        }\n      }]);\n      return la;\n    }(ra);\n    la.prototype.bytesPerElement = 12, Oi(la, \"StructArrayLayout2i4ub1f12\");\n    var ua = /*#__PURE__*/function (_ra5) {\n      _inherits(ua, _ra5);\n      function ua() {\n        _classCallCheck(this, ua);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ua).apply(this, arguments));\n      }\n      _createClass(ua, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n) {\n          var i = this.length;\n          return this.resize(i + 1), this.emplace(i, t, e, r, n);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i) {\n          var s = 4 * t;\n          return this.float32[s + 0] = e, this.float32[s + 1] = r, this.float32[s + 2] = n, this.float32[s + 3] = i, t;\n        }\n      }]);\n      return ua;\n    }(ra);\n    ua.prototype.bytesPerElement = 16, Oi(ua, \"StructArrayLayout4f16\");\n    var ca = /*#__PURE__*/function (_ra6) {\n      _inherits(ca, _ra6);\n      function ca() {\n        _classCallCheck(this, ca);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ca).apply(this, arguments));\n      }\n      _createClass(ca, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i) {\n          var s = this.length;\n          return this.resize(s + 1), this.emplace(s, t, e, r, n, i);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s) {\n          var a = 6 * t,\n            o = 3 * t;\n          return this.uint16[a + 0] = e, this.uint16[a + 1] = r, this.uint16[a + 2] = n, this.uint16[a + 3] = i, this.float32[o + 2] = s, t;\n        }\n      }]);\n      return ca;\n    }(ra);\n    ca.prototype.bytesPerElement = 12, Oi(ca, \"StructArrayLayout4ui1f12\");\n    var ha = /*#__PURE__*/function (_ra7) {\n      _inherits(ha, _ra7);\n      function ha() {\n        _classCallCheck(this, ha);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ha).apply(this, arguments));\n      }\n      _createClass(ha, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n) {\n          var i = this.length;\n          return this.resize(i + 1), this.emplace(i, t, e, r, n);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i) {\n          var s = 4 * t;\n          return this.uint16[s + 0] = e, this.uint16[s + 1] = r, this.uint16[s + 2] = n, this.uint16[s + 3] = i, t;\n        }\n      }]);\n      return ha;\n    }(ra);\n    ha.prototype.bytesPerElement = 8, Oi(ha, \"StructArrayLayout4ui8\");\n    var pa = /*#__PURE__*/function (_ra8) {\n      _inherits(pa, _ra8);\n      function pa() {\n        _classCallCheck(this, pa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(pa).apply(this, arguments));\n      }\n      _createClass(pa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s) {\n          var a = this.length;\n          return this.resize(a + 1), this.emplace(a, t, e, r, n, i, s);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a) {\n          var o = 6 * t;\n          return this.int16[o + 0] = e, this.int16[o + 1] = r, this.int16[o + 2] = n, this.int16[o + 3] = i, this.int16[o + 4] = s, this.int16[o + 5] = a, t;\n        }\n      }]);\n      return pa;\n    }(ra);\n    pa.prototype.bytesPerElement = 12, Oi(pa, \"StructArrayLayout6i12\");\n    var fa = /*#__PURE__*/function (_ra9) {\n      _inherits(fa, _ra9);\n      function fa() {\n        _classCallCheck(this, fa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(fa).apply(this, arguments));\n      }\n      _createClass(fa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h) {\n          var p = this.length;\n          return this.resize(p + 1), this.emplace(p, t, e, r, n, i, s, a, o, l, u, c, h);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p) {\n          var f = 12 * t;\n          return this.int16[f + 0] = e, this.int16[f + 1] = r, this.int16[f + 2] = n, this.int16[f + 3] = i, this.uint16[f + 4] = s, this.uint16[f + 5] = a, this.uint16[f + 6] = o, this.uint16[f + 7] = l, this.int16[f + 8] = u, this.int16[f + 9] = c, this.int16[f + 10] = h, this.int16[f + 11] = p, t;\n        }\n      }]);\n      return fa;\n    }(ra);\n    fa.prototype.bytesPerElement = 24, Oi(fa, \"StructArrayLayout4i4ui4i24\");\n    var da = /*#__PURE__*/function (_ra10) {\n      _inherits(da, _ra10);\n      function da() {\n        _classCallCheck(this, da);\n        return _possibleConstructorReturn(this, _getPrototypeOf(da).apply(this, arguments));\n      }\n      _createClass(da, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s) {\n          var a = this.length;\n          return this.resize(a + 1), this.emplace(a, t, e, r, n, i, s);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a) {\n          var o = 10 * t,\n            l = 5 * t;\n          return this.int16[o + 0] = e, this.int16[o + 1] = r, this.int16[o + 2] = n, this.float32[l + 2] = i, this.float32[l + 3] = s, this.float32[l + 4] = a, t;\n        }\n      }]);\n      return da;\n    }(ra);\n    da.prototype.bytesPerElement = 20, Oi(da, \"StructArrayLayout3i3f20\");\n    var ya = /*#__PURE__*/function (_ra11) {\n      _inherits(ya, _ra11);\n      function ya() {\n        _classCallCheck(this, ya);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ya).apply(this, arguments));\n      }\n      _createClass(ya, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t) {\n          var e = this.length;\n          return this.resize(e + 1), this.emplace(e, t);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e) {\n          return this.uint32[1 * t + 0] = e, t;\n        }\n      }]);\n      return ya;\n    }(ra);\n    ya.prototype.bytesPerElement = 4, Oi(ya, \"StructArrayLayout1ul4\");\n    var ma = /*#__PURE__*/function (_ra12) {\n      _inherits(ma, _ra12);\n      function ma() {\n        _classCallCheck(this, ma);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ma).apply(this, arguments));\n      }\n      _createClass(ma, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h, p) {\n          var f = this.length;\n          return this.resize(f + 1), this.emplace(f, t, e, r, n, i, s, a, o, l, u, c, h, p);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p, f) {\n          var d = 20 * t,\n            y = 10 * t;\n          return this.int16[d + 0] = e, this.int16[d + 1] = r, this.int16[d + 2] = n, this.int16[d + 3] = i, this.int16[d + 4] = s, this.float32[y + 3] = a, this.float32[y + 4] = o, this.float32[y + 5] = l, this.float32[y + 6] = u, this.int16[d + 14] = c, this.uint32[y + 8] = h, this.uint16[d + 18] = p, this.uint16[d + 19] = f, t;\n        }\n      }]);\n      return ma;\n    }(ra);\n    ma.prototype.bytesPerElement = 40, Oi(ma, \"StructArrayLayout5i4f1i1ul2ui40\");\n    var ga = /*#__PURE__*/function (_ra13) {\n      _inherits(ga, _ra13);\n      function ga() {\n        _classCallCheck(this, ga);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ga).apply(this, arguments));\n      }\n      _createClass(ga, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s, a) {\n          var o = this.length;\n          return this.resize(o + 1), this.emplace(o, t, e, r, n, i, s, a);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a, o) {\n          var l = 8 * t;\n          return this.int16[l + 0] = e, this.int16[l + 1] = r, this.int16[l + 2] = n, this.int16[l + 4] = i, this.int16[l + 5] = s, this.int16[l + 6] = a, this.int16[l + 7] = o, t;\n        }\n      }]);\n      return ga;\n    }(ra);\n    ga.prototype.bytesPerElement = 16, Oi(ga, \"StructArrayLayout3i2i2i16\");\n    var xa = /*#__PURE__*/function (_ra14) {\n      _inherits(xa, _ra14);\n      function xa() {\n        _classCallCheck(this, xa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(xa).apply(this, arguments));\n      }\n      _createClass(xa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i) {\n          var s = this.length;\n          return this.resize(s + 1), this.emplace(s, t, e, r, n, i);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s) {\n          var a = 4 * t,\n            o = 8 * t;\n          return this.float32[a + 0] = e, this.float32[a + 1] = r, this.float32[a + 2] = n, this.int16[o + 6] = i, this.int16[o + 7] = s, t;\n        }\n      }]);\n      return xa;\n    }(ra);\n    xa.prototype.bytesPerElement = 16, Oi(xa, \"StructArrayLayout2f1f2i16\");\n    var va = /*#__PURE__*/function (_ra15) {\n      _inherits(va, _ra15);\n      function va() {\n        _classCallCheck(this, va);\n        return _possibleConstructorReturn(this, _getPrototypeOf(va).apply(this, arguments));\n      }\n      _createClass(va, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n) {\n          var i = this.length;\n          return this.resize(i + 1), this.emplace(i, t, e, r, n);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i) {\n          var s = 12 * t,\n            a = 3 * t;\n          return this.uint8[s + 0] = e, this.uint8[s + 1] = r, this.float32[a + 1] = n, this.float32[a + 2] = i, t;\n        }\n      }]);\n      return va;\n    }(ra);\n    va.prototype.bytesPerElement = 12, Oi(va, \"StructArrayLayout2ub2f12\");\n    var ba = /*#__PURE__*/function (_ra16) {\n      _inherits(ba, _ra16);\n      function ba() {\n        _classCallCheck(this, ba);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ba).apply(this, arguments));\n      }\n      _createClass(ba, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r) {\n          var n = this.length;\n          return this.resize(n + 1), this.emplace(n, t, e, r);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n) {\n          var i = 3 * t;\n          return this.float32[i + 0] = e, this.float32[i + 1] = r, this.float32[i + 2] = n, t;\n        }\n      }]);\n      return ba;\n    }(ra);\n    ba.prototype.bytesPerElement = 12, Oi(ba, \"StructArrayLayout3f12\");\n    var wa = /*#__PURE__*/function (_ra17) {\n      _inherits(wa, _ra17);\n      function wa() {\n        _classCallCheck(this, wa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(wa).apply(this, arguments));\n      }\n      _createClass(wa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r) {\n          var n = this.length;\n          return this.resize(n + 1), this.emplace(n, t, e, r);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n) {\n          var i = 3 * t;\n          return this.uint16[i + 0] = e, this.uint16[i + 1] = r, this.uint16[i + 2] = n, t;\n        }\n      }]);\n      return wa;\n    }(ra);\n    wa.prototype.bytesPerElement = 6, Oi(wa, \"StructArrayLayout3ui6\");\n    var _a = /*#__PURE__*/function (_ra18) {\n      _inherits(_a, _ra18);\n      function _a() {\n        _classCallCheck(this, _a);\n        return _possibleConstructorReturn(this, _getPrototypeOf(_a).apply(this, arguments));\n      }\n      _createClass(_a, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h, p, f, d, y, m, g, x, v, b) {\n          var w = this.length;\n          return this.resize(w + 1), this.emplace(w, t, e, r, n, i, s, a, o, l, u, c, h, p, f, d, y, m, g, x, v, b);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p, f, d, y, m, g, x, v, b, w) {\n          var _ = 30 * t,\n            A = 15 * t,\n            S = 60 * t;\n          return this.int16[_ + 0] = e, this.int16[_ + 1] = r, this.int16[_ + 2] = n, this.float32[A + 2] = i, this.float32[A + 3] = s, this.uint16[_ + 8] = a, this.uint16[_ + 9] = o, this.uint32[A + 5] = l, this.uint32[A + 6] = u, this.uint32[A + 7] = c, this.uint16[_ + 16] = h, this.uint16[_ + 17] = p, this.uint16[_ + 18] = f, this.float32[A + 10] = d, this.float32[A + 11] = y, this.uint8[S + 48] = m, this.uint8[S + 49] = g, this.uint8[S + 50] = x, this.uint32[A + 13] = v, this.int16[_ + 28] = b, this.uint8[S + 58] = w, t;\n        }\n      }]);\n      return _a;\n    }(ra);\n    _a.prototype.bytesPerElement = 60, Oi(_a, \"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60\");\n    var Aa = /*#__PURE__*/function (_ra19) {\n      _inherits(Aa, _ra19);\n      function Aa() {\n        _classCallCheck(this, Aa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Aa).apply(this, arguments));\n      }\n      _createClass(Aa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.int16 = new Int16Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i, s, a, o, l, u, c, h, p, f, d, y, m, g, x, v, b, w, _, A, S, k, I, M, T, z) {\n          var B = this.length;\n          return this.resize(B + 1), this.emplace(B, t, e, r, n, i, s, a, o, l, u, c, h, p, f, d, y, m, g, x, v, b, w, _, A, S, k, I, M, T, z);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s, a, o, l, u, c, h, p, f, d, y, m, g, x, v, b, w, _, A, S, k, I, M, T, z, B) {\n          var E = 38 * t,\n            C = 19 * t;\n          return this.int16[E + 0] = e, this.int16[E + 1] = r, this.int16[E + 2] = n, this.float32[C + 2] = i, this.float32[C + 3] = s, this.int16[E + 8] = a, this.int16[E + 9] = o, this.int16[E + 10] = l, this.int16[E + 11] = u, this.int16[E + 12] = c, this.int16[E + 13] = h, this.uint16[E + 14] = p, this.uint16[E + 15] = f, this.uint16[E + 16] = d, this.uint16[E + 17] = y, this.uint16[E + 18] = m, this.uint16[E + 19] = g, this.uint16[E + 20] = x, this.uint16[E + 21] = v, this.uint16[E + 22] = b, this.uint16[E + 23] = w, this.uint16[E + 24] = _, this.uint16[E + 25] = A, this.uint16[E + 26] = S, this.uint16[E + 27] = k, this.uint16[E + 28] = I, this.uint32[C + 15] = M, this.float32[C + 16] = T, this.float32[C + 17] = z, this.float32[C + 18] = B, t;\n        }\n      }]);\n      return Aa;\n    }(ra);\n    Aa.prototype.bytesPerElement = 76, Oi(Aa, \"StructArrayLayout3i2f6i15ui1ul3f76\");\n    var Sa = /*#__PURE__*/function (_ra20) {\n      _inherits(Sa, _ra20);\n      function Sa() {\n        _classCallCheck(this, Sa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Sa).apply(this, arguments));\n      }\n      _createClass(Sa, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t) {\n          var e = this.length;\n          return this.resize(e + 1), this.emplace(e, t);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e) {\n          return this.float32[1 * t + 0] = e, t;\n        }\n      }]);\n      return Sa;\n    }(ra);\n    Sa.prototype.bytesPerElement = 4, Oi(Sa, \"StructArrayLayout1f4\");\n    var ka = /*#__PURE__*/function (_ra21) {\n      _inherits(ka, _ra21);\n      function ka() {\n        _classCallCheck(this, ka);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ka).apply(this, arguments));\n      }\n      _createClass(ka, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n, i) {\n          var s = this.length;\n          return this.resize(s + 1), this.emplace(s, t, e, r, n, i);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i, s) {\n          var a = 5 * t;\n          return this.float32[a + 0] = e, this.float32[a + 1] = r, this.float32[a + 2] = n, this.float32[a + 3] = i, this.float32[a + 4] = s, t;\n        }\n      }]);\n      return ka;\n    }(ra);\n    ka.prototype.bytesPerElement = 20, Oi(ka, \"StructArrayLayout5f20\");\n    var Ia = /*#__PURE__*/function (_ra22) {\n      _inherits(Ia, _ra22);\n      function Ia() {\n        _classCallCheck(this, Ia);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ia).apply(this, arguments));\n      }\n      _createClass(Ia, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint32 = new Uint32Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e, r, n) {\n          var i = this.length;\n          return this.resize(i + 1), this.emplace(i, t, e, r, n);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r, n, i) {\n          var s = 6 * t;\n          return this.uint32[3 * t + 0] = e, this.uint16[s + 2] = r, this.uint16[s + 3] = n, this.uint16[s + 4] = i, t;\n        }\n      }]);\n      return Ia;\n    }(ra);\n    Ia.prototype.bytesPerElement = 12, Oi(Ia, \"StructArrayLayout1ul3ui12\");\n    var Ma = /*#__PURE__*/function (_ra23) {\n      _inherits(Ma, _ra23);\n      function Ma() {\n        _classCallCheck(this, Ma);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ma).apply(this, arguments));\n      }\n      _createClass(Ma, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e) {\n          var r = this.length;\n          return this.resize(r + 1), this.emplace(r, t, e);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r) {\n          var n = 2 * t;\n          return this.uint16[n + 0] = e, this.uint16[n + 1] = r, t;\n        }\n      }]);\n      return Ma;\n    }(ra);\n    Ma.prototype.bytesPerElement = 4, Oi(Ma, \"StructArrayLayout2ui4\");\n    var Ta = /*#__PURE__*/function (_ra24) {\n      _inherits(Ta, _ra24);\n      function Ta() {\n        _classCallCheck(this, Ta);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ta).apply(this, arguments));\n      }\n      _createClass(Ta, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.uint16 = new Uint16Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t) {\n          var e = this.length;\n          return this.resize(e + 1), this.emplace(e, t);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e) {\n          return this.uint16[1 * t + 0] = e, t;\n        }\n      }]);\n      return Ta;\n    }(ra);\n    Ta.prototype.bytesPerElement = 2, Oi(Ta, \"StructArrayLayout1ui2\");\n    var za = /*#__PURE__*/function (_ra25) {\n      _inherits(za, _ra25);\n      function za() {\n        _classCallCheck(this, za);\n        return _possibleConstructorReturn(this, _getPrototypeOf(za).apply(this, arguments));\n      }\n      _createClass(za, [{\n        key: \"_refreshViews\",\n        value: function _refreshViews() {\n          this.uint8 = new Uint8Array(this.arrayBuffer), this.float32 = new Float32Array(this.arrayBuffer);\n        }\n      }, {\n        key: \"emplaceBack\",\n        value: function emplaceBack(t, e) {\n          var r = this.length;\n          return this.resize(r + 1), this.emplace(r, t, e);\n        }\n      }, {\n        key: \"emplace\",\n        value: function emplace(t, e, r) {\n          var n = 2 * t;\n          return this.float32[n + 0] = e, this.float32[n + 1] = r, t;\n        }\n      }]);\n      return za;\n    }(ra);\n    za.prototype.bytesPerElement = 8, Oi(za, \"StructArrayLayout2f8\");\n    var Ba = /*#__PURE__*/function (_ea) {\n      _inherits(Ba, _ea);\n      function Ba() {\n        _classCallCheck(this, Ba);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ba).apply(this, arguments));\n      }\n      _createClass(Ba, [{\n        key: \"projectedAnchorX\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 0];\n        }\n      }, {\n        key: \"projectedAnchorY\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 1];\n        }\n      }, {\n        key: \"projectedAnchorZ\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 2];\n        }\n      }, {\n        key: \"tileAnchorX\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 3];\n        }\n      }, {\n        key: \"tileAnchorY\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 4];\n        }\n      }, {\n        key: \"x1\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 3];\n        }\n      }, {\n        key: \"y1\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 4];\n        }\n      }, {\n        key: \"x2\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 5];\n        }\n      }, {\n        key: \"y2\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 6];\n        }\n      }, {\n        key: \"padding\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 14];\n        }\n      }, {\n        key: \"featureIndex\",\n        get: function get() {\n          return this._structArray.uint32[this._pos4 + 8];\n        }\n      }, {\n        key: \"sourceLayerIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 18];\n        }\n      }, {\n        key: \"bucketIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 19];\n        }\n      }]);\n      return Ba;\n    }(ea);\n    Ba.prototype.size = 40;\n    var Ea = /*#__PURE__*/function (_ma) {\n      _inherits(Ea, _ma);\n      function Ea() {\n        _classCallCheck(this, Ea);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ea).apply(this, arguments));\n      }\n      _createClass(Ea, [{\n        key: \"get\",\n        value: function get(t) {\n          return new Ba(this, t);\n        }\n      }]);\n      return Ea;\n    }(ma);\n    Oi(Ea, \"CollisionBoxArray\");\n    var Ca = /*#__PURE__*/function (_ea2) {\n      _inherits(Ca, _ea2);\n      function Ca() {\n        _classCallCheck(this, Ca);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ca).apply(this, arguments));\n      }\n      _createClass(Ca, [{\n        key: \"projectedAnchorX\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 0];\n        }\n      }, {\n        key: \"projectedAnchorY\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 1];\n        }\n      }, {\n        key: \"projectedAnchorZ\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 2];\n        }\n      }, {\n        key: \"tileAnchorX\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 2];\n        }\n      }, {\n        key: \"tileAnchorY\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 3];\n        }\n      }, {\n        key: \"glyphStartIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 8];\n        }\n      }, {\n        key: \"numGlyphs\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 9];\n        }\n      }, {\n        key: \"vertexStartIndex\",\n        get: function get() {\n          return this._structArray.uint32[this._pos4 + 5];\n        }\n      }, {\n        key: \"lineStartIndex\",\n        get: function get() {\n          return this._structArray.uint32[this._pos4 + 6];\n        }\n      }, {\n        key: \"lineLength\",\n        get: function get() {\n          return this._structArray.uint32[this._pos4 + 7];\n        }\n      }, {\n        key: \"segment\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 16];\n        }\n      }, {\n        key: \"lowerSize\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 17];\n        }\n      }, {\n        key: \"upperSize\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 18];\n        }\n      }, {\n        key: \"lineOffsetX\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 10];\n        }\n      }, {\n        key: \"lineOffsetY\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 11];\n        }\n      }, {\n        key: \"writingMode\",\n        get: function get() {\n          return this._structArray.uint8[this._pos1 + 48];\n        }\n      }, {\n        key: \"placedOrientation\",\n        get: function get() {\n          return this._structArray.uint8[this._pos1 + 49];\n        },\n        set: function set(t) {\n          this._structArray.uint8[this._pos1 + 49] = t;\n        }\n      }, {\n        key: \"hidden\",\n        get: function get() {\n          return this._structArray.uint8[this._pos1 + 50];\n        },\n        set: function set(t) {\n          this._structArray.uint8[this._pos1 + 50] = t;\n        }\n      }, {\n        key: \"crossTileID\",\n        get: function get() {\n          return this._structArray.uint32[this._pos4 + 13];\n        },\n        set: function set(t) {\n          this._structArray.uint32[this._pos4 + 13] = t;\n        }\n      }, {\n        key: \"associatedIconIndex\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 28];\n        }\n      }, {\n        key: \"flipState\",\n        get: function get() {\n          return this._structArray.uint8[this._pos1 + 58];\n        },\n        set: function set(t) {\n          this._structArray.uint8[this._pos1 + 58] = t;\n        }\n      }]);\n      return Ca;\n    }(ea);\n    Ca.prototype.size = 60;\n    var Pa = /*#__PURE__*/function (_a24) {\n      _inherits(Pa, _a24);\n      function Pa() {\n        _classCallCheck(this, Pa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Pa).apply(this, arguments));\n      }\n      _createClass(Pa, [{\n        key: \"get\",\n        value: function get(t) {\n          return new Ca(this, t);\n        }\n      }]);\n      return Pa;\n    }(_a);\n    Oi(Pa, \"PlacedSymbolArray\");\n    var Da = /*#__PURE__*/function (_ea3) {\n      _inherits(Da, _ea3);\n      function Da() {\n        _classCallCheck(this, Da);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Da).apply(this, arguments));\n      }\n      _createClass(Da, [{\n        key: \"projectedAnchorX\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 0];\n        }\n      }, {\n        key: \"projectedAnchorY\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 1];\n        }\n      }, {\n        key: \"projectedAnchorZ\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 2];\n        }\n      }, {\n        key: \"tileAnchorX\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 2];\n        }\n      }, {\n        key: \"tileAnchorY\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 3];\n        }\n      }, {\n        key: \"rightJustifiedTextSymbolIndex\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 8];\n        }\n      }, {\n        key: \"centerJustifiedTextSymbolIndex\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 9];\n        }\n      }, {\n        key: \"leftJustifiedTextSymbolIndex\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 10];\n        }\n      }, {\n        key: \"verticalPlacedTextSymbolIndex\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 11];\n        }\n      }, {\n        key: \"placedIconSymbolIndex\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 12];\n        }\n      }, {\n        key: \"verticalPlacedIconSymbolIndex\",\n        get: function get() {\n          return this._structArray.int16[this._pos2 + 13];\n        }\n      }, {\n        key: \"key\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 14];\n        }\n      }, {\n        key: \"textBoxStartIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 15];\n        }\n      }, {\n        key: \"textBoxEndIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 16];\n        }\n      }, {\n        key: \"verticalTextBoxStartIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 17];\n        }\n      }, {\n        key: \"verticalTextBoxEndIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 18];\n        }\n      }, {\n        key: \"iconBoxStartIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 19];\n        }\n      }, {\n        key: \"iconBoxEndIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 20];\n        }\n      }, {\n        key: \"verticalIconBoxStartIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 21];\n        }\n      }, {\n        key: \"verticalIconBoxEndIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 22];\n        }\n      }, {\n        key: \"featureIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 23];\n        }\n      }, {\n        key: \"numHorizontalGlyphVertices\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 24];\n        }\n      }, {\n        key: \"numVerticalGlyphVertices\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 25];\n        }\n      }, {\n        key: \"numIconVertices\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 26];\n        }\n      }, {\n        key: \"numVerticalIconVertices\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 27];\n        }\n      }, {\n        key: \"useRuntimeCollisionCircles\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 28];\n        }\n      }, {\n        key: \"crossTileID\",\n        get: function get() {\n          return this._structArray.uint32[this._pos4 + 15];\n        },\n        set: function set(t) {\n          this._structArray.uint32[this._pos4 + 15] = t;\n        }\n      }, {\n        key: \"textOffset0\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 16];\n        }\n      }, {\n        key: \"textOffset1\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 17];\n        }\n      }, {\n        key: \"collisionCircleDiameter\",\n        get: function get() {\n          return this._structArray.float32[this._pos4 + 18];\n        }\n      }]);\n      return Da;\n    }(ea);\n    Da.prototype.size = 76;\n    var Va = /*#__PURE__*/function (_Aa) {\n      _inherits(Va, _Aa);\n      function Va() {\n        _classCallCheck(this, Va);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Va).apply(this, arguments));\n      }\n      _createClass(Va, [{\n        key: \"get\",\n        value: function get(t) {\n          return new Da(this, t);\n        }\n      }]);\n      return Va;\n    }(Aa);\n    Oi(Va, \"SymbolInstanceArray\");\n    var La = /*#__PURE__*/function (_Sa) {\n      _inherits(La, _Sa);\n      function La() {\n        _classCallCheck(this, La);\n        return _possibleConstructorReturn(this, _getPrototypeOf(La).apply(this, arguments));\n      }\n      _createClass(La, [{\n        key: \"getoffsetX\",\n        value: function getoffsetX(t) {\n          return this.float32[1 * t + 0];\n        }\n      }]);\n      return La;\n    }(Sa);\n    Oi(La, \"GlyphOffsetArray\");\n    var Fa = /*#__PURE__*/function (_sa) {\n      _inherits(Fa, _sa);\n      function Fa() {\n        _classCallCheck(this, Fa);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Fa).apply(this, arguments));\n      }\n      _createClass(Fa, [{\n        key: \"getx\",\n        value: function getx(t) {\n          return this.int16[2 * t + 0];\n        }\n      }, {\n        key: \"gety\",\n        value: function gety(t) {\n          return this.int16[2 * t + 1];\n        }\n      }]);\n      return Fa;\n    }(sa);\n    Oi(Fa, \"SymbolLineVertexArray\");\n    var Ra = /*#__PURE__*/function (_ea4) {\n      _inherits(Ra, _ea4);\n      function Ra() {\n        _classCallCheck(this, Ra);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ra).apply(this, arguments));\n      }\n      _createClass(Ra, [{\n        key: \"featureIndex\",\n        get: function get() {\n          return this._structArray.uint32[this._pos4 + 0];\n        }\n      }, {\n        key: \"sourceLayerIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 2];\n        }\n      }, {\n        key: \"bucketIndex\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 3];\n        }\n      }, {\n        key: \"layoutVertexArrayOffset\",\n        get: function get() {\n          return this._structArray.uint16[this._pos2 + 4];\n        }\n      }]);\n      return Ra;\n    }(ea);\n    Ra.prototype.size = 12;\n    var ja = /*#__PURE__*/function (_Ia) {\n      _inherits(ja, _Ia);\n      function ja() {\n        _classCallCheck(this, ja);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ja).apply(this, arguments));\n      }\n      _createClass(ja, [{\n        key: \"get\",\n        value: function get(t) {\n          return new Ra(this, t);\n        }\n      }]);\n      return ja;\n    }(Ia);\n    Oi(ja, \"FeatureIndexArray\");\n    var $a = /*#__PURE__*/function (_Ma) {\n      _inherits($a, _Ma);\n      function $a() {\n        _classCallCheck(this, $a);\n        return _possibleConstructorReturn(this, _getPrototypeOf($a).apply(this, arguments));\n      }\n      _createClass($a, [{\n        key: \"geta_centroid_pos0\",\n        value: function geta_centroid_pos0(t) {\n          return this.uint16[2 * t + 0];\n        }\n      }, {\n        key: \"geta_centroid_pos1\",\n        value: function geta_centroid_pos1(t) {\n          return this.uint16[2 * t + 1];\n        }\n      }]);\n      return $a;\n    }(Ma);\n    Oi($a, \"FillExtrusionCentroidArray\");\n    var Ua = na([{\n        name: \"a_pattern\",\n        components: 4,\n        type: \"Uint16\"\n      }, {\n        name: \"a_pixel_ratio\",\n        components: 1,\n        type: \"Float32\"\n      }]),\n      Oa = na([{\n        name: \"a_dash\",\n        components: 4,\n        type: \"Uint16\"\n      }]);\n    var qa = {},\n      Na = {\n        get exports() {\n          return qa;\n        },\n        set exports(t) {\n          qa = t;\n        }\n      },\n      Ga = {};\n    ({\n      get exports() {\n        return Ga;\n      },\n      set exports(t) {\n        Ga = t;\n      }\n    }).exports = function (t, e) {\n      var r, n, i, s, a, o, l, u;\n      for (n = t.length - (r = 3 & t.length), i = e, a = 3432918353, o = 461845907, u = 0; u < n;) l = 255 & t.charCodeAt(u) | (255 & t.charCodeAt(++u)) << 8 | (255 & t.charCodeAt(++u)) << 16 | (255 & t.charCodeAt(++u)) << 24, ++u, i = 27492 + (65535 & (s = 5 * (65535 & (i = (i ^= l = (65535 & (l = (l = (65535 & l) * a + (((l >>> 16) * a & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295) << 13 | i >>> 19)) + ((5 * (i >>> 16) & 65535) << 16) & 4294967295)) + ((58964 + (s >>> 16) & 65535) << 16);\n      switch (l = 0, r) {\n        case 3:\n          l ^= (255 & t.charCodeAt(u + 2)) << 16;\n        case 2:\n          l ^= (255 & t.charCodeAt(u + 1)) << 8;\n        case 1:\n          i ^= l = (65535 & (l = (l = (65535 & (l ^= 255 & t.charCodeAt(u))) * a + (((l >>> 16) * a & 65535) << 16) & 4294967295) << 15 | l >>> 17)) * o + (((l >>> 16) * o & 65535) << 16) & 4294967295;\n      }\n      return i ^= t.length, i = 2246822507 * (65535 & (i ^= i >>> 16)) + ((2246822507 * (i >>> 16) & 65535) << 16) & 4294967295, i = 3266489909 * (65535 & (i ^= i >>> 13)) + ((3266489909 * (i >>> 16) & 65535) << 16) & 4294967295, (i ^= i >>> 16) >>> 0;\n    };\n    var Za = {};\n    ({\n      get exports() {\n        return Za;\n      },\n      set exports(t) {\n        Za = t;\n      }\n    }).exports = function (t, e) {\n      for (var r, n = t.length, i = e ^ n, s = 0; n >= 4;) r = 1540483477 * (65535 & (r = 255 & t.charCodeAt(s) | (255 & t.charCodeAt(++s)) << 8 | (255 & t.charCodeAt(++s)) << 16 | (255 & t.charCodeAt(++s)) << 24)) + ((1540483477 * (r >>> 16) & 65535) << 16), i = 1540483477 * (65535 & i) + ((1540483477 * (i >>> 16) & 65535) << 16) ^ (r = 1540483477 * (65535 & (r ^= r >>> 24)) + ((1540483477 * (r >>> 16) & 65535) << 16)), n -= 4, ++s;\n      switch (n) {\n        case 3:\n          i ^= (255 & t.charCodeAt(s + 2)) << 16;\n        case 2:\n          i ^= (255 & t.charCodeAt(s + 1)) << 8;\n        case 1:\n          i = 1540483477 * (65535 & (i ^= 255 & t.charCodeAt(s))) + ((1540483477 * (i >>> 16) & 65535) << 16);\n      }\n      return i = 1540483477 * (65535 & (i ^= i >>> 13)) + ((1540483477 * (i >>> 16) & 65535) << 16), (i ^= i >>> 15) >>> 0;\n    };\n    var Xa = Ga,\n      Ka = Za;\n    Na.exports = Xa, qa.murmur3 = Xa, qa.murmur2 = Ka;\n    var Ya = /*#__PURE__*/function () {\n      function Ya() {\n        _classCallCheck(this, Ya);\n        this.ids = [], this.positions = [], this.indexed = !1;\n      }\n      _createClass(Ya, [{\n        key: \"add\",\n        value: function add(t, e, r, n) {\n          this.ids.push(Ha(t)), this.positions.push(e, r, n);\n        }\n      }, {\n        key: \"getPositions\",\n        value: function getPositions(t) {\n          var e = Ha(t);\n          var r = 0,\n            n = this.ids.length - 1;\n          for (; r < n;) {\n            var _t65 = r + n >> 1;\n            this.ids[_t65] >= e ? n = _t65 : r = _t65 + 1;\n          }\n          var i = [];\n          for (; this.ids[r] === e;) i.push({\n            index: this.positions[3 * r],\n            start: this.positions[3 * r + 1],\n            end: this.positions[3 * r + 2]\n          }), r++;\n          return i;\n        }\n      }], [{\n        key: \"serialize\",\n        value: function serialize(t, e) {\n          var r = new Float64Array(t.ids),\n            n = new Uint32Array(t.positions);\n          return Wa(r, n, 0, r.length - 1), e && e.push(r.buffer, n.buffer), {\n            ids: r,\n            positions: n\n          };\n        }\n      }, {\n        key: \"deserialize\",\n        value: function deserialize(t) {\n          var e = new Ya();\n          return e.ids = t.ids, e.positions = t.positions, e.indexed = !0, e;\n        }\n      }]);\n      return Ya;\n    }();\n    function Ha(t) {\n      var e = +t;\n      return !isNaN(e) && Number.MIN_SAFE_INTEGER <= e && e <= Number.MAX_SAFE_INTEGER ? e : qa(String(t));\n    }\n    function Wa(t, e, r, n) {\n      for (; r < n;) {\n        var _i47 = t[r + n >> 1];\n        var _s25 = r - 1,\n          _a25 = n + 1;\n        for (;;) {\n          do {\n            _s25++;\n          } while (t[_s25] < _i47);\n          do {\n            _a25--;\n          } while (t[_a25] > _i47);\n          if (_s25 >= _a25) break;\n          Ja(t, _s25, _a25), Ja(e, 3 * _s25, 3 * _a25), Ja(e, 3 * _s25 + 1, 3 * _a25 + 1), Ja(e, 3 * _s25 + 2, 3 * _a25 + 2);\n        }\n        _a25 - r < n - _a25 ? (Wa(t, e, r, _a25), r = _a25 + 1) : (Wa(t, e, _a25 + 1, n), n = _a25);\n      }\n    }\n    function Ja(t, e, r) {\n      var n = t[e];\n      t[e] = t[r], t[r] = n;\n    }\n    Oi(Ya, \"FeaturePositionMap\");\n    var Qa = /*#__PURE__*/function () {\n      function Qa(t) {\n        _classCallCheck(this, Qa);\n        this.gl = t.gl, this.initialized = !1;\n      }\n      _createClass(Qa, [{\n        key: \"fetchUniformLocation\",\n        value: function fetchUniformLocation(t, e) {\n          return this.location || this.initialized || (this.location = this.gl.getUniformLocation(t, e), this.initialized = !0), !!this.location;\n        }\n      }]);\n      return Qa;\n    }();\n    var to = /*#__PURE__*/function (_Qa) {\n      _inherits(to, _Qa);\n      function to(t) {\n        var _this13;\n        _classCallCheck(this, to);\n        _this13 = _possibleConstructorReturn(this, _getPrototypeOf(to).call(this, t)), _this13.current = 0;\n        return _this13;\n      }\n      _createClass(to, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          this.fetchUniformLocation(t, e) && this.current !== r && (this.current = r, this.gl.uniform1f(this.location, r));\n        }\n      }]);\n      return to;\n    }(Qa);\n    var eo = /*#__PURE__*/function (_Qa2) {\n      _inherits(eo, _Qa2);\n      function eo(t) {\n        var _this14;\n        _classCallCheck(this, eo);\n        _this14 = _possibleConstructorReturn(this, _getPrototypeOf(eo).call(this, t)), _this14.current = [0, 0, 0, 0];\n        return _this14;\n      }\n      _createClass(eo, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          this.fetchUniformLocation(t, e) && (r[0] === this.current[0] && r[1] === this.current[1] && r[2] === this.current[2] && r[3] === this.current[3] || (this.current = r, this.gl.uniform4f(this.location, r[0], r[1], r[2], r[3])));\n        }\n      }]);\n      return eo;\n    }(Qa);\n    var ro = /*#__PURE__*/function (_Qa3) {\n      _inherits(ro, _Qa3);\n      function ro(t) {\n        var _this15;\n        _classCallCheck(this, ro);\n        _this15 = _possibleConstructorReturn(this, _getPrototypeOf(ro).call(this, t)), _this15.current = Me.transparent;\n        return _this15;\n      }\n      _createClass(ro, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          this.fetchUniformLocation(t, e) && (r.r === this.current.r && r.g === this.current.g && r.b === this.current.b && r.a === this.current.a || (this.current = r, this.gl.uniform4f(this.location, r.r, r.g, r.b, r.a)));\n        }\n      }]);\n      return ro;\n    }(Qa);\n    var no = new Float32Array(16),\n      io = new Float32Array(9),\n      so = new Float32Array(4);\n    function ao(t) {\n      return [Qs(255 * t.r, 255 * t.g), Qs(255 * t.b, 255 * t.a)];\n    }\n    var oo = /*#__PURE__*/function () {\n      function oo(t, e, r) {\n        _classCallCheck(this, oo);\n        this.value = t, this.uniformNames = e.map(function (t) {\n          return \"u_\".concat(t);\n        }), this.type = r;\n      }\n      _createClass(oo, [{\n        key: \"setUniform\",\n        value: function setUniform(t, e, r, n, i) {\n          e.set(t, i, n.constantOr(this.value));\n        }\n      }, {\n        key: \"getBinding\",\n        value: function getBinding(t, e) {\n          return \"color\" === this.type ? new ro(t) : new to(t);\n        }\n      }]);\n      return oo;\n    }();\n    var lo = /*#__PURE__*/function () {\n      function lo(t, e) {\n        _classCallCheck(this, lo);\n        this.uniformNames = e.map(function (t) {\n          return \"u_\".concat(t);\n        }), this.pattern = null, this.pixelRatio = 1;\n      }\n      _createClass(lo, [{\n        key: \"setConstantPatternPositions\",\n        value: function setConstantPatternPositions(t) {\n          this.pixelRatio = t.pixelRatio || 1, this.pattern = t.tl.concat(t.br);\n        }\n      }, {\n        key: \"setUniform\",\n        value: function setUniform(t, e, r, n, i) {\n          var s = \"u_pattern\" === i || \"u_dash\" === i ? this.pattern : \"u_pixel_ratio\" === i ? this.pixelRatio : null;\n          s && e.set(t, i, s);\n        }\n      }, {\n        key: \"getBinding\",\n        value: function getBinding(t, e) {\n          return \"u_pattern\" === e || \"u_dash\" === e ? new eo(t) : new to(t);\n        }\n      }]);\n      return lo;\n    }();\n    var uo = /*#__PURE__*/function () {\n      function uo(t, e, r, n) {\n        _classCallCheck(this, uo);\n        this.expression = t, this.type = r, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {\n          return {\n            name: \"a_\".concat(t),\n            type: \"Float32\",\n            components: \"color\" === r ? 2 : 1,\n            offset: 0\n          };\n        }), this.paintVertexArray = new n();\n      }\n      _createClass(uo, [{\n        key: \"populatePaintArray\",\n        value: function populatePaintArray(t, e, r, n, i, s) {\n          var a = this.paintVertexArray.length,\n            o = this.expression.evaluate(new $s(0), e, {}, i, n, s);\n          this.paintVertexArray.resize(t), this._setPaintValue(a, t, o);\n        }\n      }, {\n        key: \"updatePaintArray\",\n        value: function updatePaintArray(t, e, r, n, i) {\n          var s = this.expression.evaluate({\n            zoom: 0\n          }, r, n, void 0, i);\n          this._setPaintValue(t, e, s);\n        }\n      }, {\n        key: \"_setPaintValue\",\n        value: function _setPaintValue(t, e, r) {\n          if (\"color\" === this.type) {\n            var _n44 = ao(r);\n            for (var _r62 = t; _r62 < e; _r62++) this.paintVertexArray.emplace(_r62, _n44[0], _n44[1]);\n          } else {\n            for (var _n45 = t; _n45 < e; _n45++) this.paintVertexArray.emplace(_n45, r);\n            this.maxValue = Math.max(this.maxValue, Math.abs(r));\n          }\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.paintVertexBuffer && this.paintVertexBuffer.destroy();\n        }\n      }]);\n      return uo;\n    }();\n    var co = /*#__PURE__*/function () {\n      function co(t, e, r, n, i, s) {\n        _classCallCheck(this, co);\n        this.expression = t, this.uniformNames = e.map(function (t) {\n          return \"u_\".concat(t, \"_t\");\n        }), this.type = r, this.useIntegerZoom = n, this.zoom = i, this.maxValue = 0, this.paintVertexAttributes = e.map(function (t) {\n          return {\n            name: \"a_\".concat(t),\n            type: \"Float32\",\n            components: \"color\" === r ? 4 : 2,\n            offset: 0\n          };\n        }), this.paintVertexArray = new s();\n      }\n      _createClass(co, [{\n        key: \"populatePaintArray\",\n        value: function populatePaintArray(t, e, r, n, i, s) {\n          var a = this.expression.evaluate(new $s(this.zoom), e, {}, i, n, s),\n            o = this.expression.evaluate(new $s(this.zoom + 1), e, {}, i, n, s),\n            l = this.paintVertexArray.length;\n          this.paintVertexArray.resize(t), this._setPaintValue(l, t, a, o);\n        }\n      }, {\n        key: \"updatePaintArray\",\n        value: function updatePaintArray(t, e, r, n, i) {\n          var s = this.expression.evaluate({\n              zoom: this.zoom\n            }, r, n, void 0, i),\n            a = this.expression.evaluate({\n              zoom: this.zoom + 1\n            }, r, n, void 0, i);\n          this._setPaintValue(t, e, s, a);\n        }\n      }, {\n        key: \"_setPaintValue\",\n        value: function _setPaintValue(t, e, r, n) {\n          if (\"color\" === this.type) {\n            var _i48 = ao(r),\n              _s26 = ao(n);\n            for (var _r63 = t; _r63 < e; _r63++) this.paintVertexArray.emplace(_r63, _i48[0], _i48[1], _s26[0], _s26[1]);\n          } else {\n            for (var _i49 = t; _i49 < e; _i49++) this.paintVertexArray.emplace(_i49, r, n);\n            this.maxValue = Math.max(this.maxValue, Math.abs(r), Math.abs(n));\n          }\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer && this.paintVertexBuffer.buffer ? this.paintVertexBuffer.updateData(this.paintVertexArray) : this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.paintVertexBuffer && this.paintVertexBuffer.destroy();\n        }\n      }, {\n        key: \"setUniform\",\n        value: function setUniform(t, e, r, n, i) {\n          var s = this.useIntegerZoom ? Math.floor(r.zoom) : r.zoom,\n            a = S(this.expression.interpolationFactor(s, this.zoom, this.zoom + 1), 0, 1);\n          e.set(t, i, a);\n        }\n      }, {\n        key: \"getBinding\",\n        value: function getBinding(t, e) {\n          return new to(t);\n        }\n      }]);\n      return co;\n    }();\n    var ho = /*#__PURE__*/function () {\n      function ho(t, e, r, n, i) {\n        _classCallCheck(this, ho);\n        this.expression = t, this.layerId = i, this.paintVertexAttributes = (\"array\" === r ? Oa : Ua).members;\n        for (var _t66 = 0; _t66 < e.length; ++_t66);\n        this.paintVertexArray = new n();\n      }\n      _createClass(ho, [{\n        key: \"populatePaintArray\",\n        value: function populatePaintArray(t, e, r) {\n          var n = this.paintVertexArray.length;\n          this.paintVertexArray.resize(t), this._setPaintValues(n, t, e.patterns && e.patterns[this.layerId], r);\n        }\n      }, {\n        key: \"updatePaintArray\",\n        value: function updatePaintArray(t, e, r, n, i, s) {\n          this._setPaintValues(t, e, r.patterns && r.patterns[this.layerId], s);\n        }\n      }, {\n        key: \"_setPaintValues\",\n        value: function _setPaintValues(t, e, r, n) {\n          if (!n || !r) return;\n          var i = n[r];\n          if (!i) return;\n          var s = i.tl,\n            a = i.br,\n            o = i.pixelRatio;\n          for (var _r64 = t; _r64 < e; _r64++) this.paintVertexArray.emplace(_r64, s[0], s[1], a[0], a[1], o);\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          this.paintVertexArray && this.paintVertexArray.arrayBuffer && (this.paintVertexBuffer = t.createVertexBuffer(this.paintVertexArray, this.paintVertexAttributes, this.expression.isStateDependent));\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.paintVertexBuffer && this.paintVertexBuffer.destroy();\n        }\n      }]);\n      return ho;\n    }();\n    var po = /*#__PURE__*/function () {\n      function po(t, e) {\n        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {\n          return !0;\n        };\n        _classCallCheck(this, po);\n        this.binders = {}, this._buffers = [];\n        var n = [];\n        for (var _i50 in t.paint._values) {\n          if (!r(_i50)) continue;\n          var _s27 = t.paint.get(_i50);\n          if (!(_s27 instanceof Xs && En(_s27.property.specification))) continue;\n          var _a26 = mo(_i50, t.type),\n            _o8 = _s27.value,\n            _l7 = _s27.property.specification.type,\n            _u7 = !!_s27.property.useIntegerZoom,\n            _c4 = \"line-dasharray\" === _i50 || _i50.endsWith(\"pattern\"),\n            _h2 = \"line-dasharray\" === _i50 && \"constant\" !== t.layout.get(\"line-cap\").value.kind;\n          if (\"constant\" !== _o8.kind || _h2) {\n            if (\"source\" === _o8.kind || _h2 || _c4) {\n              var _e70 = vo(_i50, _l7, \"source\");\n              this.binders[_i50] = _c4 ? new ho(_o8, _a26, _l7, _e70, t.id) : new uo(_o8, _a26, _l7, _e70), n.push(\"/a_\".concat(_i50));\n            } else {\n              var _t67 = vo(_i50, _l7, \"composite\");\n              this.binders[_i50] = new co(_o8, _a26, _l7, _u7, e, _t67), n.push(\"/z_\".concat(_i50));\n            }\n          } else this.binders[_i50] = _c4 ? new lo(_o8.value, _a26) : new oo(_o8.value, _a26, _l7), n.push(\"/u_\".concat(_i50));\n        }\n        this.cacheKey = n.sort().join(\"\");\n      }\n      _createClass(po, [{\n        key: \"getMaxValue\",\n        value: function getMaxValue(t) {\n          var e = this.binders[t];\n          return e instanceof uo || e instanceof co ? e.maxValue : 0;\n        }\n      }, {\n        key: \"populatePaintArrays\",\n        value: function populatePaintArrays(t, e, r, n, i, s) {\n          for (var _a27 in this.binders) {\n            var _o9 = this.binders[_a27];\n            (_o9 instanceof uo || _o9 instanceof co || _o9 instanceof ho) && _o9.populatePaintArray(t, e, r, n, i, s);\n          }\n        }\n      }, {\n        key: \"setConstantPatternPositions\",\n        value: function setConstantPatternPositions(t) {\n          for (var _e71 in this.binders) {\n            var _r65 = this.binders[_e71];\n            _r65 instanceof lo && _r65.setConstantPatternPositions(t);\n          }\n        }\n      }, {\n        key: \"updatePaintArrays\",\n        value: function updatePaintArrays(t, e, r, n, i, s) {\n          var a = !1;\n          for (var _o10 in t) {\n            var _l8 = e.getPositions(_o10);\n            var _iterator55 = _createForOfIteratorHelper(_l8),\n              _step55;\n            try {\n              for (_iterator55.s(); !(_step55 = _iterator55.n()).done;) {\n                var _e72 = _step55.value;\n                var _l9 = r.feature(_e72.index);\n                for (var _r66 in this.binders) {\n                  var _u8 = this.binders[_r66];\n                  if ((_u8 instanceof uo || _u8 instanceof co || _u8 instanceof ho) && !0 === _u8.expression.isStateDependent) {\n                    var _c5 = n.paint.get(_r66);\n                    _u8.expression = _c5.value, _u8.updatePaintArray(_e72.start, _e72.end, _l9, t[_o10], i, s), a = !0;\n                  }\n                }\n              }\n            } catch (err) {\n              _iterator55.e(err);\n            } finally {\n              _iterator55.f();\n            }\n          }\n          return a;\n        }\n      }, {\n        key: \"defines\",\n        value: function defines() {\n          var t = [];\n          for (var _e73 in this.binders) {\n            var _r67 = this.binders[_e73];\n            (_r67 instanceof oo || _r67 instanceof lo) && t.push.apply(t, _toConsumableArray(_r67.uniformNames.map(function (t) {\n              return \"#define HAS_UNIFORM_\".concat(t);\n            })));\n          }\n          return t;\n        }\n      }, {\n        key: \"getBinderAttributes\",\n        value: function getBinderAttributes() {\n          var t = [];\n          for (var _e74 in this.binders) {\n            var _r68 = this.binders[_e74];\n            if (_r68 instanceof uo || _r68 instanceof co || _r68 instanceof ho) for (var _e75 = 0; _e75 < _r68.paintVertexAttributes.length; _e75++) t.push(_r68.paintVertexAttributes[_e75].name);\n          }\n          return t;\n        }\n      }, {\n        key: \"getBinderUniforms\",\n        value: function getBinderUniforms() {\n          var t = [];\n          for (var _e76 in this.binders) {\n            var _r69 = this.binders[_e76];\n            if (_r69 instanceof oo || _r69 instanceof lo || _r69 instanceof co) {\n              var _iterator56 = _createForOfIteratorHelper(_r69.uniformNames),\n                _step56;\n              try {\n                for (_iterator56.s(); !(_step56 = _iterator56.n()).done;) {\n                  var _e77 = _step56.value;\n                  t.push(_e77);\n                }\n              } catch (err) {\n                _iterator56.e(err);\n              } finally {\n                _iterator56.f();\n              }\n            }\n          }\n          return t;\n        }\n      }, {\n        key: \"getPaintVertexBuffers\",\n        value: function getPaintVertexBuffers() {\n          return this._buffers;\n        }\n      }, {\n        key: \"getUniforms\",\n        value: function getUniforms(t) {\n          var e = [];\n          for (var _r70 in this.binders) {\n            var _n46 = this.binders[_r70];\n            if (_n46 instanceof oo || _n46 instanceof lo || _n46 instanceof co) {\n              var _iterator57 = _createForOfIteratorHelper(_n46.uniformNames),\n                _step57;\n              try {\n                for (_iterator57.s(); !(_step57 = _iterator57.n()).done;) {\n                  var _i51 = _step57.value;\n                  e.push({\n                    name: _i51,\n                    property: _r70,\n                    binding: _n46.getBinding(t, _i51)\n                  });\n                }\n              } catch (err) {\n                _iterator57.e(err);\n              } finally {\n                _iterator57.f();\n              }\n            }\n          }\n          return e;\n        }\n      }, {\n        key: \"setUniforms\",\n        value: function setUniforms(t, e, r, n, i) {\n          var _iterator58 = _createForOfIteratorHelper(r),\n            _step58;\n          try {\n            for (_iterator58.s(); !(_step58 = _iterator58.n()).done;) {\n              var _step58$value = _step58.value,\n                _e78 = _step58$value.name,\n                _s28 = _step58$value.property,\n                _a28 = _step58$value.binding;\n              this.binders[_s28].setUniform(t, _a28, i, n.get(_s28), _e78);\n            }\n          } catch (err) {\n            _iterator58.e(err);\n          } finally {\n            _iterator58.f();\n          }\n        }\n      }, {\n        key: \"updatePaintBuffers\",\n        value: function updatePaintBuffers() {\n          this._buffers = [];\n          for (var _t68 in this.binders) {\n            var _e79 = this.binders[_t68];\n            (_e79 instanceof uo || _e79 instanceof co || _e79 instanceof ho) && _e79.paintVertexBuffer && this._buffers.push(_e79.paintVertexBuffer);\n          }\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          for (var _e80 in this.binders) {\n            var _r71 = this.binders[_e80];\n            (_r71 instanceof uo || _r71 instanceof co || _r71 instanceof ho) && _r71.upload(t);\n          }\n          this.updatePaintBuffers();\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          for (var _t69 in this.binders) {\n            var _e81 = this.binders[_t69];\n            (_e81 instanceof uo || _e81 instanceof co || _e81 instanceof ho) && _e81.destroy();\n          }\n        }\n      }]);\n      return po;\n    }();\n    var fo = /*#__PURE__*/function () {\n      function fo(t, e) {\n        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {\n          return !0;\n        };\n        _classCallCheck(this, fo);\n        this.programConfigurations = {};\n        var _iterator59 = _createForOfIteratorHelper(t),\n          _step59;\n        try {\n          for (_iterator59.s(); !(_step59 = _iterator59.n()).done;) {\n            var _n47 = _step59.value;\n            this.programConfigurations[_n47.id] = new po(_n47, e, r);\n          }\n        } catch (err) {\n          _iterator59.e(err);\n        } finally {\n          _iterator59.f();\n        }\n        this.needsUpload = !1, this._featureMap = new Ya(), this._bufferOffset = 0;\n      }\n      _createClass(fo, [{\n        key: \"populatePaintArrays\",\n        value: function populatePaintArrays(t, e, r, n, i, s, a) {\n          for (var _r72 in this.programConfigurations) this.programConfigurations[_r72].populatePaintArrays(t, e, n, i, s, a);\n          void 0 !== e.id && this._featureMap.add(e.id, r, this._bufferOffset, t), this._bufferOffset = t, this.needsUpload = !0;\n        }\n      }, {\n        key: \"updatePaintArrays\",\n        value: function updatePaintArrays(t, e, r, n, i) {\n          var _iterator60 = _createForOfIteratorHelper(r),\n            _step60;\n          try {\n            for (_iterator60.s(); !(_step60 = _iterator60.n()).done;) {\n              var _s29 = _step60.value;\n              this.needsUpload = this.programConfigurations[_s29.id].updatePaintArrays(t, this._featureMap, e, _s29, n, i) || this.needsUpload;\n            }\n          } catch (err) {\n            _iterator60.e(err);\n          } finally {\n            _iterator60.f();\n          }\n        }\n      }, {\n        key: \"get\",\n        value: function get(t) {\n          return this.programConfigurations[t];\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          if (this.needsUpload) {\n            for (var _e82 in this.programConfigurations) this.programConfigurations[_e82].upload(t);\n            this.needsUpload = !1;\n          }\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          for (var _t70 in this.programConfigurations) this.programConfigurations[_t70].destroy();\n        }\n      }]);\n      return fo;\n    }();\n    var yo = {\n      \"text-opacity\": [\"opacity\"],\n      \"icon-opacity\": [\"opacity\"],\n      \"text-color\": [\"fill_color\"],\n      \"icon-color\": [\"fill_color\"],\n      \"text-halo-color\": [\"halo_color\"],\n      \"icon-halo-color\": [\"halo_color\"],\n      \"text-halo-blur\": [\"halo_blur\"],\n      \"icon-halo-blur\": [\"halo_blur\"],\n      \"text-halo-width\": [\"halo_width\"],\n      \"icon-halo-width\": [\"halo_width\"],\n      \"line-gap-width\": [\"gapwidth\"],\n      \"line-pattern\": [\"pattern\", \"pixel_ratio\"],\n      \"fill-pattern\": [\"pattern\", \"pixel_ratio\"],\n      \"fill-extrusion-pattern\": [\"pattern\", \"pixel_ratio\"],\n      \"line-dasharray\": [\"dash\"]\n    };\n    function mo(t, e) {\n      return yo[t] || [t.replace(\"\".concat(e, \"-\"), \"\").replace(/-/g, \"_\")];\n    }\n    var go = {\n        \"line-pattern\": {\n          source: ca,\n          composite: ca\n        },\n        \"fill-pattern\": {\n          source: ca,\n          composite: ca\n        },\n        \"fill-extrusion-pattern\": {\n          source: ca,\n          composite: ca\n        },\n        \"line-dasharray\": {\n          source: ha,\n          composite: ha\n        }\n      },\n      xo = {\n        color: {\n          source: za,\n          composite: ua\n        },\n        number: {\n          source: Sa,\n          composite: za\n        }\n      };\n    function vo(t, e, r) {\n      var n = go[t];\n      return n && n[r] || xo[e][r];\n    }\n    Oi(oo, \"ConstantBinder\"), Oi(lo, \"PatternConstantBinder\"), Oi(uo, \"SourceExpressionBinder\"), Oi(ho, \"PatternCompositeBinder\"), Oi(co, \"CompositeExpressionBinder\"), Oi(po, \"ProgramConfiguration\", {\n      omit: [\"_buffers\"]\n    }), Oi(fo, \"ProgramConfigurationSet\");\n    var bo = \"-transition\";\n    var wo = /*#__PURE__*/function (_Yt) {\n      _inherits(wo, _Yt);\n      function wo(t, e) {\n        var _this16;\n        _classCallCheck(this, wo);\n        if (_this16 = _possibleConstructorReturn(this, _getPrototypeOf(wo).call(this)), _this16.id = t.id, _this16.type = t.type, _this16._featureFilter = {\n          filter: function filter() {\n            return !0;\n          },\n          needGeometry: !1,\n          needFeature: !1\n        }, _this16._filterCompiled = !1, \"custom\" !== t.type && (_this16.metadata = t.metadata, _this16.minzoom = t.minzoom, _this16.maxzoom = t.maxzoom, \"background\" !== t.type && \"sky\" !== t.type && (_this16.source = t.source, _this16.sourceLayer = t[\"source-layer\"], _this16.filter = t.filter), e.layout && (_this16._unevaluatedLayout = new Zs(e.layout)), e.paint)) {\n          _this16._transitionablePaint = new qs(e.paint);\n          for (var _e83 in t.paint) _this16.setPaintProperty(_e83, t.paint[_e83], {\n            validate: !1\n          });\n          for (var _e84 in t.layout) _this16.setLayoutProperty(_e84, t.layout[_e84], {\n            validate: !1\n          });\n          _this16._transitioningPaint = _this16._transitionablePaint.untransitioned(), _this16.paint = new Ks(e.paint);\n        }\n        return _possibleConstructorReturn(_this16);\n      }\n      _createClass(wo, [{\n        key: \"getLayoutProperty\",\n        value: function getLayoutProperty(t) {\n          return \"visibility\" === t ? this.visibility : this._unevaluatedLayout.getValue(t);\n        }\n      }, {\n        key: \"setLayoutProperty\",\n        value: function setLayoutProperty(t, e) {\n          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          null != e && this._validate(Li, \"layers.\".concat(this.id, \".layout.\").concat(t), t, e, r) || (\"visibility\" !== t ? this._unevaluatedLayout.setValue(t, e) : this.visibility = e);\n        }\n      }, {\n        key: \"getPaintProperty\",\n        value: function getPaintProperty(t) {\n          return L(t, bo) ? this._transitionablePaint.getTransition(t.slice(0, -bo.length)) : this._transitionablePaint.getValue(t);\n        }\n      }, {\n        key: \"setPaintProperty\",\n        value: function setPaintProperty(t, e) {\n          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (null != e && this._validate(Vi, \"layers.\".concat(this.id, \".paint.\").concat(t), t, e, r)) return !1;\n          if (L(t, bo)) return this._transitionablePaint.setTransition(t.slice(0, -bo.length), e || void 0), !1;\n          {\n            var _r73 = this._transitionablePaint._values[t],\n              _n48 = _r73.value.isDataDriven(),\n              _i52 = _r73.value;\n            this._transitionablePaint.setValue(t, e), this._handleSpecialPaintPropertyUpdate(t);\n            var _s30 = this._transitionablePaint._values[t].value,\n              _a29 = _s30.isDataDriven(),\n              _o11 = L(t, \"pattern\") || \"line-dasharray\" === t;\n            return _a29 || _n48 || _o11 || this._handleOverridablePaintPropertyUpdate(t, _i52, _s30);\n          }\n        }\n      }, {\n        key: \"_handleSpecialPaintPropertyUpdate\",\n        value: function _handleSpecialPaintPropertyUpdate(t) {}\n      }, {\n        key: \"getProgramIds\",\n        value: function getProgramIds() {\n          return null;\n        }\n      }, {\n        key: \"getProgramConfiguration\",\n        value: function getProgramConfiguration(t) {\n          return null;\n        }\n      }, {\n        key: \"_handleOverridablePaintPropertyUpdate\",\n        value: function _handleOverridablePaintPropertyUpdate(t, e, r) {\n          return !1;\n        }\n      }, {\n        key: \"isHidden\",\n        value: function isHidden(t) {\n          return !!(this.minzoom && t < this.minzoom) || !!(this.maxzoom && t >= this.maxzoom) || \"none\" === this.visibility;\n        }\n      }, {\n        key: \"updateTransitions\",\n        value: function updateTransitions(t) {\n          this._transitioningPaint = this._transitionablePaint.transitioned(t, this._transitioningPaint);\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return this._transitioningPaint.hasTransition();\n        }\n      }, {\n        key: \"recalculate\",\n        value: function recalculate(t, e) {\n          this._unevaluatedLayout && (this.layout = this._unevaluatedLayout.possiblyEvaluate(t, void 0, e)), this.paint = this._transitioningPaint.possiblyEvaluate(t, void 0, e);\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = {\n            id: this.id,\n            type: this.type,\n            source: this.source,\n            \"source-layer\": this.sourceLayer,\n            metadata: this.metadata,\n            minzoom: this.minzoom,\n            maxzoom: this.maxzoom,\n            filter: this.filter,\n            layout: this._unevaluatedLayout && this._unevaluatedLayout.serialize(),\n            paint: this._transitionablePaint && this._transitionablePaint.serialize()\n          };\n          return this.visibility && (t.layout = t.layout || {}, t.layout.visibility = this.visibility), R(t, function (t, e) {\n            return !(void 0 === t || \"layout\" === e && !Object.keys(t).length || \"paint\" === e && !Object.keys(t).length);\n          });\n        }\n      }, {\n        key: \"_validate\",\n        value: function _validate(t, e, r, n) {\n          var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n          return (!i || !1 !== i.validate) && Ri(this, t.call(Di, {\n            key: e,\n            layerType: this.type,\n            objectKey: r,\n            value: n,\n            styleSpec: Ht,\n            style: {\n              glyphs: !0,\n              sprite: !0\n            }\n          }));\n        }\n      }, {\n        key: \"is3D\",\n        value: function is3D() {\n          return !1;\n        }\n      }, {\n        key: \"isSky\",\n        value: function isSky() {\n          return !1;\n        }\n      }, {\n        key: \"isTileClipped\",\n        value: function isTileClipped() {\n          return !1;\n        }\n      }, {\n        key: \"hasOffscreenPass\",\n        value: function hasOffscreenPass() {\n          return !1;\n        }\n      }, {\n        key: \"resize\",\n        value: function resize() {}\n      }, {\n        key: \"isStateDependent\",\n        value: function isStateDependent() {\n          for (var _t71 in this.paint._values) {\n            var _e85 = this.paint.get(_t71);\n            if (_e85 instanceof Xs && En(_e85.property.specification) && (\"source\" === _e85.value.kind || \"composite\" === _e85.value.kind) && _e85.value.isStateDependent) return !0;\n          }\n          return !1;\n        }\n      }, {\n        key: \"compileFilter\",\n        value: function compileFilter() {\n          this._filterCompiled || (this._featureFilter = ai(this.filter), this._filterCompiled = !0);\n        }\n      }, {\n        key: \"invalidateCompiledFilter\",\n        value: function invalidateCompiledFilter() {\n          this._filterCompiled = !1;\n        }\n      }, {\n        key: \"dynamicFilter\",\n        value: function dynamicFilter() {\n          return this._featureFilter.dynamicFilter;\n        }\n      }, {\n        key: \"dynamicFilterNeedsFeature\",\n        value: function dynamicFilterNeedsFeature() {\n          return this._featureFilter.needFeature;\n        }\n      }]);\n      return wo;\n    }(Yt);\n    var _o = na([{\n        name: \"a_pos\",\n        components: 2,\n        type: \"Int16\"\n      }], 4),\n      Ao = na([{\n        name: \"a_pos_3\",\n        components: 3,\n        type: \"Int16\"\n      }, {\n        name: \"a_pos_normal_3\",\n        components: 3,\n        type: \"Int16\"\n      }]);\n    var So = /*#__PURE__*/function () {\n      function So() {\n        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n        _classCallCheck(this, So);\n        this.segments = t;\n      }\n      _createClass(So, [{\n        key: \"prepareSegment\",\n        value: function prepareSegment(t, e, r, n) {\n          var i = this.segments[this.segments.length - 1];\n          return t > So.MAX_VERTEX_ARRAY_LENGTH && U(\"Max vertices per segment is \".concat(So.MAX_VERTEX_ARRAY_LENGTH, \": bucket requested \").concat(t)), (!i || i.vertexLength + t > So.MAX_VERTEX_ARRAY_LENGTH || i.sortKey !== n) && (i = {\n            vertexOffset: e.length,\n            primitiveOffset: r.length,\n            vertexLength: 0,\n            primitiveLength: 0\n          }, void 0 !== n && (i.sortKey = n), this.segments.push(i)), i;\n        }\n      }, {\n        key: \"get\",\n        value: function get() {\n          return this.segments;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          var _iterator61 = _createForOfIteratorHelper(this.segments),\n            _step61;\n          try {\n            for (_iterator61.s(); !(_step61 = _iterator61.n()).done;) {\n              var _t72 = _step61.value;\n              for (var _e86 in _t72.vaos) _t72.vaos[_e86].destroy();\n            }\n          } catch (err) {\n            _iterator61.e(err);\n          } finally {\n            _iterator61.f();\n          }\n        }\n      }], [{\n        key: \"simpleSegment\",\n        value: function simpleSegment(t, e, r, n) {\n          return new So([{\n            vertexOffset: t,\n            primitiveOffset: e,\n            vertexLength: r,\n            primitiveLength: n,\n            vaos: {},\n            sortKey: 0\n          }]);\n        }\n      }]);\n      return So;\n    }();\n    So.MAX_VERTEX_ARRAY_LENGTH = Math.pow(2, 16) - 1, Oi(So, \"SegmentVector\");\n    var ko = 8192;\n    var Io = /*#__PURE__*/function () {\n      function Io(t, e) {\n        _classCallCheck(this, Io);\n        t && (e ? this.setSouthWest(t).setNorthEast(e) : 4 === t.length ? this.setSouthWest([t[0], t[1]]).setNorthEast([t[2], t[3]]) : this.setSouthWest(t[0]).setNorthEast(t[1]));\n      }\n      _createClass(Io, [{\n        key: \"setNorthEast\",\n        value: function setNorthEast(t) {\n          return this._ne = t instanceof ru ? new ru(t.lng, t.lat) : ru.convert(t), this;\n        }\n      }, {\n        key: \"setSouthWest\",\n        value: function setSouthWest(t) {\n          return this._sw = t instanceof ru ? new ru(t.lng, t.lat) : ru.convert(t), this;\n        }\n      }, {\n        key: \"extend\",\n        value: function extend(t) {\n          var e = this._sw,\n            r = this._ne;\n          var n, i;\n          if (t instanceof ru) n = t, i = t;else {\n            if (!(t instanceof Io)) return Array.isArray(t) ? 4 === t.length || t.every(Array.isArray) ? this.extend(Io.convert(t)) : this.extend(ru.convert(t)) : \"object\" == typeof t && null !== t && t.hasOwnProperty(\"lat\") && (t.hasOwnProperty(\"lon\") || t.hasOwnProperty(\"lng\")) ? this.extend(ru.convert(t)) : this;\n            if (n = t._sw, i = t._ne, !n || !i) return this;\n          }\n          return e || r ? (e.lng = Math.min(n.lng, e.lng), e.lat = Math.min(n.lat, e.lat), r.lng = Math.max(i.lng, r.lng), r.lat = Math.max(i.lat, r.lat)) : (this._sw = new ru(n.lng, n.lat), this._ne = new ru(i.lng, i.lat)), this;\n        }\n      }, {\n        key: \"getCenter\",\n        value: function getCenter() {\n          return new ru((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2);\n        }\n      }, {\n        key: \"getSouthWest\",\n        value: function getSouthWest() {\n          return this._sw;\n        }\n      }, {\n        key: \"getNorthEast\",\n        value: function getNorthEast() {\n          return this._ne;\n        }\n      }, {\n        key: \"getNorthWest\",\n        value: function getNorthWest() {\n          return new ru(this.getWest(), this.getNorth());\n        }\n      }, {\n        key: \"getSouthEast\",\n        value: function getSouthEast() {\n          return new ru(this.getEast(), this.getSouth());\n        }\n      }, {\n        key: \"getWest\",\n        value: function getWest() {\n          return this._sw.lng;\n        }\n      }, {\n        key: \"getSouth\",\n        value: function getSouth() {\n          return this._sw.lat;\n        }\n      }, {\n        key: \"getEast\",\n        value: function getEast() {\n          return this._ne.lng;\n        }\n      }, {\n        key: \"getNorth\",\n        value: function getNorth() {\n          return this._ne.lat;\n        }\n      }, {\n        key: \"toArray\",\n        value: function toArray() {\n          return [this._sw.toArray(), this._ne.toArray()];\n        }\n      }, {\n        key: \"toString\",\n        value: function toString() {\n          return \"LngLatBounds(\".concat(this._sw.toString(), \", \").concat(this._ne.toString(), \")\");\n        }\n      }, {\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return !(this._sw && this._ne);\n        }\n      }, {\n        key: \"contains\",\n        value: function contains(t) {\n          var _ru$convert = ru.convert(t),\n            e = _ru$convert.lng,\n            r = _ru$convert.lat;\n          var n = this._sw.lng <= e && e <= this._ne.lng;\n          return this._sw.lng > this._ne.lng && (n = this._sw.lng >= e && e >= this._ne.lng), this._sw.lat <= r && r <= this._ne.lat && n;\n        }\n      }], [{\n        key: \"convert\",\n        value: function convert(t) {\n          return !t || t instanceof Io ? t : new Io(t);\n        }\n      }]);\n      return Io;\n    }();\n    var Mo = 1e-6,\n      To = \"undefined\" != typeof Float32Array ? Float32Array : Array;\n    function zo() {\n      var t = new To(9);\n      return To != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[5] = 0, t[6] = 0, t[7] = 0), t[0] = 1, t[4] = 1, t[8] = 1, t;\n    }\n    function Bo(t, e, r) {\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = e[3],\n        o = e[4],\n        l = e[5],\n        u = e[6],\n        c = e[7],\n        h = e[8],\n        p = r[0],\n        f = r[1],\n        d = r[2],\n        y = r[3],\n        m = r[4],\n        g = r[5],\n        x = r[6],\n        v = r[7],\n        b = r[8];\n      return t[0] = p * n + f * a + d * u, t[1] = p * i + f * o + d * c, t[2] = p * s + f * l + d * h, t[3] = y * n + m * a + g * u, t[4] = y * i + m * o + g * c, t[5] = y * s + m * l + g * h, t[6] = x * n + v * a + b * u, t[7] = x * i + v * o + b * c, t[8] = x * s + v * l + b * h, t;\n    }\n    function Eo(t) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }\n    function Co(t, e) {\n      var r = e[0],\n        n = e[1],\n        i = e[2],\n        s = e[3],\n        a = e[4],\n        o = e[5],\n        l = e[6],\n        u = e[7],\n        c = e[8],\n        h = e[9],\n        p = e[10],\n        f = e[11],\n        d = e[12],\n        y = e[13],\n        m = e[14],\n        g = e[15],\n        x = r * o - n * a,\n        v = r * l - i * a,\n        b = r * u - s * a,\n        w = n * l - i * o,\n        _ = n * u - s * o,\n        A = i * u - s * l,\n        S = c * y - h * d,\n        k = c * m - p * d,\n        I = c * g - f * d,\n        M = h * m - p * y,\n        T = h * g - f * y,\n        z = p * g - f * m,\n        B = x * z - v * T + b * M + w * I - _ * k + A * S;\n      return B ? (t[0] = (o * z - l * T + u * M) * (B = 1 / B), t[1] = (i * T - n * z - s * M) * B, t[2] = (y * A - m * _ + g * w) * B, t[3] = (p * _ - h * A - f * w) * B, t[4] = (l * I - a * z - u * k) * B, t[5] = (r * z - i * I + s * k) * B, t[6] = (m * b - d * A - g * v) * B, t[7] = (c * A - p * b + f * v) * B, t[8] = (a * T - o * I + u * S) * B, t[9] = (n * I - r * T - s * S) * B, t[10] = (d * _ - y * b + g * x) * B, t[11] = (h * b - c * _ - f * x) * B, t[12] = (o * k - a * M - l * S) * B, t[13] = (r * M - n * k + i * S) * B, t[14] = (y * v - d * w - m * x) * B, t[15] = (c * w - h * v + p * x) * B, t) : null;\n    }\n    function Po(t, e, r) {\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = e[3],\n        o = e[4],\n        l = e[5],\n        u = e[6],\n        c = e[7],\n        h = e[8],\n        p = e[9],\n        f = e[10],\n        d = e[11],\n        y = e[12],\n        m = e[13],\n        g = e[14],\n        x = e[15],\n        v = r[0],\n        b = r[1],\n        w = r[2],\n        _ = r[3];\n      return t[0] = v * n + b * o + w * h + _ * y, t[1] = v * i + b * l + w * p + _ * m, t[2] = v * s + b * u + w * f + _ * g, t[3] = v * a + b * c + w * d + _ * x, t[4] = (v = r[4]) * n + (b = r[5]) * o + (w = r[6]) * h + (_ = r[7]) * y, t[5] = v * i + b * l + w * p + _ * m, t[6] = v * s + b * u + w * f + _ * g, t[7] = v * a + b * c + w * d + _ * x, t[8] = (v = r[8]) * n + (b = r[9]) * o + (w = r[10]) * h + (_ = r[11]) * y, t[9] = v * i + b * l + w * p + _ * m, t[10] = v * s + b * u + w * f + _ * g, t[11] = v * a + b * c + w * d + _ * x, t[12] = (v = r[12]) * n + (b = r[13]) * o + (w = r[14]) * h + (_ = r[15]) * y, t[13] = v * i + b * l + w * p + _ * m, t[14] = v * s + b * u + w * f + _ * g, t[15] = v * a + b * c + w * d + _ * x, t;\n    }\n    function Do(t, e, r) {\n      var n,\n        i,\n        s,\n        a,\n        o,\n        l,\n        u,\n        c,\n        h,\n        p,\n        f,\n        d,\n        y = r[0],\n        m = r[1],\n        g = r[2];\n      return e === t ? (t[12] = e[0] * y + e[4] * m + e[8] * g + e[12], t[13] = e[1] * y + e[5] * m + e[9] * g + e[13], t[14] = e[2] * y + e[6] * m + e[10] * g + e[14], t[15] = e[3] * y + e[7] * m + e[11] * g + e[15]) : (i = e[1], s = e[2], a = e[3], o = e[4], l = e[5], u = e[6], c = e[7], h = e[8], p = e[9], f = e[10], d = e[11], t[0] = n = e[0], t[1] = i, t[2] = s, t[3] = a, t[4] = o, t[5] = l, t[6] = u, t[7] = c, t[8] = h, t[9] = p, t[10] = f, t[11] = d, t[12] = n * y + o * m + h * g + e[12], t[13] = i * y + l * m + p * g + e[13], t[14] = s * y + u * m + f * g + e[14], t[15] = a * y + c * m + d * g + e[15]), t;\n    }\n    function Vo(t, e, r) {\n      var n = r[0],\n        i = r[1],\n        s = r[2];\n      return t[0] = e[0] * n, t[1] = e[1] * n, t[2] = e[2] * n, t[3] = e[3] * n, t[4] = e[4] * i, t[5] = e[5] * i, t[6] = e[6] * i, t[7] = e[7] * i, t[8] = e[8] * s, t[9] = e[9] * s, t[10] = e[10] * s, t[11] = e[11] * s, t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15], t;\n    }\n    function Lo(t, e, r) {\n      var n = Math.sin(r),\n        i = Math.cos(r),\n        s = e[4],\n        a = e[5],\n        o = e[6],\n        l = e[7],\n        u = e[8],\n        c = e[9],\n        h = e[10],\n        p = e[11];\n      return e !== t && (t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[3], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[4] = s * i + u * n, t[5] = a * i + c * n, t[6] = o * i + h * n, t[7] = l * i + p * n, t[8] = u * i - s * n, t[9] = c * i - a * n, t[10] = h * i - o * n, t[11] = p * i - l * n, t;\n    }\n    function Fo(t, e, r) {\n      var n = Math.sin(r),\n        i = Math.cos(r),\n        s = e[0],\n        a = e[1],\n        o = e[2],\n        l = e[3],\n        u = e[8],\n        c = e[9],\n        h = e[10],\n        p = e[11];\n      return e !== t && (t[4] = e[4], t[5] = e[5], t[6] = e[6], t[7] = e[7], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = s * i - u * n, t[1] = a * i - c * n, t[2] = o * i - h * n, t[3] = l * i - p * n, t[8] = s * n + u * i, t[9] = a * n + c * i, t[10] = o * n + h * i, t[11] = l * n + p * i, t;\n    }\n    function Ro(t, e) {\n      return t[0] = e[0], t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = e[1], t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = e[2], t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }\n    function jo(t, e, r) {\n      var n,\n        i,\n        s,\n        a = r[0],\n        o = r[1],\n        l = r[2],\n        u = Math.hypot(a, o, l);\n      return u < Mo ? null : (a *= u = 1 / u, o *= u, l *= u, n = Math.sin(e), i = Math.cos(e), t[0] = a * a * (s = 1 - i) + i, t[1] = o * a * s + l * n, t[2] = l * a * s - o * n, t[3] = 0, t[4] = a * o * s - l * n, t[5] = o * o * s + i, t[6] = l * o * s + a * n, t[7] = 0, t[8] = a * l * s + o * n, t[9] = o * l * s - a * n, t[10] = l * l * s + i, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t);\n    }\n    Math.hypot || (Math.hypot = function () {\n      for (var t = 0, e = arguments.length; e--;) t += arguments[e] * arguments[e];\n      return Math.sqrt(t);\n    });\n    var $o = Po;\n    function Uo() {\n      var t = new To(3);\n      return To != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t;\n    }\n    function Oo(t) {\n      var e = new To(3);\n      return e[0] = t[0], e[1] = t[1], e[2] = t[2], e;\n    }\n    function qo(t) {\n      return Math.hypot(t[0], t[1], t[2]);\n    }\n    function No(t, e, r) {\n      var n = new To(3);\n      return n[0] = t, n[1] = e, n[2] = r, n;\n    }\n    function Go(t, e, r) {\n      return t[0] = e[0] + r[0], t[1] = e[1] + r[1], t[2] = e[2] + r[2], t;\n    }\n    function Zo(t, e, r) {\n      return t[0] = e[0] - r[0], t[1] = e[1] - r[1], t[2] = e[2] - r[2], t;\n    }\n    function Xo(t, e, r) {\n      return t[0] = e[0] * r[0], t[1] = e[1] * r[1], t[2] = e[2] * r[2], t;\n    }\n    function Ko(t, e, r) {\n      return t[0] = Math.min(e[0], r[0]), t[1] = Math.min(e[1], r[1]), t[2] = Math.min(e[2], r[2]), t;\n    }\n    function Yo(t, e, r) {\n      return t[0] = Math.max(e[0], r[0]), t[1] = Math.max(e[1], r[1]), t[2] = Math.max(e[2], r[2]), t;\n    }\n    function Ho(t, e, r) {\n      return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t;\n    }\n    function Wo(t, e, r, n) {\n      return t[0] = e[0] + r[0] * n, t[1] = e[1] + r[1] * n, t[2] = e[2] + r[2] * n, t;\n    }\n    function Jo(t, e) {\n      var r = e[0],\n        n = e[1],\n        i = e[2],\n        s = r * r + n * n + i * i;\n      return s > 0 && (s = 1 / Math.sqrt(s)), t[0] = e[0] * s, t[1] = e[1] * s, t[2] = e[2] * s, t;\n    }\n    function Qo(t, e) {\n      return t[0] * e[0] + t[1] * e[1] + t[2] * e[2];\n    }\n    function tl(t, e, r) {\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = r[0],\n        o = r[1],\n        l = r[2];\n      return t[0] = i * l - s * o, t[1] = s * a - n * l, t[2] = n * o - i * a, t;\n    }\n    function el(t, e, r) {\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = r[3] * n + r[7] * i + r[11] * s + r[15];\n      return t[0] = (r[0] * n + r[4] * i + r[8] * s + r[12]) / (a = a || 1), t[1] = (r[1] * n + r[5] * i + r[9] * s + r[13]) / a, t[2] = (r[2] * n + r[6] * i + r[10] * s + r[14]) / a, t;\n    }\n    function rl(t, e, r) {\n      var n = r[0],\n        i = r[1],\n        s = r[2],\n        a = e[0],\n        o = e[1],\n        l = e[2],\n        u = i * l - s * o,\n        c = s * a - n * l,\n        h = n * o - i * a,\n        p = i * h - s * c,\n        f = s * u - n * h,\n        d = n * c - i * u,\n        y = 2 * r[3];\n      return c *= y, h *= y, f *= 2, d *= 2, t[0] = a + (u *= y) + (p *= 2), t[1] = o + c + f, t[2] = l + h + d, t;\n    }\n    var nl,\n      il = Zo,\n      sl = Xo,\n      al = qo;\n    function ol(t, e, r) {\n      return t[0] = e[0] * r, t[1] = e[1] * r, t[2] = e[2] * r, t[3] = e[3] * r, t;\n    }\n    function ll(t, e) {\n      var r = e[0],\n        n = e[1],\n        i = e[2],\n        s = e[3],\n        a = r * r + n * n + i * i + s * s;\n      return a > 0 && (a = 1 / Math.sqrt(a)), t[0] = r * a, t[1] = n * a, t[2] = i * a, t[3] = s * a, t;\n    }\n    function ul(t, e, r) {\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = e[3];\n      return t[0] = r[0] * n + r[4] * i + r[8] * s + r[12] * a, t[1] = r[1] * n + r[5] * i + r[9] * s + r[13] * a, t[2] = r[2] * n + r[6] * i + r[10] * s + r[14] * a, t[3] = r[3] * n + r[7] * i + r[11] * s + r[15] * a, t;\n    }\n    function cl() {\n      var t = new To(4);\n      return To != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t[3] = 1, t;\n    }\n    function hl(t) {\n      return t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1, t;\n    }\n    function pl(t, e, r) {\n      r *= .5;\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = e[3],\n        o = Math.sin(r),\n        l = Math.cos(r);\n      return t[0] = n * l + a * o, t[1] = i * l + s * o, t[2] = s * l - i * o, t[3] = a * l - n * o, t;\n    }\n    function fl(t, e, r) {\n      r *= .5;\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = e[3],\n        o = Math.sin(r),\n        l = Math.cos(r);\n      return t[0] = n * l - s * o, t[1] = i * l + a * o, t[2] = s * l + n * o, t[3] = a * l - i * o, t;\n    }\n    Uo(), nl = new To(4), To != Float32Array && (nl[0] = 0, nl[1] = 0, nl[2] = 0, nl[3] = 0);\n    var dl = ll;\n    Uo(), No(1, 0, 0), No(0, 1, 0), cl(), cl(), zo();\n    var yl = na([{\n        type: \"Float32\",\n        name: \"a_globe_pos\",\n        components: 3\n      }, {\n        type: \"Float32\",\n        name: \"a_uv\",\n        components: 2\n      }]),\n      ml = yl.members,\n      gl = na([{\n        name: \"a_pos_3\",\n        components: 3,\n        type: \"Int16\"\n      }]);\n    var xl = na([{\n      name: \"a_pos\",\n      type: \"Int16\",\n      components: 2\n    }]);\n    var vl = /*#__PURE__*/function () {\n      function vl(t, e) {\n        _classCallCheck(this, vl);\n        this.pos = t, this.dir = e;\n      }\n      _createClass(vl, [{\n        key: \"intersectsPlane\",\n        value: function intersectsPlane(t, e, r) {\n          var n = Qo(e, this.dir);\n          if (Math.abs(n) < 1e-6) return !1;\n          var i = ((t[0] - this.pos[0]) * e[0] + (t[1] - this.pos[1]) * e[1] + (t[2] - this.pos[2]) * e[2]) / n;\n          return r[0] = this.pos[0] + this.dir[0] * i, r[1] = this.pos[1] + this.dir[1] * i, r[2] = this.pos[2] + this.dir[2] * i, !0;\n        }\n      }, {\n        key: \"closestPointOnSphere\",\n        value: function closestPointOnSphere(t, e, r) {\n          if (function (t, e) {\n            var r = t[0],\n              n = t[1],\n              i = t[2],\n              s = e[0],\n              a = e[1],\n              o = e[2];\n            return Math.abs(r - s) <= Mo * Math.max(1, Math.abs(r), Math.abs(s)) && Math.abs(n - a) <= Mo * Math.max(1, Math.abs(n), Math.abs(a)) && Math.abs(i - o) <= Mo * Math.max(1, Math.abs(i), Math.abs(o));\n          }(this.pos, t) || 0 === e) return r[0] = r[1] = r[2] = 0, !1;\n          var _this$dir = _slicedToArray(this.dir, 3),\n            n = _this$dir[0],\n            i = _this$dir[1],\n            s = _this$dir[2],\n            a = this.pos[0] - t[0],\n            o = this.pos[1] - t[1],\n            l = this.pos[2] - t[2],\n            u = n * n + i * i + s * s,\n            c = 2 * (a * n + o * i + l * s),\n            h = c * c - 4 * u * (a * a + o * o + l * l - e * e);\n          if (h < 0) {\n            var _t73 = Math.max(-c / 2, 0),\n              _u9 = a + n * _t73,\n              _h3 = o + i * _t73,\n              _p2 = l + s * _t73,\n              _f2 = Math.hypot(_u9, _h3, _p2);\n            return r[0] = _u9 * e / _f2, r[1] = _h3 * e / _f2, r[2] = _p2 * e / _f2, !1;\n          }\n          {\n            var _t74 = (-c - Math.sqrt(h)) / (2 * u);\n            if (_t74 < 0) {\n              var _t75 = Math.hypot(a, o, l);\n              return r[0] = a * e / _t75, r[1] = o * e / _t75, r[2] = l * e / _t75, !1;\n            }\n            return r[0] = a + n * _t74, r[1] = o + i * _t74, r[2] = l + s * _t74, !0;\n          }\n        }\n      }]);\n      return vl;\n    }();\n    var bl = /*#__PURE__*/function () {\n      function bl(t, e, r, n, i) {\n        _classCallCheck(this, bl);\n        this.TL = t, this.TR = e, this.BR = r, this.BL = n, this.horizon = i;\n      }\n      _createClass(bl, null, [{\n        key: \"fromInvProjectionMatrix\",\n        value: function fromInvProjectionMatrix(t, e, r) {\n          var n = [-1, 1, 1],\n            i = [1, 1, 1],\n            s = [1, -1, 1],\n            a = [-1, -1, 1],\n            o = el(n, n, t),\n            l = el(i, i, t),\n            u = el(s, s, t),\n            c = el(a, a, t);\n          return new bl(o, l, u, c, e / r);\n        }\n      }]);\n      return bl;\n    }();\n    var wl = /*#__PURE__*/function () {\n      function wl(t, e) {\n        _classCallCheck(this, wl);\n        this.points = t, this.planes = e;\n      }\n      _createClass(wl, null, [{\n        key: \"fromInvProjectionMatrix\",\n        value: function fromInvProjectionMatrix(t, e, r, n) {\n          var i = Math.pow(2, r),\n            s = [[-1, 1, -1, 1], [1, 1, -1, 1], [1, -1, -1, 1], [-1, -1, -1, 1], [-1, 1, 1, 1], [1, 1, 1, 1], [1, -1, 1, 1], [-1, -1, 1, 1]].map(function (r) {\n              var s = ul([], r, t),\n                a = 1 / s[3] / e * i;\n              return function (t, e, r) {\n                return t[0] = e[0] * r[0], t[1] = e[1] * r[1], t[2] = e[2] * r[2], t[3] = e[3] * r[3], t;\n              }(s, s, [a, a, n ? 1 / s[3] : a, a]);\n            }),\n            a = [[0, 1, 2], [6, 5, 4], [0, 3, 7], [2, 1, 5], [3, 2, 6], [0, 4, 5]].map(function (t) {\n              var e = Jo([], tl([], il([], s[t[0]], s[t[1]]), il([], s[t[2]], s[t[1]]))),\n                r = -Qo(e, s[t[1]]);\n              return e.concat(r);\n            });\n          return new wl(s, a);\n        }\n      }]);\n      return wl;\n    }();\n    var _l = /*#__PURE__*/function () {\n      _createClass(_l, null, [{\n        key: \"fromPoints\",\n        value: function fromPoints(t) {\n          var e = [1 / 0, 1 / 0, 1 / 0],\n            r = [-1 / 0, -1 / 0, -1 / 0];\n          var _iterator62 = _createForOfIteratorHelper(t),\n            _step62;\n          try {\n            for (_iterator62.s(); !(_step62 = _iterator62.n()).done;) {\n              var _n49 = _step62.value;\n              Ko(e, e, _n49), Yo(r, r, _n49);\n            }\n          } catch (err) {\n            _iterator62.e(err);\n          } finally {\n            _iterator62.f();\n          }\n          return new _l(e, r);\n        }\n      }, {\n        key: \"applyTransform\",\n        value: function applyTransform(t, e) {\n          var r = t.getCorners();\n          for (var _t76 = 0; _t76 < r.length; ++_t76) el(r[_t76], r[_t76], e);\n          return _l.fromPoints(r);\n        }\n      }]);\n      function _l(t, e) {\n        _classCallCheck(this, _l);\n        this.min = t, this.max = e, this.center = Ho([], Go([], this.min, this.max), .5);\n      }\n      _createClass(_l, [{\n        key: \"quadrant\",\n        value: function quadrant(t) {\n          var e = [t % 2 == 0, t < 2],\n            r = Oo(this.min),\n            n = Oo(this.max);\n          for (var _t77 = 0; _t77 < e.length; _t77++) r[_t77] = e[_t77] ? this.min[_t77] : this.center[_t77], n[_t77] = e[_t77] ? this.center[_t77] : this.max[_t77];\n          return n[2] = this.max[2], new _l(r, n);\n        }\n      }, {\n        key: \"distanceX\",\n        value: function distanceX(t) {\n          return Math.max(Math.min(this.max[0], t[0]), this.min[0]) - t[0];\n        }\n      }, {\n        key: \"distanceY\",\n        value: function distanceY(t) {\n          return Math.max(Math.min(this.max[1], t[1]), this.min[1]) - t[1];\n        }\n      }, {\n        key: \"distanceZ\",\n        value: function distanceZ(t) {\n          return Math.max(Math.min(this.max[2], t[2]), this.min[2]) - t[2];\n        }\n      }, {\n        key: \"getCorners\",\n        value: function getCorners() {\n          var t = this.min,\n            e = this.max;\n          return [[t[0], t[1], t[2]], [e[0], t[1], t[2]], [e[0], e[1], t[2]], [t[0], e[1], t[2]], [t[0], t[1], e[2]], [e[0], t[1], e[2]], [e[0], e[1], e[2]], [t[0], e[1], e[2]]];\n        }\n      }, {\n        key: \"intersects\",\n        value: function intersects(t) {\n          var e = this.getCorners();\n          var r = !0;\n          for (var _n50 = 0; _n50 < t.planes.length; _n50++) {\n            var _i53 = t.planes[_n50];\n            var _s31 = 0;\n            for (var _t78 = 0; _t78 < e.length; _t78++) _s31 += Qo(_i53, e[_t78]) + _i53[3] >= 0;\n            if (0 === _s31) return 0;\n            _s31 !== e.length && (r = !1);\n          }\n          if (r) return 2;\n          for (var _e87 = 0; _e87 < 3; _e87++) {\n            var _r74 = Number.MAX_VALUE,\n              _n51 = -Number.MAX_VALUE;\n            for (var _i54 = 0; _i54 < t.points.length; _i54++) {\n              var _s32 = t.points[_i54][_e87] - this.min[_e87];\n              _r74 = Math.min(_r74, _s32), _n51 = Math.max(_n51, _s32);\n            }\n            if (_n51 < 0 || _r74 > this.max[_e87] - this.min[_e87]) return 0;\n          }\n          return 1;\n        }\n      }]);\n      return _l;\n    }();\n    var Al = ko / Math.PI / 2,\n      Sl = 64,\n      kl = [Sl, 32, 16],\n      Il = -Al,\n      Ml = Al,\n      Tl = [new _l([Il, Il, Il], [Ml, Ml, Ml]), new _l([Il, Il, Il], [0, 0, Ml]), new _l([0, Il, Il], [Ml, 0, Ml]), new _l([Il, 0, Il], [0, Ml, Ml]), new _l([0, 0, Il], [Ml, Ml, Ml])];\n    function zl(t) {\n      return t * Al / tu;\n    }\n    function Bl(t, e, r) {\n      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !0;\n      var i = Ho([], t._camera.position, t.worldSize),\n        s = [e, r, 1, 1];\n      ul(s, s, t.pixelMatrixInverse), ol(s, s, 1 / s[3]);\n      var a = Jo([], il([], s, i)),\n        o = t.globeMatrix,\n        l = [o[12], o[13], o[14]],\n        u = il([], l, i),\n        c = qo(u),\n        h = Jo([], u),\n        p = t.worldSize / (2 * Math.PI),\n        f = Qo(h, a),\n        d = Math.asin(p / c);\n      if (d < Math.acos(f)) {\n        if (!n) return null;\n        var _t79 = [],\n          _e88 = [];\n        Ho(_t79, a, c / f), Jo(_e88, il(_e88, _t79, u)), Jo(a, Go(a, u, Ho(a, _e88, Math.tan(d) * c)));\n      }\n      var y = [];\n      new vl(i, a).closestPointOnSphere(l, p, y);\n      var m = Jo([], Y(o, 0)),\n        g = Jo([], Y(o, 1)),\n        x = Jo([], Y(o, 2)),\n        b = Qo(m, y),\n        w = Qo(g, y),\n        _ = Qo(x, y),\n        A = v(Math.asin(-w / p));\n      var k = v(Math.atan2(b, _));\n      k = t.center.lng + function (t, e) {\n        var r = (e - t + 180) % 360 - 180;\n        return r < -180 ? r + 360 : r;\n      }(t.center.lng, k);\n      var I = iu(k),\n        M = S(su(A), 0, 1);\n      return new pu(I, M);\n    }\n    var El = function El(t, e, r) {\n      _classCallCheck(this, El);\n      this.a = il([], t, r), this.b = il([], e, r), this.center = r;\n      var n = Jo([], this.a),\n        i = Jo([], this.b);\n      this.angle = Math.acos(Qo(n, i));\n    };\n    function Cl(t, e) {\n      if (0 === t.angle) return null;\n      var r;\n      return r = 0 === t.a[e] ? 1 / t.angle * .5 * Math.PI : 1 / t.angle * Math.atan(t.b[e] / t.a[e] / Math.sin(t.angle) - 1 / Math.tan(t.angle)), r < 0 || r > 1 ? null : function (t, e, r, n) {\n        var i = Math.sin(r);\n        return t * (Math.sin((1 - n) * r) / i) + e * (Math.sin(n * r) / i);\n      }(t.a[e], t.b[e], t.angle, S(r, 0, 1)) + t.center[e];\n    }\n    function Pl(t) {\n      if (t.z <= 1) return Tl[t.z + 2 * t.y + t.x];\n      var e = jl(Rl(t));\n      return _l.fromPoints(e);\n    }\n    function Dl(t, e, r) {\n      return Ho(t, t, 1 - r), Wo(t, t, e, r);\n    }\n    function Vl(t, e) {\n      var r = Kl(e.zoom);\n      if (0 === r) return Pl(t);\n      var n = Rl(t),\n        i = jl(n),\n        s = iu(n.getWest()) * e.worldSize,\n        a = iu(n.getEast()) * e.worldSize,\n        o = su(n.getNorth()) * e.worldSize,\n        l = su(n.getSouth()) * e.worldSize,\n        u = [s, o, 0],\n        c = [a, o, 0],\n        h = [s, l, 0],\n        p = [a, l, 0],\n        f = Co([], e.globeMatrix);\n      return el(u, u, f), el(c, c, f), el(h, h, f), el(p, p, f), i[0] = Dl(i[0], h, r), i[1] = Dl(i[1], p, r), i[2] = Dl(i[2], c, r), i[3] = Dl(i[3], u, r), _l.fromPoints(i);\n    }\n    function Ll(t, e, r) {\n      var _iterator63 = _createForOfIteratorHelper(t),\n        _step63;\n      try {\n        for (_iterator63.s(); !(_step63 = _iterator63.n()).done;) {\n          var _n52 = _step63.value;\n          el(_n52, _n52, e), Ho(_n52, _n52, r);\n        }\n      } catch (err) {\n        _iterator63.e(err);\n      } finally {\n        _iterator63.f();\n      }\n    }\n    function Fl(t, e, r) {\n      var n = e / t.worldSize,\n        i = t.globeMatrix;\n      if (r.z <= 1) {\n        var _t80 = Pl(r).getCorners();\n        return Ll(_t80, i, n), _l.fromPoints(_t80);\n      }\n      var s = Rl(r),\n        a = jl(s);\n      Ll(a, i, n);\n      var o = Number.MAX_VALUE,\n        l = [-o, -o, -o],\n        u = [o, o, o];\n      if (s.contains(t.center)) {\n        var _iterator64 = _createForOfIteratorHelper(a),\n          _step64;\n        try {\n          for (_iterator64.s(); !(_step64 = _iterator64.n()).done;) {\n            var _t81 = _step64.value;\n            Ko(u, u, _t81), Yo(l, l, _t81);\n          }\n        } catch (err) {\n          _iterator64.e(err);\n        } finally {\n          _iterator64.f();\n        }\n        l[2] = 0;\n        var _e89 = t.point,\n          _r75 = [_e89.x * n, _e89.y * n, 0];\n        return Ko(u, u, _r75), Yo(l, l, _r75), new _l(u, l);\n      }\n      var c = [i[12] * n, i[13] * n, i[14] * n],\n        h = s.getCenter(),\n        p = S(t.center.lat, -cu, cu),\n        f = S(h.lat, -cu, cu),\n        d = iu(t.center.lng),\n        y = su(p);\n      var m = d - iu(h.lng);\n      var g = y - su(f);\n      m > .5 ? m -= 1 : m < -.5 && (m += 1);\n      var v = 0;\n      Math.abs(m) > Math.abs(g) ? v = m >= 0 ? 1 : 3 : (v = g >= 0 ? 0 : 2, Wo(c, c, [i[4] * n, i[5] * n, i[6] * n], -Math.sin(x(g >= 0 ? s.getSouth() : s.getNorth())) * Al));\n      var b = a[v],\n        w = a[(v + 1) % 4],\n        _ = new El(b, w, c),\n        A = [Cl(_, 0) || b[0], Cl(_, 1) || b[1], Cl(_, 2) || b[2]],\n        k = Kl(t.zoom);\n      if (k > 0) {\n        var _n53 = function (_ref112, n, i, s, a) {\n          var t = _ref112.x,\n            e = _ref112.y,\n            r = _ref112.z;\n          var o = 1 / (1 << r);\n          var l = t * o,\n            u = l + o,\n            c = e * o,\n            h = c + o,\n            p = 0;\n          var f = (l + u) / 2 - s;\n          return f > .5 ? p = -1 : f < -.5 && (p = 1), l = ((l + p) * n - (s *= n)) * i + s, u = ((u + p) * n - s) * i + s, c = (c * n - (a *= n)) * i + a, h = (h * n - a) * i + a, [[l, h, 0], [u, h, 0], [u, c, 0], [l, c, 0]];\n        }(r, e, t._pixelsPerMercatorPixel, d, y);\n        for (var _t82 = 0; _t82 < a.length; _t82++) Dl(a[_t82], _n53[_t82], k);\n        var _i55 = Go([], _n53[v], _n53[(v + 1) % 4]);\n        Ho(_i55, _i55, .5), Dl(A, _i55, k);\n      }\n      var _iterator65 = _createForOfIteratorHelper(a),\n        _step65;\n      try {\n        for (_iterator65.s(); !(_step65 = _iterator65.n()).done;) {\n          var _t83 = _step65.value;\n          Ko(u, u, _t83), Yo(l, l, _t83);\n        }\n      } catch (err) {\n        _iterator65.e(err);\n      } finally {\n        _iterator65.f();\n      }\n      return u[2] = Math.min(b[2], w[2]), Ko(u, u, A), Yo(l, l, A), new _l(u, l);\n    }\n    function Rl(_ref113) {\n      var t = _ref113.x,\n        e = _ref113.y,\n        r = _ref113.z;\n      var n = 1 / (1 << r),\n        i = new ru(ou(t * n), lu((e + 1) * n)),\n        s = new ru(ou((t + 1) * n), lu(e * n));\n      return new Io(i, s);\n    }\n    function jl(t) {\n      var e = x(t.getNorth()),\n        r = x(t.getSouth()),\n        n = Math.cos(e),\n        i = Math.cos(r),\n        s = Math.sin(e),\n        a = Math.sin(r),\n        o = t.getWest(),\n        l = t.getEast();\n      return [$l(i, a, o), $l(i, a, l), $l(n, s, l), $l(n, s, o)];\n    }\n    function $l(t, e, r) {\n      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Al;\n      return r = x(r), [t * Math.sin(r) * n, -e * n, t * Math.cos(r) * n];\n    }\n    function Ul(t, e, r) {\n      return $l(Math.cos(x(t)), Math.sin(x(t)), e, r);\n    }\n    function Ol(t, e, r, n) {\n      var i = 1 << r.z,\n        s = (t / ko + r.x) / i;\n      return Ul(lu((e / ko + r.y) / i), ou(s), n);\n    }\n    function ql(_ref114) {\n      var t = _ref114.min,\n        e = _ref114.max;\n      return 16383 / Math.max(e[0] - t[0], e[1] - t[1], e[2] - t[2]);\n    }\n    var Nl = new Float64Array(16);\n    function Gl(t) {\n      var e = ql(t),\n        r = Ro(Nl, [e, e, e]);\n      return Do(r, r, ((n = [])[0] = -(i = t.min)[0], n[1] = -i[1], n[2] = -i[2], n));\n      var n, i;\n    }\n    function Zl(t) {\n      var e = (n = t.min, (r = Nl)[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = 1, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = 1, r[11] = 0, r[12] = n[0], r[13] = n[1], r[14] = n[2], r[15] = 1, r);\n      var r, n;\n      var i = 1 / ql(t);\n      return Vo(e, e, [i, i, i]);\n    }\n    function Xl(t, e, r, n, i) {\n      var s = function (t) {\n          var e = ko / (2 * Math.PI);\n          return t / (2 * Math.PI) / e;\n        }(r),\n        a = [t, e, -r / (2 * Math.PI)],\n        o = Eo(new Float64Array(16));\n      return Do(o, o, a), Vo(o, o, [s, s, s]), Lo(o, o, x(-i)), Fo(o, o, x(-n)), o;\n    }\n    function Kl(t) {\n      return k(5, 6, t);\n    }\n    function Yl(t, e) {\n      var r = Ul(e.lat, e.lng),\n        n = function (t) {\n          var e = Ul(t._center.lat, t._center.lng);\n          var r = tl([], No(0, 1, 0), e);\n          var n = jo([], -t.angle, e);\n          r = el(r, r, n), jo(n, -t._pitch, r);\n          var i = Jo([], e);\n          return Ho(i, i, zl(t.cameraToCenterDistance / t.pixelsPerMeter)), el(i, i, n), Go([], e, i);\n        }(t);\n      return a = (i = Zo([], n, r))[0], o = i[1], l = i[2], u = (s = r)[0], c = s[1], h = s[2], f = (p = Math.sqrt(a * a + o * o + l * l) * Math.sqrt(u * u + c * c + h * h)) && Qo(i, s) / p, Math.acos(Math.min(Math.max(f, -1), 1));\n      var i, s, a, o, l, u, c, h, p, f;\n    }\n    function Hl(t, e) {\n      return Yl(t, e) > Math.PI / 2 * 1.01;\n    }\n    var Wl = x(85),\n      Jl = Math.cos(Wl),\n      Ql = Math.sin(Wl),\n      tu = 6371008.8,\n      eu = 2 * Math.PI * tu;\n    var ru = /*#__PURE__*/function () {\n      function ru(t, e) {\n        _classCallCheck(this, ru);\n        if (isNaN(t) || isNaN(e)) throw new Error(\"Invalid LngLat object: (\".concat(t, \", \").concat(e, \")\"));\n        if (this.lng = +t, this.lat = +e, this.lat > 90 || this.lat < -90) throw new Error(\"Invalid LngLat latitude value: must be between -90 and 90\");\n      }\n      _createClass(ru, [{\n        key: \"wrap\",\n        value: function wrap() {\n          return new ru(I(this.lng, -180, 180), this.lat);\n        }\n      }, {\n        key: \"toArray\",\n        value: function toArray() {\n          return [this.lng, this.lat];\n        }\n      }, {\n        key: \"toString\",\n        value: function toString() {\n          return \"LngLat(\".concat(this.lng, \", \").concat(this.lat, \")\");\n        }\n      }, {\n        key: \"distanceTo\",\n        value: function distanceTo(t) {\n          var e = Math.PI / 180,\n            r = this.lat * e,\n            n = t.lat * e,\n            i = Math.sin(r) * Math.sin(n) + Math.cos(r) * Math.cos(n) * Math.cos((t.lng - this.lng) * e);\n          return tu * Math.acos(Math.min(i, 1));\n        }\n      }, {\n        key: \"toBounds\",\n        value: function toBounds() {\n          var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n          var e = 360 * t / 40075017,\n            r = e / Math.cos(Math.PI / 180 * this.lat);\n          return new Io(new ru(this.lng - r, this.lat - e), new ru(this.lng + r, this.lat + e));\n        }\n      }, {\n        key: \"toEcef\",\n        value: function toEcef(t) {\n          var e = zl(t);\n          return Ul(this.lat, this.lng, Al + e);\n        }\n      }], [{\n        key: \"convert\",\n        value: function convert(t) {\n          if (t instanceof ru) return t;\n          if (Array.isArray(t) && (2 === t.length || 3 === t.length)) return new ru(Number(t[0]), Number(t[1]));\n          if (!Array.isArray(t) && \"object\" == typeof t && null !== t) return new ru(Number(\"lng\" in t ? t.lng : t.lon), Number(t.lat));\n          throw new Error(\"`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]\");\n        }\n      }]);\n      return ru;\n    }();\n    function nu(t) {\n      return eu * Math.cos(t * Math.PI / 180);\n    }\n    function iu(t) {\n      return (180 + t) / 360;\n    }\n    function su(t) {\n      return (180 - 180 / Math.PI * Math.log(Math.tan(Math.PI / 4 + t * Math.PI / 360))) / 360;\n    }\n    function au(t, e) {\n      return t / nu(e);\n    }\n    function ou(t) {\n      return 360 * t - 180;\n    }\n    function lu(t) {\n      return 360 / Math.PI * Math.atan(Math.exp((180 - 360 * t) * Math.PI / 180)) - 90;\n    }\n    function uu(t, e) {\n      return t * nu(lu(e));\n    }\n    var cu = 85.051129;\n    function hu(t) {\n      return 1 / Math.cos(t * Math.PI / 180);\n    }\n    var pu = /*#__PURE__*/function () {\n      function pu(t, e) {\n        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n        _classCallCheck(this, pu);\n        this.x = +t, this.y = +e, this.z = +r;\n      }\n      _createClass(pu, [{\n        key: \"toLngLat\",\n        value: function toLngLat() {\n          return new ru(ou(this.x), lu(this.y));\n        }\n      }, {\n        key: \"toAltitude\",\n        value: function toAltitude() {\n          return uu(this.z, this.y);\n        }\n      }, {\n        key: \"meterInMercatorCoordinateUnits\",\n        value: function meterInMercatorCoordinateUnits() {\n          return 1 / eu * hu(lu(this.y));\n        }\n      }], [{\n        key: \"fromLngLat\",\n        value: function fromLngLat(t) {\n          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n          var r = ru.convert(t);\n          return new pu(iu(r.lng), su(r.lat), au(e, r.lat));\n        }\n      }]);\n      return pu;\n    }();\n    function fu(t, e, r, n, i, s, a, o, l) {\n      var u = (e + n) / 2,\n        c = (r + i) / 2,\n        h = new d(u, c);\n      o(h), function (t, e, r, n, i, s) {\n        var a = r - i,\n          o = n - s;\n        return Math.abs((n - e) * a - (r - t) * o) / Math.hypot(a, o);\n      }(h.x, h.y, s.x, s.y, a.x, a.y) >= l ? (fu(t, e, r, u, c, s, h, o, l), fu(t, u, c, n, i, h, a, o, l)) : t.push(a);\n    }\n    function du(t, e, r) {\n      var n = t[0],\n        i = n.x,\n        s = n.y;\n      e(n);\n      var a = [n];\n      for (var _o12 = 1; _o12 < t.length; _o12++) {\n        var _l10 = t[_o12],\n          _u10 = _l10.x,\n          _c6 = _l10.y;\n        e(_l10), fu(a, i, s, _u10, _c6, n, _l10, e, r), i = _u10, s = _c6, n = _l10;\n      }\n      return a;\n    }\n    function yu(t, e, r, n) {\n      if (n(e, r)) {\n        var _i56 = e.add(r)._mult(.5);\n        yu(t, e, _i56, n), yu(t, _i56, r, n);\n      } else t.push(r);\n    }\n    function mu(t, e) {\n      var r = t[0];\n      var n = [r];\n      for (var _i57 = 1; _i57 < t.length; _i57++) {\n        var _s33 = t[_i57];\n        yu(n, r, _s33, e), r = _s33;\n      }\n      return n;\n    }\n    var gu = Math.pow(2, 14) - 1,\n      xu = -gu - 1;\n    function vu(t, e) {\n      var r = Math.round(t.x * e),\n        n = Math.round(t.y * e);\n      return t.x = S(r, xu, gu), t.y = S(n, xu, gu), (r < t.x || r > t.x + 1 || n < t.y || n > t.y + 1) && U(\"Geometry exceeds allowed extent, reduce your vector tile buffer size\"), t;\n    }\n    function bu(t, e, r) {\n      var n = t.loadGeometry(),\n        i = t.extent,\n        s = ko / i;\n      if (e && r && r.projection.isReprojectedInTileSpace) {\n        var _s34 = 1 << e.z,\n          _a30 = r.scale,\n          _o13 = r.x,\n          _l11 = r.y,\n          _u11 = r.projection,\n          _c7 = function _c7(t) {\n            var r = ou((e.x + t.x / i) / _s34),\n              n = lu((e.y + t.y / i) / _s34),\n              c = _u11.project(r, n);\n            t.x = (c.x * _a30 - _o13) * i, t.y = (c.y * _a30 - _l11) * i;\n          };\n        for (var _e90 = 0; _e90 < n.length; _e90++) if (1 !== t.type) n[_e90] = du(n[_e90], _c7, 1);else {\n          var _t84 = [];\n          var _iterator66 = _createForOfIteratorHelper(n[_e90]),\n            _step66;\n          try {\n            for (_iterator66.s(); !(_step66 = _iterator66.n()).done;) {\n              var _r76 = _step66.value;\n              _r76.x < 0 || _r76.x >= i || _r76.y < 0 || _r76.y >= i || (_c7(_r76), _t84.push(_r76));\n            }\n          } catch (err) {\n            _iterator66.e(err);\n          } finally {\n            _iterator66.f();\n          }\n          n[_e90] = _t84;\n        }\n      }\n      var _iterator67 = _createForOfIteratorHelper(n),\n        _step67;\n      try {\n        for (_iterator67.s(); !(_step67 = _iterator67.n()).done;) {\n          var _t85 = _step67.value;\n          var _iterator68 = _createForOfIteratorHelper(_t85),\n            _step68;\n          try {\n            for (_iterator68.s(); !(_step68 = _iterator68.n()).done;) {\n              var _e91 = _step68.value;\n              vu(_e91, s);\n            }\n          } catch (err) {\n            _iterator68.e(err);\n          } finally {\n            _iterator68.f();\n          }\n        }\n      } catch (err) {\n        _iterator67.e(err);\n      } finally {\n        _iterator67.f();\n      }\n      return n;\n    }\n    function wu(t, e) {\n      return {\n        type: t.type,\n        id: t.id,\n        properties: t.properties,\n        geometry: e ? bu(t) : []\n      };\n    }\n    function _u(t, e, r, n, i) {\n      t.emplaceBack(2 * e + (n + 1) / 2, 2 * r + (i + 1) / 2);\n    }\n    function Au(t, e, r) {\n      var n = 16384;\n      t.emplaceBack(e.x, e.y, e.z, r[0] * n, r[1] * n, r[2] * n);\n    }\n    var Su = /*#__PURE__*/function () {\n      function Su(t) {\n        _classCallCheck(this, Su);\n        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {\n          return t.id;\n        }), this.index = t.index, this.hasPattern = !1, this.projection = t.projection, this.layoutVertexArray = new sa(), this.indexArray = new wa(), this.segments = new So(), this.programConfigurations = new fo(t.layers, t.zoom), this.stateDependentLayerIds = this.layers.filter(function (t) {\n          return t.isStateDependent();\n        }).map(function (t) {\n          return t.id;\n        });\n      }\n      _createClass(Su, [{\n        key: \"populate\",\n        value: function populate(t, e, r, n) {\n          var i = this.layers[0],\n            s = [];\n          var a = null;\n          \"circle\" === i.type && (a = i.layout.get(\"circle-sort-key\"));\n          var _iterator69 = _createForOfIteratorHelper(t),\n            _step69;\n          try {\n            for (_iterator69.s(); !(_step69 = _iterator69.n()).done;) {\n              var _step69$value = _step69.value,\n                _e92 = _step69$value.feature,\n                _i60 = _step69$value.id,\n                _o14 = _step69$value.index,\n                _l13 = _step69$value.sourceLayerIndex;\n              var _t86 = this.layers[0]._featureFilter.needGeometry,\n                _u12 = wu(_e92, _t86);\n              if (!this.layers[0]._featureFilter.filter(new $s(this.zoom), _u12, r)) continue;\n              var _c8 = a ? a.evaluate(_u12, {}, r) : void 0,\n                _h4 = {\n                  id: _i60,\n                  properties: _e92.properties,\n                  type: _e92.type,\n                  sourceLayerIndex: _l13,\n                  index: _o14,\n                  geometry: _t86 ? _u12.geometry : bu(_e92, r, n),\n                  patterns: {},\n                  sortKey: _c8\n                };\n              s.push(_h4);\n            }\n          } catch (err) {\n            _iterator69.e(err);\n          } finally {\n            _iterator69.f();\n          }\n          a && s.sort(function (t, e) {\n            return t.sortKey - e.sortKey;\n          });\n          var o = null;\n          \"globe\" === n.projection.name && (this.globeExtVertexArray = new pa(), o = n.projection);\n          for (var _i58 = 0, _s35 = s; _i58 < _s35.length; _i58++) {\n            var _n54 = _s35[_i58];\n            var _i59 = _n54.geometry,\n              _s36 = _n54.index,\n              _a31 = _n54.sourceLayerIndex,\n              _l12 = t[_s36].feature;\n            this.addFeature(_n54, _i59, _s36, e.availableImages, r, o), e.featureIndex.insert(_l12, _i59, _s36, _a31, this.index);\n          }\n        }\n      }, {\n        key: \"update\",\n        value: function update(t, e, r, n) {\n          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);\n        }\n      }, {\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return 0 === this.layoutVertexArray.length;\n        }\n      }, {\n        key: \"uploadPending\",\n        value: function uploadPending() {\n          return !this.uploaded || this.programConfigurations.needsUpload;\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, _o.members), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.globeExtVertexArray && (this.globeExtVertexBuffer = t.createVertexBuffer(this.globeExtVertexArray, Ao.members))), this.programConfigurations.upload(t), this.uploaded = !0;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.globeExtVertexBuffer && this.globeExtVertexBuffer.destroy());\n        }\n      }, {\n        key: \"addFeature\",\n        value: function addFeature(t, e, r, n, i, s) {\n          var _iterator70 = _createForOfIteratorHelper(e),\n            _step70;\n          try {\n            for (_iterator70.s(); !(_step70 = _iterator70.n()).done;) {\n              var _r77 = _step70.value;\n              var _iterator71 = _createForOfIteratorHelper(_r77),\n                _step71;\n              try {\n                for (_iterator71.s(); !(_step71 = _iterator71.n()).done;) {\n                  var _e93 = _step71.value;\n                  var _r78 = _e93.x,\n                    _n55 = _e93.y;\n                  if (_r78 < 0 || _r78 >= ko || _n55 < 0 || _n55 >= ko) continue;\n                  if (s) {\n                    var _t87 = s.projectTilePoint(_r78, _n55, i),\n                      _e94 = s.upVector(i, _r78, _n55),\n                      _a32 = this.globeExtVertexArray;\n                    Au(_a32, _t87, _e94), Au(_a32, _t87, _e94), Au(_a32, _t87, _e94), Au(_a32, _t87, _e94);\n                  }\n                  var _a33 = this.segments.prepareSegment(4, this.layoutVertexArray, this.indexArray, t.sortKey),\n                    _o15 = _a33.vertexLength;\n                  _u(this.layoutVertexArray, _r78, _n55, -1, -1), _u(this.layoutVertexArray, _r78, _n55, 1, -1), _u(this.layoutVertexArray, _r78, _n55, 1, 1), _u(this.layoutVertexArray, _r78, _n55, -1, 1), this.indexArray.emplaceBack(_o15, _o15 + 1, _o15 + 2), this.indexArray.emplaceBack(_o15, _o15 + 2, _o15 + 3), _a33.vertexLength += 4, _a33.primitiveLength += 2;\n                }\n              } catch (err) {\n                _iterator71.e(err);\n              } finally {\n                _iterator71.f();\n              }\n            }\n          } catch (err) {\n            _iterator70.e(err);\n          } finally {\n            _iterator70.f();\n          }\n          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, {}, n, i);\n        }\n      }]);\n      return Su;\n    }();\n    function ku(t, e) {\n      for (var _r79 = 0; _r79 < t.length; _r79++) if (Du(e, t[_r79])) return !0;\n      for (var _r80 = 0; _r80 < e.length; _r80++) if (Du(t, e[_r80])) return !0;\n      return !!zu(t, e);\n    }\n    function Iu(t, e, r) {\n      return !!Du(t, e) || !!Eu(e, t, r);\n    }\n    function Mu(t, e) {\n      if (1 === t.length) return Pu(e, t[0]);\n      for (var _r81 = 0; _r81 < e.length; _r81++) {\n        var _n56 = e[_r81];\n        for (var _e95 = 0; _e95 < _n56.length; _e95++) if (Du(t, _n56[_e95])) return !0;\n      }\n      for (var _r82 = 0; _r82 < t.length; _r82++) if (Pu(e, t[_r82])) return !0;\n      for (var _r83 = 0; _r83 < e.length; _r83++) if (zu(t, e[_r83])) return !0;\n      return !1;\n    }\n    function Tu(t, e, r) {\n      if (t.length > 1) {\n        if (zu(t, e)) return !0;\n        for (var _n57 = 0; _n57 < e.length; _n57++) if (Eu(e[_n57], t, r)) return !0;\n      }\n      for (var _n58 = 0; _n58 < t.length; _n58++) if (Eu(t[_n58], e, r)) return !0;\n      return !1;\n    }\n    function zu(t, e) {\n      if (0 === t.length || 0 === e.length) return !1;\n      for (var _r84 = 0; _r84 < t.length - 1; _r84++) {\n        var _n59 = t[_r84],\n          _i61 = t[_r84 + 1];\n        for (var _t88 = 0; _t88 < e.length - 1; _t88++) if (Bu(_n59, _i61, e[_t88], e[_t88 + 1])) return !0;\n      }\n      return !1;\n    }\n    function Bu(t, e, r, n) {\n      return O(t, r, n) !== O(e, r, n) && O(t, e, r) !== O(t, e, n);\n    }\n    function Eu(t, e, r) {\n      var n = r * r;\n      if (1 === e.length) return t.distSqr(e[0]) < n;\n      for (var _r85 = 1; _r85 < e.length; _r85++) if (Cu(t, e[_r85 - 1], e[_r85]) < n) return !0;\n      return !1;\n    }\n    function Cu(t, e, r) {\n      var n = e.distSqr(r);\n      if (0 === n) return t.distSqr(e);\n      var i = ((t.x - e.x) * (r.x - e.x) + (t.y - e.y) * (r.y - e.y)) / n;\n      return t.distSqr(i < 0 ? e : i > 1 ? r : r.sub(e)._mult(i)._add(e));\n    }\n    function Pu(t, e) {\n      var r,\n        n,\n        i,\n        s = !1;\n      for (var _a34 = 0; _a34 < t.length; _a34++) {\n        r = t[_a34];\n        for (var _t89 = 0, _a35 = r.length - 1; _t89 < r.length; _a35 = _t89++) n = r[_t89], i = r[_a35], n.y > e.y != i.y > e.y && e.x < (i.x - n.x) * (e.y - n.y) / (i.y - n.y) + n.x && (s = !s);\n      }\n      return s;\n    }\n    function Du(t, e) {\n      var r = !1;\n      for (var _n60 = 0, _i62 = t.length - 1; _n60 < t.length; _i62 = _n60++) {\n        var _s37 = t[_n60],\n          _a36 = t[_i62];\n        _s37.y > e.y != _a36.y > e.y && e.x < (_a36.x - _s37.x) * (e.y - _s37.y) / (_a36.y - _s37.y) + _s37.x && (r = !r);\n      }\n      return r;\n    }\n    function Vu(t, e, r, n, i) {\n      var _iterator72 = _createForOfIteratorHelper(t),\n        _step72;\n      try {\n        for (_iterator72.s(); !(_step72 = _iterator72.n()).done;) {\n          var _s38 = _step72.value;\n          if (e <= _s38.x && r <= _s38.y && n >= _s38.x && i >= _s38.y) return !0;\n        }\n      } catch (err) {\n        _iterator72.e(err);\n      } finally {\n        _iterator72.f();\n      }\n      var s = [new d(e, r), new d(e, i), new d(n, i), new d(n, r)];\n      if (t.length > 2) {\n        var _iterator73 = _createForOfIteratorHelper(s),\n          _step73;\n        try {\n          for (_iterator73.s(); !(_step73 = _iterator73.n()).done;) {\n            var _e96 = _step73.value;\n            if (Du(t, _e96)) return !0;\n          }\n        } catch (err) {\n          _iterator73.e(err);\n        } finally {\n          _iterator73.f();\n        }\n      }\n      for (var _e97 = 0; _e97 < t.length - 1; _e97++) if (Lu(t[_e97], t[_e97 + 1], s)) return !0;\n      return !1;\n    }\n    function Lu(t, e, r) {\n      var n = r[0],\n        i = r[2];\n      if (t.x < n.x && e.x < n.x || t.x > i.x && e.x > i.x || t.y < n.y && e.y < n.y || t.y > i.y && e.y > i.y) return !1;\n      var s = O(t, e, r[0]);\n      return s !== O(t, e, r[1]) || s !== O(t, e, r[2]) || s !== O(t, e, r[3]);\n    }\n    function Fu(t, e, r) {\n      var n = e.paint.get(t).value;\n      return \"constant\" === n.kind ? n.value : r.programConfigurations.get(e.id).getMaxValue(t);\n    }\n    function Ru(t) {\n      return Math.sqrt(t[0] * t[0] + t[1] * t[1]);\n    }\n    function ju(t, e, r, n, i) {\n      if (!e[0] && !e[1]) return t;\n      var s = d.convert(e)._mult(i);\n      \"viewport\" === r && s._rotate(-n);\n      var a = [];\n      for (var _e98 = 0; _e98 < t.length; _e98++) a.push(t[_e98].sub(s));\n      return a;\n    }\n    function $u(t, e, r, n) {\n      var i = d.convert(t)._mult(n);\n      return \"viewport\" === e && i._rotate(-r), i;\n    }\n    Oi(Su, \"CircleBucket\", {\n      omit: [\"layers\"]\n    });\n    var Uu = new Js({\n      \"circle-sort-key\": new Hs(Ht.layout_circle[\"circle-sort-key\"])\n    });\n    var Ou = {\n      paint: new Js({\n        \"circle-radius\": new Hs(Ht.paint_circle[\"circle-radius\"]),\n        \"circle-color\": new Hs(Ht.paint_circle[\"circle-color\"]),\n        \"circle-blur\": new Hs(Ht.paint_circle[\"circle-blur\"]),\n        \"circle-opacity\": new Hs(Ht.paint_circle[\"circle-opacity\"]),\n        \"circle-translate\": new Ys(Ht.paint_circle[\"circle-translate\"]),\n        \"circle-translate-anchor\": new Ys(Ht.paint_circle[\"circle-translate-anchor\"]),\n        \"circle-pitch-scale\": new Ys(Ht.paint_circle[\"circle-pitch-scale\"]),\n        \"circle-pitch-alignment\": new Ys(Ht.paint_circle[\"circle-pitch-alignment\"]),\n        \"circle-stroke-width\": new Hs(Ht.paint_circle[\"circle-stroke-width\"]),\n        \"circle-stroke-color\": new Hs(Ht.paint_circle[\"circle-stroke-color\"]),\n        \"circle-stroke-opacity\": new Hs(Ht.paint_circle[\"circle-stroke-opacity\"])\n      }),\n      layout: Uu\n    };\n    function qu(t, e, r, n, i, s, a, o, l) {\n      if (s && t.queryGeometry.isAboveHorizon) return !1;\n      s && (l *= t.pixelToTileUnitsFactor);\n      var u = t.tileID.canonical,\n        c = r.projection.upVectorScale(u, r.center.lat, r.worldSize).metersToTile;\n      var _iterator74 = _createForOfIteratorHelper(e),\n        _step74;\n      try {\n        for (_iterator74.s(); !(_step74 = _iterator74.n()).done;) {\n          var _h5 = _step74.value;\n          var _iterator75 = _createForOfIteratorHelper(_h5),\n            _step75;\n          try {\n            var _loop2 = function _loop2() {\n              var e = _step75.value;\n              var h = e.add(o),\n                p = i && r.elevation ? r.elevation.exaggeration() * i.getElevationAt(h.x, h.y, !0) : 0,\n                f = r.projection.projectTilePoint(h.x, h.y, u);\n              if (p > 0) {\n                var _t90 = r.projection.upVector(u, h.x, h.y);\n                f.x += _t90[0] * c * p, f.y += _t90[1] * c * p, f.z += _t90[2] * c * p;\n              }\n              var d = s ? h : Nu(f.x, f.y, f.z, n),\n                y = s ? t.tilespaceRays.map(function (t) {\n                  return Xu(t, p);\n                }) : t.queryGeometry.screenGeometry,\n                m = ul([], [f.x, f.y, f.z, 1], n);\n              if (!a && s ? l *= m[3] / r.cameraToCenterDistance : a && !s && (l *= r.cameraToCenterDistance / m[3]), s) {\n                var _t91 = lu((e.y / ko + u.y) / (1 << u.z));\n                l /= r.projection.pixelsPerMeter(_t91, 1) / au(1, _t91);\n              }\n              if (Iu(y, d, l)) return {\n                v: !0\n              };\n            };\n            for (_iterator75.s(); !(_step75 = _iterator75.n()).done;) {\n              var _ret = _loop2();\n              if (typeof _ret === \"object\") return _ret.v;\n            }\n          } catch (err) {\n            _iterator75.e(err);\n          } finally {\n            _iterator75.f();\n          }\n        }\n      } catch (err) {\n        _iterator74.e(err);\n      } finally {\n        _iterator74.f();\n      }\n      return !1;\n    }\n    function Nu(t, e, r, n) {\n      var i = ul([], [t, e, r, 1], n);\n      return new d(i[0] / i[3], i[1] / i[3]);\n    }\n    var Gu = No(0, 0, 0),\n      Zu = No(0, 0, 1);\n    function Xu(t, e) {\n      var r = Uo();\n      return Gu[2] = e, t.intersectsPlane(Gu, Zu, r), new d(r[0], r[1]);\n    }\n    var Ku = /*#__PURE__*/function (_Su) {\n      _inherits(Ku, _Su);\n      function Ku() {\n        _classCallCheck(this, Ku);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ku).apply(this, arguments));\n      }\n      return Ku;\n    }(Su);\n    function Yu(t, _ref115, n, i) {\n      var e = _ref115.width,\n        r = _ref115.height;\n      if (i) {\n        if (i instanceof Uint8ClampedArray) i = new Uint8Array(i.buffer);else if (i.length !== e * r * n) throw new RangeError(\"mismatched image size\");\n      } else i = new Uint8Array(e * r * n);\n      return t.width = e, t.height = r, t.data = i, t;\n    }\n    function Hu(t, e, r) {\n      var n = e.width,\n        i = e.height;\n      n === t.width && i === t.height || (Wu(t, e, {\n        x: 0,\n        y: 0\n      }, {\n        x: 0,\n        y: 0\n      }, {\n        width: Math.min(t.width, n),\n        height: Math.min(t.height, i)\n      }, r), t.width = n, t.height = i, t.data = e.data);\n    }\n    function Wu(t, e, r, n, i, s) {\n      if (0 === i.width || 0 === i.height) return e;\n      if (i.width > t.width || i.height > t.height || r.x > t.width - i.width || r.y > t.height - i.height) throw new RangeError(\"out of range source coordinates for image copy\");\n      if (i.width > e.width || i.height > e.height || n.x > e.width - i.width || n.y > e.height - i.height) throw new RangeError(\"out of range destination coordinates for image copy\");\n      var a = t.data,\n        o = e.data;\n      for (var _l14 = 0; _l14 < i.height; _l14++) {\n        var _u13 = ((r.y + _l14) * t.width + r.x) * s,\n          _c9 = ((n.y + _l14) * e.width + n.x) * s;\n        for (var _t92 = 0; _t92 < i.width * s; _t92++) o[_c9 + _t92] = a[_u13 + _t92];\n      }\n      return e;\n    }\n    Oi(Ku, \"HeatmapBucket\", {\n      omit: [\"layers\"]\n    });\n    var Ju = /*#__PURE__*/function () {\n      function Ju(t, e) {\n        _classCallCheck(this, Ju);\n        Yu(this, t, 1, e);\n      }\n      _createClass(Ju, [{\n        key: \"resize\",\n        value: function resize(t) {\n          Hu(this, new Ju(t), 1);\n        }\n      }, {\n        key: \"clone\",\n        value: function clone() {\n          return new Ju({\n            width: this.width,\n            height: this.height\n          }, new Uint8Array(this.data));\n        }\n      }], [{\n        key: \"copy\",\n        value: function copy(t, e, r, n, i) {\n          Wu(t, e, r, n, i, 1);\n        }\n      }]);\n      return Ju;\n    }();\n    var Qu = /*#__PURE__*/function () {\n      function Qu(t, e) {\n        _classCallCheck(this, Qu);\n        Yu(this, t, 4, e);\n      }\n      _createClass(Qu, [{\n        key: \"resize\",\n        value: function resize(t) {\n          Hu(this, new Qu(t), 4);\n        }\n      }, {\n        key: \"replace\",\n        value: function replace(t, e) {\n          e ? this.data.set(t) : this.data = t instanceof Uint8ClampedArray ? new Uint8Array(t.buffer) : t;\n        }\n      }, {\n        key: \"clone\",\n        value: function clone() {\n          return new Qu({\n            width: this.width,\n            height: this.height\n          }, new Uint8Array(this.data));\n        }\n      }], [{\n        key: \"copy\",\n        value: function copy(t, e, r, n, i) {\n          Wu(t, e, r, n, i, 4);\n        }\n      }]);\n      return Qu;\n    }();\n    Oi(Ju, \"AlphaImage\"), Oi(Qu, \"RGBAImage\");\n    var tc = {\n      paint: new Js({\n        \"heatmap-radius\": new Hs(Ht.paint_heatmap[\"heatmap-radius\"]),\n        \"heatmap-weight\": new Hs(Ht.paint_heatmap[\"heatmap-weight\"]),\n        \"heatmap-intensity\": new Ys(Ht.paint_heatmap[\"heatmap-intensity\"]),\n        \"heatmap-color\": new Ws(Ht.paint_heatmap[\"heatmap-color\"]),\n        \"heatmap-opacity\": new Ys(Ht.paint_heatmap[\"heatmap-opacity\"])\n      })\n    };\n    function ec(t) {\n      var e = {},\n        r = t.resolution || 256,\n        n = t.clips ? t.clips.length : 1,\n        i = t.image || new Qu({\n          width: r,\n          height: n\n        }),\n        s = function s(r, n, _s39) {\n          e[t.evaluationKey] = _s39;\n          var a = t.expression.evaluate(e);\n          i.data[r + n + 0] = Math.floor(255 * a.r / a.a), i.data[r + n + 1] = Math.floor(255 * a.g / a.a), i.data[r + n + 2] = Math.floor(255 * a.b / a.a), i.data[r + n + 3] = Math.floor(255 * a.a);\n        };\n      if (t.clips) for (var _e99 = 0, _i63 = 0; _e99 < n; ++_e99, _i63 += 4 * r) for (var _n61 = 0, _a37 = 0; _n61 < r; _n61++, _a37 += 4) {\n        var _o16 = _n61 / (r - 1),\n          _t$clips$_e = t.clips[_e99],\n          _l15 = _t$clips$_e.start,\n          _u14 = _t$clips$_e.end;\n        s(_i63, _a37, _l15 * (1 - _o16) + _u14 * _o16);\n      } else for (var _t93 = 0, _e100 = 0; _t93 < r; _t93++, _e100 += 4) s(0, _e100, _t93 / (r - 1));\n      return i;\n    }\n    var rc = {\n      paint: new Js({\n        \"hillshade-illumination-direction\": new Ys(Ht.paint_hillshade[\"hillshade-illumination-direction\"]),\n        \"hillshade-illumination-anchor\": new Ys(Ht.paint_hillshade[\"hillshade-illumination-anchor\"]),\n        \"hillshade-exaggeration\": new Ys(Ht.paint_hillshade[\"hillshade-exaggeration\"]),\n        \"hillshade-shadow-color\": new Ys(Ht.paint_hillshade[\"hillshade-shadow-color\"]),\n        \"hillshade-highlight-color\": new Ys(Ht.paint_hillshade[\"hillshade-highlight-color\"]),\n        \"hillshade-accent-color\": new Ys(Ht.paint_hillshade[\"hillshade-accent-color\"])\n      })\n    };\n    var nc = na([{\n        name: \"a_pos\",\n        components: 2,\n        type: \"Int16\"\n      }], 4),\n      ic = nc.members;\n    var sc = {};\n    function ac(t, e, r) {\n      r = r || 2;\n      var n,\n        i,\n        s,\n        a,\n        o,\n        l,\n        u,\n        c = e && e.length,\n        h = c ? e[0] * r : t.length,\n        p = oc(t, 0, h, r, !0),\n        f = [];\n      if (!p || p.next === p.prev) return f;\n      if (c && (p = function (t, e, r, n) {\n        var i,\n          s,\n          a,\n          o = [];\n        for (i = 0, s = e.length; i < s; i++) (a = oc(t, e[i] * n, i < s - 1 ? e[i + 1] * n : t.length, n, !1)) === a.next && (a.steiner = !0), o.push(xc(a));\n        for (o.sort(dc), i = 0; i < o.length; i++) r = yc(o[i], r);\n        return r;\n      }(t, e, p, r)), t.length > 80 * r) {\n        n = s = t[0], i = a = t[1];\n        for (var d = r; d < h; d += r) (o = t[d]) < n && (n = o), (l = t[d + 1]) < i && (i = l), o > s && (s = o), l > a && (a = l);\n        u = 0 !== (u = Math.max(s - n, a - i)) ? 32767 / u : 0;\n      }\n      return uc(p, f, r, n, i, u, 0), f;\n    }\n    function oc(t, e, r, n, i) {\n      var s, a;\n      if (i === Ec(t, e, r, n) > 0) for (s = e; s < r; s += n) a = Tc(s, t[s], t[s + 1], a);else for (s = r - n; s >= e; s -= n) a = Tc(s, t[s], t[s + 1], a);\n      return a && _c(a, a.next) && (zc(a), a = a.next), a;\n    }\n    function lc(t, e) {\n      if (!t) return t;\n      e || (e = t);\n      var r,\n        n = t;\n      do {\n        if (r = !1, n.steiner || !_c(n, n.next) && 0 !== wc(n.prev, n, n.next)) n = n.next;else {\n          if (zc(n), (n = e = n.prev) === n.next) break;\n          r = !0;\n        }\n      } while (r || n !== e);\n      return e;\n    }\n    function uc(t, e, r, n, i, s, a) {\n      if (t) {\n        !a && s && function (t, e, r, n) {\n          var i = t;\n          do {\n            0 === i.z && (i.z = gc(i.x, i.y, e, r, n)), i.prevZ = i.prev, i.nextZ = i.next, i = i.next;\n          } while (i !== t);\n          i.prevZ.nextZ = null, i.prevZ = null, function (t) {\n            var e,\n              r,\n              n,\n              i,\n              s,\n              a,\n              o,\n              l,\n              u = 1;\n            do {\n              for (r = t, t = null, s = null, a = 0; r;) {\n                for (a++, n = r, o = 0, e = 0; e < u && (o++, n = n.nextZ); e++);\n                for (l = u; o > 0 || l > 0 && n;) 0 !== o && (0 === l || !n || r.z <= n.z) ? (i = r, r = r.nextZ, o--) : (i = n, n = n.nextZ, l--), s ? s.nextZ = i : t = i, i.prevZ = s, s = i;\n                r = n;\n              }\n              s.nextZ = null, u *= 2;\n            } while (a > 1);\n          }(i);\n        }(t, n, i, s);\n        for (var o, l, u = t; t.prev !== t.next;) if (o = t.prev, l = t.next, s ? hc(t, n, i, s) : cc(t)) e.push(o.i / r | 0), e.push(t.i / r | 0), e.push(l.i / r | 0), zc(t), t = l.next, u = l.next;else if ((t = l) === u) {\n          a ? 1 === a ? uc(t = pc(lc(t), e, r), e, r, n, i, s, 2) : 2 === a && fc(t, e, r, n, i, s) : uc(lc(t), e, r, n, i, s, 1);\n          break;\n        }\n      }\n    }\n    function cc(t) {\n      var e = t.prev,\n        r = t,\n        n = t.next;\n      if (wc(e, r, n) >= 0) return !1;\n      for (var i = e.x, s = r.x, a = n.x, o = e.y, l = r.y, u = n.y, c = i < s ? i < a ? i : a : s < a ? s : a, h = o < l ? o < u ? o : u : l < u ? l : u, p = i > s ? i > a ? i : a : s > a ? s : a, f = o > l ? o > u ? o : u : l > u ? l : u, d = n.next; d !== e;) {\n        if (d.x >= c && d.x <= p && d.y >= h && d.y <= f && vc(i, o, s, l, a, u, d.x, d.y) && wc(d.prev, d, d.next) >= 0) return !1;\n        d = d.next;\n      }\n      return !0;\n    }\n    function hc(t, e, r, n) {\n      var i = t.prev,\n        s = t,\n        a = t.next;\n      if (wc(i, s, a) >= 0) return !1;\n      for (var o = i.x, l = s.x, u = a.x, c = i.y, h = s.y, p = a.y, f = o < l ? o < u ? o : u : l < u ? l : u, d = c < h ? c < p ? c : p : h < p ? h : p, y = o > l ? o > u ? o : u : l > u ? l : u, m = c > h ? c > p ? c : p : h > p ? h : p, g = gc(f, d, e, r, n), x = gc(y, m, e, r, n), v = t.prevZ, b = t.nextZ; v && v.z >= g && b && b.z <= x;) {\n        if (v.x >= f && v.x <= y && v.y >= d && v.y <= m && v !== i && v !== a && vc(o, c, l, h, u, p, v.x, v.y) && wc(v.prev, v, v.next) >= 0) return !1;\n        if (v = v.prevZ, b.x >= f && b.x <= y && b.y >= d && b.y <= m && b !== i && b !== a && vc(o, c, l, h, u, p, b.x, b.y) && wc(b.prev, b, b.next) >= 0) return !1;\n        b = b.nextZ;\n      }\n      for (; v && v.z >= g;) {\n        if (v.x >= f && v.x <= y && v.y >= d && v.y <= m && v !== i && v !== a && vc(o, c, l, h, u, p, v.x, v.y) && wc(v.prev, v, v.next) >= 0) return !1;\n        v = v.prevZ;\n      }\n      for (; b && b.z <= x;) {\n        if (b.x >= f && b.x <= y && b.y >= d && b.y <= m && b !== i && b !== a && vc(o, c, l, h, u, p, b.x, b.y) && wc(b.prev, b, b.next) >= 0) return !1;\n        b = b.nextZ;\n      }\n      return !0;\n    }\n    function pc(t, e, r) {\n      var n = t;\n      do {\n        var i = n.prev,\n          s = n.next.next;\n        !_c(i, s) && Ac(i, n, n.next, s) && Ic(i, s) && Ic(s, i) && (e.push(i.i / r | 0), e.push(n.i / r | 0), e.push(s.i / r | 0), zc(n), zc(n.next), n = t = s), n = n.next;\n      } while (n !== t);\n      return lc(n);\n    }\n    function fc(t, e, r, n, i, s) {\n      var a = t;\n      do {\n        for (var o = a.next.next; o !== a.prev;) {\n          if (a.i !== o.i && bc(a, o)) {\n            var l = Mc(a, o);\n            return a = lc(a, a.next), l = lc(l, l.next), uc(a, e, r, n, i, s, 0), void uc(l, e, r, n, i, s, 0);\n          }\n          o = o.next;\n        }\n        a = a.next;\n      } while (a !== t);\n    }\n    function dc(t, e) {\n      return t.x - e.x;\n    }\n    function yc(t, e) {\n      var r = function (t, e) {\n        var r,\n          n = e,\n          i = t.x,\n          s = t.y,\n          a = -1 / 0;\n        do {\n          if (s <= n.y && s >= n.next.y && n.next.y !== n.y) {\n            var o = n.x + (s - n.y) * (n.next.x - n.x) / (n.next.y - n.y);\n            if (o <= i && o > a && (a = o, r = n.x < n.next.x ? n : n.next, o === i)) return r;\n          }\n          n = n.next;\n        } while (n !== e);\n        if (!r) return null;\n        var l,\n          u = r,\n          c = r.x,\n          h = r.y,\n          p = 1 / 0;\n        n = r;\n        do {\n          i >= n.x && n.x >= c && i !== n.x && vc(s < h ? i : a, s, c, h, s < h ? a : i, s, n.x, n.y) && (l = Math.abs(s - n.y) / (i - n.x), Ic(n, t) && (l < p || l === p && (n.x > r.x || n.x === r.x && mc(r, n))) && (r = n, p = l)), n = n.next;\n        } while (n !== u);\n        return r;\n      }(t, e);\n      if (!r) return e;\n      var n = Mc(r, t);\n      return lc(n, n.next), lc(r, r.next);\n    }\n    function mc(t, e) {\n      return wc(t.prev, t, e.prev) < 0 && wc(e.next, t, t.next) < 0;\n    }\n    function gc(t, e, r, n, i) {\n      return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = (t - r) * i | 0) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = (e - n) * i | 0) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1;\n    }\n    function xc(t) {\n      var e = t,\n        r = t;\n      do {\n        (e.x < r.x || e.x === r.x && e.y < r.y) && (r = e), e = e.next;\n      } while (e !== t);\n      return r;\n    }\n    function vc(t, e, r, n, i, s, a, o) {\n      return (i - a) * (e - o) >= (t - a) * (s - o) && (t - a) * (n - o) >= (r - a) * (e - o) && (r - a) * (s - o) >= (i - a) * (n - o);\n    }\n    function bc(t, e) {\n      return t.next.i !== e.i && t.prev.i !== e.i && !function (t, e) {\n        var r = t;\n        do {\n          if (r.i !== t.i && r.next.i !== t.i && r.i !== e.i && r.next.i !== e.i && Ac(r, r.next, t, e)) return !0;\n          r = r.next;\n        } while (r !== t);\n        return !1;\n      }(t, e) && (Ic(t, e) && Ic(e, t) && function (t, e) {\n        var r = t,\n          n = !1,\n          i = (t.x + e.x) / 2,\n          s = (t.y + e.y) / 2;\n        do {\n          r.y > s != r.next.y > s && r.next.y !== r.y && i < (r.next.x - r.x) * (s - r.y) / (r.next.y - r.y) + r.x && (n = !n), r = r.next;\n        } while (r !== t);\n        return n;\n      }(t, e) && (wc(t.prev, t, e.prev) || wc(t, e.prev, e)) || _c(t, e) && wc(t.prev, t, t.next) > 0 && wc(e.prev, e, e.next) > 0);\n    }\n    function wc(t, e, r) {\n      return (e.y - t.y) * (r.x - e.x) - (e.x - t.x) * (r.y - e.y);\n    }\n    function _c(t, e) {\n      return t.x === e.x && t.y === e.y;\n    }\n    function Ac(t, e, r, n) {\n      var i = kc(wc(t, e, r)),\n        s = kc(wc(t, e, n)),\n        a = kc(wc(r, n, t)),\n        o = kc(wc(r, n, e));\n      return i !== s && a !== o || !(0 !== i || !Sc(t, r, e)) || !(0 !== s || !Sc(t, n, e)) || !(0 !== a || !Sc(r, t, n)) || !(0 !== o || !Sc(r, e, n));\n    }\n    function Sc(t, e, r) {\n      return e.x <= Math.max(t.x, r.x) && e.x >= Math.min(t.x, r.x) && e.y <= Math.max(t.y, r.y) && e.y >= Math.min(t.y, r.y);\n    }\n    function kc(t) {\n      return t > 0 ? 1 : t < 0 ? -1 : 0;\n    }\n    function Ic(t, e) {\n      return wc(t.prev, t, t.next) < 0 ? wc(t, e, t.next) >= 0 && wc(t, t.prev, e) >= 0 : wc(t, e, t.prev) < 0 || wc(t, t.next, e) < 0;\n    }\n    function Mc(t, e) {\n      var r = new Bc(t.i, t.x, t.y),\n        n = new Bc(e.i, e.x, e.y),\n        i = t.next,\n        s = e.prev;\n      return t.next = e, e.prev = t, r.next = i, i.prev = r, n.next = r, r.prev = n, s.next = n, n.prev = s, n;\n    }\n    function Tc(t, e, r, n) {\n      var i = new Bc(t, e, r);\n      return n ? (i.next = n.next, i.prev = n, n.next.prev = i, n.next = i) : (i.prev = i, i.next = i), i;\n    }\n    function zc(t) {\n      t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ);\n    }\n    function Bc(t, e, r) {\n      this.i = t, this.x = e, this.y = r, this.prev = null, this.next = null, this.z = 0, this.prevZ = null, this.nextZ = null, this.steiner = !1;\n    }\n    function Ec(t, e, r, n) {\n      for (var i = 0, s = e, a = r - n; s < r; s += n) i += (t[a] - t[s]) * (t[s + 1] + t[a + 1]), a = s;\n      return i;\n    }\n    function Cc(t, e, r, n, i) {\n      Pc(t, e, r || 0, n || t.length - 1, i || Vc);\n    }\n    function Pc(t, e, r, n, i) {\n      for (; n > r;) {\n        if (n - r > 600) {\n          var s = n - r + 1,\n            a = e - r + 1,\n            o = Math.log(s),\n            l = .5 * Math.exp(2 * o / 3),\n            u = .5 * Math.sqrt(o * l * (s - l) / s) * (a - s / 2 < 0 ? -1 : 1);\n          Pc(t, e, Math.max(r, Math.floor(e - a * l / s + u)), Math.min(n, Math.floor(e + (s - a) * l / s + u)), i);\n        }\n        var c = t[e],\n          h = r,\n          p = n;\n        for (Dc(t, r, e), i(t[n], c) > 0 && Dc(t, r, n); h < p;) {\n          for (Dc(t, h, p), h++, p--; i(t[h], c) < 0;) h++;\n          for (; i(t[p], c) > 0;) p--;\n        }\n        0 === i(t[r], c) ? Dc(t, r, p) : Dc(t, ++p, n), p <= e && (r = p + 1), e <= p && (n = p - 1);\n      }\n    }\n    function Dc(t, e, r) {\n      var n = t[e];\n      t[e] = t[r], t[r] = n;\n    }\n    function Vc(t, e) {\n      return t < e ? -1 : t > e ? 1 : 0;\n    }\n    function Lc(t, e) {\n      var r = t.length;\n      if (r <= 1) return [t];\n      var n = [];\n      var i, s;\n      for (var _e101 = 0; _e101 < r; _e101++) {\n        var _r86 = q(t[_e101]);\n        0 !== _r86 && (t[_e101].area = Math.abs(_r86), void 0 === s && (s = _r86 < 0), s === _r86 < 0 ? (i && n.push(i), i = [t[_e101]]) : i.push(t[_e101]));\n      }\n      if (i && n.push(i), e > 1) for (var _t94 = 0; _t94 < n.length; _t94++) n[_t94].length <= e || (Cc(n[_t94], e, 1, n[_t94].length - 1, Fc), n[_t94] = n[_t94].slice(0, e));\n      return n;\n    }\n    function Fc(t, e) {\n      return e.area - t.area;\n    }\n    function Rc(t, e, r) {\n      var n = r.patternDependencies;\n      var i = !1;\n      var _iterator76 = _createForOfIteratorHelper(e),\n        _step76;\n      try {\n        for (_iterator76.s(); !(_step76 = _iterator76.n()).done;) {\n          var _r87 = _step76.value;\n          var _e102 = _r87.paint.get(\"\".concat(t, \"-pattern\"));\n          _e102.isConstant() || (i = !0);\n          var _s40 = _e102.constantOr(null);\n          _s40 && (i = !0, n[_s40] = !0);\n        }\n      } catch (err) {\n        _iterator76.e(err);\n      } finally {\n        _iterator76.f();\n      }\n      return i;\n    }\n    function jc(t, e, r, n, i) {\n      var s = i.patternDependencies;\n      var _iterator77 = _createForOfIteratorHelper(e),\n        _step77;\n      try {\n        for (_iterator77.s(); !(_step77 = _iterator77.n()).done;) {\n          var _a38 = _step77.value;\n          var _e103 = _a38.paint.get(\"\".concat(t, \"-pattern\")).value;\n          if (\"constant\" !== _e103.kind) {\n            var _t95 = _e103.evaluate({\n              zoom: n\n            }, r, {}, i.availableImages);\n            _t95 = _t95 && _t95.name ? _t95.name : _t95, s[_t95] = !0, r.patterns[_a38.id] = _t95;\n          }\n        }\n      } catch (err) {\n        _iterator77.e(err);\n      } finally {\n        _iterator77.f();\n      }\n      return r;\n    }\n    ({\n      get exports() {\n        return sc;\n      },\n      set exports(t) {\n        sc = t;\n      }\n    }).exports = ac, sc.default = ac, ac.deviation = function (t, e, r, n) {\n      var i = e && e.length,\n        s = Math.abs(Ec(t, 0, i ? e[0] * r : t.length, r));\n      if (i) for (var a = 0, o = e.length; a < o; a++) s -= Math.abs(Ec(t, e[a] * r, a < o - 1 ? e[a + 1] * r : t.length, r));\n      var l = 0;\n      for (a = 0; a < n.length; a += 3) {\n        var u = n[a] * r,\n          c = n[a + 1] * r,\n          h = n[a + 2] * r;\n        l += Math.abs((t[u] - t[h]) * (t[c + 1] - t[u + 1]) - (t[u] - t[c]) * (t[h + 1] - t[u + 1]));\n      }\n      return 0 === s && 0 === l ? 0 : Math.abs((l - s) / s);\n    }, ac.flatten = function (t) {\n      for (var e = t[0][0].length, r = {\n          vertices: [],\n          holes: [],\n          dimensions: e\n        }, n = 0, i = 0; i < t.length; i++) {\n        for (var s = 0; s < t[i].length; s++) for (var a = 0; a < e; a++) r.vertices.push(t[i][s][a]);\n        i > 0 && r.holes.push(n += t[i - 1].length);\n      }\n      return r;\n    };\n    var $c = /*#__PURE__*/function () {\n      function $c(t) {\n        _classCallCheck(this, $c);\n        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {\n          return t.id;\n        }), this.index = t.index, this.hasPattern = !1, this.patternFeatures = [], this.layoutVertexArray = new sa(), this.indexArray = new wa(), this.indexArray2 = new Ma(), this.programConfigurations = new fo(t.layers, t.zoom), this.segments = new So(), this.segments2 = new So(), this.stateDependentLayerIds = this.layers.filter(function (t) {\n          return t.isStateDependent();\n        }).map(function (t) {\n          return t.id;\n        }), this.projection = t.projection;\n      }\n      _createClass($c, [{\n        key: \"populate\",\n        value: function populate(t, e, r, n) {\n          this.hasPattern = Rc(\"fill\", this.layers, e);\n          var i = this.layers[0].layout.get(\"fill-sort-key\"),\n            s = [];\n          var _iterator78 = _createForOfIteratorHelper(t),\n            _step78;\n          try {\n            for (_iterator78.s(); !(_step78 = _iterator78.n()).done;) {\n              var _step78$value = _step78.value,\n                _a40 = _step78$value.feature,\n                _o17 = _step78$value.id,\n                _l16 = _step78$value.index,\n                _u15 = _step78$value.sourceLayerIndex;\n              var _t97 = this.layers[0]._featureFilter.needGeometry,\n                _c10 = wu(_a40, _t97);\n              if (!this.layers[0]._featureFilter.filter(new $s(this.zoom), _c10, r)) continue;\n              var _h6 = i ? i.evaluate(_c10, {}, r, e.availableImages) : void 0,\n                _p3 = {\n                  id: _o17,\n                  properties: _a40.properties,\n                  type: _a40.type,\n                  sourceLayerIndex: _u15,\n                  index: _l16,\n                  geometry: _t97 ? _c10.geometry : bu(_a40, r, n),\n                  patterns: {},\n                  sortKey: _h6\n                };\n              s.push(_p3);\n            }\n          } catch (err) {\n            _iterator78.e(err);\n          } finally {\n            _iterator78.f();\n          }\n          i && s.sort(function (t, e) {\n            return t.sortKey - e.sortKey;\n          });\n          for (var _i64 = 0, _s41 = s; _i64 < _s41.length; _i64++) {\n            var _n62 = _s41[_i64];\n            var _i65 = _n62.geometry,\n              _s42 = _n62.index,\n              _a39 = _n62.sourceLayerIndex;\n            if (this.hasPattern) {\n              var _t96 = jc(\"fill\", this.layers, _n62, this.zoom, e);\n              this.patternFeatures.push(_t96);\n            } else this.addFeature(_n62, _i65, _s42, r, {}, e.availableImages);\n            e.featureIndex.insert(t[_s42].feature, _i65, _s42, _a39, this.index);\n          }\n        }\n      }, {\n        key: \"update\",\n        value: function update(t, e, r, n) {\n          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);\n        }\n      }, {\n        key: \"addFeatures\",\n        value: function addFeatures(t, e, r, n, i) {\n          var _iterator79 = _createForOfIteratorHelper(this.patternFeatures),\n            _step79;\n          try {\n            for (_iterator79.s(); !(_step79 = _iterator79.n()).done;) {\n              var _t98 = _step79.value;\n              this.addFeature(_t98, _t98.geometry, _t98.index, e, r, n);\n            }\n          } catch (err) {\n            _iterator79.e(err);\n          } finally {\n            _iterator79.f();\n          }\n        }\n      }, {\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return 0 === this.layoutVertexArray.length;\n        }\n      }, {\n        key: \"uploadPending\",\n        value: function uploadPending() {\n          return !this.uploaded || this.programConfigurations.needsUpload;\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, ic), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.indexBuffer2 = t.createIndexBuffer(this.indexArray2)), this.programConfigurations.upload(t), this.uploaded = !0;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.indexBuffer2.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.segments2.destroy());\n        }\n      }, {\n        key: \"addFeature\",\n        value: function addFeature(t, e, r, n, i) {\n          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : [];\n          var _iterator80 = _createForOfIteratorHelper(Lc(e, 500)),\n            _step80;\n          try {\n            for (_iterator80.s(); !(_step80 = _iterator80.n()).done;) {\n              var _t99 = _step80.value;\n              var _e104 = 0;\n              var _iterator81 = _createForOfIteratorHelper(_t99),\n                _step81;\n              try {\n                for (_iterator81.s(); !(_step81 = _iterator81.n()).done;) {\n                  var _r89 = _step81.value;\n                  _e104 += _r89.length;\n                }\n              } catch (err) {\n                _iterator81.e(err);\n              } finally {\n                _iterator81.f();\n              }\n              var _r88 = this.segments.prepareSegment(_e104, this.layoutVertexArray, this.indexArray),\n                _n63 = _r88.vertexLength,\n                _i66 = [],\n                _s43 = [];\n              var _iterator82 = _createForOfIteratorHelper(_t99),\n                _step82;\n              try {\n                for (_iterator82.s(); !(_step82 = _iterator82.n()).done;) {\n                  var _e105 = _step82.value;\n                  if (0 === _e105.length) continue;\n                  _e105 !== _t99[0] && _s43.push(_i66.length / 2);\n                  var _r90 = this.segments2.prepareSegment(_e105.length, this.layoutVertexArray, this.indexArray2),\n                    _n64 = _r90.vertexLength;\n                  this.layoutVertexArray.emplaceBack(_e105[0].x, _e105[0].y), this.indexArray2.emplaceBack(_n64 + _e105.length - 1, _n64), _i66.push(_e105[0].x), _i66.push(_e105[0].y);\n                  for (var _t101 = 1; _t101 < _e105.length; _t101++) this.layoutVertexArray.emplaceBack(_e105[_t101].x, _e105[_t101].y), this.indexArray2.emplaceBack(_n64 + _t101 - 1, _n64 + _t101), _i66.push(_e105[_t101].x), _i66.push(_e105[_t101].y);\n                  _r90.vertexLength += _e105.length, _r90.primitiveLength += _e105.length;\n                }\n              } catch (err) {\n                _iterator82.e(err);\n              } finally {\n                _iterator82.f();\n              }\n              var _a41 = sc(_i66, _s43);\n              for (var _t100 = 0; _t100 < _a41.length; _t100 += 3) this.indexArray.emplaceBack(_n63 + _a41[_t100], _n63 + _a41[_t100 + 1], _n63 + _a41[_t100 + 2]);\n              _r88.vertexLength += _e104, _r88.primitiveLength += _a41.length / 3;\n            }\n          } catch (err) {\n            _iterator80.e(err);\n          } finally {\n            _iterator80.f();\n          }\n          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, s, n);\n        }\n      }]);\n      return $c;\n    }();\n    Oi($c, \"FillBucket\", {\n      omit: [\"layers\", \"patternFeatures\"]\n    });\n    var Uc = new Js({\n      \"fill-sort-key\": new Hs(Ht.layout_fill[\"fill-sort-key\"])\n    });\n    var Oc = {\n      paint: new Js({\n        \"fill-antialias\": new Ys(Ht.paint_fill[\"fill-antialias\"]),\n        \"fill-opacity\": new Hs(Ht.paint_fill[\"fill-opacity\"]),\n        \"fill-color\": new Hs(Ht.paint_fill[\"fill-color\"]),\n        \"fill-outline-color\": new Hs(Ht.paint_fill[\"fill-outline-color\"]),\n        \"fill-translate\": new Ys(Ht.paint_fill[\"fill-translate\"]),\n        \"fill-translate-anchor\": new Ys(Ht.paint_fill[\"fill-translate-anchor\"]),\n        \"fill-pattern\": new Hs(Ht.paint_fill[\"fill-pattern\"])\n      }),\n      layout: Uc\n    };\n    var qc = na([{\n        name: \"a_pos_normal_ed\",\n        components: 4,\n        type: \"Int16\"\n      }]),\n      Nc = na([{\n        name: \"a_centroid_pos\",\n        components: 2,\n        type: \"Uint16\"\n      }]),\n      Gc = na([{\n        name: \"a_pos_3\",\n        components: 3,\n        type: \"Int16\"\n      }, {\n        name: \"a_pos_normal_3\",\n        components: 3,\n        type: \"Int16\"\n      }]),\n      Zc = qc.members;\n    var Xc = {},\n      Kc = d,\n      Yc = Hc;\n    function Hc(t, e, r, n, i) {\n      this.properties = {}, this.extent = r, this.type = 0, this._pbf = t, this._geometry = -1, this._keys = n, this._values = i, t.readFields(Wc, this, e);\n    }\n    function Wc(t, e, r) {\n      1 == t ? e.id = r.readVarint() : 2 == t ? function (t, e) {\n        for (var r = t.readVarint() + t.pos; t.pos < r;) {\n          var n = e._keys[t.readVarint()],\n            i = e._values[t.readVarint()];\n          e.properties[n] = i;\n        }\n      }(r, e) : 3 == t ? e.type = r.readVarint() : 4 == t && (e._geometry = r.pos);\n    }\n    function Jc(t) {\n      for (var e, r, n = 0, i = 0, s = t.length, a = s - 1; i < s; a = i++) n += ((r = t[a]).x - (e = t[i]).x) * (e.y + r.y);\n      return n;\n    }\n    Hc.types = [\"Unknown\", \"Point\", \"LineString\", \"Polygon\"], Hc.prototype.loadGeometry = function () {\n      var t = this._pbf;\n      t.pos = this._geometry;\n      for (var e, r = t.readVarint() + t.pos, n = 1, i = 0, s = 0, a = 0, o = []; t.pos < r;) {\n        if (i <= 0) {\n          var l = t.readVarint();\n          n = 7 & l, i = l >> 3;\n        }\n        if (i--, 1 === n || 2 === n) s += t.readSVarint(), a += t.readSVarint(), 1 === n && (e && o.push(e), e = []), e.push(new Kc(s, a));else {\n          if (7 !== n) throw new Error(\"unknown command \" + n);\n          e && e.push(e[0].clone());\n        }\n      }\n      return e && o.push(e), o;\n    }, Hc.prototype.bbox = function () {\n      var t = this._pbf;\n      t.pos = this._geometry;\n      for (var e = t.readVarint() + t.pos, r = 1, n = 0, i = 0, s = 0, a = 1 / 0, o = -1 / 0, l = 1 / 0, u = -1 / 0; t.pos < e;) {\n        if (n <= 0) {\n          var c = t.readVarint();\n          r = 7 & c, n = c >> 3;\n        }\n        if (n--, 1 === r || 2 === r) (i += t.readSVarint()) < a && (a = i), i > o && (o = i), (s += t.readSVarint()) < l && (l = s), s > u && (u = s);else if (7 !== r) throw new Error(\"unknown command \" + r);\n      }\n      return [a, l, o, u];\n    }, Hc.prototype.toGeoJSON = function (t, e, r) {\n      var n,\n        i,\n        s = this.extent * Math.pow(2, r),\n        a = this.extent * t,\n        o = this.extent * e,\n        l = this.loadGeometry(),\n        u = Hc.types[this.type];\n      function c(t) {\n        for (var e = 0; e < t.length; e++) {\n          var r = t[e];\n          t[e] = [360 * (r.x + a) / s - 180, 360 / Math.PI * Math.atan(Math.exp((180 - 360 * (r.y + o) / s) * Math.PI / 180)) - 90];\n        }\n      }\n      switch (this.type) {\n        case 1:\n          var h = [];\n          for (n = 0; n < l.length; n++) h[n] = l[n][0];\n          c(l = h);\n          break;\n        case 2:\n          for (n = 0; n < l.length; n++) c(l[n]);\n          break;\n        case 3:\n          for (l = function (t) {\n            var e = t.length;\n            if (e <= 1) return [t];\n            for (var r, n, i = [], s = 0; s < e; s++) {\n              var a = Jc(t[s]);\n              0 !== a && (void 0 === n && (n = a < 0), n === a < 0 ? (r && i.push(r), r = [t[s]]) : r.push(t[s]));\n            }\n            return r && i.push(r), i;\n          }(l), n = 0; n < l.length; n++) for (i = 0; i < l[n].length; i++) c(l[n][i]);\n      }\n      1 === l.length ? l = l[0] : u = \"Multi\" + u;\n      var p = {\n        type: \"Feature\",\n        geometry: {\n          type: u,\n          coordinates: l\n        },\n        properties: this.properties\n      };\n      return \"id\" in this && (p.id = this.id), p;\n    };\n    var Qc = Yc,\n      th = eh;\n    function eh(t, e) {\n      this.version = 1, this.name = null, this.extent = 4096, this.length = 0, this._pbf = t, this._keys = [], this._values = [], this._features = [], t.readFields(rh, this, e), this.length = this._features.length;\n    }\n    function rh(t, e, r) {\n      15 === t ? e.version = r.readVarint() : 1 === t ? e.name = r.readString() : 5 === t ? e.extent = r.readVarint() : 2 === t ? e._features.push(r.pos) : 3 === t ? e._keys.push(r.readString()) : 4 === t && e._values.push(function (t) {\n        for (var e = null, r = t.readVarint() + t.pos; t.pos < r;) {\n          var n = t.readVarint() >> 3;\n          e = 1 === n ? t.readString() : 2 === n ? t.readFloat() : 3 === n ? t.readDouble() : 4 === n ? t.readVarint64() : 5 === n ? t.readVarint() : 6 === n ? t.readSVarint() : 7 === n ? t.readBoolean() : null;\n        }\n        return e;\n      }(r));\n    }\n    eh.prototype.feature = function (t) {\n      if (t < 0 || t >= this._features.length) throw new Error(\"feature index out of bounds\");\n      this._pbf.pos = this._features[t];\n      var e = this._pbf.readVarint() + this._pbf.pos;\n      return new Qc(this._pbf, e, this.extent, this._keys, this._values);\n    };\n    var nh = th;\n    function ih(t, e, r) {\n      if (3 === t) {\n        var n = new nh(r, r.readVarint() + r.pos);\n        n.length && (e[n.name] = n);\n      }\n    }\n    var sh = Xc.VectorTile = function (t, e) {\n        this.layers = t.readFields(ih, {}, e);\n      },\n      ah = Xc.VectorTileFeature = Yc;\n    function oh(t, e, r, n) {\n      var i = [],\n        s = 0 === n ? function (t, e, r, n, i, s) {\n          t.push(new d(s, r + (s - e) / (n - e) * (i - r)));\n        } : function (t, e, r, n, i, s) {\n          t.push(new d(e + (s - r) / (i - r) * (n - e), s));\n        };\n      var _iterator83 = _createForOfIteratorHelper(t),\n        _step83;\n      try {\n        for (_iterator83.s(); !(_step83 = _iterator83.n()).done;) {\n          var _a42 = _step83.value;\n          var _t102 = [];\n          var _iterator84 = _createForOfIteratorHelper(_a42),\n            _step84;\n          try {\n            for (_iterator84.s(); !(_step84 = _iterator84.n()).done;) {\n              var _i67 = _step84.value;\n              if (_i67.length <= 2) continue;\n              var _a43 = [];\n              for (var _t103 = 0; _t103 < _i67.length - 1; _t103++) {\n                var _o18 = _i67[_t103].x,\n                  _l17 = _i67[_t103].y,\n                  _u16 = _i67[_t103 + 1].x,\n                  _c11 = _i67[_t103 + 1].y,\n                  _h7 = 0 === n ? _o18 : _l17,\n                  _p4 = 0 === n ? _u16 : _c11;\n                _h7 < e ? _p4 > e && s(_a43, _o18, _l17, _u16, _c11, e) : _h7 > r ? _p4 < r && s(_a43, _o18, _l17, _u16, _c11, r) : _a43.push(_i67[_t103]), _p4 < e && _h7 >= e && s(_a43, _o18, _l17, _u16, _c11, e), _p4 > r && _h7 <= r && s(_a43, _o18, _l17, _u16, _c11, r);\n              }\n              var _o19 = _i67[_i67.length - 1];\n              var _l18 = 0 === n ? _o19.x : _o19.y;\n              _l18 >= e && _l18 <= r && _a43.push(_o19), _a43.length && (_o19 = _a43[_a43.length - 1], _a43[0].x === _o19.x && _a43[0].y === _o19.y || _a43.push(_a43[0]), _t102.push(_a43));\n            }\n          } catch (err) {\n            _iterator84.e(err);\n          } finally {\n            _iterator84.f();\n          }\n          _t102.length && i.push(_t102);\n        }\n      } catch (err) {\n        _iterator83.e(err);\n      } finally {\n        _iterator83.f();\n      }\n      return i;\n    }\n    Xc.VectorTileLayer = th;\n    var lh = ah.types,\n      uh = Math.pow(2, 13);\n    function ch(t, e, r, n, i, s, a, o) {\n      t.emplaceBack((e << 1) + a, (r << 1) + s, (Math.floor(n * uh) << 1) + i, Math.round(o));\n    }\n    function hh(t, e, r) {\n      var n = 16384;\n      t.emplaceBack(e.x, e.y, e.z, r[0] * n, r[1] * n, r[2] * n);\n    }\n    var ph = /*#__PURE__*/function () {\n      function ph() {\n        _classCallCheck(this, ph);\n        this.acc = new d(0, 0), this.polyCount = [];\n      }\n      _createClass(ph, [{\n        key: \"startRing\",\n        value: function startRing(t) {\n          this.currentPolyCount = {\n            edges: 0,\n            top: 0\n          }, this.polyCount.push(this.currentPolyCount), this.min || (this.min = new d(t.x, t.y), this.max = new d(t.x, t.y));\n        }\n      }, {\n        key: \"append\",\n        value: function append(t, e) {\n          this.currentPolyCount.edges++, this.acc._add(t);\n          var r = this.min,\n            n = this.max;\n          t.x < r.x ? r.x = t.x : t.x > n.x && (n.x = t.x), t.y < r.y ? r.y = t.y : t.y > n.y && (n.y = t.y), ((0 === t.x || t.x === ko) && t.x === e.x) != ((0 === t.y || t.y === ko) && t.y === e.y) && this.processBorderOverlap(t, e), e.x < 0 != t.x < 0 && this.addBorderIntersection(0, Mr(e.y, t.y, (0 - e.x) / (t.x - e.x))), e.x > ko != t.x > ko && this.addBorderIntersection(1, Mr(e.y, t.y, (ko - e.x) / (t.x - e.x))), e.y < 0 != t.y < 0 && this.addBorderIntersection(2, Mr(e.x, t.x, (0 - e.y) / (t.y - e.y))), e.y > ko != t.y > ko && this.addBorderIntersection(3, Mr(e.x, t.x, (ko - e.y) / (t.y - e.y)));\n        }\n      }, {\n        key: \"addBorderIntersection\",\n        value: function addBorderIntersection(t, e) {\n          this.borders || (this.borders = [[Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE], [Number.MAX_VALUE, -Number.MAX_VALUE]]);\n          var r = this.borders[t];\n          e < r[0] && (r[0] = e), e > r[1] && (r[1] = e);\n        }\n      }, {\n        key: \"processBorderOverlap\",\n        value: function processBorderOverlap(t, e) {\n          if (t.x === e.x) {\n            if (t.y === e.y) return;\n            var _r91 = 0 === t.x ? 0 : 1;\n            this.addBorderIntersection(_r91, e.y), this.addBorderIntersection(_r91, t.y);\n          } else {\n            var _r92 = 0 === t.y ? 2 : 3;\n            this.addBorderIntersection(_r92, e.x), this.addBorderIntersection(_r92, t.x);\n          }\n        }\n      }, {\n        key: \"centroid\",\n        value: function centroid() {\n          var t = this.polyCount.reduce(function (t, e) {\n            return t + e.edges;\n          }, 0);\n          return 0 !== t ? this.acc.div(t)._round() : new d(0, 0);\n        }\n      }, {\n        key: \"span\",\n        value: function span() {\n          return new d(this.max.x - this.min.x, this.max.y - this.min.y);\n        }\n      }, {\n        key: \"intersectsCount\",\n        value: function intersectsCount() {\n          return this.borders.reduce(function (t, e) {\n            return t + +(e[0] !== Number.MAX_VALUE);\n          }, 0);\n        }\n      }]);\n      return ph;\n    }();\n    var fh = /*#__PURE__*/function () {\n      function fh(t) {\n        _classCallCheck(this, fh);\n        this.zoom = t.zoom, this.canonical = t.canonical, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {\n          return t.id;\n        }), this.index = t.index, this.hasPattern = !1, this.edgeRadius = 0, this.projection = t.projection, this.layoutVertexArray = new oa(), this.centroidVertexArray = new $a(), this.indexArray = new wa(), this.programConfigurations = new fo(t.layers, t.zoom), this.segments = new So(), this.stateDependentLayerIds = this.layers.filter(function (t) {\n          return t.isStateDependent();\n        }).map(function (t) {\n          return t.id;\n        }), this.enableTerrain = t.enableTerrain;\n      }\n      _createClass(fh, [{\n        key: \"populate\",\n        value: function populate(t, e, r, n) {\n          this.features = [], this.hasPattern = Rc(\"fill-extrusion\", this.layers, e), this.featuresOnBorder = [], this.borders = [[], [], [], []], this.borderDoneWithNeighborZ = [-1, -1, -1, -1], this.tileToMeter = function (t) {\n            var e = Math.exp(Math.PI * (1 - t.y / (1 << t.z) * 2));\n            return 80150034 * e / (e * e + 1) / ko / (1 << t.z);\n          }(r), this.edgeRadius = this.layers[0].layout.get(\"fill-extrusion-edge-radius\") / this.tileToMeter;\n          var _iterator85 = _createForOfIteratorHelper(t),\n            _step85;\n          try {\n            for (_iterator85.s(); !(_step85 = _iterator85.n()).done;) {\n              var _step85$value = _step85.value,\n                _i68 = _step85$value.feature,\n                _s44 = _step85$value.id,\n                _a44 = _step85$value.index,\n                _o20 = _step85$value.sourceLayerIndex;\n              var _t104 = this.layers[0]._featureFilter.needGeometry,\n                _l19 = wu(_i68, _t104);\n              if (!this.layers[0]._featureFilter.filter(new $s(this.zoom), _l19, r)) continue;\n              var _u17 = {\n                  id: _s44,\n                  sourceLayerIndex: _o20,\n                  index: _a44,\n                  geometry: _t104 ? _l19.geometry : bu(_i68, r, n),\n                  properties: _i68.properties,\n                  type: _i68.type,\n                  patterns: {}\n                },\n                _c12 = this.layoutVertexArray.length;\n              this.hasPattern ? this.features.push(jc(\"fill-extrusion\", this.layers, _u17, this.zoom, e)) : this.addFeature(_u17, _u17.geometry, _a44, r, {}, e.availableImages, n), e.featureIndex.insert(_i68, _u17.geometry, _a44, _o20, this.index, _c12);\n            }\n          } catch (err) {\n            _iterator85.e(err);\n          } finally {\n            _iterator85.f();\n          }\n          this.sortBorders();\n        }\n      }, {\n        key: \"addFeatures\",\n        value: function addFeatures(t, e, r, n, i) {\n          var _iterator86 = _createForOfIteratorHelper(this.features),\n            _step86;\n          try {\n            for (_iterator86.s(); !(_step86 = _iterator86.n()).done;) {\n              var _t105 = _step86.value;\n              var _s45 = _t105.geometry;\n              this.addFeature(_t105, _s45, _t105.index, e, r, n, i);\n            }\n          } catch (err) {\n            _iterator86.e(err);\n          } finally {\n            _iterator86.f();\n          }\n          this.sortBorders();\n        }\n      }, {\n        key: \"update\",\n        value: function update(t, e, r, n) {\n          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);\n        }\n      }, {\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return 0 === this.layoutVertexArray.length;\n        }\n      }, {\n        key: \"uploadPending\",\n        value: function uploadPending() {\n          return !this.uploaded || this.programConfigurations.needsUpload;\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          this.uploaded || (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Zc), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.layoutVertexExtArray && (this.layoutVertexExtBuffer = t.createVertexBuffer(this.layoutVertexExtArray, Gc.members, !0))), this.programConfigurations.upload(t), this.uploaded = !0;\n        }\n      }, {\n        key: \"uploadCentroid\",\n        value: function uploadCentroid(t) {\n          0 !== this.centroidVertexArray.length && (this.centroidVertexBuffer ? this.needsCentroidUpdate && this.centroidVertexBuffer.updateData(this.centroidVertexArray) : this.centroidVertexBuffer = t.createVertexBuffer(this.centroidVertexArray, Nc.members, !0), this.needsCentroidUpdate = !1);\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.centroidVertexBuffer && this.centroidVertexBuffer.destroy(), this.layoutVertexExtBuffer && this.layoutVertexExtBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());\n        }\n      }, {\n        key: \"addFeature\",\n        value: function addFeature(t, e, r, n, i, s, a) {\n          var o = [new d(0, 0), new d(ko, ko)],\n            l = a.projection,\n            u = \"globe\" === l.name,\n            c = this.enableTerrain && !u ? new ph() : null,\n            h = \"Polygon\" === lh[t.type];\n          u && !this.layoutVertexExtArray && (this.layoutVertexExtArray = new pa());\n          var p = Lc(e, 500);\n          for (var _t106 = p.length - 1; _t106 >= 0; _t106--) {\n            var _e106 = p[_t106];\n            (0 === _e106.length || (f = _e106[0]).every(function (t) {\n              return t.x <= 0;\n            }) || f.every(function (t) {\n              return t.x >= ko;\n            }) || f.every(function (t) {\n              return t.y <= 0;\n            }) || f.every(function (t) {\n              return t.y >= ko;\n            })) && p.splice(_t106, 1);\n          }\n          var f;\n          var y;\n          if (u) y = wh(p, o, n);else {\n            y = [];\n            var _iterator87 = _createForOfIteratorHelper(p),\n              _step87;\n            try {\n              for (_iterator87.s(); !(_step87 = _iterator87.n()).done;) {\n                var _t107 = _step87.value;\n                y.push({\n                  polygon: _t107,\n                  bounds: o\n                });\n              }\n            } catch (err) {\n              _iterator87.e(err);\n            } finally {\n              _iterator87.f();\n            }\n          }\n          var m = h ? this.edgeRadius : 0;\n          var _iterator88 = _createForOfIteratorHelper(y),\n            _step88;\n          try {\n            for (_iterator88.s(); !(_step88 = _iterator88.n()).done;) {\n              var _step88$value = _step88.value,\n                _t109 = _step88$value.polygon,\n                _e108 = _step88$value.bounds;\n              var _r94 = 0,\n                _i69 = 0;\n              var _iterator89 = _createForOfIteratorHelper(_t109),\n                _step89;\n              try {\n                for (_iterator89.s(); !(_step89 = _iterator89.n()).done;) {\n                  var _e111 = _step89.value;\n                  h && !_e111[0].equals(_e111[_e111.length - 1]) && _e111.push(_e111[0]), _i69 += h ? _e111.length - 1 : _e111.length;\n                }\n              } catch (err) {\n                _iterator89.e(err);\n              } finally {\n                _iterator89.f();\n              }\n              var _s46 = this.segments.prepareSegment((h ? 5 : 4) * _i69, this.layoutVertexArray, this.indexArray);\n              if (h) {\n                var _e109 = [],\n                  _i70 = [];\n                _r94 = _s46.vertexLength;\n                var _iterator90 = _createForOfIteratorHelper(_t109),\n                  _step90;\n                try {\n                  for (_iterator90.s(); !(_step90 = _iterator90.n()).done;) {\n                    var _r95 = _step90.value;\n                    var _a46 = void 0,\n                      _o21 = void 0;\n                    _r95.length && _r95 !== _t109[0] && _i70.push(_e109.length / 2), _a46 = _r95[1].sub(_r95[0])._perp()._unit();\n                    for (var _t111 = 1; _t111 < _r95.length; _t111++) {\n                      var _i71 = _r95[_t111],\n                        _c13 = _r95[_t111 === _r95.length - 1 ? 1 : _t111 + 1];\n                      var _h8 = _i71.x,\n                        _p5 = _i71.y;\n                      if (m) {\n                        _o21 = _c13.sub(_i71)._perp()._unit();\n                        var _t112 = _a46.add(_o21)._unit(),\n                          _e110 = m * Math.min(4, 1 / (_a46.x * _t112.x + _a46.y * _t112.y));\n                        _h8 += _e110 * _t112.x, _p5 += _e110 * _t112.y, _a46 = _o21;\n                      }\n                      ch(this.layoutVertexArray, _h8, _p5, 0, 0, 1, 1, 0), _s46.vertexLength++, _e109.push(_i71.x, _i71.y), u && hh(this.layoutVertexExtArray, l.projectTilePoint(_h8, _p5, n), l.upVector(n, _h8, _p5));\n                    }\n                  }\n                } catch (err) {\n                  _iterator90.e(err);\n                } finally {\n                  _iterator90.f();\n                }\n                var _a45 = sc(_e109, _i70);\n                for (var _t110 = 0; _t110 < _a45.length; _t110 += 3) this.indexArray.emplaceBack(_r94 + _a45[_t110], _r94 + _a45[_t110 + 2], _r94 + _a45[_t110 + 1]), _s46.primitiveLength++;\n              }\n              var _iterator91 = _createForOfIteratorHelper(_t109),\n                _step91;\n              try {\n                for (_iterator91.s(); !(_step91 = _iterator91.n()).done;) {\n                  var _i72 = _step91.value;\n                  c && _i72.length && c.startRing(_i72[0]);\n                  var _t113 = void 0,\n                    _a47 = void 0,\n                    _o22 = void 0,\n                    _p6 = _i72.length > 4 && xh(_i72[_i72.length - 2], _i72[0], _i72[1]),\n                    _f3 = m ? yh(_i72[_i72.length - 2], _i72[0], _i72[1], m) : 0;\n                  _a47 = _i72[1].sub(_i72[0])._perp()._unit();\n                  var _d2 = !0;\n                  for (var _y = 1, _g = 0; _y < _i72.length; _y++) {\n                    var _x = _i72[_y - 1],\n                      _v = _i72[_y];\n                    var _b = _i72[_y === _i72.length - 1 ? 1 : _y + 1];\n                    if (c && h && c.currentPolyCount.top++, gh(_v, _x, _e108)) {\n                      m && (_a47 = _b.sub(_v)._perp()._unit(), _d2 = !_d2);\n                      continue;\n                    }\n                    c && c.append(_v, _x);\n                    var _w = _v.sub(_x)._perp(),\n                      _2 = _w.x / (Math.abs(_w.x) + Math.abs(_w.y)),\n                      _A = _w.y > 0 ? 1 : 0,\n                      _S = _x.dist(_v);\n                    if (_g + _S > 32768 && (_g = 0), m) {\n                      _o22 = _b.sub(_v)._perp()._unit();\n                      var _t114 = mh(_x, _v, _b, dh(_a47, _o22), m);\n                      isNaN(_t114) && (_t114 = 0);\n                      var _e112 = _v.sub(_x)._unit();\n                      _x = _x.add(_e112.mult(_f3))._round(), _v = _v.add(_e112.mult(-_t114))._round(), _f3 = _t114, _a47 = _o22;\n                    }\n                    var _k = _s46.vertexLength,\n                      _I = _i72.length > 4 && xh(_x, _v, _b);\n                    var _M = vh(_g, _p6, _d2);\n                    if (ch(this.layoutVertexArray, _x.x, _x.y, _2, _A, 0, 0, _M), ch(this.layoutVertexArray, _x.x, _x.y, _2, _A, 0, 1, _M), _g += _S, _M = vh(_g, _I, !_d2), _p6 = _I, ch(this.layoutVertexArray, _v.x, _v.y, _2, _A, 0, 0, _M), ch(this.layoutVertexArray, _v.x, _v.y, _2, _A, 0, 1, _M), _s46.vertexLength += 4, this.indexArray.emplaceBack(_k + 0, _k + 1, _k + 2), this.indexArray.emplaceBack(_k + 1, _k + 3, _k + 2), _s46.primitiveLength += 2, m) {\n                      var _n65 = _r94 + (1 === _y ? _i72.length - 2 : _y - 2),\n                        _a48 = 1 === _y ? _r94 : _n65 + 1;\n                      if (this.indexArray.emplaceBack(_k + 1, _n65, _k + 3), this.indexArray.emplaceBack(_n65, _a48, _k + 3), _s46.primitiveLength += 2, void 0 === _t113 && (_t113 = _k), !gh(_b, _i72[_y], _e108)) {\n                        var _e113 = _y === _i72.length - 1 ? _t113 : _s46.vertexLength;\n                        this.indexArray.emplaceBack(_k + 2, _k + 3, _e113), this.indexArray.emplaceBack(_k + 3, _e113 + 1, _e113), this.indexArray.emplaceBack(_k + 3, _a48, _e113 + 1), _s46.primitiveLength += 3;\n                      }\n                      _d2 = !_d2;\n                    }\n                    if (u) {\n                      var _t115 = this.layoutVertexExtArray,\n                        _e114 = l.projectTilePoint(_x.x, _x.y, n),\n                        _r96 = l.projectTilePoint(_v.x, _v.y, n),\n                        _i73 = l.upVector(n, _x.x, _x.y),\n                        _s47 = l.upVector(n, _v.x, _v.y);\n                      hh(_t115, _e114, _i73), hh(_t115, _e114, _i73), hh(_t115, _r96, _s47), hh(_t115, _r96, _s47);\n                    }\n                  }\n                  h && (_r94 += _i72.length - 1);\n                }\n              } catch (err) {\n                _iterator91.e(err);\n              } finally {\n                _iterator91.f();\n              }\n            }\n          } catch (err) {\n            _iterator88.e(err);\n          } finally {\n            _iterator88.f();\n          }\n          if (c && c.polyCount.length > 0) {\n            if (c.borders) {\n              c.vertexArrayOffset = this.centroidVertexArray.length;\n              var _t108 = c.borders,\n                _e107 = this.featuresOnBorder.push(c) - 1;\n              for (var _r93 = 0; _r93 < 4; _r93++) _t108[_r93][0] !== Number.MAX_VALUE && this.borders[_r93].push(_e107);\n            }\n            this.encodeCentroid(c.borders ? void 0 : c.centroid(), c);\n          }\n          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, s, n);\n        }\n      }, {\n        key: \"sortBorders\",\n        value: function sortBorders() {\n          var _this17 = this;\n          var _loop3 = function _loop3(_t116) {\n            _this17.borders[_t116].sort(function (e, r) {\n              return _this17.featuresOnBorder[e].borders[_t116][0] - _this17.featuresOnBorder[r].borders[_t116][0];\n            });\n          };\n          for (var _t116 = 0; _t116 < 4; _t116++) {\n            _loop3(_t116);\n          }\n        }\n      }, {\n        key: \"encodeCentroid\",\n        value: function encodeCentroid(t, e) {\n          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;\n          var n, i;\n          if (t) {\n            if (0 !== t.y) {\n              var _r97 = e.span()._mult(this.tileToMeter);\n              n = (Math.max(t.x, 1) << 3) + Math.min(7, Math.round(_r97.x / 10)), i = (Math.max(t.y, 1) << 3) + Math.min(7, Math.round(_r97.y / 10));\n            } else n = Math.ceil(7 * (t.x + 450)), i = 0;\n          } else n = 0, i = +r;\n          var s = r ? this.centroidVertexArray.length : e.vertexArrayOffset;\n          var _iterator92 = _createForOfIteratorHelper(e.polyCount),\n            _step92;\n          try {\n            for (_iterator92.s(); !(_step92 = _iterator92.n()).done;) {\n              var _t117 = _step92.value;\n              r && this.centroidVertexArray.resize(this.centroidVertexArray.length + 4 * _t117.edges + _t117.top);\n              for (var _e115 = 0; _e115 < _t117.top; _e115++) this.centroidVertexArray.emplace(s++, n, i);\n              for (var _e116 = 0; _e116 < 2 * _t117.edges; _e116++) this.centroidVertexArray.emplace(s++, 0, i), this.centroidVertexArray.emplace(s++, n, i);\n            }\n          } catch (err) {\n            _iterator92.e(err);\n          } finally {\n            _iterator92.f();\n          }\n        }\n      }]);\n      return fh;\n    }();\n    function dh(t, e) {\n      var r = t.add(e)._unit();\n      return t.x * r.x + t.y * r.y;\n    }\n    function yh(t, e, r, n) {\n      var i = e.sub(t)._perp()._unit(),\n        s = r.sub(e)._perp()._unit();\n      return mh(t, e, r, dh(i, s), n);\n    }\n    function mh(t, e, r, n, i) {\n      var s = Math.sqrt(1 - n * n);\n      return Math.min(t.dist(e) / 3, e.dist(r) / 3, i * s / n);\n    }\n    function gh(t, e, r) {\n      return t.x < r[0].x && e.x < r[0].x || t.x > r[1].x && e.x > r[1].x || t.y < r[0].y && e.y < r[0].y || t.y > r[1].y && e.y > r[1].y;\n    }\n    function xh(t, e, r) {\n      if (t.x < 0 || t.x >= ko || e.x < 0 || e.x >= ko || r.x < 0 || r.x >= ko) return !1;\n      var n = r.sub(e),\n        i = n.perp(),\n        s = t.sub(e);\n      return (n.x * s.x + n.y * s.y) / Math.sqrt((n.x * n.x + n.y * n.y) * (s.x * s.x + s.y * s.y)) > -.866 && i.x * s.x + i.y * s.y < 0;\n    }\n    function vh(t, e, r) {\n      var n = e ? 2 | t : -3 & t;\n      return r ? 1 | n : -2 & n;\n    }\n    function bh() {\n      var t = Math.PI / 32,\n        e = Math.tan(t),\n        r = tu;\n      return r * Math.sqrt(1 + 2 * e * e) - r;\n    }\n    function wh(t, e, r) {\n      var n = 1 << r.z,\n        i = ou(r.x / n),\n        s = ou((r.x + 1) / n),\n        a = lu(r.y / n),\n        o = lu((r.y + 1) / n);\n      return function (t, e, r, n) {\n        var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n        var s = arguments.length > 5 ? arguments[5] : undefined;\n        var a = [];\n        if (!t.length || !r || !n) return a;\n        var o = function o(t, e) {\n            var _iterator93 = _createForOfIteratorHelper(t),\n              _step93;\n            try {\n              for (_iterator93.s(); !(_step93 = _iterator93.n()).done;) {\n                var _r98 = _step93.value;\n                a.push({\n                  polygon: _r98,\n                  bounds: e\n                });\n              }\n            } catch (err) {\n              _iterator93.e(err);\n            } finally {\n              _iterator93.f();\n            }\n          },\n          l = Math.ceil(Math.log2(r)),\n          u = Math.ceil(Math.log2(n)),\n          c = l - u,\n          h = [];\n        for (var _t118 = 0; _t118 < Math.abs(c); _t118++) h.push(c > 0 ? 0 : 1);\n        for (var _t119 = 0; _t119 < Math.min(l, u); _t119++) h.push(0), h.push(1);\n        var p = t;\n        if (p = oh(p, e[0].y - i, e[1].y + i, 1), p = oh(p, e[0].x - i, e[1].x + i, 0), !p.length) return a;\n        var f = [];\n        for (h.length ? f.push({\n          polygons: p,\n          bounds: e,\n          depth: 0\n        }) : o(p, e); f.length;) {\n          var _t120 = f.pop(),\n            _e117 = _t120.depth,\n            _r99 = h[_e117],\n            _n66 = _t120.bounds[0],\n            _a49 = _t120.bounds[1],\n            _l20 = 0 === _r99 ? _n66.x : _n66.y,\n            _u18 = 0 === _r99 ? _a49.x : _a49.y,\n            _c14 = s ? s(_r99, _l20, _u18) : .5 * (_l20 + _u18),\n            _p7 = oh(_t120.polygons, _l20 - i, _c14 + i, _r99),\n            _y2 = oh(_t120.polygons, _c14 - i, _u18 + i, _r99);\n          if (_p7.length) {\n            var _t121 = [_n66, new d(0 === _r99 ? _c14 : _a49.x, 1 === _r99 ? _c14 : _a49.y)];\n            h.length > _e117 + 1 ? f.push({\n              polygons: _p7,\n              bounds: _t121,\n              depth: _e117 + 1\n            }) : o(_p7, _t121);\n          }\n          if (_y2.length) {\n            var _t122 = [new d(0 === _r99 ? _c14 : _n66.x, 1 === _r99 ? _c14 : _n66.y), _a49];\n            h.length > _e117 + 1 ? f.push({\n              polygons: _y2,\n              bounds: _t122,\n              depth: _e117 + 1\n            }) : o(_y2, _t122);\n          }\n        }\n        return a;\n      }(t, e, Math.ceil((s - i) / 11.25), Math.ceil((a - o) / 11.25), 1, function (t, e, i) {\n        if (0 === t) return .5 * (e + i);\n        {\n          var _t123 = lu((r.y + e / ko) / n);\n          return (su(.5 * (lu((r.y + i / ko) / n) + _t123)) * n - r.y) * ko;\n        }\n      });\n    }\n    Oi(fh, \"FillExtrusionBucket\", {\n      omit: [\"layers\", \"features\"]\n    }), Oi(ph, \"PartMetadata\");\n    var _h = new Js({\n      \"fill-extrusion-edge-radius\": new Ys(Ht[\"layout_fill-extrusion\"][\"fill-extrusion-edge-radius\"])\n    });\n    var Ah = {\n      paint: new Js({\n        \"fill-extrusion-opacity\": new Ys(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-opacity\"]),\n        \"fill-extrusion-color\": new Hs(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-color\"]),\n        \"fill-extrusion-translate\": new Ys(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-translate\"]),\n        \"fill-extrusion-translate-anchor\": new Ys(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-translate-anchor\"]),\n        \"fill-extrusion-pattern\": new Hs(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-pattern\"]),\n        \"fill-extrusion-height\": new Hs(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-height\"]),\n        \"fill-extrusion-base\": new Hs(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-base\"]),\n        \"fill-extrusion-vertical-gradient\": new Ys(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-vertical-gradient\"]),\n        \"fill-extrusion-ambient-occlusion-intensity\": new Ys(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-ambient-occlusion-intensity\"]),\n        \"fill-extrusion-ambient-occlusion-radius\": new Ys(Ht[\"paint_fill-extrusion\"][\"fill-extrusion-ambient-occlusion-radius\"])\n      }),\n      layout: _h\n    };\n    function Sh(t, e, r) {\n      var n = 2 * Math.PI * 6378137 / 256 / Math.pow(2, r);\n      return [t * n - 2 * Math.PI * 6378137 / 2, e * n - 2 * Math.PI * 6378137 / 2];\n    }\n    var kh = /*#__PURE__*/function () {\n      function kh(t, e, r) {\n        _classCallCheck(this, kh);\n        this.z = t, this.x = e, this.y = r, this.key = Th(0, t, t, e, r);\n      }\n      _createClass(kh, [{\n        key: \"equals\",\n        value: function equals(t) {\n          return this.z === t.z && this.x === t.x && this.y === t.y;\n        }\n      }, {\n        key: \"url\",\n        value: function url(t, e) {\n          var r = function (t, e, r) {\n              var n = Sh(256 * t, 256 * (e = Math.pow(2, r) - e - 1), r),\n                i = Sh(256 * (t + 1), 256 * (e + 1), r);\n              return n[0] + \",\" + n[1] + \",\" + i[0] + \",\" + i[1];\n            }(this.x, this.y, this.z),\n            n = function (t, e, r) {\n              var n,\n                i = \"\";\n              for (var _s48 = t; _s48 > 0; _s48--) n = 1 << _s48 - 1, i += (e & n ? 1 : 0) + (r & n ? 2 : 0);\n              return i;\n            }(this.z, this.x, this.y);\n          return t[(this.x + this.y) % t.length].replace(\"{prefix}\", (this.x % 16).toString(16) + (this.y % 16).toString(16)).replace(/{z}/g, String(this.z)).replace(/{x}/g, String(this.x)).replace(/{y}/g, String(\"tms\" === e ? Math.pow(2, this.z) - this.y - 1 : this.y)).replace(\"{quadkey}\", n).replace(\"{bbox-epsg-3857}\", r);\n        }\n      }, {\n        key: \"toString\",\n        value: function toString() {\n          return \"\".concat(this.z, \"/\").concat(this.x, \"/\").concat(this.y);\n        }\n      }]);\n      return kh;\n    }();\n    var Ih = function Ih(t, e) {\n      _classCallCheck(this, Ih);\n      this.wrap = t, this.canonical = e, this.key = Th(t, e.z, e.z, e.x, e.y);\n    };\n    var Mh = /*#__PURE__*/function () {\n      function Mh(t, e, r, n, i) {\n        _classCallCheck(this, Mh);\n        this.overscaledZ = t, this.wrap = e, this.canonical = new kh(r, +n, +i), this.key = 0 === e && t === r ? this.canonical.key : Th(e, t, r, n, i);\n      }\n      _createClass(Mh, [{\n        key: \"equals\",\n        value: function equals(t) {\n          return this.overscaledZ === t.overscaledZ && this.wrap === t.wrap && this.canonical.equals(t.canonical);\n        }\n      }, {\n        key: \"scaledTo\",\n        value: function scaledTo(t) {\n          var e = this.canonical.z - t;\n          return t > this.canonical.z ? new Mh(t, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y) : new Mh(t, this.wrap, t, this.canonical.x >> e, this.canonical.y >> e);\n        }\n      }, {\n        key: \"calculateScaledKey\",\n        value: function calculateScaledKey(t) {\n          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n          if (this.overscaledZ === t && e) return this.key;\n          if (t > this.canonical.z) return Th(this.wrap * +e, t, this.canonical.z, this.canonical.x, this.canonical.y);\n          {\n            var _r100 = this.canonical.z - t;\n            return Th(this.wrap * +e, t, t, this.canonical.x >> _r100, this.canonical.y >> _r100);\n          }\n        }\n      }, {\n        key: \"isChildOf\",\n        value: function isChildOf(t) {\n          if (t.wrap !== this.wrap) return !1;\n          var e = this.canonical.z - t.canonical.z;\n          return 0 === t.overscaledZ || t.overscaledZ < this.overscaledZ && t.canonical.x === this.canonical.x >> e && t.canonical.y === this.canonical.y >> e;\n        }\n      }, {\n        key: \"children\",\n        value: function children(t) {\n          if (this.overscaledZ >= t) return [new Mh(this.overscaledZ + 1, this.wrap, this.canonical.z, this.canonical.x, this.canonical.y)];\n          var e = this.canonical.z + 1,\n            r = 2 * this.canonical.x,\n            n = 2 * this.canonical.y;\n          return [new Mh(e, this.wrap, e, r, n), new Mh(e, this.wrap, e, r + 1, n), new Mh(e, this.wrap, e, r, n + 1), new Mh(e, this.wrap, e, r + 1, n + 1)];\n        }\n      }, {\n        key: \"isLessThan\",\n        value: function isLessThan(t) {\n          return this.wrap < t.wrap || !(this.wrap > t.wrap) && (this.overscaledZ < t.overscaledZ || !(this.overscaledZ > t.overscaledZ) && (this.canonical.x < t.canonical.x || !(this.canonical.x > t.canonical.x) && this.canonical.y < t.canonical.y));\n        }\n      }, {\n        key: \"wrapped\",\n        value: function wrapped() {\n          return new Mh(this.overscaledZ, 0, this.canonical.z, this.canonical.x, this.canonical.y);\n        }\n      }, {\n        key: \"unwrapTo\",\n        value: function unwrapTo(t) {\n          return new Mh(this.overscaledZ, t, this.canonical.z, this.canonical.x, this.canonical.y);\n        }\n      }, {\n        key: \"overscaleFactor\",\n        value: function overscaleFactor() {\n          return Math.pow(2, this.overscaledZ - this.canonical.z);\n        }\n      }, {\n        key: \"toUnwrapped\",\n        value: function toUnwrapped() {\n          return new Ih(this.wrap, this.canonical);\n        }\n      }, {\n        key: \"toString\",\n        value: function toString() {\n          return \"\".concat(this.overscaledZ, \"/\").concat(this.canonical.x, \"/\").concat(this.canonical.y);\n        }\n      }]);\n      return Mh;\n    }();\n    function Th(t, e, r, n, i) {\n      var s = 1 << Math.min(r, 22);\n      var a = s * (i % s) + n % s;\n      return t && r < 22 && (a += s * s * ((t < 0 ? -2 * t - 1 : 2 * t) % (1 << 2 * (22 - r)))), 16 * (32 * a + r) + (e - r);\n    }\n    Oi(kh, \"CanonicalTileID\"), Oi(Mh, \"OverscaledTileID\", {\n      omit: [\"projMatrix\"]\n    });\n    var zh = /*#__PURE__*/function (_d3) {\n      _inherits(zh, _d3);\n      function zh(t, e, r) {\n        var _this18;\n        _classCallCheck(this, zh);\n        _this18 = _possibleConstructorReturn(this, _getPrototypeOf(zh).call(this, t, e)), _this18.z = r;\n        return _this18;\n      }\n      return zh;\n    }(d);\n    function Bh(t, e) {\n      return t.x * e.x + t.y * e.y;\n    }\n    function Eh(t, e) {\n      if (1 === t.length) {\n        var _r101 = 0;\n        var _n67 = e[_r101++];\n        var _i74;\n        for (; !_i74 || _n67.equals(_i74);) if (_i74 = e[_r101++], !_i74) return 1 / 0;\n        for (; _r101 < e.length; _r101++) {\n          var _s49 = e[_r101],\n            _a50 = t[0],\n            _o23 = _i74.sub(_n67),\n            _l21 = _s49.sub(_n67),\n            _u19 = _a50.sub(_n67),\n            _c15 = Bh(_o23, _o23),\n            _h9 = Bh(_o23, _l21),\n            _p8 = Bh(_l21, _l21),\n            _f4 = Bh(_u19, _o23),\n            _d4 = Bh(_u19, _l21),\n            _y3 = _c15 * _p8 - _h9 * _h9,\n            _m = (_p8 * _f4 - _h9 * _d4) / _y3,\n            _g2 = (_c15 * _d4 - _h9 * _f4) / _y3,\n            _x2 = _n67.z * (1 - _m - _g2) + _i74.z * _m + _s49.z * _g2;\n          if (isFinite(_x2)) return _x2;\n        }\n        return 1 / 0;\n      }\n      {\n        var _t124 = 1 / 0;\n        var _iterator94 = _createForOfIteratorHelper(e),\n          _step94;\n        try {\n          for (_iterator94.s(); !(_step94 = _iterator94.n()).done;) {\n            var _r102 = _step94.value;\n            _t124 = Math.min(_t124, _r102.z);\n          }\n        } catch (err) {\n          _iterator94.e(err);\n        } finally {\n          _iterator94.f();\n        }\n        return _t124;\n      }\n    }\n    function Ch(t, e, r, n, i, s, a, o) {\n      var l = a * i.getElevationAt(t, e, !0, !0),\n        u = 0 !== s[0],\n        c = u ? 0 === s[1] ? a * (s[0] / 7 - 450) : a * function (t, e, r) {\n          var n = Math.floor(e[0] / 8),\n            i = Math.floor(e[1] / 8),\n            s = 10 * (e[0] - 8 * n),\n            a = 10 * (e[1] - 8 * i),\n            o = t.getElevationAt(n, i, !0, !0),\n            l = t.getMeterToDEM(r),\n            u = Math.floor(.5 * (s * l - 1)),\n            c = Math.floor(.5 * (a * l - 1)),\n            h = t.tileCoordToPixel(n, i),\n            p = 2 * u + 1,\n            f = 2 * c + 1,\n            d = function (t, e, r, n, i) {\n              return [t.getElevationAtPixel(e, r, !0), t.getElevationAtPixel(e + i, r, !0), t.getElevationAtPixel(e, r + i, !0), t.getElevationAtPixel(e + n, r + i, !0)];\n            }(t, h.x - u, h.y - c, p, f),\n            y = Math.abs(d[0] - d[1]),\n            m = Math.abs(d[2] - d[3]),\n            g = Math.abs(d[0] - d[2]) + Math.abs(d[1] - d[3]),\n            x = Math.min(.25, .5 * l * (y + m) / p),\n            v = Math.min(.25, .5 * l * g / f);\n          return o + Math.max(x * s, v * a);\n        }(i, s, o) : l;\n      return {\n        base: l + (0 === r) ? -1 : r,\n        top: u ? Math.max(c + n, l + r + 2) : l + n\n      };\n    }\n    var Ph = na([{\n        name: \"a_pos_normal\",\n        components: 2,\n        type: \"Int16\"\n      }, {\n        name: \"a_data\",\n        components: 4,\n        type: \"Uint8\"\n      }, {\n        name: \"a_linesofar\",\n        components: 1,\n        type: \"Float32\"\n      }], 4),\n      Dh = Ph.members,\n      Vh = na([{\n        name: \"a_packed\",\n        components: 4,\n        type: \"Float32\"\n      }]),\n      Lh = Vh.members,\n      Fh = ah.types,\n      Rh = Math.cos(Math.PI / 180 * 37.5);\n    var jh = /*#__PURE__*/function () {\n      function jh(t) {\n        var _this19 = this;\n        _classCallCheck(this, jh);\n        this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {\n          return t.id;\n        }), this.index = t.index, this.projection = t.projection, this.hasPattern = !1, this.patternFeatures = [], this.lineClipsArray = [], this.gradients = {}, this.layers.forEach(function (t) {\n          _this19.gradients[t.id] = {};\n        }), this.layoutVertexArray = new la(), this.layoutVertexArray2 = new ua(), this.indexArray = new wa(), this.programConfigurations = new fo(t.layers, t.zoom), this.segments = new So(), this.maxLineLength = 0, this.stateDependentLayerIds = this.layers.filter(function (t) {\n          return t.isStateDependent();\n        }).map(function (t) {\n          return t.id;\n        });\n      }\n      _createClass(jh, [{\n        key: \"populate\",\n        value: function populate(t, e, r, n) {\n          this.hasPattern = Rc(\"line\", this.layers, e);\n          var i = this.layers[0].layout.get(\"line-sort-key\"),\n            s = [];\n          var _iterator95 = _createForOfIteratorHelper(t),\n            _step95;\n          try {\n            for (_iterator95.s(); !(_step95 = _iterator95.n()).done;) {\n              var _step95$value = _step95.value,\n                _e118 = _step95$value.feature,\n                _a51 = _step95$value.id,\n                _o24 = _step95$value.index,\n                _l22 = _step95$value.sourceLayerIndex;\n              var _t126 = this.layers[0]._featureFilter.needGeometry,\n                _u21 = wu(_e118, _t126);\n              if (!this.layers[0]._featureFilter.filter(new $s(this.zoom), _u21, r)) continue;\n              var _c16 = i ? i.evaluate(_u21, {}, r) : void 0,\n                _h10 = {\n                  id: _a51,\n                  properties: _e118.properties,\n                  type: _e118.type,\n                  sourceLayerIndex: _l22,\n                  index: _o24,\n                  geometry: _t126 ? _u21.geometry : bu(_e118, r, n),\n                  patterns: {},\n                  sortKey: _c16\n                };\n              s.push(_h10);\n            }\n          } catch (err) {\n            _iterator95.e(err);\n          } finally {\n            _iterator95.f();\n          }\n          i && s.sort(function (t, e) {\n            return t.sortKey - e.sortKey;\n          });\n          var a = e.lineAtlas,\n            o = e.featureIndex,\n            l = this.addConstantDashes(a);\n          for (var _i75 = 0, _s50 = s; _i75 < _s50.length; _i75++) {\n            var _n68 = _s50[_i75];\n            var _i76 = _n68.geometry,\n              _s51 = _n68.index,\n              _u20 = _n68.sourceLayerIndex;\n            if (l && this.addFeatureDashes(_n68, a), this.hasPattern) {\n              var _t125 = jc(\"line\", this.layers, _n68, this.zoom, e);\n              this.patternFeatures.push(_t125);\n            } else this.addFeature(_n68, _i76, _s51, r, a.positions, e.availableImages);\n            o.insert(t[_s51].feature, _i76, _s51, _u20, this.index);\n          }\n        }\n      }, {\n        key: \"addConstantDashes\",\n        value: function addConstantDashes(t) {\n          var e = !1;\n          var _iterator96 = _createForOfIteratorHelper(this.layers),\n            _step96;\n          try {\n            for (_iterator96.s(); !(_step96 = _iterator96.n()).done;) {\n              var _r103 = _step96.value;\n              var _n69 = _r103.paint.get(\"line-dasharray\").value,\n                _i77 = _r103.layout.get(\"line-cap\").value;\n              if (\"constant\" !== _n69.kind || \"constant\" !== _i77.kind) e = !0;else {\n                var _e119 = _i77.value,\n                  _r104 = _n69.value;\n                if (!_r104) continue;\n                t.addDash(_r104, _e119);\n              }\n            }\n          } catch (err) {\n            _iterator96.e(err);\n          } finally {\n            _iterator96.f();\n          }\n          return e;\n        }\n      }, {\n        key: \"addFeatureDashes\",\n        value: function addFeatureDashes(t, e) {\n          var r = this.zoom;\n          var _iterator97 = _createForOfIteratorHelper(this.layers),\n            _step97;\n          try {\n            for (_iterator97.s(); !(_step97 = _iterator97.n()).done;) {\n              var _n70 = _step97.value;\n              var _i78 = _n70.paint.get(\"line-dasharray\").value,\n                _s52 = _n70.layout.get(\"line-cap\").value;\n              if (\"constant\" === _i78.kind && \"constant\" === _s52.kind) continue;\n              var _a52 = void 0,\n                _o25 = void 0;\n              if (\"constant\" === _i78.kind) {\n                if (_a52 = _i78.value, !_a52) continue;\n              } else _a52 = _i78.evaluate({\n                zoom: r\n              }, t);\n              _o25 = \"constant\" === _s52.kind ? _s52.value : _s52.evaluate({\n                zoom: r\n              }, t), e.addDash(_a52, _o25), t.patterns[_n70.id] = e.getKey(_a52, _o25);\n            }\n          } catch (err) {\n            _iterator97.e(err);\n          } finally {\n            _iterator97.f();\n          }\n        }\n      }, {\n        key: \"update\",\n        value: function update(t, e, r, n) {\n          this.stateDependentLayers.length && this.programConfigurations.updatePaintArrays(t, e, this.stateDependentLayers, r, n);\n        }\n      }, {\n        key: \"addFeatures\",\n        value: function addFeatures(t, e, r, n, i) {\n          var _iterator98 = _createForOfIteratorHelper(this.patternFeatures),\n            _step98;\n          try {\n            for (_iterator98.s(); !(_step98 = _iterator98.n()).done;) {\n              var _t127 = _step98.value;\n              this.addFeature(_t127, _t127.geometry, _t127.index, e, r, n);\n            }\n          } catch (err) {\n            _iterator98.e(err);\n          } finally {\n            _iterator98.f();\n          }\n        }\n      }, {\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return 0 === this.layoutVertexArray.length;\n        }\n      }, {\n        key: \"uploadPending\",\n        value: function uploadPending() {\n          return !this.uploaded || this.programConfigurations.needsUpload;\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          this.uploaded || (0 !== this.layoutVertexArray2.length && (this.layoutVertexBuffer2 = t.createVertexBuffer(this.layoutVertexArray2, Lh)), this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Dh), this.indexBuffer = t.createIndexBuffer(this.indexArray)), this.programConfigurations.upload(t), this.uploaded = !0;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy());\n        }\n      }, {\n        key: \"lineFeatureClips\",\n        value: function lineFeatureClips(t) {\n          if (t.properties && t.properties.hasOwnProperty(\"mapbox_clip_start\") && t.properties.hasOwnProperty(\"mapbox_clip_end\")) return {\n            start: +t.properties.mapbox_clip_start,\n            end: +t.properties.mapbox_clip_end\n          };\n        }\n      }, {\n        key: \"addFeature\",\n        value: function addFeature(t, e, r, n, i, s) {\n          var a = this.layers[0].layout,\n            o = a.get(\"line-join\").evaluate(t, {}),\n            l = a.get(\"line-cap\").evaluate(t, {}),\n            u = a.get(\"line-miter-limit\"),\n            c = a.get(\"line-round-limit\");\n          this.lineClips = this.lineFeatureClips(t);\n          var _iterator99 = _createForOfIteratorHelper(e),\n            _step99;\n          try {\n            for (_iterator99.s(); !(_step99 = _iterator99.n()).done;) {\n              var _r105 = _step99.value;\n              this.addLine(_r105, t, o, l, u, c);\n            }\n          } catch (err) {\n            _iterator99.e(err);\n          } finally {\n            _iterator99.f();\n          }\n          this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length, t, r, i, s, n);\n        }\n      }, {\n        key: \"addLine\",\n        value: function addLine(t, e, r, n, i, s) {\n          if (this.distance = 0, this.scaledDistance = 0, this.totalDistance = 0, this.lineSoFar = 0, this.lineClips) {\n            this.lineClipsArray.push(this.lineClips);\n            for (var _e120 = 0; _e120 < t.length - 1; _e120++) this.totalDistance += t[_e120].dist(t[_e120 + 1]);\n            this.updateScaledDistance(), this.maxLineLength = Math.max(this.maxLineLength, this.totalDistance);\n          }\n          var a = \"Polygon\" === Fh[e.type];\n          var o = t.length;\n          for (; o >= 2 && t[o - 1].equals(t[o - 2]);) o--;\n          var l = 0;\n          for (; l < o - 1 && t[l].equals(t[l + 1]);) l++;\n          if (o < (a ? 3 : 2)) return;\n          \"bevel\" === r && (i = 1.05);\n          var u = this.overscaling <= 16 ? 122880 / (512 * this.overscaling) : 0,\n            c = this.segments.prepareSegment(10 * o, this.layoutVertexArray, this.indexArray);\n          var h, p, f, d, y;\n          this.e1 = this.e2 = -1, a && (h = t[o - 2], y = t[l].sub(h)._unit()._perp());\n          for (var _e121 = l; _e121 < o; _e121++) {\n            if (f = _e121 === o - 1 ? a ? t[l + 1] : void 0 : t[_e121 + 1], f && t[_e121].equals(f)) continue;\n            y && (d = y), h && (p = h), h = t[_e121], y = f ? f.sub(h)._unit()._perp() : d, d = d || y;\n            var _m2 = d.add(y);\n            0 === _m2.x && 0 === _m2.y || _m2._unit();\n            var _g3 = d.x * y.x + d.y * y.y,\n              _x3 = _m2.x * y.x + _m2.y * y.y,\n              _v2 = 0 !== _x3 ? 1 / _x3 : 1 / 0,\n              _b2 = 2 * Math.sqrt(2 - 2 * _x3),\n              _w2 = _x3 < Rh && p && f,\n              _3 = d.x * y.y - d.y * y.x > 0;\n            if (_w2 && _e121 > l) {\n              var _t128 = h.dist(p);\n              if (_t128 > 2 * u) {\n                var _e122 = h.sub(h.sub(p)._mult(u / _t128)._round());\n                this.updateDistance(p, _e122), this.addCurrentVertex(_e122, d, 0, 0, c), p = _e122;\n              }\n            }\n            var _A2 = p && f;\n            var _S2 = _A2 ? r : a ? \"butt\" : n;\n            if (_A2 && \"round\" === _S2 && (_v2 < s ? _S2 = \"miter\" : _v2 <= 2 && (_S2 = \"fakeround\")), \"miter\" === _S2 && _v2 > i && (_S2 = \"bevel\"), \"bevel\" === _S2 && (_v2 > 2 && (_S2 = \"flipbevel\"), _v2 < i && (_S2 = \"miter\")), p && this.updateDistance(p, h), \"miter\" === _S2) _m2._mult(_v2), this.addCurrentVertex(h, _m2, 0, 0, c);else if (\"flipbevel\" === _S2) {\n              if (_v2 > 100) _m2 = y.mult(-1);else {\n                var _t129 = _v2 * d.add(y).mag() / d.sub(y).mag();\n                _m2._perp()._mult(_t129 * (_3 ? -1 : 1));\n              }\n              this.addCurrentVertex(h, _m2, 0, 0, c), this.addCurrentVertex(h, _m2.mult(-1), 0, 0, c);\n            } else if (\"bevel\" === _S2 || \"fakeround\" === _S2) {\n              var _t130 = -Math.sqrt(_v2 * _v2 - 1),\n                _e123 = _3 ? _t130 : 0,\n                _r106 = _3 ? 0 : _t130;\n              if (p && this.addCurrentVertex(h, d, _e123, _r106, c), \"fakeround\" === _S2) {\n                var _t131 = Math.round(180 * _b2 / Math.PI / 20);\n                for (var _e124 = 1; _e124 < _t131; _e124++) {\n                  var _r107 = _e124 / _t131;\n                  if (.5 !== _r107) {\n                    var _t132 = _r107 - .5;\n                    _r107 += _r107 * _t132 * (_r107 - 1) * ((1.0904 + _g3 * (_g3 * (3.55645 - 1.43519 * _g3) - 3.2452)) * _t132 * _t132 + (.848013 + _g3 * (.215638 * _g3 - 1.06021)));\n                  }\n                  var _n71 = y.sub(d)._mult(_r107)._add(d)._unit()._mult(_3 ? -1 : 1);\n                  this.addHalfVertex(h, _n71.x, _n71.y, !1, _3, 0, c);\n                }\n              }\n              f && this.addCurrentVertex(h, y, -_e123, -_r106, c);\n            } else if (\"butt\" === _S2) this.addCurrentVertex(h, _m2, 0, 0, c);else if (\"square\" === _S2) {\n              var _t133 = p ? 1 : -1;\n              p || this.addCurrentVertex(h, _m2, _t133, _t133, c), this.addCurrentVertex(h, _m2, 0, 0, c), p && this.addCurrentVertex(h, _m2, _t133, _t133, c);\n            } else \"round\" === _S2 && (p && (this.addCurrentVertex(h, d, 0, 0, c), this.addCurrentVertex(h, d, 1, 1, c, !0)), f && (this.addCurrentVertex(h, y, -1, -1, c, !0), this.addCurrentVertex(h, y, 0, 0, c)));\n            if (_w2 && _e121 < o - 1) {\n              var _t134 = h.dist(f);\n              if (_t134 > 2 * u) {\n                var _e125 = h.add(f.sub(h)._mult(u / _t134)._round());\n                this.updateDistance(h, _e125), this.addCurrentVertex(_e125, y, 0, 0, c), h = _e125;\n              }\n            }\n          }\n        }\n      }, {\n        key: \"addCurrentVertex\",\n        value: function addCurrentVertex(t, e, r, n, i) {\n          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !1;\n          var a = e.y * n - e.x,\n            o = -e.y - e.x * n;\n          this.addHalfVertex(t, e.x + e.y * r, e.y - e.x * r, s, !1, r, i), this.addHalfVertex(t, a, o, s, !0, -n, i);\n        }\n      }, {\n        key: \"addHalfVertex\",\n        value: function addHalfVertex(_ref116, r, n, i, s, a, o) {\n          var t = _ref116.x,\n            e = _ref116.y;\n          this.layoutVertexArray.emplaceBack((t << 1) + (i ? 1 : 0), (e << 1) + (s ? 1 : 0), Math.round(63 * r) + 128, Math.round(63 * n) + 128, 1 + (0 === a ? 0 : a < 0 ? -1 : 1), 0, this.lineSoFar), this.lineClips && this.layoutVertexArray2.emplaceBack(this.scaledDistance, this.lineClipsArray.length, this.lineClips.start, this.lineClips.end);\n          var l = o.vertexLength++;\n          this.e1 >= 0 && this.e2 >= 0 && (this.indexArray.emplaceBack(this.e1, this.e2, l), o.primitiveLength++), s ? this.e2 = l : this.e1 = l;\n        }\n      }, {\n        key: \"updateScaledDistance\",\n        value: function updateScaledDistance() {\n          if (this.lineClips) {\n            var _t135 = this.totalDistance / (this.lineClips.end - this.lineClips.start);\n            this.scaledDistance = this.distance / this.totalDistance, this.lineSoFar = _t135 * this.lineClips.start + this.distance;\n          } else this.lineSoFar = this.distance;\n        }\n      }, {\n        key: \"updateDistance\",\n        value: function updateDistance(t, e) {\n          this.distance += t.dist(e), this.updateScaledDistance();\n        }\n      }]);\n      return jh;\n    }();\n    Oi(jh, \"LineBucket\", {\n      omit: [\"layers\", \"patternFeatures\"]\n    });\n    var $h = new Js({\n      \"line-cap\": new Hs(Ht.layout_line[\"line-cap\"]),\n      \"line-join\": new Hs(Ht.layout_line[\"line-join\"]),\n      \"line-miter-limit\": new Ys(Ht.layout_line[\"line-miter-limit\"]),\n      \"line-round-limit\": new Ys(Ht.layout_line[\"line-round-limit\"]),\n      \"line-sort-key\": new Hs(Ht.layout_line[\"line-sort-key\"])\n    });\n    var Uh = {\n      paint: new Js({\n        \"line-opacity\": new Hs(Ht.paint_line[\"line-opacity\"]),\n        \"line-color\": new Hs(Ht.paint_line[\"line-color\"]),\n        \"line-translate\": new Ys(Ht.paint_line[\"line-translate\"]),\n        \"line-translate-anchor\": new Ys(Ht.paint_line[\"line-translate-anchor\"]),\n        \"line-width\": new Hs(Ht.paint_line[\"line-width\"]),\n        \"line-gap-width\": new Hs(Ht.paint_line[\"line-gap-width\"]),\n        \"line-offset\": new Hs(Ht.paint_line[\"line-offset\"]),\n        \"line-blur\": new Hs(Ht.paint_line[\"line-blur\"]),\n        \"line-dasharray\": new Hs(Ht.paint_line[\"line-dasharray\"]),\n        \"line-pattern\": new Hs(Ht.paint_line[\"line-pattern\"]),\n        \"line-gradient\": new Ws(Ht.paint_line[\"line-gradient\"]),\n        \"line-trim-offset\": new Ys(Ht.paint_line[\"line-trim-offset\"])\n      }),\n      layout: $h\n    };\n    var Oh = new ( /*#__PURE__*/function (_Hs) {\n      _inherits(_class5, _Hs);\n      function _class5() {\n        _classCallCheck(this, _class5);\n        return _possibleConstructorReturn(this, _getPrototypeOf(_class5).apply(this, arguments));\n      }\n      _createClass(_class5, [{\n        key: \"possiblyEvaluate\",\n        value: function possiblyEvaluate(t, e) {\n          return e = new $s(Math.floor(e.zoom), {\n            now: e.now,\n            fadeDuration: e.fadeDuration,\n            transition: e.transition\n          }), _get(_getPrototypeOf(_class5.prototype), \"possiblyEvaluate\", this).call(this, t, e);\n        }\n      }, {\n        key: \"evaluate\",\n        value: function evaluate(t, e, r, n) {\n          return e = z({}, e, {\n            zoom: Math.floor(e.zoom)\n          }), _get(_getPrototypeOf(_class5.prototype), \"evaluate\", this).call(this, t, e, r, n);\n        }\n      }]);\n      return _class5;\n    }(Hs))(Uh.paint.properties[\"line-width\"].specification);\n    function qh(t, e) {\n      return e > 0 ? e + 2 * t : t;\n    }\n    Oh.useIntegerZoom = !0;\n    var Nh = na([{\n        name: \"a_pos_offset\",\n        components: 4,\n        type: \"Int16\"\n      }, {\n        name: \"a_tex_size\",\n        components: 4,\n        type: \"Uint16\"\n      }, {\n        name: \"a_pixeloffset\",\n        components: 4,\n        type: \"Int16\"\n      }], 4),\n      Gh = na([{\n        name: \"a_globe_anchor\",\n        components: 3,\n        type: \"Int16\"\n      }, {\n        name: \"a_globe_normal\",\n        components: 3,\n        type: \"Float32\"\n      }], 4),\n      Zh = na([{\n        name: \"a_projected_pos\",\n        components: 4,\n        type: \"Float32\"\n      }], 4);\n    na([{\n      name: \"a_fade_opacity\",\n      components: 1,\n      type: \"Uint32\"\n    }], 4);\n    var Xh = na([{\n        name: \"a_placed\",\n        components: 2,\n        type: \"Uint8\"\n      }, {\n        name: \"a_shift\",\n        components: 2,\n        type: \"Float32\"\n      }]),\n      Kh = na([{\n        name: \"a_size_scale\",\n        components: 1,\n        type: \"Float32\"\n      }, {\n        name: \"a_padding\",\n        components: 2,\n        type: \"Float32\"\n      }]);\n    na([{\n      type: \"Int16\",\n      name: \"projectedAnchorX\"\n    }, {\n      type: \"Int16\",\n      name: \"projectedAnchorY\"\n    }, {\n      type: \"Int16\",\n      name: \"projectedAnchorZ\"\n    }, {\n      type: \"Int16\",\n      name: \"tileAnchorX\"\n    }, {\n      type: \"Int16\",\n      name: \"tileAnchorY\"\n    }, {\n      type: \"Float32\",\n      name: \"x1\"\n    }, {\n      type: \"Float32\",\n      name: \"y1\"\n    }, {\n      type: \"Float32\",\n      name: \"x2\"\n    }, {\n      type: \"Float32\",\n      name: \"y2\"\n    }, {\n      type: \"Int16\",\n      name: \"padding\"\n    }, {\n      type: \"Uint32\",\n      name: \"featureIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"sourceLayerIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"bucketIndex\"\n    }]);\n    var Yh = na([{\n        name: \"a_pos\",\n        components: 3,\n        type: \"Int16\"\n      }, {\n        name: \"a_anchor_pos\",\n        components: 2,\n        type: \"Int16\"\n      }, {\n        name: \"a_extrude\",\n        components: 2,\n        type: \"Int16\"\n      }], 4),\n      Hh = na([{\n        name: \"a_pos_2f\",\n        components: 2,\n        type: \"Float32\"\n      }, {\n        name: \"a_radius\",\n        components: 1,\n        type: \"Float32\"\n      }, {\n        name: \"a_flags\",\n        components: 2,\n        type: \"Int16\"\n      }], 4);\n    na([{\n      name: \"triangle\",\n      components: 3,\n      type: \"Uint16\"\n    }]), na([{\n      type: \"Int16\",\n      name: \"projectedAnchorX\"\n    }, {\n      type: \"Int16\",\n      name: \"projectedAnchorY\"\n    }, {\n      type: \"Int16\",\n      name: \"projectedAnchorZ\"\n    }, {\n      type: \"Float32\",\n      name: \"tileAnchorX\"\n    }, {\n      type: \"Float32\",\n      name: \"tileAnchorY\"\n    }, {\n      type: \"Uint16\",\n      name: \"glyphStartIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"numGlyphs\"\n    }, {\n      type: \"Uint32\",\n      name: \"vertexStartIndex\"\n    }, {\n      type: \"Uint32\",\n      name: \"lineStartIndex\"\n    }, {\n      type: \"Uint32\",\n      name: \"lineLength\"\n    }, {\n      type: \"Uint16\",\n      name: \"segment\"\n    }, {\n      type: \"Uint16\",\n      name: \"lowerSize\"\n    }, {\n      type: \"Uint16\",\n      name: \"upperSize\"\n    }, {\n      type: \"Float32\",\n      name: \"lineOffsetX\"\n    }, {\n      type: \"Float32\",\n      name: \"lineOffsetY\"\n    }, {\n      type: \"Uint8\",\n      name: \"writingMode\"\n    }, {\n      type: \"Uint8\",\n      name: \"placedOrientation\"\n    }, {\n      type: \"Uint8\",\n      name: \"hidden\"\n    }, {\n      type: \"Uint32\",\n      name: \"crossTileID\"\n    }, {\n      type: \"Int16\",\n      name: \"associatedIconIndex\"\n    }, {\n      type: \"Uint8\",\n      name: \"flipState\"\n    }]), na([{\n      type: \"Int16\",\n      name: \"projectedAnchorX\"\n    }, {\n      type: \"Int16\",\n      name: \"projectedAnchorY\"\n    }, {\n      type: \"Int16\",\n      name: \"projectedAnchorZ\"\n    }, {\n      type: \"Float32\",\n      name: \"tileAnchorX\"\n    }, {\n      type: \"Float32\",\n      name: \"tileAnchorY\"\n    }, {\n      type: \"Int16\",\n      name: \"rightJustifiedTextSymbolIndex\"\n    }, {\n      type: \"Int16\",\n      name: \"centerJustifiedTextSymbolIndex\"\n    }, {\n      type: \"Int16\",\n      name: \"leftJustifiedTextSymbolIndex\"\n    }, {\n      type: \"Int16\",\n      name: \"verticalPlacedTextSymbolIndex\"\n    }, {\n      type: \"Int16\",\n      name: \"placedIconSymbolIndex\"\n    }, {\n      type: \"Int16\",\n      name: \"verticalPlacedIconSymbolIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"key\"\n    }, {\n      type: \"Uint16\",\n      name: \"textBoxStartIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"textBoxEndIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"verticalTextBoxStartIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"verticalTextBoxEndIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"iconBoxStartIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"iconBoxEndIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"verticalIconBoxStartIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"verticalIconBoxEndIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"featureIndex\"\n    }, {\n      type: \"Uint16\",\n      name: \"numHorizontalGlyphVertices\"\n    }, {\n      type: \"Uint16\",\n      name: \"numVerticalGlyphVertices\"\n    }, {\n      type: \"Uint16\",\n      name: \"numIconVertices\"\n    }, {\n      type: \"Uint16\",\n      name: \"numVerticalIconVertices\"\n    }, {\n      type: \"Uint16\",\n      name: \"useRuntimeCollisionCircles\"\n    }, {\n      type: \"Uint32\",\n      name: \"crossTileID\"\n    }, {\n      type: \"Float32\",\n      components: 2,\n      name: \"textOffset\"\n    }, {\n      type: \"Float32\",\n      name: \"collisionCircleDiameter\"\n    }]), na([{\n      type: \"Float32\",\n      name: \"offsetX\"\n    }]), na([{\n      type: \"Int16\",\n      name: \"x\"\n    }, {\n      type: \"Int16\",\n      name: \"y\"\n    }]);\n    var Wh = 24;\n    var Jh = 128;\n    function Qh(t, e) {\n      var r = e.expression;\n      if (\"constant\" === r.kind) return {\n        kind: \"constant\",\n        layoutSize: r.evaluate(new $s(t + 1))\n      };\n      if (\"source\" === r.kind) return {\n        kind: \"source\"\n      };\n      {\n        var _e126 = r.zoomStops,\n          _n72 = r.interpolationType;\n        var _i79 = 0;\n        for (; _i79 < _e126.length && _e126[_i79] <= t;) _i79++;\n        _i79 = Math.max(0, _i79 - 1);\n        var _s53 = _i79;\n        for (; _s53 < _e126.length && _e126[_s53] < t + 1;) _s53++;\n        _s53 = Math.min(_e126.length - 1, _s53);\n        var _a53 = _e126[_i79],\n          _o26 = _e126[_s53];\n        return \"composite\" === r.kind ? {\n          kind: \"composite\",\n          minZoom: _a53,\n          maxZoom: _o26,\n          interpolationType: _n72\n        } : {\n          kind: \"camera\",\n          minZoom: _a53,\n          maxZoom: _o26,\n          minSize: r.evaluate(new $s(_a53)),\n          maxSize: r.evaluate(new $s(_o26)),\n          interpolationType: _n72\n        };\n      }\n    }\n    function tp(t, _ref117, _ref118) {\n      var e = _ref117.uSize,\n        r = _ref117.uSizeT;\n      var n = _ref118.lowerSize,\n        i = _ref118.upperSize;\n      return \"source\" === t.kind ? n / Jh : \"composite\" === t.kind ? Mr(n / Jh, i / Jh, r) : e;\n    }\n    function ep(t, e) {\n      var r = 0,\n        n = 0;\n      if (\"constant\" === t.kind) n = t.layoutSize;else if (\"source\" !== t.kind) {\n        var _i80 = t.interpolationType,\n          _s54 = t.minZoom,\n          _a54 = t.maxZoom,\n          _o27 = _i80 ? S(Kr.interpolationFactor(_i80, e, _s54, _a54), 0, 1) : 0;\n        \"camera\" === t.kind ? n = Mr(t.minSize, t.maxSize, _o27) : r = _o27;\n      }\n      return {\n        uSizeT: r,\n        uSize: n\n      };\n    }\n    var rp = Object.freeze({\n      __proto__: null,\n      getSizeData: Qh,\n      evaluateSizeForFeature: tp,\n      evaluateSizeForZoom: ep,\n      SIZE_PACK_FACTOR: Jh\n    });\n    function np(t, e, r) {\n      return t.sections.forEach(function (t) {\n        t.text = function (t, e, r) {\n          var n = e.layout.get(\"text-transform\").evaluate(r, {});\n          return \"uppercase\" === n ? t = t.toLocaleUpperCase() : \"lowercase\" === n && (t = t.toLocaleLowerCase()), js.applyArabicShaping && (t = js.applyArabicShaping(t)), t;\n        }(t.text, e, r);\n      }), t;\n    }\n    var ip = {\n      \"!\": \"ï¸\",\n      \"#\": \"ï¼\",\n      $: \"ï¼\",\n      \"%\": \"ï¼\",\n      \"&\": \"ï¼\",\n      \"(\": \"ï¸µ\",\n      \")\": \"ï¸¶\",\n      \"*\": \"ï¼\",\n      \"+\": \"ï¼\",\n      \",\": \"ï¸\",\n      \"-\": \"ï¸²\",\n      \".\": \"ã»\",\n      \"/\": \"ï¼\",\n      \":\": \"ï¸\",\n      \";\": \"ï¸\",\n      \"<\": \"ï¸¿\",\n      \"=\": \"ï¼\",\n      \">\": \"ï¹\",\n      \"?\": \"ï¸\",\n      \"@\": \"ï¼ \",\n      \"[\": \"ï¹\",\n      \"\\\\\": \"ï¼¼\",\n      \"]\": \"ï¹\",\n      \"^\": \"ï¼¾\",\n      _: \"ï¸³\",\n      \"`\": \"ï½\",\n      \"{\": \"ï¸·\",\n      \"|\": \"â\",\n      \"}\": \"ï¸¸\",\n      \"~\": \"ï½\",\n      \"Â¢\": \"ï¿ \",\n      \"Â£\": \"ï¿¡\",\n      \"Â¥\": \"ï¿¥\",\n      \"Â¦\": \"ï¿¤\",\n      \"Â¬\": \"ï¿¢\",\n      \"Â¯\": \"ï¿£\",\n      \"â\": \"ï¸²\",\n      \"â\": \"ï¸±\",\n      \"â\": \"ï¹\",\n      \"â\": \"ï¹\",\n      \"â\": \"ï¹\",\n      \"â\": \"ï¹\",\n      \"â¦\": \"ï¸\",\n      \"â§\": \"ã»\",\n      \"â©\": \"ï¿¦\",\n      \"ã\": \"ï¸\",\n      \"ã\": \"ï¸\",\n      \"ã\": \"ï¸¿\",\n      \"ã\": \"ï¹\",\n      \"ã\": \"ï¸½\",\n      \"ã\": \"ï¸¾\",\n      \"ã\": \"ï¹\",\n      \"ã\": \"ï¹\",\n      \"ã\": \"ï¹\",\n      \"ã\": \"ï¹\",\n      \"ã\": \"ï¸»\",\n      \"ã\": \"ï¸¼\",\n      \"ã\": \"ï¸¹\",\n      \"ã\": \"ï¸º\",\n      \"ã\": \"ï¸\",\n      \"ã\": \"ï¸\",\n      \"ï¼\": \"ï¸\",\n      \"ï¼\": \"ï¸µ\",\n      \"ï¼\": \"ï¸¶\",\n      \"ï¼\": \"ï¸\",\n      \"ï¼\": \"ï¸²\",\n      \"ï¼\": \"ã»\",\n      \"ï¼\": \"ï¸\",\n      \"ï¼\": \"ï¸\",\n      \"ï¼\": \"ï¸¿\",\n      \"ï¼\": \"ï¹\",\n      \"ï¼\": \"ï¸\",\n      \"ï¼»\": \"ï¹\",\n      \"ï¼½\": \"ï¹\",\n      \"ï¼¿\": \"ï¸³\",\n      \"ï½\": \"ï¸·\",\n      \"ï½\": \"â\",\n      \"ï½\": \"ï¸¸\",\n      \"ï½\": \"ï¸µ\",\n      \"ï½ \": \"ï¸¶\",\n      \"ï½¡\": \"ï¸\",\n      \"ï½¢\": \"ï¹\",\n      \"ï½£\": \"ï¹\",\n      \"â\": \"â\",\n      \"â\": \"â\"\n    };\n    function sp(t) {\n      return \"ï¸¶\" === t || \"ï¹\" === t || \"ï¸¸\" === t || \"ï¹\" === t || \"ï¹\" === t || \"ï¸¾\" === t || \"ï¸¼\" === t || \"ï¸º\" === t || \"ï¸\" === t || \"ï¹\" === t || \"ï¸\" === t || \"ï¸\" === t || \"ï¸\" === t || \"ï½\" === t || \"ï¿£\" === t || \"ï¸\" === t || \"ï¸\" === t;\n    }\n    function ap(t) {\n      return \"ï¸µ\" === t || \"ï¹\" === t || \"ï¸·\" === t || \"ï¹\" === t || \"ï¹\" === t || \"ï¸½\" === t || \"ï¸»\" === t || \"ï¸¹\" === t || \"ï¸\" === t || \"ï¸¿\" === t;\n    }\n    var op = cp,\n      lp = function lp(t, e, r, n, i) {\n        var s,\n          a,\n          o = 8 * i - n - 1,\n          l = (1 << o) - 1,\n          u = l >> 1,\n          c = -7,\n          h = r ? i - 1 : 0,\n          p = r ? -1 : 1,\n          f = t[e + h];\n        for (h += p, s = f & (1 << -c) - 1, f >>= -c, c += o; c > 0; s = 256 * s + t[e + h], h += p, c -= 8);\n        for (a = s & (1 << -c) - 1, s >>= -c, c += n; c > 0; a = 256 * a + t[e + h], h += p, c -= 8);\n        if (0 === s) s = 1 - u;else {\n          if (s === l) return a ? NaN : 1 / 0 * (f ? -1 : 1);\n          a += Math.pow(2, n), s -= u;\n        }\n        return (f ? -1 : 1) * a * Math.pow(2, s - n);\n      },\n      up = function up(t, e, r, n, i, s) {\n        var a,\n          o,\n          l,\n          u = 8 * s - i - 1,\n          c = (1 << u) - 1,\n          h = c >> 1,\n          p = 23 === i ? Math.pow(2, -24) - Math.pow(2, -77) : 0,\n          f = n ? 0 : s - 1,\n          d = n ? 1 : -1,\n          y = e < 0 || 0 === e && 1 / e < 0 ? 1 : 0;\n        for (e = Math.abs(e), isNaN(e) || e === 1 / 0 ? (o = isNaN(e) ? 1 : 0, a = c) : (a = Math.floor(Math.log(e) / Math.LN2), e * (l = Math.pow(2, -a)) < 1 && (a--, l *= 2), (e += a + h >= 1 ? p / l : p * Math.pow(2, 1 - h)) * l >= 2 && (a++, l /= 2), a + h >= c ? (o = 0, a = c) : a + h >= 1 ? (o = (e * l - 1) * Math.pow(2, i), a += h) : (o = e * Math.pow(2, h - 1) * Math.pow(2, i), a = 0)); i >= 8; t[r + f] = 255 & o, f += d, o /= 256, i -= 8);\n        for (a = a << i | o, u += i; u > 0; t[r + f] = 255 & a, f += d, a /= 256, u -= 8);\n        t[r + f - d] |= 128 * y;\n      };\n    /*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\n    function cp(t) {\n      this.buf = ArrayBuffer.isView && ArrayBuffer.isView(t) ? t : new Uint8Array(t || 0), this.pos = 0, this.type = 0, this.length = this.buf.length;\n    }\n    cp.Varint = 0, cp.Fixed64 = 1, cp.Bytes = 2, cp.Fixed32 = 5;\n    var hp = 4294967296,\n      pp = 1 / hp,\n      fp = \"undefined\" == typeof TextDecoder ? null : new TextDecoder(\"utf8\");\n    function dp(t) {\n      return t.type === cp.Bytes ? t.readVarint() + t.pos : t.pos + 1;\n    }\n    function yp(t, e, r) {\n      return r ? 4294967296 * e + (t >>> 0) : 4294967296 * (e >>> 0) + (t >>> 0);\n    }\n    function mp(t, e, r) {\n      var n = e <= 16383 ? 1 : e <= 2097151 ? 2 : e <= 268435455 ? 3 : Math.floor(Math.log(e) / (7 * Math.LN2));\n      r.realloc(n);\n      for (var i = r.pos - 1; i >= t; i--) r.buf[i + n] = r.buf[i];\n    }\n    function gp(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeVarint(t[r]);\n    }\n    function xp(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeSVarint(t[r]);\n    }\n    function vp(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeFloat(t[r]);\n    }\n    function bp(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeDouble(t[r]);\n    }\n    function wp(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeBoolean(t[r]);\n    }\n    function _p(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeFixed32(t[r]);\n    }\n    function Ap(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeSFixed32(t[r]);\n    }\n    function Sp(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeFixed64(t[r]);\n    }\n    function kp(t, e) {\n      for (var r = 0; r < t.length; r++) e.writeSFixed64(t[r]);\n    }\n    function Ip(t, e) {\n      return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + 16777216 * t[e + 3];\n    }\n    function Mp(t, e, r) {\n      t[r] = e, t[r + 1] = e >>> 8, t[r + 2] = e >>> 16, t[r + 3] = e >>> 24;\n    }\n    function Tp(t, e) {\n      return (t[e] | t[e + 1] << 8 | t[e + 2] << 16) + (t[e + 3] << 24);\n    }\n    function zp(t, e, r) {\n      e.glyphs = [], 1 === t && r.readMessage(Bp, e);\n    }\n    function Bp(t, e, r) {\n      if (3 === t) {\n        var _r$readMessage = r.readMessage(Ep, {}),\n          _t136 = _r$readMessage.id,\n          _n73 = _r$readMessage.bitmap,\n          _i81 = _r$readMessage.width,\n          _s55 = _r$readMessage.height,\n          _a55 = _r$readMessage.left,\n          _o28 = _r$readMessage.top,\n          _l23 = _r$readMessage.advance;\n        e.glyphs.push({\n          id: _t136,\n          bitmap: new Ju({\n            width: _i81 + 6,\n            height: _s55 + 6\n          }, _n73),\n          metrics: {\n            width: _i81,\n            height: _s55,\n            left: _a55,\n            top: _o28,\n            advance: _l23\n          }\n        });\n      } else 4 === t ? e.ascender = r.readSVarint() : 5 === t && (e.descender = r.readSVarint());\n    }\n    function Ep(t, e, r) {\n      1 === t ? e.id = r.readVarint() : 2 === t ? e.bitmap = r.readBytes() : 3 === t ? e.width = r.readVarint() : 4 === t ? e.height = r.readVarint() : 5 === t ? e.left = r.readSVarint() : 6 === t ? e.top = r.readSVarint() : 7 === t && (e.advance = r.readVarint());\n    }\n    function Cp(t) {\n      var e = 0,\n        r = 0;\n      var _iterator100 = _createForOfIteratorHelper(t),\n        _step100;\n      try {\n        for (_iterator100.s(); !(_step100 = _iterator100.n()).done;) {\n          var _n74 = _step100.value;\n          e += _n74.w * _n74.h, r = Math.max(r, _n74.w);\n        }\n      } catch (err) {\n        _iterator100.e(err);\n      } finally {\n        _iterator100.f();\n      }\n      t.sort(function (t, e) {\n        return e.h - t.h;\n      });\n      var n = [{\n        x: 0,\n        y: 0,\n        w: Math.max(Math.ceil(Math.sqrt(e / .95)), r),\n        h: 1 / 0\n      }];\n      var i = 0,\n        s = 0;\n      var _iterator101 = _createForOfIteratorHelper(t),\n        _step101;\n      try {\n        for (_iterator101.s(); !(_step101 = _iterator101.n()).done;) {\n          var _e127 = _step101.value;\n          for (var _t137 = n.length - 1; _t137 >= 0; _t137--) {\n            var _r108 = n[_t137];\n            if (!(_e127.w > _r108.w || _e127.h > _r108.h)) {\n              if (_e127.x = _r108.x, _e127.y = _r108.y, s = Math.max(s, _e127.y + _e127.h), i = Math.max(i, _e127.x + _e127.w), _e127.w === _r108.w && _e127.h === _r108.h) {\n                var _e128 = n.pop();\n                _t137 < n.length && (n[_t137] = _e128);\n              } else _e127.h === _r108.h ? (_r108.x += _e127.w, _r108.w -= _e127.w) : _e127.w === _r108.w ? (_r108.y += _e127.h, _r108.h -= _e127.h) : (n.push({\n                x: _r108.x + _e127.w,\n                y: _r108.y,\n                w: _r108.w - _e127.w,\n                h: _e127.h\n              }), _r108.y += _e127.h, _r108.h -= _e127.h);\n              break;\n            }\n          }\n        }\n      } catch (err) {\n        _iterator101.e(err);\n      } finally {\n        _iterator101.f();\n      }\n      return {\n        w: i,\n        h: s,\n        fill: e / (i * s) || 0\n      };\n    }\n    cp.prototype = {\n      destroy: function destroy() {\n        this.buf = null;\n      },\n      readFields: function readFields(t, e, r) {\n        for (r = r || this.length; this.pos < r;) {\n          var n = this.readVarint(),\n            i = n >> 3,\n            s = this.pos;\n          this.type = 7 & n, t(i, e, this), this.pos === s && this.skip(n);\n        }\n        return e;\n      },\n      readMessage: function readMessage(t, e) {\n        return this.readFields(t, e, this.readVarint() + this.pos);\n      },\n      readFixed32: function readFixed32() {\n        var t = Ip(this.buf, this.pos);\n        return this.pos += 4, t;\n      },\n      readSFixed32: function readSFixed32() {\n        var t = Tp(this.buf, this.pos);\n        return this.pos += 4, t;\n      },\n      readFixed64: function readFixed64() {\n        var t = Ip(this.buf, this.pos) + Ip(this.buf, this.pos + 4) * hp;\n        return this.pos += 8, t;\n      },\n      readSFixed64: function readSFixed64() {\n        var t = Ip(this.buf, this.pos) + Tp(this.buf, this.pos + 4) * hp;\n        return this.pos += 8, t;\n      },\n      readFloat: function readFloat() {\n        var t = lp(this.buf, this.pos, !0, 23, 4);\n        return this.pos += 4, t;\n      },\n      readDouble: function readDouble() {\n        var t = lp(this.buf, this.pos, !0, 52, 8);\n        return this.pos += 8, t;\n      },\n      readVarint: function readVarint(t) {\n        var e,\n          r,\n          n = this.buf;\n        return e = 127 & (r = n[this.pos++]), r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 7, r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 14, r < 128 ? e : (e |= (127 & (r = n[this.pos++])) << 21, r < 128 ? e : function (t, e, r) {\n          var n,\n            i,\n            s = r.buf;\n          if (n = (112 & (i = s[r.pos++])) >> 4, i < 128) return yp(t, n, e);\n          if (n |= (127 & (i = s[r.pos++])) << 3, i < 128) return yp(t, n, e);\n          if (n |= (127 & (i = s[r.pos++])) << 10, i < 128) return yp(t, n, e);\n          if (n |= (127 & (i = s[r.pos++])) << 17, i < 128) return yp(t, n, e);\n          if (n |= (127 & (i = s[r.pos++])) << 24, i < 128) return yp(t, n, e);\n          if (n |= (1 & (i = s[r.pos++])) << 31, i < 128) return yp(t, n, e);\n          throw new Error(\"Expected varint not more than 10 bytes\");\n        }(e |= (15 & (r = n[this.pos])) << 28, t, this))));\n      },\n      readVarint64: function readVarint64() {\n        return this.readVarint(!0);\n      },\n      readSVarint: function readSVarint() {\n        var t = this.readVarint();\n        return t % 2 == 1 ? (t + 1) / -2 : t / 2;\n      },\n      readBoolean: function readBoolean() {\n        return Boolean(this.readVarint());\n      },\n      readString: function readString() {\n        var t = this.readVarint() + this.pos,\n          e = this.pos;\n        return this.pos = t, t - e >= 12 && fp ? function (t, e, r) {\n          return fp.decode(t.subarray(e, r));\n        }(this.buf, e, t) : function (t, e, r) {\n          for (var n = \"\", i = e; i < r;) {\n            var s,\n              a,\n              o,\n              l = t[i],\n              u = null,\n              c = l > 239 ? 4 : l > 223 ? 3 : l > 191 ? 2 : 1;\n            if (i + c > r) break;\n            1 === c ? l < 128 && (u = l) : 2 === c ? 128 == (192 & (s = t[i + 1])) && (u = (31 & l) << 6 | 63 & s) <= 127 && (u = null) : 3 === c ? (a = t[i + 2], 128 == (192 & (s = t[i + 1])) && 128 == (192 & a) && ((u = (15 & l) << 12 | (63 & s) << 6 | 63 & a) <= 2047 || u >= 55296 && u <= 57343) && (u = null)) : 4 === c && (a = t[i + 2], o = t[i + 3], 128 == (192 & (s = t[i + 1])) && 128 == (192 & a) && 128 == (192 & o) && ((u = (15 & l) << 18 | (63 & s) << 12 | (63 & a) << 6 | 63 & o) <= 65535 || u >= 1114112) && (u = null)), null === u ? (u = 65533, c = 1) : u > 65535 && (u -= 65536, n += String.fromCharCode(u >>> 10 & 1023 | 55296), u = 56320 | 1023 & u), n += String.fromCharCode(u), i += c;\n          }\n          return n;\n        }(this.buf, e, t);\n      },\n      readBytes: function readBytes() {\n        var t = this.readVarint() + this.pos,\n          e = this.buf.subarray(this.pos, t);\n        return this.pos = t, e;\n      },\n      readPackedVarint: function readPackedVarint(t, e) {\n        if (this.type !== cp.Bytes) return t.push(this.readVarint(e));\n        var r = dp(this);\n        for (t = t || []; this.pos < r;) t.push(this.readVarint(e));\n        return t;\n      },\n      readPackedSVarint: function readPackedSVarint(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readSVarint());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readSVarint());\n        return t;\n      },\n      readPackedBoolean: function readPackedBoolean(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readBoolean());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readBoolean());\n        return t;\n      },\n      readPackedFloat: function readPackedFloat(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readFloat());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readFloat());\n        return t;\n      },\n      readPackedDouble: function readPackedDouble(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readDouble());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readDouble());\n        return t;\n      },\n      readPackedFixed32: function readPackedFixed32(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readFixed32());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readFixed32());\n        return t;\n      },\n      readPackedSFixed32: function readPackedSFixed32(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readSFixed32());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readSFixed32());\n        return t;\n      },\n      readPackedFixed64: function readPackedFixed64(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readFixed64());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readFixed64());\n        return t;\n      },\n      readPackedSFixed64: function readPackedSFixed64(t) {\n        if (this.type !== cp.Bytes) return t.push(this.readSFixed64());\n        var e = dp(this);\n        for (t = t || []; this.pos < e;) t.push(this.readSFixed64());\n        return t;\n      },\n      skip: function skip(t) {\n        var e = 7 & t;\n        if (e === cp.Varint) for (; this.buf[this.pos++] > 127;);else if (e === cp.Bytes) this.pos = this.readVarint() + this.pos;else if (e === cp.Fixed32) this.pos += 4;else {\n          if (e !== cp.Fixed64) throw new Error(\"Unimplemented type: \" + e);\n          this.pos += 8;\n        }\n      },\n      writeTag: function writeTag(t, e) {\n        this.writeVarint(t << 3 | e);\n      },\n      realloc: function realloc(t) {\n        for (var e = this.length || 16; e < this.pos + t;) e *= 2;\n        if (e !== this.length) {\n          var r = new Uint8Array(e);\n          r.set(this.buf), this.buf = r, this.length = e;\n        }\n      },\n      finish: function finish() {\n        return this.length = this.pos, this.pos = 0, this.buf.subarray(0, this.length);\n      },\n      writeFixed32: function writeFixed32(t) {\n        this.realloc(4), Mp(this.buf, t, this.pos), this.pos += 4;\n      },\n      writeSFixed32: function writeSFixed32(t) {\n        this.realloc(4), Mp(this.buf, t, this.pos), this.pos += 4;\n      },\n      writeFixed64: function writeFixed64(t) {\n        this.realloc(8), Mp(this.buf, -1 & t, this.pos), Mp(this.buf, Math.floor(t * pp), this.pos + 4), this.pos += 8;\n      },\n      writeSFixed64: function writeSFixed64(t) {\n        this.realloc(8), Mp(this.buf, -1 & t, this.pos), Mp(this.buf, Math.floor(t * pp), this.pos + 4), this.pos += 8;\n      },\n      writeVarint: function writeVarint(t) {\n        (t = +t || 0) > 268435455 || t < 0 ? function (t, e) {\n          var r, n;\n          if (t >= 0 ? (r = t % 4294967296 | 0, n = t / 4294967296 | 0) : (n = ~(-t / 4294967296), 4294967295 ^ (r = ~(-t % 4294967296)) ? r = r + 1 | 0 : (r = 0, n = n + 1 | 0)), t >= 0x10000000000000000 || t < -0x10000000000000000) throw new Error(\"Given varint doesn't fit into 10 bytes\");\n          e.realloc(10), function (t, e, r) {\n            r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, t >>>= 7, r.buf[r.pos++] = 127 & t | 128, r.buf[r.pos] = 127 & (t >>>= 7);\n          }(r, 0, e), function (t, e) {\n            var r = (7 & t) << 4;\n            e.buf[e.pos++] |= r | ((t >>>= 3) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t | ((t >>>= 7) ? 128 : 0), t && (e.buf[e.pos++] = 127 & t)))));\n          }(n, e);\n        }(t, this) : (this.realloc(4), this.buf[this.pos++] = 127 & t | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = 127 & (t >>>= 7) | (t > 127 ? 128 : 0), t <= 127 || (this.buf[this.pos++] = t >>> 7 & 127))));\n      },\n      writeSVarint: function writeSVarint(t) {\n        this.writeVarint(t < 0 ? 2 * -t - 1 : 2 * t);\n      },\n      writeBoolean: function writeBoolean(t) {\n        this.writeVarint(Boolean(t));\n      },\n      writeString: function writeString(t) {\n        t = String(t), this.realloc(4 * t.length), this.pos++;\n        var e = this.pos;\n        this.pos = function (t, e, r) {\n          for (var n, i, s = 0; s < e.length; s++) {\n            if ((n = e.charCodeAt(s)) > 55295 && n < 57344) {\n              if (!i) {\n                n > 56319 || s + 1 === e.length ? (t[r++] = 239, t[r++] = 191, t[r++] = 189) : i = n;\n                continue;\n              }\n              if (n < 56320) {\n                t[r++] = 239, t[r++] = 191, t[r++] = 189, i = n;\n                continue;\n              }\n              n = i - 55296 << 10 | n - 56320 | 65536, i = null;\n            } else i && (t[r++] = 239, t[r++] = 191, t[r++] = 189, i = null);\n            n < 128 ? t[r++] = n : (n < 2048 ? t[r++] = n >> 6 | 192 : (n < 65536 ? t[r++] = n >> 12 | 224 : (t[r++] = n >> 18 | 240, t[r++] = n >> 12 & 63 | 128), t[r++] = n >> 6 & 63 | 128), t[r++] = 63 & n | 128);\n          }\n          return r;\n        }(this.buf, t, this.pos);\n        var r = this.pos - e;\n        r >= 128 && mp(e, r, this), this.pos = e - 1, this.writeVarint(r), this.pos += r;\n      },\n      writeFloat: function writeFloat(t) {\n        this.realloc(4), up(this.buf, t, this.pos, !0, 23, 4), this.pos += 4;\n      },\n      writeDouble: function writeDouble(t) {\n        this.realloc(8), up(this.buf, t, this.pos, !0, 52, 8), this.pos += 8;\n      },\n      writeBytes: function writeBytes(t) {\n        var e = t.length;\n        this.writeVarint(e), this.realloc(e);\n        for (var r = 0; r < e; r++) this.buf[this.pos++] = t[r];\n      },\n      writeRawMessage: function writeRawMessage(t, e) {\n        this.pos++;\n        var r = this.pos;\n        t(e, this);\n        var n = this.pos - r;\n        n >= 128 && mp(r, n, this), this.pos = r - 1, this.writeVarint(n), this.pos += n;\n      },\n      writeMessage: function writeMessage(t, e, r) {\n        this.writeTag(t, cp.Bytes), this.writeRawMessage(e, r);\n      },\n      writePackedVarint: function writePackedVarint(t, e) {\n        e.length && this.writeMessage(t, gp, e);\n      },\n      writePackedSVarint: function writePackedSVarint(t, e) {\n        e.length && this.writeMessage(t, xp, e);\n      },\n      writePackedBoolean: function writePackedBoolean(t, e) {\n        e.length && this.writeMessage(t, wp, e);\n      },\n      writePackedFloat: function writePackedFloat(t, e) {\n        e.length && this.writeMessage(t, vp, e);\n      },\n      writePackedDouble: function writePackedDouble(t, e) {\n        e.length && this.writeMessage(t, bp, e);\n      },\n      writePackedFixed32: function writePackedFixed32(t, e) {\n        e.length && this.writeMessage(t, _p, e);\n      },\n      writePackedSFixed32: function writePackedSFixed32(t, e) {\n        e.length && this.writeMessage(t, Ap, e);\n      },\n      writePackedFixed64: function writePackedFixed64(t, e) {\n        e.length && this.writeMessage(t, Sp, e);\n      },\n      writePackedSFixed64: function writePackedSFixed64(t, e) {\n        e.length && this.writeMessage(t, kp, e);\n      },\n      writeBytesField: function writeBytesField(t, e) {\n        this.writeTag(t, cp.Bytes), this.writeBytes(e);\n      },\n      writeFixed32Field: function writeFixed32Field(t, e) {\n        this.writeTag(t, cp.Fixed32), this.writeFixed32(e);\n      },\n      writeSFixed32Field: function writeSFixed32Field(t, e) {\n        this.writeTag(t, cp.Fixed32), this.writeSFixed32(e);\n      },\n      writeFixed64Field: function writeFixed64Field(t, e) {\n        this.writeTag(t, cp.Fixed64), this.writeFixed64(e);\n      },\n      writeSFixed64Field: function writeSFixed64Field(t, e) {\n        this.writeTag(t, cp.Fixed64), this.writeSFixed64(e);\n      },\n      writeVarintField: function writeVarintField(t, e) {\n        this.writeTag(t, cp.Varint), this.writeVarint(e);\n      },\n      writeSVarintField: function writeSVarintField(t, e) {\n        this.writeTag(t, cp.Varint), this.writeSVarint(e);\n      },\n      writeStringField: function writeStringField(t, e) {\n        this.writeTag(t, cp.Bytes), this.writeString(e);\n      },\n      writeFloatField: function writeFloatField(t, e) {\n        this.writeTag(t, cp.Fixed32), this.writeFloat(e);\n      },\n      writeDoubleField: function writeDoubleField(t, e) {\n        this.writeTag(t, cp.Fixed64), this.writeDouble(e);\n      },\n      writeBooleanField: function writeBooleanField(t, e) {\n        this.writeVarintField(t, Boolean(e));\n      }\n    };\n    var Pp = /*#__PURE__*/function () {\n      function Pp(t, _ref119) {\n        var e = _ref119.pixelRatio,\n          r = _ref119.version,\n          n = _ref119.stretchX,\n          i = _ref119.stretchY,\n          s = _ref119.content;\n        _classCallCheck(this, Pp);\n        this.paddedRect = t, this.pixelRatio = e, this.stretchX = n, this.stretchY = i, this.content = s, this.version = r;\n      }\n      _createClass(Pp, [{\n        key: \"tl\",\n        get: function get() {\n          return [this.paddedRect.x + 1, this.paddedRect.y + 1];\n        }\n      }, {\n        key: \"br\",\n        get: function get() {\n          return [this.paddedRect.x + this.paddedRect.w - 1, this.paddedRect.y + this.paddedRect.h - 1];\n        }\n      }, {\n        key: \"displaySize\",\n        get: function get() {\n          return [(this.paddedRect.w - 2) / this.pixelRatio, (this.paddedRect.h - 2) / this.pixelRatio];\n        }\n      }]);\n      return Pp;\n    }();\n    var Dp = /*#__PURE__*/function () {\n      function Dp(t, e) {\n        _classCallCheck(this, Dp);\n        var r = {},\n          n = {};\n        this.haveRenderCallbacks = [];\n        var i = [];\n        this.addImages(t, r, i), this.addImages(e, n, i);\n        var _Cp = Cp(i),\n          s = _Cp.w,\n          a = _Cp.h,\n          o = new Qu({\n            width: s || 1,\n            height: a || 1\n          });\n        for (var _e129 in t) {\n          var _n75 = t[_e129],\n            _i82 = r[_e129].paddedRect;\n          Qu.copy(_n75.data, o, {\n            x: 0,\n            y: 0\n          }, {\n            x: _i82.x + 1,\n            y: _i82.y + 1\n          }, _n75.data);\n        }\n        for (var _t138 in e) {\n          var _r109 = e[_t138],\n            _i83 = n[_t138].paddedRect,\n            _s56 = _i83.x + 1,\n            _a56 = _i83.y + 1,\n            _l24 = _r109.data.width,\n            _u22 = _r109.data.height;\n          Qu.copy(_r109.data, o, {\n            x: 0,\n            y: 0\n          }, {\n            x: _s56,\n            y: _a56\n          }, _r109.data), Qu.copy(_r109.data, o, {\n            x: 0,\n            y: _u22 - 1\n          }, {\n            x: _s56,\n            y: _a56 - 1\n          }, {\n            width: _l24,\n            height: 1\n          }), Qu.copy(_r109.data, o, {\n            x: 0,\n            y: 0\n          }, {\n            x: _s56,\n            y: _a56 + _u22\n          }, {\n            width: _l24,\n            height: 1\n          }), Qu.copy(_r109.data, o, {\n            x: _l24 - 1,\n            y: 0\n          }, {\n            x: _s56 - 1,\n            y: _a56\n          }, {\n            width: 1,\n            height: _u22\n          }), Qu.copy(_r109.data, o, {\n            x: 0,\n            y: 0\n          }, {\n            x: _s56 + _l24,\n            y: _a56\n          }, {\n            width: 1,\n            height: _u22\n          });\n        }\n        this.image = o, this.iconPositions = r, this.patternPositions = n;\n      }\n      _createClass(Dp, [{\n        key: \"addImages\",\n        value: function addImages(t, e, r) {\n          for (var _n76 in t) {\n            var _i84 = t[_n76],\n              _s57 = {\n                x: 0,\n                y: 0,\n                w: _i84.data.width + 2,\n                h: _i84.data.height + 2\n              };\n            r.push(_s57), e[_n76] = new Pp(_s57, _i84), _i84.hasRenderCallback && this.haveRenderCallbacks.push(_n76);\n          }\n        }\n      }, {\n        key: \"patchUpdatedImages\",\n        value: function patchUpdatedImages(t, e) {\n          this.haveRenderCallbacks = this.haveRenderCallbacks.filter(function (e) {\n            return t.hasImage(e);\n          }), t.dispatchRenderCallbacks(this.haveRenderCallbacks);\n          for (var _r110 in t.updatedImages) this.patchUpdatedImage(this.iconPositions[_r110], t.getImage(_r110), e), this.patchUpdatedImage(this.patternPositions[_r110], t.getImage(_r110), e);\n        }\n      }, {\n        key: \"patchUpdatedImage\",\n        value: function patchUpdatedImage(t, e, r) {\n          if (!t || !e) return;\n          if (t.version === e.version) return;\n          t.version = e.version;\n          var _t$tl = _slicedToArray(t.tl, 2),\n            n = _t$tl[0],\n            i = _t$tl[1];\n          r.update(e.data, void 0, {\n            x: n,\n            y: i\n          });\n        }\n      }]);\n      return Dp;\n    }();\n    Oi(Pp, \"ImagePosition\"), Oi(Dp, \"ImageAtlas\");\n    var Vp = {\n      horizontal: 1,\n      vertical: 2,\n      horizontalOnly: 3\n    };\n    var Lp = /*#__PURE__*/function () {\n      function Lp() {\n        _classCallCheck(this, Lp);\n        this.scale = 1, this.fontStack = \"\", this.imageName = null;\n      }\n      _createClass(Lp, null, [{\n        key: \"forText\",\n        value: function forText(t, e) {\n          var r = new Lp();\n          return r.scale = t || 1, r.fontStack = e, r;\n        }\n      }, {\n        key: \"forImage\",\n        value: function forImage(t) {\n          var e = new Lp();\n          return e.imageName = t, e;\n        }\n      }]);\n      return Lp;\n    }();\n    var Fp = /*#__PURE__*/function () {\n      function Fp() {\n        _classCallCheck(this, Fp);\n        this.text = \"\", this.sectionIndex = [], this.sections = [], this.imageSectionID = null;\n      }\n      _createClass(Fp, [{\n        key: \"length\",\n        value: function length() {\n          return this.text.length;\n        }\n      }, {\n        key: \"getSection\",\n        value: function getSection(t) {\n          return this.sections[this.sectionIndex[t]];\n        }\n      }, {\n        key: \"getSections\",\n        value: function getSections() {\n          return this.sections;\n        }\n      }, {\n        key: \"getSectionIndex\",\n        value: function getSectionIndex(t) {\n          return this.sectionIndex[t];\n        }\n      }, {\n        key: \"getCharCode\",\n        value: function getCharCode(t) {\n          return this.text.charCodeAt(t);\n        }\n      }, {\n        key: \"verticalizePunctuation\",\n        value: function verticalizePunctuation(t) {\n          this.text = function (t, e) {\n            var r = \"\";\n            for (var _n77 = 0; _n77 < t.length; _n77++) {\n              var _i85 = t.charCodeAt(_n77 + 1) || null,\n                _s58 = t.charCodeAt(_n77 - 1) || null;\n              r += !e && (_i85 && Ss(_i85) && !ip[t[_n77 + 1]] || _s58 && Ss(_s58) && !ip[t[_n77 - 1]]) || !ip[t[_n77]] ? t[_n77] : ip[t[_n77]];\n            }\n            return r;\n          }(this.text, t);\n        }\n      }, {\n        key: \"trim\",\n        value: function trim() {\n          var t = 0;\n          for (var _e130 = 0; _e130 < this.text.length && jp[this.text.charCodeAt(_e130)]; _e130++) t++;\n          var e = this.text.length;\n          for (var _r111 = this.text.length - 1; _r111 >= 0 && _r111 >= t && jp[this.text.charCodeAt(_r111)]; _r111--) e--;\n          this.text = this.text.substring(t, e), this.sectionIndex = this.sectionIndex.slice(t, e);\n        }\n      }, {\n        key: \"substring\",\n        value: function substring(t, e) {\n          var r = new Fp();\n          return r.text = this.text.substring(t, e), r.sectionIndex = this.sectionIndex.slice(t, e), r.sections = this.sections, r;\n        }\n      }, {\n        key: \"toString\",\n        value: function toString() {\n          return this.text;\n        }\n      }, {\n        key: \"getMaxScale\",\n        value: function getMaxScale() {\n          var _this20 = this;\n          return this.sectionIndex.reduce(function (t, e) {\n            return Math.max(t, _this20.sections[e].scale);\n          }, 0);\n        }\n      }, {\n        key: \"addTextSection\",\n        value: function addTextSection(t, e) {\n          this.text += t.text, this.sections.push(Lp.forText(t.scale, t.fontStack || e));\n          var r = this.sections.length - 1;\n          for (var _e131 = 0; _e131 < t.text.length; ++_e131) this.sectionIndex.push(r);\n        }\n      }, {\n        key: \"addImageSection\",\n        value: function addImageSection(t) {\n          var e = t.image ? t.image.name : \"\";\n          if (0 === e.length) return void U(\"Can't add FormattedSection with an empty image.\");\n          var r = this.getNextImageSectionCharCode();\n          r ? (this.text += String.fromCharCode(r), this.sections.push(Lp.forImage(e)), this.sectionIndex.push(this.sections.length - 1)) : U(\"Reached maximum number of images 6401\");\n        }\n      }, {\n        key: \"getNextImageSectionCharCode\",\n        value: function getNextImageSectionCharCode() {\n          return this.imageSectionID ? this.imageSectionID >= 63743 ? null : ++this.imageSectionID : (this.imageSectionID = 57344, this.imageSectionID);\n        }\n      }], [{\n        key: \"fromFeature\",\n        value: function fromFeature(t, e) {\n          var r = new Fp();\n          for (var _n78 = 0; _n78 < t.sections.length; _n78++) {\n            var _i86 = t.sections[_n78];\n            _i86.image ? r.addImageSection(_i86) : r.addTextSection(_i86, e);\n          }\n          return r;\n        }\n      }]);\n      return Fp;\n    }();\n    function Rp(t, e, r, n, i, s, a, o, l, u, c, h, p, f, d) {\n      var y = Fp.fromFeature(t, i);\n      h === Vp.vertical && y.verticalizePunctuation(p);\n      var m = [];\n      var g = function (t, e, r, n, i, s) {\n          if (!t) return [];\n          var a = [],\n            o = function (t, e, r, n, i, s) {\n              var a = 0;\n              for (var _r112 = 0; _r112 < t.length(); _r112++) {\n                var _o29 = t.getSection(_r112);\n                a += Up(t.getCharCode(_r112), _o29, n, i, e, s);\n              }\n              return a / Math.max(1, Math.ceil(a / r));\n            }(t, e, r, n, i, s),\n            l = t.text.indexOf(\"â\") >= 0;\n          var u = 0;\n          for (var _r113 = 0; _r113 < t.length(); _r113++) {\n            var _h11 = t.getSection(_r113),\n              _p9 = t.getCharCode(_r113);\n            if (jp[_p9] || (u += Up(_p9, _h11, n, i, e, s)), _r113 < t.length() - 1) {\n              var _e132 = !((c = _p9) < 11904 || !(ns(c) || rs(c) || ms(c) || fs(c) || os(c) || Hi(c) || is(c) || Qi(c) || ls(c) || us(c) || as(c) || vs(c) || ts(c) || Ji(c) || Wi(c) || ss(c) || es(c) || ys(c) || hs(c) || cs(c)));\n              ($p[_p9] || _e132 || _h11.imageName) && a.push(Np(_r113 + 1, u, o, a, qp(_p9, t.getCharCode(_r113 + 1), _e132 && l), !1));\n            }\n          }\n          var c;\n          return Gp(Np(t.length(), u, o, a, 0, !0));\n        }(y, u, s, e, n, f),\n        x = js.processBidirectionalText,\n        v = js.processStyledBidirectionalText;\n      if (x && 1 === y.sections.length) {\n        var _t139 = x(y.toString(), g);\n        var _iterator102 = _createForOfIteratorHelper(_t139),\n          _step102;\n        try {\n          for (_iterator102.s(); !(_step102 = _iterator102.n()).done;) {\n            var _e133 = _step102.value;\n            var _t140 = new Fp();\n            _t140.text = _e133, _t140.sections = y.sections;\n            for (var _r114 = 0; _r114 < _e133.length; _r114++) _t140.sectionIndex.push(0);\n            m.push(_t140);\n          }\n        } catch (err) {\n          _iterator102.e(err);\n        } finally {\n          _iterator102.f();\n        }\n      } else if (v) {\n        var _t141 = v(y.text, y.sectionIndex, g);\n        var _iterator103 = _createForOfIteratorHelper(_t141),\n          _step103;\n        try {\n          for (_iterator103.s(); !(_step103 = _iterator103.n()).done;) {\n            var _e134 = _step103.value;\n            var _t142 = new Fp();\n            _t142.text = _e134[0], _t142.sectionIndex = _e134[1], _t142.sections = y.sections, m.push(_t142);\n          }\n        } catch (err) {\n          _iterator103.e(err);\n        } finally {\n          _iterator103.f();\n        }\n      } else m = function (t, e) {\n        var r = [],\n          n = t.text;\n        var i = 0;\n        var _iterator104 = _createForOfIteratorHelper(e),\n          _step104;\n        try {\n          for (_iterator104.s(); !(_step104 = _iterator104.n()).done;) {\n            var _n79 = _step104.value;\n            r.push(t.substring(i, _n79)), i = _n79;\n          }\n        } catch (err) {\n          _iterator104.e(err);\n        } finally {\n          _iterator104.f();\n        }\n        return i < n.length && r.push(t.substring(i, n.length)), r;\n      }(y, g);\n      var b = [],\n        w = {\n          positionedLines: b,\n          text: y.toString(),\n          top: c[1],\n          bottom: c[1],\n          left: c[0],\n          right: c[0],\n          writingMode: h,\n          iconsInText: !1,\n          verticalizable: !1,\n          hasBaseline: !1\n        };\n      return function (t, e, r, n, i, s, a, o, l, u, c, h) {\n        var p = 0,\n          f = 0,\n          d = 0;\n        var y = \"right\" === o ? 1 : \"left\" === o ? 0 : .5;\n        var m = !1;\n        var _iterator105 = _createForOfIteratorHelper(i),\n          _step105;\n        try {\n          for (_iterator105.s(); !(_step105 = _iterator105.n()).done;) {\n            var _t144 = _step105.value;\n            var _r115 = _t144.getSections();\n            var _iterator109 = _createForOfIteratorHelper(_r115),\n              _step109;\n            try {\n              for (_iterator109.s(); !(_step109 = _iterator109.n()).done;) {\n                var _t145 = _step109.value;\n                if (_t145.imageName) continue;\n                var _r116 = e[_t145.fontStack];\n                if (_r116 && (m = void 0 !== _r116.ascender && void 0 !== _r116.descender, !m)) break;\n              }\n            } catch (err) {\n              _iterator109.e(err);\n            } finally {\n              _iterator109.f();\n            }\n            if (!m) break;\n          }\n        } catch (err) {\n          _iterator105.e(err);\n        } finally {\n          _iterator105.f();\n        }\n        var g = 0;\n        var _iterator106 = _createForOfIteratorHelper(i),\n          _step106;\n        try {\n          for (_iterator106.s(); !(_step106 = _iterator106.n()).done;) {\n            var _a57 = _step106.value;\n            _a57.trim();\n            var _i87 = _a57.getMaxScale(),\n              _o30 = (_i87 - 1) * Wh,\n              _v3 = {\n                positionedGlyphs: [],\n                lineOffset: 0\n              };\n            t.positionedLines[g] = _v3;\n            var _b3 = _v3.positionedGlyphs;\n            var _w3 = 0;\n            if (!_a57.length()) {\n              f += s, ++g;\n              continue;\n            }\n            var _4 = 0,\n              _A3 = 0;\n            for (var _s59 = 0; _s59 < _a57.length(); _s59++) {\n              var _o31 = _a57.getSection(_s59),\n                _d5 = _a57.getSectionIndex(_s59),\n                _y4 = _a57.getCharCode(_s59);\n              var _g4 = _o31.scale,\n                _v4 = null,\n                _S3 = null,\n                _k2 = null,\n                _I2 = Wh,\n                _M2 = 0;\n              var _T = !(l === Vp.horizontal || !c && !As(_y4) || c && (jp[_y4] || (x = _y4, Xi(x) || Ki(x) || Yi(x) || ds(x) || xs(x))));\n              if (_o31.imageName) {\n                var _e136 = n[_o31.imageName];\n                if (!_e136) continue;\n                _k2 = _o31.imageName, t.iconsInText = t.iconsInText || !0, _S3 = _e136.paddedRect;\n                var _r117 = _e136.displaySize;\n                _g4 = _g4 * Wh / h, _v4 = {\n                  width: _r117[0],\n                  height: _r117[1],\n                  left: 1,\n                  top: -3,\n                  advance: _T ? _r117[1] : _r117[0],\n                  localGlyph: !1\n                }, _M2 = m ? -_v4.height * _g4 : _i87 * Wh - 17 - _r117[1] * _g4, _I2 = _v4.advance;\n                var _s60 = (_T ? _r117[0] : _r117[1]) * _g4 - Wh * _i87;\n                _s60 > 0 && _s60 > _w3 && (_w3 = _s60);\n              } else {\n                var _t146 = r[_o31.fontStack];\n                if (!_t146) continue;\n                _t146[_y4] && (_S3 = _t146[_y4]);\n                var _n80 = e[_o31.fontStack];\n                if (!_n80) continue;\n                var _s61 = _n80.glyphs[_y4];\n                if (!_s61) continue;\n                if (_v4 = _s61.metrics, _I2 = 8203 !== _y4 ? Wh : 0, m) {\n                  var _t147 = void 0 !== _n80.ascender ? Math.abs(_n80.ascender) : 0,\n                    _e137 = void 0 !== _n80.descender ? Math.abs(_n80.descender) : 0,\n                    _r118 = (_t147 + _e137) * _g4;\n                  _4 < _r118 && (_4 = _r118, _A3 = (_t147 - _e137) / 2 * _g4), _M2 = -_t147 * _g4;\n                } else _M2 = (_i87 - _g4) * Wh - 17;\n              }\n              _T ? (t.verticalizable = !0, _b3.push({\n                glyph: _y4,\n                imageName: _k2,\n                x: p,\n                y: f + _M2,\n                vertical: _T,\n                scale: _g4,\n                localGlyph: _v4.localGlyph,\n                fontStack: _o31.fontStack,\n                sectionIndex: _d5,\n                metrics: _v4,\n                rect: _S3\n              }), p += _I2 * _g4 + u) : (_b3.push({\n                glyph: _y4,\n                imageName: _k2,\n                x: p,\n                y: f + _M2,\n                vertical: _T,\n                scale: _g4,\n                localGlyph: _v4.localGlyph,\n                fontStack: _o31.fontStack,\n                sectionIndex: _d5,\n                metrics: _v4,\n                rect: _S3\n              }), p += _v4.advance * _g4 + u);\n            }\n            0 !== _b3.length && (d = Math.max(p - u, d), m ? Xp(_b3, y, _w3, _A3, s * _i87 / 2) : Xp(_b3, y, _w3, 0, s / 2)), p = 0;\n            var _S4 = s * _i87 + _w3;\n            _v3.lineOffset = Math.max(_w3, _o30), f += _S4, ++g;\n          }\n        } catch (err) {\n          _iterator106.e(err);\n        } finally {\n          _iterator106.f();\n        }\n        var x;\n        var v = f,\n          _Zp = Zp(a),\n          b = _Zp.horizontalAlign,\n          w = _Zp.verticalAlign;\n        (function (t, e, r, n, i, s) {\n          var a = (e - r) * i,\n            o = -s * n;\n          var _iterator107 = _createForOfIteratorHelper(t),\n            _step107;\n          try {\n            for (_iterator107.s(); !(_step107 = _iterator107.n()).done;) {\n              var _e135 = _step107.value;\n              var _iterator108 = _createForOfIteratorHelper(_e135.positionedGlyphs),\n                _step108;\n              try {\n                for (_iterator108.s(); !(_step108 = _iterator108.n()).done;) {\n                  var _t143 = _step108.value;\n                  _t143.x += a, _t143.y += o;\n                }\n              } catch (err) {\n                _iterator108.e(err);\n              } finally {\n                _iterator108.f();\n              }\n            }\n          } catch (err) {\n            _iterator107.e(err);\n          } finally {\n            _iterator107.f();\n          }\n        })(t.positionedLines, y, b, w, d, v), t.top += -w * v, t.bottom = t.top + v, t.left += -b * d, t.right = t.left + d, t.hasBaseline = m;\n      }(w, e, r, n, m, a, o, l, h, u, p, d), !function (t) {\n        var _iterator110 = _createForOfIteratorHelper(t),\n          _step110;\n        try {\n          for (_iterator110.s(); !(_step110 = _iterator110.n()).done;) {\n            var _e138 = _step110.value;\n            if (0 !== _e138.positionedGlyphs.length) return !1;\n          }\n        } catch (err) {\n          _iterator110.e(err);\n        } finally {\n          _iterator110.f();\n        }\n        return !0;\n      }(b) && w;\n    }\n    var jp = {\n        9: !0,\n        10: !0,\n        11: !0,\n        12: !0,\n        13: !0,\n        32: !0\n      },\n      $p = {\n        10: !0,\n        32: !0,\n        38: !0,\n        40: !0,\n        41: !0,\n        43: !0,\n        45: !0,\n        47: !0,\n        173: !0,\n        183: !0,\n        8203: !0,\n        8208: !0,\n        8211: !0,\n        8231: !0\n      };\n    function Up(t, e, r, n, i, s) {\n      if (e.imageName) {\n        var _t148 = n[e.imageName];\n        return _t148 ? _t148.displaySize[0] * e.scale * Wh / s + i : 0;\n      }\n      {\n        var _n81 = r[e.fontStack],\n          _s62 = _n81 && _n81.glyphs[t];\n        return _s62 ? _s62.metrics.advance * e.scale + i : 0;\n      }\n    }\n    function Op(t, e, r, n) {\n      var i = Math.pow(t - e, 2);\n      return n ? t < e ? i / 2 : 2 * i : i + Math.abs(r) * r;\n    }\n    function qp(t, e, r) {\n      var n = 0;\n      return 10 === t && (n -= 1e4), r && (n += 150), 40 !== t && 65288 !== t || (n += 50), 41 !== e && 65289 !== e || (n += 50), n;\n    }\n    function Np(t, e, r, n, i, s) {\n      var a = null,\n        o = Op(e, r, i, s);\n      var _iterator111 = _createForOfIteratorHelper(n),\n        _step111;\n      try {\n        for (_iterator111.s(); !(_step111 = _iterator111.n()).done;) {\n          var _t149 = _step111.value;\n          var _n82 = Op(e - _t149.x, r, i, s) + _t149.badness;\n          _n82 <= o && (a = _t149, o = _n82);\n        }\n      } catch (err) {\n        _iterator111.e(err);\n      } finally {\n        _iterator111.f();\n      }\n      return {\n        index: t,\n        x: e,\n        priorBreak: a,\n        badness: o\n      };\n    }\n    function Gp(t) {\n      return t ? Gp(t.priorBreak).concat(t.index) : [];\n    }\n    function Zp(t) {\n      var e = .5,\n        r = .5;\n      switch (t) {\n        case \"right\":\n        case \"top-right\":\n        case \"bottom-right\":\n          e = 1;\n          break;\n        case \"left\":\n        case \"top-left\":\n        case \"bottom-left\":\n          e = 0;\n      }\n      switch (t) {\n        case \"bottom\":\n        case \"bottom-right\":\n        case \"bottom-left\":\n          r = 1;\n          break;\n        case \"top\":\n        case \"top-right\":\n        case \"top-left\":\n          r = 0;\n      }\n      return {\n        horizontalAlign: e,\n        verticalAlign: r\n      };\n    }\n    function Xp(t, e, r, n, i) {\n      if (!(e || r || n || i)) return;\n      var s = t.length - 1,\n        a = t[s],\n        o = (a.x + a.metrics.advance * a.scale) * e;\n      for (var _e139 = 0; _e139 <= s; _e139++) t[_e139].x -= o, t[_e139].y += r + n + i;\n    }\n    function Kp(t, e, r) {\n      var _Zp2 = Zp(r),\n        n = _Zp2.horizontalAlign,\n        i = _Zp2.verticalAlign,\n        s = e[0] - t.displaySize[0] * n,\n        a = e[1] - t.displaySize[1] * i;\n      return {\n        image: t,\n        top: a,\n        bottom: a + t.displaySize[1],\n        left: s,\n        right: s + t.displaySize[0]\n      };\n    }\n    function Yp(t, e, r, n, i, s) {\n      var a = t.image;\n      var o;\n      if (a.content) {\n        var _t150 = a.content,\n          _e140 = a.pixelRatio || 1;\n        o = [_t150[0] / _e140, _t150[1] / _e140, a.displaySize[0] - _t150[2] / _e140, a.displaySize[1] - _t150[3] / _e140];\n      }\n      var l = e.left * s,\n        u = e.right * s;\n      var c, h, p, f;\n      \"width\" === r || \"both\" === r ? (f = i[0] + l - n[3], h = i[0] + u + n[1]) : (f = i[0] + (l + u - a.displaySize[0]) / 2, h = f + a.displaySize[0]);\n      var d = e.top * s,\n        y = e.bottom * s;\n      return \"height\" === r || \"both\" === r ? (c = i[1] + d - n[0], p = i[1] + y + n[2]) : (c = i[1] + (d + y - a.displaySize[1]) / 2, p = c + a.displaySize[1]), {\n        image: a,\n        top: c,\n        right: h,\n        bottom: p,\n        left: f,\n        collisionPadding: o\n      };\n    }\n    var Hp = /*#__PURE__*/function (_d6) {\n      _inherits(Hp, _d6);\n      function Hp(t, e, r, n, i) {\n        var _this21;\n        _classCallCheck(this, Hp);\n        _this21 = _possibleConstructorReturn(this, _getPrototypeOf(Hp).call(this, t, e)), _this21.angle = n, _this21.z = r, void 0 !== i && (_this21.segment = i);\n        return _this21;\n      }\n      _createClass(Hp, [{\n        key: \"clone\",\n        value: function clone() {\n          return new Hp(this.x, this.y, this.z, this.angle, this.segment);\n        }\n      }]);\n      return Hp;\n    }(d);\n    function Wp(t, e, r, n, i) {\n      if (void 0 === e.segment) return !0;\n      var s = e,\n        a = e.segment + 1,\n        o = 0;\n      for (; o > -r / 2;) {\n        if (a--, a < 0) return !1;\n        o -= t[a].dist(s), s = t[a];\n      }\n      o += t[a].dist(t[a + 1]), a++;\n      var l = [];\n      var u = 0;\n      for (; o < r / 2;) {\n        var _e141 = t[a],\n          _r119 = t[a + 1];\n        if (!_r119) return !1;\n        var _s63 = t[a - 1].angleTo(_e141) - _e141.angleTo(_r119);\n        for (_s63 = Math.abs((_s63 + 3 * Math.PI) % (2 * Math.PI) - Math.PI), l.push({\n          distance: o,\n          angleDelta: _s63\n        }), u += _s63; o - l[0].distance > n;) u -= l.shift().angleDelta;\n        if (u > i) return !1;\n        a++, o += _e141.dist(_r119);\n      }\n      return !0;\n    }\n    function Jp(t) {\n      var e = 0;\n      for (var _r120 = 0; _r120 < t.length - 1; _r120++) e += t[_r120].dist(t[_r120 + 1]);\n      return e;\n    }\n    function Qp(t, e, r) {\n      return t ? .6 * e * r : 0;\n    }\n    function tf(t, e) {\n      return Math.max(t ? t.right - t.left : 0, e ? e.right - e.left : 0);\n    }\n    function ef(t, e, r, n, i, s) {\n      var a = Qp(r, i, s),\n        o = tf(r, n) * s;\n      var l = 0;\n      var u = Jp(t) / 2;\n      for (var _r121 = 0; _r121 < t.length - 1; _r121++) {\n        var _n83 = t[_r121],\n          _i88 = t[_r121 + 1],\n          _s64 = _n83.dist(_i88);\n        if (l + _s64 > u) {\n          var _c17 = (u - l) / _s64,\n            _h12 = Mr(_n83.x, _i88.x, _c17),\n            _p10 = Mr(_n83.y, _i88.y, _c17),\n            _f5 = new Hp(_h12, _p10, 0, _i88.angleTo(_n83), _r121);\n          return !a || Wp(t, _f5, o, a, e) ? _f5 : void 0;\n        }\n        l += _s64;\n      }\n    }\n    function rf(t, e, r, n, i, s, a, o, l) {\n      var u = Qp(n, s, a),\n        c = tf(n, i),\n        h = c * a,\n        p = 0 === t[0].x || t[0].x === l || 0 === t[0].y || t[0].y === l;\n      return e - h < e / 4 && (e = h + e / 4), nf(t, p ? e / 2 * o % e : (c / 2 + 2 * s) * a * o % e, e, u, r, h, p, !1, l);\n    }\n    function nf(t, e, r, n, i, s, a, o, l) {\n      var u = s / 2,\n        c = Jp(t);\n      var h = 0,\n        p = e - r,\n        f = [];\n      for (var _e142 = 0; _e142 < t.length - 1; _e142++) {\n        var _a58 = t[_e142],\n          _o32 = t[_e142 + 1],\n          _d7 = _a58.dist(_o32),\n          _y5 = _o32.angleTo(_a58);\n        for (; p + r < h + _d7;) {\n          p += r;\n          var _m3 = (p - h) / _d7,\n            _g5 = Mr(_a58.x, _o32.x, _m3),\n            _x4 = Mr(_a58.y, _o32.y, _m3);\n          if (_g5 >= 0 && _g5 < l && _x4 >= 0 && _x4 < l && p - u >= 0 && p + u <= c) {\n            var _r122 = new Hp(_g5, _x4, 0, _y5, _e142);\n            _r122._round(), n && !Wp(t, _r122, s, n, i) || f.push(_r122);\n          }\n        }\n        h += _d7;\n      }\n      return o || f.length || a || (f = nf(t, h / 2, r, n, i, s, a, !0, l)), f;\n    }\n    function sf(t, e, r, n, i) {\n      var s = [];\n      for (var _a59 = 0; _a59 < t.length; _a59++) {\n        var _o33 = t[_a59];\n        var _l25 = void 0;\n        for (var _t151 = 0; _t151 < _o33.length - 1; _t151++) {\n          var _a60 = _o33[_t151],\n            _u23 = _o33[_t151 + 1];\n          _a60.x < e && _u23.x < e || (_a60.x < e ? _a60 = new d(e, _a60.y + (e - _a60.x) / (_u23.x - _a60.x) * (_u23.y - _a60.y))._round() : _u23.x < e && (_u23 = new d(e, _a60.y + (e - _a60.x) / (_u23.x - _a60.x) * (_u23.y - _a60.y))._round()), _a60.y < r && _u23.y < r || (_a60.y < r ? _a60 = new d(_a60.x + (r - _a60.y) / (_u23.y - _a60.y) * (_u23.x - _a60.x), r)._round() : _u23.y < r && (_u23 = new d(_a60.x + (r - _a60.y) / (_u23.y - _a60.y) * (_u23.x - _a60.x), r)._round()), _a60.x >= n && _u23.x >= n || (_a60.x >= n ? _a60 = new d(n, _a60.y + (n - _a60.x) / (_u23.x - _a60.x) * (_u23.y - _a60.y))._round() : _u23.x >= n && (_u23 = new d(n, _a60.y + (n - _a60.x) / (_u23.x - _a60.x) * (_u23.y - _a60.y))._round()), _a60.y >= i && _u23.y >= i || (_a60.y >= i ? _a60 = new d(_a60.x + (i - _a60.y) / (_u23.y - _a60.y) * (_u23.x - _a60.x), i)._round() : _u23.y >= i && (_u23 = new d(_a60.x + (i - _a60.y) / (_u23.y - _a60.y) * (_u23.x - _a60.x), i)._round()), _l25 && _a60.equals(_l25[_l25.length - 1]) || (_l25 = [_a60], s.push(_l25)), _l25.push(_u23)))));\n        }\n      }\n      return s;\n    }\n    Oi(Hp, \"Anchor\");\n    var af = 1e20;\n    function of(t, e, r, n, i, s, a, o, l) {\n      for (var _u24 = e; _u24 < e + n; _u24++) lf(t, r * s + _u24, s, i, a, o, l);\n      for (var _u25 = r; _u25 < r + i; _u25++) lf(t, _u25 * s + e, 1, n, a, o, l);\n    }\n    function lf(t, e, r, n, i, s, a) {\n      s[0] = 0, a[0] = -af, a[1] = af, i[0] = t[e];\n      for (var _o34 = 1, _l26 = 0, _u26 = 0; _o34 < n; _o34++) {\n        i[_o34] = t[e + _o34 * r];\n        var _n84 = _o34 * _o34;\n        do {\n          var _t152 = s[_l26];\n          _u26 = (i[_o34] - i[_t152] + _n84 - _t152 * _t152) / (_o34 - _t152) / 2;\n        } while (_u26 <= a[_l26] && --_l26 > -1);\n        _l26++, s[_l26] = _o34, a[_l26] = _u26, a[_l26 + 1] = af;\n      }\n      for (var _o35 = 0, _l27 = 0; _o35 < n; _o35++) {\n        for (; a[_l27 + 1] < _o35;) _l27++;\n        var _n85 = s[_l27],\n          _u27 = _o35 - _n85;\n        t[e + _o35 * r] = i[_n85] + _u27 * _u27;\n      }\n    }\n    var uf = {\n      none: 0,\n      ideographs: 1,\n      all: 2\n    };\n    var cf = /*#__PURE__*/function () {\n      function cf(t, e, r) {\n        _classCallCheck(this, cf);\n        this.requestManager = t, this.localGlyphMode = e, this.localFontFamily = r, this.entries = {}, this.localGlyphs = {\n          200: {},\n          400: {},\n          500: {},\n          900: {}\n        };\n      }\n      _createClass(cf, [{\n        key: \"setURL\",\n        value: function setURL(t) {\n          this.url = t;\n        }\n      }, {\n        key: \"getGlyphs\",\n        value: function getGlyphs(t, e) {\n          var _this22 = this;\n          var r = [];\n          for (var _e143 in t) {\n            var _iterator112 = _createForOfIteratorHelper(t[_e143]),\n              _step112;\n            try {\n              for (_iterator112.s(); !(_step112 = _iterator112.n()).done;) {\n                var _n86 = _step112.value;\n                r.push({\n                  stack: _e143,\n                  id: _n86\n                });\n              }\n            } catch (err) {\n              _iterator112.e(err);\n            } finally {\n              _iterator112.f();\n            }\n          }\n          M(r, function (_ref120, r) {\n            var t = _ref120.stack,\n              e = _ref120.id;\n            var n = _this22.entries[t];\n            n || (n = _this22.entries[t] = {\n              glyphs: {},\n              requests: {},\n              ranges: {},\n              ascender: void 0,\n              descender: void 0\n            });\n            var i = n.glyphs[e];\n            if (void 0 !== i) return void r(null, {\n              stack: t,\n              id: e,\n              glyph: i\n            });\n            if (i = _this22._tinySDF(n, t, e), i) return n.glyphs[e] = i, void r(null, {\n              stack: t,\n              id: e,\n              glyph: i\n            });\n            var s = Math.floor(e / 256);\n            if (256 * s > 65535) return void r(new Error(\"glyphs > 65535 not supported\"));\n            if (n.ranges[s]) return void r(null, {\n              stack: t,\n              id: e,\n              glyph: i\n            });\n            var a = n.requests[s];\n            a || (a = n.requests[s] = [], cf.loadGlyphRange(t, s, _this22.url, _this22.requestManager, function (t, e) {\n              if (e) {\n                n.ascender = e.ascender, n.descender = e.descender;\n                for (var _t153 in e.glyphs) _this22._doesCharSupportLocalGlyph(+_t153) || (n.glyphs[+_t153] = e.glyphs[+_t153]);\n                n.ranges[s] = !0;\n              }\n              var _iterator113 = _createForOfIteratorHelper(a),\n                _step113;\n              try {\n                for (_iterator113.s(); !(_step113 = _iterator113.n()).done;) {\n                  var _r123 = _step113.value;\n                  _r123(t, e);\n                }\n              } catch (err) {\n                _iterator113.e(err);\n              } finally {\n                _iterator113.f();\n              }\n              delete n.requests[s];\n            })), a.push(function (n, i) {\n              n ? r(n) : i && r(null, {\n                stack: t,\n                id: e,\n                glyph: i.glyphs[e] || null\n              });\n            });\n          }, function (t, r) {\n            if (t) e(t);else if (r) {\n              var _t154 = {};\n              var _iterator114 = _createForOfIteratorHelper(r),\n                _step114;\n              try {\n                for (_iterator114.s(); !(_step114 = _iterator114.n()).done;) {\n                  var _step114$value = _step114.value,\n                    _e144 = _step114$value.stack,\n                    _n87 = _step114$value.id,\n                    _i89 = _step114$value.glyph;\n                  void 0 === _t154[_e144] && (_t154[_e144] = {}), void 0 === _t154[_e144].glyphs && (_t154[_e144].glyphs = {}), _t154[_e144].glyphs[_n87] = _i89 && {\n                    id: _i89.id,\n                    bitmap: _i89.bitmap.clone(),\n                    metrics: _i89.metrics\n                  }, _t154[_e144].ascender = _this22.entries[_e144].ascender, _t154[_e144].descender = _this22.entries[_e144].descender;\n                }\n              } catch (err) {\n                _iterator114.e(err);\n              } finally {\n                _iterator114.f();\n              }\n              e(null, _t154);\n            }\n          });\n        }\n      }, {\n        key: \"_doesCharSupportLocalGlyph\",\n        value: function _doesCharSupportLocalGlyph(t) {\n          return this.localGlyphMode !== uf.none && (this.localGlyphMode === uf.all ? !!this.localFontFamily : !!this.localFontFamily && (us(t) || ps(t) || ts(t) || es(t) || Qi(t)));\n        }\n      }, {\n        key: \"_tinySDF\",\n        value: function _tinySDF(t, e, r) {\n          var n = this.localFontFamily;\n          if (!n || !this._doesCharSupportLocalGlyph(r)) return;\n          var i = t.tinySDF;\n          if (!i) {\n            var _r124 = \"400\";\n            /bold/i.test(e) ? _r124 = \"900\" : /medium/i.test(e) ? _r124 = \"500\" : /light/i.test(e) && (_r124 = \"200\"), i = t.tinySDF = new cf.TinySDF({\n              fontFamily: n,\n              fontWeight: _r124,\n              fontSize: 48,\n              buffer: 6,\n              radius: 16\n            }), i.fontWeight = _r124;\n          }\n          if (this.localGlyphs[i.fontWeight][r]) return this.localGlyphs[i.fontWeight][r];\n          var s = String.fromCharCode(r),\n            _i$draw = i.draw(s),\n            a = _i$draw.data,\n            o = _i$draw.width,\n            l = _i$draw.height,\n            u = _i$draw.glyphWidth,\n            c = _i$draw.glyphHeight,\n            h = _i$draw.glyphLeft,\n            p = _i$draw.glyphTop,\n            f = _i$draw.glyphAdvance;\n          return this.localGlyphs[i.fontWeight][r] = {\n            id: r,\n            bitmap: new Ju({\n              width: o,\n              height: l\n            }, a),\n            metrics: {\n              width: u / 2,\n              height: c / 2,\n              left: h / 2,\n              top: p / 2 - 27,\n              advance: f / 2,\n              localGlyph: !0\n            }\n          };\n        }\n      }]);\n      return cf;\n    }();\n    function hf(t, e, r, n) {\n      var i = [],\n        s = t.image,\n        a = s.pixelRatio,\n        o = s.paddedRect.w - 2,\n        l = s.paddedRect.h - 2,\n        u = t.right - t.left,\n        c = t.bottom - t.top,\n        h = s.stretchX || [[0, o]],\n        p = s.stretchY || [[0, l]],\n        f = function f(t, e) {\n          return t + e[1] - e[0];\n        },\n        y = h.reduce(f, 0),\n        m = p.reduce(f, 0),\n        g = o - y,\n        x = l - m;\n      var v = 0,\n        b = y,\n        w = 0,\n        _ = m,\n        A = 0,\n        S = g,\n        k = 0,\n        I = x;\n      if (s.content && n) {\n        var _t155 = s.content;\n        v = pf(h, 0, _t155[0]), w = pf(p, 0, _t155[1]), b = pf(h, _t155[0], _t155[2]), _ = pf(p, _t155[1], _t155[3]), A = _t155[0] - v, k = _t155[1] - w, S = _t155[2] - _t155[0] - b, I = _t155[3] - _t155[1] - _;\n      }\n      var M = function M(n, i, o, l) {\n        var h = df(n.stretch - v, b, u, t.left),\n          p = yf(n.fixed - A, S, n.stretch, y),\n          f = df(i.stretch - w, _, c, t.top),\n          g = yf(i.fixed - k, I, i.stretch, m),\n          x = df(o.stretch - v, b, u, t.left),\n          M = yf(o.fixed - A, S, o.stretch, y),\n          T = df(l.stretch - w, _, c, t.top),\n          z = yf(l.fixed - k, I, l.stretch, m),\n          B = new d(h, f),\n          E = new d(x, f),\n          C = new d(x, T),\n          P = new d(h, T),\n          D = new d(p / a, g / a),\n          V = new d(M / a, z / a),\n          L = e * Math.PI / 180;\n        if (L) {\n          var _t156 = Math.sin(L),\n            _e145 = Math.cos(L),\n            _r125 = [_e145, -_t156, _t156, _e145];\n          B._matMult(_r125), E._matMult(_r125), P._matMult(_r125), C._matMult(_r125);\n        }\n        var F = n.stretch + n.fixed,\n          R = i.stretch + i.fixed;\n        return {\n          tl: B,\n          tr: E,\n          bl: P,\n          br: C,\n          tex: {\n            x: s.paddedRect.x + 1 + F,\n            y: s.paddedRect.y + 1 + R,\n            w: o.stretch + o.fixed - F,\n            h: l.stretch + l.fixed - R\n          },\n          writingMode: void 0,\n          glyphOffset: [0, 0],\n          sectionIndex: 0,\n          pixelOffsetTL: D,\n          pixelOffsetBR: V,\n          minFontScaleX: S / a / u,\n          minFontScaleY: I / a / c,\n          isSDF: r\n        };\n      };\n      if (n && (s.stretchX || s.stretchY)) {\n        var _t157 = ff(h, g, y),\n          _e146 = ff(p, x, m);\n        for (var _r126 = 0; _r126 < _t157.length - 1; _r126++) {\n          var _n88 = _t157[_r126],\n            _s65 = _t157[_r126 + 1];\n          for (var _t158 = 0; _t158 < _e146.length - 1; _t158++) i.push(M(_n88, _e146[_t158], _s65, _e146[_t158 + 1]));\n        }\n      } else i.push(M({\n        fixed: 0,\n        stretch: -1\n      }, {\n        fixed: 0,\n        stretch: -1\n      }, {\n        fixed: 0,\n        stretch: o + 1\n      }, {\n        fixed: 0,\n        stretch: l + 1\n      }));\n      return i;\n    }\n    function pf(t, e, r) {\n      var n = 0;\n      var _iterator115 = _createForOfIteratorHelper(t),\n        _step115;\n      try {\n        for (_iterator115.s(); !(_step115 = _iterator115.n()).done;) {\n          var _i90 = _step115.value;\n          n += Math.max(e, Math.min(r, _i90[1])) - Math.max(e, Math.min(r, _i90[0]));\n        }\n      } catch (err) {\n        _iterator115.e(err);\n      } finally {\n        _iterator115.f();\n      }\n      return n;\n    }\n    function ff(t, e, r) {\n      var n = [{\n        fixed: -1,\n        stretch: 0\n      }];\n      var _iterator116 = _createForOfIteratorHelper(t),\n        _step116;\n      try {\n        for (_iterator116.s(); !(_step116 = _iterator116.n()).done;) {\n          var _step116$value = _slicedToArray(_step116.value, 2),\n            _e147 = _step116$value[0],\n            _r127 = _step116$value[1];\n          var _t159 = n[n.length - 1];\n          n.push({\n            fixed: _e147 - _t159.stretch,\n            stretch: _t159.stretch\n          }), n.push({\n            fixed: _e147 - _t159.stretch,\n            stretch: _t159.stretch + (_r127 - _e147)\n          });\n        }\n      } catch (err) {\n        _iterator116.e(err);\n      } finally {\n        _iterator116.f();\n      }\n      return n.push({\n        fixed: e + 1,\n        stretch: r\n      }), n;\n    }\n    function df(t, e, r, n) {\n      return t / e * r + n;\n    }\n    function yf(t, e, r, n) {\n      return t - e * r / n;\n    }\n    function mf(t, e, r, n) {\n      var i = e + t.positionedLines[n].lineOffset;\n      return 0 === n ? r + i / 2 : r + (i + (e + t.positionedLines[n - 1].lineOffset)) / 2;\n    }\n    cf.loadGlyphRange = function (t, e, r, n, i) {\n      var s = 256 * e,\n        a = s + 255,\n        o = n.transformRequest(n.normalizeGlyphsURL(r).replace(\"{fontstack}\", t).replace(\"{range}\", \"\".concat(s, \"-\").concat(a)), st.Glyphs);\n      ut(o, function (t, e) {\n        if (t) i(t);else if (e) {\n          var _t160 = {},\n            _r128 = function (t) {\n              return new op(t).readFields(zp, {});\n            }(e);\n          var _iterator117 = _createForOfIteratorHelper(_r128.glyphs),\n            _step117;\n          try {\n            for (_iterator117.s(); !(_step117 = _iterator117.n()).done;) {\n              var _e148 = _step117.value;\n              _t160[_e148.id] = _e148;\n            }\n          } catch (err) {\n            _iterator117.e(err);\n          } finally {\n            _iterator117.f();\n          }\n          i(null, {\n            glyphs: _t160,\n            ascender: _r128.ascender,\n            descender: _r128.descender\n          });\n        }\n      });\n    }, cf.TinySDF = /*#__PURE__*/function () {\n      function _class6() {\n        var _ref121 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref121$fontSize = _ref121.fontSize,\n          t = _ref121$fontSize === void 0 ? 24 : _ref121$fontSize,\n          _ref121$buffer = _ref121.buffer,\n          e = _ref121$buffer === void 0 ? 3 : _ref121$buffer,\n          _ref121$radius = _ref121.radius,\n          r = _ref121$radius === void 0 ? 8 : _ref121$radius,\n          _ref121$cutoff = _ref121.cutoff,\n          n = _ref121$cutoff === void 0 ? .25 : _ref121$cutoff,\n          _ref121$fontFamily = _ref121.fontFamily,\n          i = _ref121$fontFamily === void 0 ? \"sans-serif\" : _ref121$fontFamily,\n          _ref121$fontWeight = _ref121.fontWeight,\n          s = _ref121$fontWeight === void 0 ? \"normal\" : _ref121$fontWeight,\n          _ref121$fontStyle = _ref121.fontStyle,\n          a = _ref121$fontStyle === void 0 ? \"normal\" : _ref121$fontStyle;\n        _classCallCheck(this, _class6);\n        this.buffer = e, this.cutoff = n, this.radius = r;\n        var o = this.size = t + 4 * e,\n          l = this._createCanvas(o),\n          u = this.ctx = l.getContext(\"2d\", {\n            willReadFrequently: !0\n          });\n        u.font = \"\".concat(a, \" \").concat(s, \" \").concat(t, \"px \").concat(i), u.textBaseline = \"alphabetic\", u.textAlign = \"left\", u.fillStyle = \"black\", this.gridOuter = new Float64Array(o * o), this.gridInner = new Float64Array(o * o), this.f = new Float64Array(o), this.z = new Float64Array(o + 1), this.v = new Uint16Array(o);\n      }\n      _createClass(_class6, [{\n        key: \"_createCanvas\",\n        value: function _createCanvas(t) {\n          var e = document.createElement(\"canvas\");\n          return e.width = e.height = t, e;\n        }\n      }, {\n        key: \"draw\",\n        value: function draw(t) {\n          var _this$ctx$measureText = this.ctx.measureText(t),\n            e = _this$ctx$measureText.width,\n            r = _this$ctx$measureText.actualBoundingBoxAscent,\n            n = _this$ctx$measureText.actualBoundingBoxDescent,\n            i = _this$ctx$measureText.actualBoundingBoxLeft,\n            s = _this$ctx$measureText.actualBoundingBoxRight,\n            a = Math.ceil(r),\n            o = Math.max(0, Math.min(this.size - this.buffer, Math.ceil(s - i))),\n            l = Math.min(this.size - this.buffer, a + Math.ceil(n)),\n            u = o + 2 * this.buffer,\n            c = l + 2 * this.buffer,\n            h = Math.max(u * c, 0),\n            p = new Uint8ClampedArray(h),\n            f = {\n              data: p,\n              width: u,\n              height: c,\n              glyphWidth: o,\n              glyphHeight: l,\n              glyphTop: a,\n              glyphLeft: 0,\n              glyphAdvance: e\n            };\n          if (0 === o || 0 === l) return f;\n          var d = this.ctx,\n            y = this.buffer,\n            m = this.gridInner,\n            g = this.gridOuter;\n          d.clearRect(y, y, o, l), d.fillText(t, y, y + a);\n          var x = d.getImageData(y, y, o, l);\n          g.fill(af, 0, h), m.fill(0, 0, h);\n          for (var _t161 = 0; _t161 < l; _t161++) for (var _e149 = 0; _e149 < o; _e149++) {\n            var _r129 = x.data[4 * (_t161 * o + _e149) + 3] / 255;\n            if (0 === _r129) continue;\n            var _n89 = (_t161 + y) * u + _e149 + y;\n            if (1 === _r129) g[_n89] = 0, m[_n89] = af;else {\n              var _t162 = .5 - _r129;\n              g[_n89] = _t162 > 0 ? _t162 * _t162 : 0, m[_n89] = _t162 < 0 ? _t162 * _t162 : 0;\n            }\n          }\n          of(g, 0, 0, u, c, u, this.f, this.v, this.z), of(m, y, y, o, l, u, this.f, this.v, this.z);\n          for (var _t163 = 0; _t163 < h; _t163++) {\n            var _e150 = Math.sqrt(g[_t163]) - Math.sqrt(m[_t163]);\n            p[_t163] = Math.round(255 - 255 * (_e150 / this.radius + this.cutoff));\n          }\n          return f;\n        }\n      }]);\n      return _class6;\n    }();\n    var gf = /*#__PURE__*/function () {\n      function gf() {\n        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : xf;\n        _classCallCheck(this, gf);\n        if (this.data = t, this.length = this.data.length, this.compare = e, this.length > 0) for (var _t164 = (this.length >> 1) - 1; _t164 >= 0; _t164--) this._down(_t164);\n      }\n      _createClass(gf, [{\n        key: \"push\",\n        value: function push(t) {\n          this.data.push(t), this.length++, this._up(this.length - 1);\n        }\n      }, {\n        key: \"pop\",\n        value: function pop() {\n          if (0 === this.length) return;\n          var t = this.data[0],\n            e = this.data.pop();\n          return this.length--, this.length > 0 && (this.data[0] = e, this._down(0)), t;\n        }\n      }, {\n        key: \"peek\",\n        value: function peek() {\n          return this.data[0];\n        }\n      }, {\n        key: \"_up\",\n        value: function _up(t) {\n          var e = this.data,\n            r = this.compare,\n            n = e[t];\n          for (; t > 0;) {\n            var _i91 = t - 1 >> 1,\n              _s66 = e[_i91];\n            if (r(n, _s66) >= 0) break;\n            e[t] = _s66, t = _i91;\n          }\n          e[t] = n;\n        }\n      }, {\n        key: \"_down\",\n        value: function _down(t) {\n          var e = this.data,\n            r = this.compare,\n            n = this.length >> 1,\n            i = e[t];\n          for (; t < n;) {\n            var _n90 = 1 + (t << 1),\n              _s67 = e[_n90];\n            var _a61 = _n90 + 1;\n            if (_a61 < this.length && r(e[_a61], _s67) < 0 && (_n90 = _a61, _s67 = e[_a61]), r(_s67, i) >= 0) break;\n            e[t] = _s67, t = _n90;\n          }\n          e[t] = i;\n        }\n      }]);\n      return gf;\n    }();\n    function xf(t, e) {\n      return t < e ? -1 : t > e ? 1 : 0;\n    }\n    function vf(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n      var n = 1 / 0,\n        i = 1 / 0,\n        s = -1 / 0,\n        a = -1 / 0;\n      var o = t[0];\n      for (var _t165 = 0; _t165 < o.length; _t165++) {\n        var _e151 = o[_t165];\n        (!_t165 || _e151.x < n) && (n = _e151.x), (!_t165 || _e151.y < i) && (i = _e151.y), (!_t165 || _e151.x > s) && (s = _e151.x), (!_t165 || _e151.y > a) && (a = _e151.y);\n      }\n      var l = Math.min(s - n, a - i);\n      var u = l / 2;\n      var c = new gf([], bf);\n      if (0 === l) return new d(n, i);\n      for (var _e152 = n; _e152 < s; _e152 += l) for (var _r130 = i; _r130 < a; _r130 += l) c.push(new wf(_e152 + u, _r130 + u, u, t));\n      var h = function (t) {\n          var e = 0,\n            r = 0,\n            n = 0;\n          var i = t[0];\n          for (var _t166 = 0, _s68 = i.length, _a62 = _s68 - 1; _t166 < _s68; _a62 = _t166++) {\n            var _s69 = i[_t166],\n              _o36 = i[_a62],\n              _l28 = _s69.x * _o36.y - _o36.x * _s69.y;\n            r += (_s69.x + _o36.x) * _l28, n += (_s69.y + _o36.y) * _l28, e += 3 * _l28;\n          }\n          return new wf(r / e, n / e, 0, t);\n        }(t),\n        p = c.length;\n      for (; c.length;) {\n        var _n91 = c.pop();\n        (_n91.d > h.d || !h.d) && (h = _n91, r && console.log(\"found best %d after %d probes\", Math.round(1e4 * _n91.d) / 1e4, p)), _n91.max - h.d <= e || (u = _n91.h / 2, c.push(new wf(_n91.p.x - u, _n91.p.y - u, u, t)), c.push(new wf(_n91.p.x + u, _n91.p.y - u, u, t)), c.push(new wf(_n91.p.x - u, _n91.p.y + u, u, t)), c.push(new wf(_n91.p.x + u, _n91.p.y + u, u, t)), p += 4);\n      }\n      return r && (console.log(\"num probes: \".concat(p)), console.log(\"best distance: \".concat(h.d))), h.p;\n    }\n    function bf(t, e) {\n      return e.max - t.max;\n    }\n    var wf = function wf(t, e, r, n) {\n      _classCallCheck(this, wf);\n      this.p = new d(t, e), this.h = r, this.d = function (t, e) {\n        var r = !1,\n          n = 1 / 0;\n        for (var _i92 = 0; _i92 < e.length; _i92++) {\n          var _s70 = e[_i92];\n          for (var _e153 = 0, _i93 = _s70.length, _a63 = _i93 - 1; _e153 < _i93; _a63 = _e153++) {\n            var _i94 = _s70[_e153],\n              _o37 = _s70[_a63];\n            _i94.y > t.y != _o37.y > t.y && t.x < (_o37.x - _i94.x) * (t.y - _i94.y) / (_o37.y - _i94.y) + _i94.x && (r = !r), n = Math.min(n, Cu(t, _i94, _o37));\n          }\n        }\n        return (r ? 1 : -1) * Math.sqrt(n);\n      }(this.p, n), this.max = this.d + this.h * Math.SQRT2;\n    };\n    var _f = Number.POSITIVE_INFINITY,\n      Af = Math.sqrt(2);\n    function Sf(t, _ref122) {\n      var _ref123 = _slicedToArray(_ref122, 2),\n        e = _ref123[0],\n        r = _ref123[1];\n      var n = 0,\n        i = 0;\n      if (r === _f) {\n        e < 0 && (e = 0);\n        var _r131 = e / Af;\n        switch (t) {\n          case \"top-right\":\n          case \"top-left\":\n            i = _r131 - 7;\n            break;\n          case \"bottom-right\":\n          case \"bottom-left\":\n            i = 7 - _r131;\n            break;\n          case \"bottom\":\n            i = 7 - e;\n            break;\n          case \"top\":\n            i = e - 7;\n        }\n        switch (t) {\n          case \"top-right\":\n          case \"bottom-right\":\n            n = -_r131;\n            break;\n          case \"top-left\":\n          case \"bottom-left\":\n            n = _r131;\n            break;\n          case \"left\":\n            n = e;\n            break;\n          case \"right\":\n            n = -e;\n        }\n      } else {\n        switch (e = Math.abs(e), r = Math.abs(r), t) {\n          case \"top-right\":\n          case \"top-left\":\n          case \"top\":\n            i = r - 7;\n            break;\n          case \"bottom-right\":\n          case \"bottom-left\":\n          case \"bottom\":\n            i = 7 - r;\n        }\n        switch (t) {\n          case \"top-right\":\n          case \"bottom-right\":\n          case \"right\":\n            n = -e;\n            break;\n          case \"top-left\":\n          case \"bottom-left\":\n          case \"left\":\n            n = e;\n        }\n      }\n      return [n, i];\n    }\n    function kf(t, e, r, n, i, s, a, o, l, u) {\n      t.createArrays(), t.tilePixelRatio = ko / (512 * t.overscaling), t.compareText = {}, t.iconsNeedLinear = !1;\n      var c = t.layers[0].layout,\n        h = t.layers[0]._unevaluatedLayout._values,\n        p = {};\n      if (\"composite\" === t.textSizeData.kind) {\n        var _t$textSizeData = t.textSizeData,\n          _e154 = _t$textSizeData.minZoom,\n          _r132 = _t$textSizeData.maxZoom;\n        p.compositeTextSizes = [h[\"text-size\"].possiblyEvaluate(new $s(_e154), o), h[\"text-size\"].possiblyEvaluate(new $s(_r132), o)];\n      }\n      if (\"composite\" === t.iconSizeData.kind) {\n        var _t$iconSizeData = t.iconSizeData,\n          _e155 = _t$iconSizeData.minZoom,\n          _r133 = _t$iconSizeData.maxZoom;\n        p.compositeIconSizes = [h[\"icon-size\"].possiblyEvaluate(new $s(_e155), o), h[\"icon-size\"].possiblyEvaluate(new $s(_r133), o)];\n      }\n      p.layoutTextSize = h[\"text-size\"].possiblyEvaluate(new $s(l + 1), o), p.layoutIconSize = h[\"icon-size\"].possiblyEvaluate(new $s(l + 1), o), p.textMaxSize = h[\"text-size\"].possiblyEvaluate(new $s(18), o);\n      var f = \"map\" === c.get(\"text-rotation-alignment\") && \"point\" !== c.get(\"symbol-placement\"),\n        d = c.get(\"text-size\");\n      var _iterator118 = _createForOfIteratorHelper(t.features),\n        _step118;\n      try {\n        var _loop4 = function _loop4() {\n          var s = _step118.value;\n          var l = c.get(\"text-font\").evaluate(s, {}, o).join(\",\"),\n            h = d.evaluate(s, {}, o),\n            y = p.layoutTextSize.evaluate(s, {}, o),\n            m = (p.layoutIconSize.evaluate(s, {}, o), {\n              horizontal: {},\n              vertical: void 0\n            }),\n            g = s.text;\n          var x,\n            v = [0, 0];\n          if (g) {\n            var _n92 = g.toString(),\n              _a64 = c.get(\"text-letter-spacing\").evaluate(s, {}, o) * Wh,\n              _u28 = c.get(\"text-line-height\").evaluate(s, {}, o) * Wh,\n              _p11 = ws(_n92) ? _a64 : 0,\n              _d8 = c.get(\"text-anchor\").evaluate(s, {}, o),\n              _x5 = c.get(\"text-variable-anchor\");\n            if (!_x5) {\n              var _t167 = c.get(\"text-radial-offset\").evaluate(s, {}, o);\n              v = _t167 ? Sf(_d8, [_t167 * Wh, _f]) : c.get(\"text-offset\").evaluate(s, {}, o).map(function (t) {\n                return t * Wh;\n              });\n            }\n            var _b4 = f ? \"center\" : c.get(\"text-justify\").evaluate(s, {}, o);\n            var _w4 = \"point\" === c.get(\"symbol-placement\"),\n              _5 = _w4 ? c.get(\"text-max-width\").evaluate(s, {}, o) * Wh : 1 / 0,\n              _A4 = function _A4(s) {\n                t.allowVerticalPlacement && bs(_n92) && (m.vertical = Rp(g, e, r, i, l, _5, _u28, _d8, s, _p11, v, Vp.vertical, !0, y, h));\n              };\n            if (!f && _x5) {\n              var _t168 = \"auto\" === _b4 ? _x5.map(function (t) {\n                return If(t);\n              }) : [_b4];\n              var _n93 = !1;\n              for (var _s71 = 0; _s71 < _t168.length; _s71++) {\n                var _a65 = _t168[_s71];\n                if (!m.horizontal[_a65]) if (_n93) m.horizontal[_a65] = m.horizontal[0];else {\n                  var _t169 = Rp(g, e, r, i, l, _5, _u28, \"center\", _a65, _p11, v, Vp.horizontal, !1, y, h);\n                  _t169 && (m.horizontal[_a65] = _t169, _n93 = 1 === _t169.positionedLines.length);\n                }\n              }\n              _A4(\"left\");\n            } else {\n              if (\"auto\" === _b4 && (_b4 = If(_d8)), _w4 || c.get(\"text-writing-mode\").indexOf(\"horizontal\") >= 0 || !bs(_n92)) {\n                var _t170 = Rp(g, e, r, i, l, _5, _u28, _d8, _b4, _p11, v, Vp.horizontal, !1, y, h);\n                _t170 && (m.horizontal[_b4] = _t170);\n              }\n              _A4(_w4 ? \"left\" : _b4);\n            }\n          }\n          var b = !1;\n          if (s.icon && s.icon.name) {\n            var _e156 = n[s.icon.name];\n            _e156 && (x = Kp(i[s.icon.name], c.get(\"icon-offset\").evaluate(s, {}, o), c.get(\"icon-anchor\").evaluate(s, {}, o)), b = _e156.sdf, void 0 === t.sdfIcons ? t.sdfIcons = _e156.sdf : t.sdfIcons !== _e156.sdf && U(\"Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer\"), (_e156.pixelRatio !== t.pixelRatio || 0 !== c.get(\"icon-rotate\").constantOr(1)) && (t.iconsNeedLinear = !0));\n          }\n          var w = Bf(m.horizontal) || m.vertical;\n          t.iconsInText || (t.iconsInText = !!w && w.iconsInText), (w || x) && Mf(t, s, m, x, n, p, y, 0, v, b, a, o, u);\n        };\n        for (_iterator118.s(); !(_step118 = _iterator118.n()).done;) {\n          _loop4();\n        }\n      } catch (err) {\n        _iterator118.e(err);\n      } finally {\n        _iterator118.f();\n      }\n      s && t.generateCollisionDebugBuffers(l, t.collisionBoxArray);\n    }\n    function If(t) {\n      switch (t) {\n        case \"right\":\n        case \"top-right\":\n        case \"bottom-right\":\n          return \"right\";\n        case \"left\":\n        case \"top-left\":\n        case \"bottom-left\":\n          return \"left\";\n      }\n      return \"center\";\n    }\n    function Mf(t, e, r, n, i, s, a, o, l, u, c, h, p) {\n      var f = s.textMaxSize.evaluate(e, {}, h);\n      void 0 === f && (f = a);\n      var d = t.layers[0].layout,\n        y = d.get(\"icon-offset\").evaluate(e, {}, h),\n        m = Bf(r.horizontal) || r.vertical,\n        g = \"globe\" === p.name,\n        v = a / 24,\n        b = t.tilePixelRatio * f / 24,\n        w = (z = t.overscaling, t.zoom > 18 && z > 2 && (z >>= 1), Math.max(ko / (512 * z), 1) * d.get(\"symbol-spacing\")),\n        _ = d.get(\"text-padding\") * t.tilePixelRatio,\n        A = d.get(\"icon-padding\") * t.tilePixelRatio,\n        S = x(d.get(\"text-max-angle\")),\n        k = \"map\" === d.get(\"text-rotation-alignment\") && \"point\" !== d.get(\"symbol-placement\"),\n        I = \"map\" === d.get(\"icon-rotation-alignment\") && \"point\" !== d.get(\"symbol-placement\"),\n        M = d.get(\"symbol-placement\"),\n        T = w / 2;\n      var z;\n      var B = d.get(\"icon-text-fit\");\n      var E;\n      n && \"none\" !== B && (t.allowVerticalPlacement && r.vertical && (E = Yp(n, r.vertical, B, d.get(\"icon-text-fit-padding\"), y, v)), m && (n = Yp(n, m, B, d.get(\"icon-text-fit-padding\"), y, v)));\n      var C = function C(a, o, f) {\n        if (o.x < 0 || o.x >= ko || o.y < 0 || o.y >= ko) return;\n        var d = null;\n        if (g) {\n          var _p$projectTilePoint = p.projectTilePoint(o.x, o.y, f),\n            _t171 = _p$projectTilePoint.x,\n            _e157 = _p$projectTilePoint.y,\n            _r134 = _p$projectTilePoint.z;\n          d = {\n            anchor: new Hp(_t171, _e157, _r134, 0, void 0),\n            up: p.upVector(f, o.x, o.y)\n          };\n        }\n        !function (t, e, r, n, i, s, a, o, l, u, c, h, p, f, d, y, m, g, x, v, b, w, _, A, S) {\n          var _l$layout$get$evaluat, _l$layout$get$evaluat2;\n          var k = t.addToLineVertexArray(e, n);\n          var I,\n            M,\n            T,\n            z,\n            B,\n            E,\n            C,\n            P = 0,\n            D = 0,\n            V = 0,\n            L = 0,\n            F = -1,\n            R = -1;\n          var j = {};\n          var $ = qa(\"\");\n          var O = r ? r.anchor : e;\n          var q = 0,\n            N = 0;\n          if (void 0 === l._unevaluatedLayout.getValue(\"text-radial-offset\") ? (_l$layout$get$evaluat = l.layout.get(\"text-offset\").evaluate(b, {}, S).map(function (t) {\n            return t * Wh;\n          }), _l$layout$get$evaluat2 = _slicedToArray(_l$layout$get$evaluat, 2), q = _l$layout$get$evaluat2[0], N = _l$layout$get$evaluat2[1], _l$layout$get$evaluat) : (q = l.layout.get(\"text-radial-offset\").evaluate(b, {}, S) * Wh, N = _f), t.allowVerticalPlacement && i.vertical) {\n            var _t172 = i.vertical;\n            if (d) E = Cf(_t172), o && (C = Cf(o));else {\n              var _r135 = l.layout.get(\"text-rotate\").evaluate(b, {}, S) + 90;\n              T = Ef(u, O, e, c, h, p, _t172, f, _r135, y), o && (z = Ef(u, O, e, c, h, p, o, g, _r135));\n            }\n          }\n          if (s) {\n            var _n94 = l.layout.get(\"icon-rotate\").evaluate(b, {}, S),\n              _i95 = \"none\" !== l.layout.get(\"icon-text-fit\"),\n              _a66 = hf(s, _n94, _, _i95),\n              _f6 = o ? hf(o, _n94, _, _i95) : void 0;\n            M = Ef(u, O, e, c, h, p, s, g, _n94), P = 4 * _a66.length;\n            var _d9 = t.iconSizeData;\n            var _y6 = null;\n            \"source\" === _d9.kind ? (_y6 = [Jh * l.layout.get(\"icon-size\").evaluate(b, {}, S)], _y6[0] > Tf && U(\"\".concat(t.layerIds[0], \": Value for \\\"icon-size\\\" is >= 255. Reduce your \\\"icon-size\\\".\"))) : \"composite\" === _d9.kind && (_y6 = [Jh * w.compositeIconSizes[0].evaluate(b, {}, S), Jh * w.compositeIconSizes[1].evaluate(b, {}, S)], (_y6[0] > Tf || _y6[1] > Tf) && U(\"\".concat(t.layerIds[0], \": Value for \\\"icon-size\\\" is >= 255. Reduce your \\\"icon-size\\\".\"))), t.addSymbols(t.icon, _a66, _y6, v, x, b, !1, r, e, k.lineStartIndex, k.lineLength, -1, A, S), F = t.icon.placedSymbolArray.length - 1, _f6 && (D = 4 * _f6.length, t.addSymbols(t.icon, _f6, _y6, v, x, b, Vp.vertical, r, e, k.lineStartIndex, k.lineLength, -1, A, S), R = t.icon.placedSymbolArray.length - 1);\n          }\n          for (var _n95 in i.horizontal) {\n            var _s72 = i.horizontal[_n95];\n            I || ($ = qa(_s72.text), d ? B = Cf(_s72) : I = Ef(u, O, e, c, h, p, _s72, f, l.layout.get(\"text-rotate\").evaluate(b, {}, S), y));\n            var _o38 = 1 === _s72.positionedLines.length;\n            if (V += zf(t, r, e, _s72, a, l, d, b, y, k, i.vertical ? Vp.horizontal : Vp.horizontalOnly, _o38 ? Object.keys(i.horizontal) : [_n95], j, F, w, A, S), _o38) break;\n          }\n          i.vertical && (L += zf(t, r, e, i.vertical, a, l, d, b, y, k, Vp.vertical, [\"vertical\"], j, R, w, A, S));\n          var G = -1;\n          var Z = function Z(t, e) {\n            return t ? Math.max(t, e) : e;\n          };\n          G = Z(B, G), G = Z(E, G), G = Z(C, G);\n          var X = G > -1 ? 1 : 0;\n          t.glyphOffsetArray.length >= hd.MAX_GLYPHS && U(\"Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907\"), void 0 !== b.sortKey && t.addToSortKeyRanges(t.symbolInstances.length, b.sortKey), t.symbolInstances.emplaceBack(O.x, O.y, O.z, e.x, e.y, j.right >= 0 ? j.right : -1, j.center >= 0 ? j.center : -1, j.left >= 0 ? j.left : -1, j.vertical >= 0 ? j.vertical : -1, F, R, $, void 0 !== I ? I : t.collisionBoxArray.length, void 0 !== I ? I + 1 : t.collisionBoxArray.length, void 0 !== T ? T : t.collisionBoxArray.length, void 0 !== T ? T + 1 : t.collisionBoxArray.length, void 0 !== M ? M : t.collisionBoxArray.length, void 0 !== M ? M + 1 : t.collisionBoxArray.length, z || t.collisionBoxArray.length, z ? z + 1 : t.collisionBoxArray.length, c, V, L, P, D, X, 0, q, N, G);\n        }(t, o, d, a, r, n, i, E, t.layers[0], t.collisionBoxArray, e.index, e.sourceLayerIndex, t.index, _, k, l, 0, A, I, y, e, s, u, c, h);\n      };\n      if (\"line\" === M) {\n        var _iterator119 = _createForOfIteratorHelper(sf(e.geometry, 0, 0, ko, ko)),\n          _step119;\n        try {\n          for (_iterator119.s(); !(_step119 = _iterator119.n()).done;) {\n            var _i96 = _step119.value;\n            var _e158 = rf(_i96, w, S, r.vertical || m, n, 24, b, t.overscaling, ko);\n            var _iterator120 = _createForOfIteratorHelper(_e158),\n              _step120;\n            try {\n              for (_iterator120.s(); !(_step120 = _iterator120.n()).done;) {\n                var _r136 = _step120.value;\n                var _e159 = m;\n                _e159 && Pf(t, _e159.text, T, _r136) || C(_i96, _r136, h);\n              }\n            } catch (err) {\n              _iterator120.e(err);\n            } finally {\n              _iterator120.f();\n            }\n          }\n        } catch (err) {\n          _iterator119.e(err);\n        } finally {\n          _iterator119.f();\n        }\n      } else if (\"line-center\" === M) {\n        var _iterator121 = _createForOfIteratorHelper(e.geometry),\n          _step121;\n        try {\n          for (_iterator121.s(); !(_step121 = _iterator121.n()).done;) {\n            var _t173 = _step121.value;\n            if (_t173.length > 1) {\n              var _e160 = ef(_t173, S, r.vertical || m, n, 24, b);\n              _e160 && C(_t173, _e160, h);\n            }\n          }\n        } catch (err) {\n          _iterator121.e(err);\n        } finally {\n          _iterator121.f();\n        }\n      } else if (\"Polygon\" === e.type) {\n        var _iterator122 = _createForOfIteratorHelper(Lc(e.geometry, 0)),\n          _step122;\n        try {\n          for (_iterator122.s(); !(_step122 = _iterator122.n()).done;) {\n            var _t174 = _step122.value;\n            var _e161 = vf(_t174, 16);\n            C(_t174[0], new Hp(_e161.x, _e161.y, 0, 0, void 0), h);\n          }\n        } catch (err) {\n          _iterator122.e(err);\n        } finally {\n          _iterator122.f();\n        }\n      } else if (\"LineString\" === e.type) {\n        var _iterator123 = _createForOfIteratorHelper(e.geometry),\n          _step123;\n        try {\n          for (_iterator123.s(); !(_step123 = _iterator123.n()).done;) {\n            var _t175 = _step123.value;\n            C(_t175, new Hp(_t175[0].x, _t175[0].y, 0, 0, void 0), h);\n          }\n        } catch (err) {\n          _iterator123.e(err);\n        } finally {\n          _iterator123.f();\n        }\n      } else if (\"Point\" === e.type) {\n        var _iterator124 = _createForOfIteratorHelper(e.geometry),\n          _step124;\n        try {\n          for (_iterator124.s(); !(_step124 = _iterator124.n()).done;) {\n            var _t176 = _step124.value;\n            var _iterator125 = _createForOfIteratorHelper(_t176),\n              _step125;\n            try {\n              for (_iterator125.s(); !(_step125 = _iterator125.n()).done;) {\n                var _e162 = _step125.value;\n                C([_e162], new Hp(_e162.x, _e162.y, 0, 0, void 0), h);\n              }\n            } catch (err) {\n              _iterator125.e(err);\n            } finally {\n              _iterator125.f();\n            }\n          }\n        } catch (err) {\n          _iterator124.e(err);\n        } finally {\n          _iterator124.f();\n        }\n      }\n    }\n    var Tf = 32640;\n    function zf(t, e, r, n, i, s, a, o, l, u, c, h, p, f, y, m, g) {\n      var x = function (t, e, r, n, i, s, a, o) {\n          var l = [];\n          if (0 === e.positionedLines.length) return l;\n          var u = n.layout.get(\"text-rotate\").evaluate(s, {}) * Math.PI / 180,\n            c = function (t) {\n              var e = t[0],\n                r = t[1],\n                n = e * r;\n              return n > 0 ? [e, -r] : n < 0 ? [-e, r] : 0 === e ? [r, e] : [r, -e];\n            }(r);\n          var h = Math.abs(e.top - e.bottom);\n          var _iterator126 = _createForOfIteratorHelper(e.positionedLines),\n            _step126;\n          try {\n            for (_iterator126.s(); !(_step126 = _iterator126.n()).done;) {\n              var _t180 = _step126.value;\n              h -= _t180.lineOffset;\n            }\n          } catch (err) {\n            _iterator126.e(err);\n          } finally {\n            _iterator126.f();\n          }\n          var p = e.positionedLines.length,\n            f = h / p;\n          var y = e.top - r[1];\n          for (var _t177 = 0; _t177 < p; ++_t177) {\n            var _n96 = e.positionedLines[_t177];\n            y = mf(e, f, y, _t177);\n            var _iterator127 = _createForOfIteratorHelper(_n96.positionedGlyphs),\n              _step127;\n            try {\n              for (_iterator127.s(); !(_step127 = _iterator127.n()).done;) {\n                var _t178 = _step127.value;\n                if (!_t178.rect) continue;\n                var _n97 = _t178.rect || {};\n                var _s73 = 4,\n                  _h13 = !0,\n                  _p12 = 1,\n                  _f7 = 0;\n                if (_t178.imageName) {\n                  var _e163 = a[_t178.imageName];\n                  if (!_e163) continue;\n                  if (_e163.sdf) {\n                    U(\"SDF images are not supported in formatted text and will be ignored.\");\n                    continue;\n                  }\n                  _h13 = !1, _p12 = _e163.pixelRatio, _s73 = 1 / _p12;\n                }\n                var _m4 = (i || o) && _t178.vertical,\n                  _g6 = _t178.metrics.advance * _t178.scale / 2,\n                  _x6 = _t178.metrics,\n                  _v5 = _t178.rect;\n                if (null === _v5) continue;\n                o && e.verticalizable && (_f7 = _t178.imageName ? _g6 - _t178.metrics.width * _t178.scale / 2 : 0);\n                var _b5 = i ? [_t178.x + _g6, _t178.y] : [0, 0];\n                var _w5 = [0, 0],\n                  _6 = [0, 0],\n                  _A5 = !1;\n                i || (_m4 ? (_6 = [_t178.x + _g6 + c[0], _t178.y + c[1] - _f7], _A5 = !0) : _w5 = [_t178.x + _g6 + r[0], _t178.y + r[1] - _f7]);\n                var _S5 = _v5.w * _t178.scale / (_p12 * (_t178.localGlyph ? 2 : 1)),\n                  _k3 = _v5.h * _t178.scale / (_p12 * (_t178.localGlyph ? 2 : 1));\n                var _I3 = void 0,\n                  _M3 = void 0,\n                  _T2 = void 0,\n                  _z = void 0;\n                if (_m4) {\n                  var _e164 = _t178.y - y,\n                    _r137 = new d(-_g6, _g6 - _e164),\n                    _n98 = -Math.PI / 2,\n                    _i97 = _construct(d, _toConsumableArray(_6));\n                  _I3 = new d(-_g6 + _w5[0], _w5[1]), _I3._rotateAround(_n98, _r137)._add(_i97), _I3.x += -_e164 + _g6, _I3.y -= (_x6.left - _s73) * _t178.scale;\n                  var _a67 = _t178.imageName ? _x6.advance * _t178.scale : Wh * _t178.scale,\n                    _o39 = String.fromCharCode(_t178.glyph);\n                  sp(_o39) ? _I3.x += (1 - _s73) * _t178.scale : ap(_o39) ? _I3.x += _a67 - _x6.height * _t178.scale + (-_s73 - 1) * _t178.scale : _I3.x += _t178.imageName || _x6.width + 2 * _s73 === _v5.w && _x6.height + 2 * _s73 === _v5.h ? (_a67 - _k3) / 2 : (_a67 - (_x6.height + 2 * _s73) * _t178.scale) / 2, _M3 = new d(_I3.x, _I3.y - _S5), _T2 = new d(_I3.x + _k3, _I3.y), _z = new d(_I3.x + _k3, _I3.y - _S5);\n                } else {\n                  var _e165 = (_x6.left - _s73) * _t178.scale - _g6 + _w5[0],\n                    _r138 = (-_x6.top - _s73) * _t178.scale + _w5[1],\n                    _n99 = _e165 + _S5,\n                    _i98 = _r138 + _k3;\n                  _I3 = new d(_e165, _r138), _M3 = new d(_n99, _r138), _T2 = new d(_e165, _i98), _z = new d(_n99, _i98);\n                }\n                if (u) {\n                  var _t179 = void 0;\n                  _t179 = i ? new d(0, 0) : _A5 ? new d(c[0], c[1]) : new d(r[0], r[1]), _I3._rotateAround(u, _t179), _M3._rotateAround(u, _t179), _T2._rotateAround(u, _t179), _z._rotateAround(u, _t179);\n                }\n                var _B = new d(0, 0),\n                  _E = new d(0, 0);\n                l.push({\n                  tl: _I3,\n                  tr: _M3,\n                  bl: _T2,\n                  br: _z,\n                  tex: _n97,\n                  writingMode: e.writingMode,\n                  glyphOffset: _b5,\n                  sectionIndex: _t178.sectionIndex,\n                  isSDF: _h13,\n                  pixelOffsetTL: _B,\n                  pixelOffsetBR: _E,\n                  minFontScaleX: 0,\n                  minFontScaleY: 0\n                });\n              }\n            } catch (err) {\n              _iterator127.e(err);\n            } finally {\n              _iterator127.f();\n            }\n          }\n          return l;\n        }(0, n, l, s, a, o, i, t.allowVerticalPlacement),\n        v = t.textSizeData;\n      var b = null;\n      \"source\" === v.kind ? (b = [Jh * s.layout.get(\"text-size\").evaluate(o, {}, g)], b[0] > Tf && U(\"\".concat(t.layerIds[0], \": Value for \\\"text-size\\\" is >= 255. Reduce your \\\"text-size\\\".\"))) : \"composite\" === v.kind && (b = [Jh * y.compositeTextSizes[0].evaluate(o, {}, g), Jh * y.compositeTextSizes[1].evaluate(o, {}, g)], (b[0] > Tf || b[1] > Tf) && U(\"\".concat(t.layerIds[0], \": Value for \\\"text-size\\\" is >= 255. Reduce your \\\"text-size\\\".\"))), t.addSymbols(t.text, x, b, l, a, o, c, e, r, u.lineStartIndex, u.lineLength, f, m, g);\n      var _iterator128 = _createForOfIteratorHelper(h),\n        _step128;\n      try {\n        for (_iterator128.s(); !(_step128 = _iterator128.n()).done;) {\n          var _e166 = _step128.value;\n          p[_e166] = t.text.placedSymbolArray.length - 1;\n        }\n      } catch (err) {\n        _iterator128.e(err);\n      } finally {\n        _iterator128.f();\n      }\n      return 4 * x.length;\n    }\n    function Bf(t) {\n      for (var _e167 in t) return t[_e167];\n      return null;\n    }\n    function Ef(t, e, r, n, i, s, a, o, l, u) {\n      var c = a.top,\n        h = a.bottom,\n        p = a.left,\n        f = a.right;\n      var y = a.collisionPadding;\n      if (y && (p -= y[0], c -= y[1], f += y[2], h += y[3]), l) {\n        var _t181 = new d(p, c),\n          _e168 = new d(f, c),\n          _r139 = new d(p, h),\n          _n100 = new d(f, h),\n          _i99 = x(l);\n        var _s74 = new d(0, 0);\n        u && (_s74 = new d(u[0], u[1])), _t181._rotateAround(_i99, _s74), _e168._rotateAround(_i99, _s74), _r139._rotateAround(_i99, _s74), _n100._rotateAround(_i99, _s74), p = Math.min(_t181.x, _e168.x, _r139.x, _n100.x), f = Math.max(_t181.x, _e168.x, _r139.x, _n100.x), c = Math.min(_t181.y, _e168.y, _r139.y, _n100.y), h = Math.max(_t181.y, _e168.y, _r139.y, _n100.y);\n      }\n      return t.emplaceBack(e.x, e.y, e.z, r.x, r.y, p, c, f, h, o, n, i, s), t.length - 1;\n    }\n    function Cf(t) {\n      t.collisionPadding && (t.top -= t.collisionPadding[1], t.bottom += t.collisionPadding[3]);\n      var e = t.bottom - t.top;\n      return e > 0 ? Math.max(10, e) : null;\n    }\n    function Pf(t, e, r, n) {\n      var i = t.compareText;\n      if (e in i) {\n        var _t182 = i[e];\n        for (var _e169 = _t182.length - 1; _e169 >= 0; _e169--) if (n.dist(_t182[_e169]) < r) return !0;\n      } else i[e] = [];\n      return i[e].push(n), !1;\n    }\n    function Df(t, e) {\n      var r = t.fovAboveCenter,\n        n = t.elevation ? t.elevation.getMinElevationBelowMSL() * e : 0,\n        i = (t._camera.position[2] * t.worldSize - n) / Math.cos(t._pitch),\n        s = Math.sin(r) * i / Math.sin(Math.max(Math.PI / 2 - t._pitch - r, .01)),\n        a = Math.sin(t._pitch) * s + i;\n      return Math.min(1.01 * a, i * (1 / t._horizonShift));\n    }\n    function Vf(t, e) {\n      if (!e.isReprojectedInTileSpace) return {\n        scale: 1 << t.z,\n        x: t.x,\n        y: t.y,\n        x2: t.x + 1,\n        y2: t.y + 1,\n        projection: e\n      };\n      var r = Math.pow(2, -t.z),\n        n = t.x * r,\n        i = (t.x + 1) * r,\n        s = t.y * r,\n        a = (t.y + 1) * r,\n        o = ou(n),\n        l = ou(i),\n        u = lu(s),\n        c = lu(a),\n        h = e.project(o, u),\n        p = e.project(l, u),\n        f = e.project(l, c),\n        d = e.project(o, c);\n      var y = Math.min(h.x, p.x, f.x, d.x),\n        m = Math.min(h.y, p.y, f.y, d.y),\n        g = Math.max(h.x, p.x, f.x, d.x),\n        x = Math.max(h.y, p.y, f.y, d.y);\n      var v = r / 16;\n      function b(t, r, n, i, s, a) {\n        var o = (n + s) / 2,\n          l = (i + a) / 2,\n          u = e.project(ou(o), lu(l)),\n          c = Math.max(0, y - u.x, m - u.y, u.x - g, u.y - x);\n        y = Math.min(y, u.x), g = Math.max(g, u.x), m = Math.min(m, u.y), x = Math.max(x, u.y), c > v && (b(t, u, n, i, o, l), b(u, r, o, l, s, a));\n      }\n      b(h, p, n, s, i, s), b(p, f, i, s, i, a), b(f, d, i, a, n, a), b(d, h, n, a, n, s), y -= v, m -= v, g += v, x += v;\n      var w = 1 / Math.max(g - y, x - m);\n      return {\n        scale: w,\n        x: y * w,\n        y: m * w,\n        x2: g * w,\n        y2: x * w,\n        projection: e\n      };\n    }\n    var Lf = Eo(new Float32Array(16));\n    var Ff = /*#__PURE__*/function () {\n      function Ff(t) {\n        _classCallCheck(this, Ff);\n        this.spec = t, this.name = t.name, this.wrap = !1, this.requiresDraping = !1, this.supportsWorldCopies = !1, this.supportsTerrain = !1, this.supportsFog = !1, this.supportsFreeCamera = !1, this.zAxisUnit = \"meters\", this.isReprojectedInTileSpace = !0, this.unsupportedLayers = [\"custom\"], this.center = [0, 0], this.range = [3.5, 7];\n      }\n      _createClass(Ff, [{\n        key: \"project\",\n        value: function project(t, e) {\n          return {\n            x: 0,\n            y: 0,\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          return new ru(0, 0);\n        }\n      }, {\n        key: \"projectTilePoint\",\n        value: function projectTilePoint(t, e, r) {\n          return {\n            x: t,\n            y: e,\n            z: 0\n          };\n        }\n      }, {\n        key: \"locationPoint\",\n        value: function locationPoint(t, e) {\n          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;\n          return t._coordinatePoint(t.locationCoordinate(e), r);\n        }\n      }, {\n        key: \"pixelsPerMeter\",\n        value: function pixelsPerMeter(t, e) {\n          return au(1, t) * e;\n        }\n      }, {\n        key: \"pixelSpaceConversion\",\n        value: function pixelSpaceConversion(t, e, r) {\n          return 1;\n        }\n      }, {\n        key: \"farthestPixelDistance\",\n        value: function farthestPixelDistance(t) {\n          return Df(t, t.pixelsPerMeter);\n        }\n      }, {\n        key: \"pointCoordinate\",\n        value: function pointCoordinate(t, e, r, n) {\n          var i = t.horizonLineFromTop(!1),\n            s = new d(e, Math.max(i, r));\n          return t.rayIntersectionCoordinate(t.pointRayIntersection(s, n));\n        }\n      }, {\n        key: \"pointCoordinate3D\",\n        value: function pointCoordinate3D(t, e, r) {\n          var n = new d(e, r);\n          if (t.elevation) return t.elevation.pointCoordinate(n);\n          {\n            var _e170 = this.pointCoordinate(t, n.x, n.y, 0);\n            return [_e170.x, _e170.y, _e170.z];\n          }\n        }\n      }, {\n        key: \"isPointAboveHorizon\",\n        value: function isPointAboveHorizon(t, e) {\n          if (t.elevation) return !this.pointCoordinate3D(t, e.x, e.y);\n          var r = t.horizonLineFromTop();\n          return e.y < r;\n        }\n      }, {\n        key: \"createInversionMatrix\",\n        value: function createInversionMatrix(t, e) {\n          return Lf;\n        }\n      }, {\n        key: \"createTileMatrix\",\n        value: function createTileMatrix(t, e, r) {\n          var n, i, s;\n          var a = r.canonical,\n            o = Eo(new Float64Array(16));\n          if (this.isReprojectedInTileSpace) {\n            var _l29 = Vf(a, this);\n            n = 1, i = _l29.x + r.wrap * _l29.scale, s = _l29.y, Vo(o, o, [n / _l29.scale, n / _l29.scale, t.pixelsPerMeter / e]);\n          } else n = e / t.zoomScale(a.z), i = (a.x + Math.pow(2, a.z) * r.wrap) * n, s = a.y * n;\n          return Do(o, o, [i, s, 0]), Vo(o, o, [n / ko, n / ko, 1]), o;\n        }\n      }, {\n        key: \"upVector\",\n        value: function upVector(t, e, r) {\n          return [0, 0, 1];\n        }\n      }, {\n        key: \"upVectorScale\",\n        value: function upVectorScale(t, e, r) {\n          return {\n            metersToTile: 1\n          };\n        }\n      }]);\n      return Ff;\n    }();\n    var Rf = /*#__PURE__*/function (_Ff) {\n      _inherits(Rf, _Ff);\n      function Rf(t) {\n        var _this23;\n        _classCallCheck(this, Rf);\n        _this23 = _possibleConstructorReturn(this, _getPrototypeOf(Rf).call(this, t)), _this23.range = [4, 7], _this23.center = t.center || [-96, 37.5];\n        var _this23$parallels = _this23.parallels = t.parallels || [29.5, 45.5],\n          _this23$parallels2 = _slicedToArray(_this23$parallels, 2),\n          e = _this23$parallels2[0],\n          r = _this23$parallels2[1],\n          n = Math.sin(x(e));\n        _this23.n = (n + Math.sin(x(r))) / 2, _this23.c = 1 + n * (2 * _this23.n - n), _this23.r0 = Math.sqrt(_this23.c) / _this23.n;\n        return _this23;\n      }\n      _createClass(Rf, [{\n        key: \"project\",\n        value: function project(t, e) {\n          var r = this.n,\n            n = this.c,\n            i = this.r0,\n            s = x(t - this.center[0]),\n            a = x(e),\n            o = Math.sqrt(n - 2 * r * Math.sin(a)) / r;\n          return {\n            x: o * Math.sin(s * r),\n            y: o * Math.cos(s * r) - i,\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          var r = this.n,\n            n = this.c,\n            i = this.r0,\n            s = i + e;\n          var a = Math.atan2(t, Math.abs(s)) * Math.sign(s);\n          s * r < 0 && (a -= Math.PI * Math.sign(t) * Math.sign(s));\n          var o = x(this.center[0]) * r;\n          a = I(a, -Math.PI - o, Math.PI - o);\n          var l = S(v(a / r) + this.center[0], -180, 180),\n            u = Math.asin(S((n - (t * t + s * s) * r * r) / (2 * r), -1, 1)),\n            c = S(v(u), -cu, cu);\n          return new ru(l, c);\n        }\n      }]);\n      return Rf;\n    }(Ff);\n    var jf = 1.340264,\n      $f = -.081106,\n      Uf = 893e-6,\n      Of = .003796,\n      qf = Math.sqrt(3) / 2;\n    var Nf = /*#__PURE__*/function (_Ff2) {\n      _inherits(Nf, _Ff2);\n      function Nf() {\n        _classCallCheck(this, Nf);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Nf).apply(this, arguments));\n      }\n      _createClass(Nf, [{\n        key: \"project\",\n        value: function project(t, e) {\n          e = e / 180 * Math.PI, t = t / 180 * Math.PI;\n          var r = Math.asin(qf * Math.sin(e)),\n            n = r * r,\n            i = n * n * n;\n          return {\n            x: .5 * (t * Math.cos(r) / (qf * (jf + 3 * $f * n + i * (7 * Uf + 9 * Of * n))) / Math.PI + .5),\n            y: 1 - .5 * (r * (jf + $f * n + i * (Uf + Of * n)) / Math.PI + 1),\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          t = (2 * t - .5) * Math.PI;\n          var r = e = (2 * (1 - e) - 1) * Math.PI,\n            n = r * r,\n            i = n * n * n;\n          for (var _t183, _s75, _a68, _o40 = 0; _o40 < 12 && (_s75 = r * (jf + $f * n + i * (Uf + Of * n)) - e, _a68 = jf + 3 * $f * n + i * (7 * Uf + 9 * Of * n), _t183 = _s75 / _a68, r = S(r - _t183, -Math.PI / 3, Math.PI / 3), n = r * r, i = n * n * n, !(Math.abs(_t183) < 1e-12)); ++_o40);\n          var s = qf * t * (jf + 3 * $f * n + i * (7 * Uf + 9 * Of * n)) / Math.cos(r),\n            a = Math.asin(Math.sin(r) / qf),\n            o = S(180 * s / Math.PI, -180, 180),\n            l = S(180 * a / Math.PI, -cu, cu);\n          return new ru(o, l);\n        }\n      }]);\n      return Nf;\n    }(Ff);\n    var Gf = /*#__PURE__*/function (_Ff3) {\n      _inherits(Gf, _Ff3);\n      function Gf(t) {\n        var _this24;\n        _classCallCheck(this, Gf);\n        _this24 = _possibleConstructorReturn(this, _getPrototypeOf(Gf).call(this, t)), _this24.wrap = !0, _this24.supportsWorldCopies = !0;\n        return _this24;\n      }\n      _createClass(Gf, [{\n        key: \"project\",\n        value: function project(t, e) {\n          return {\n            x: .5 + t / 360,\n            y: .5 - e / 360,\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          var r = 360 * (t - .5),\n            n = S(360 * (.5 - e), -cu, cu);\n          return new ru(r, n);\n        }\n      }]);\n      return Gf;\n    }(Ff);\n    var Zf = Math.PI / 2;\n    function Xf(t) {\n      return Math.tan((Zf + t) / 2);\n    }\n    var Kf = /*#__PURE__*/function (_Ff4) {\n      _inherits(Kf, _Ff4);\n      function Kf(t) {\n        var _this25;\n        _classCallCheck(this, Kf);\n        _this25 = _possibleConstructorReturn(this, _getPrototypeOf(Kf).call(this, t)), _this25.center = t.center || [0, 30];\n        var _this25$parallels = _this25.parallels = t.parallels || [30, 30],\n          _this25$parallels2 = _slicedToArray(_this25$parallels, 2),\n          e = _this25$parallels2[0],\n          r = _this25$parallels2[1];\n        var n = x(e),\n          i = x(r);\n        _this25.southernCenter = n + i < 0, _this25.southernCenter && (n = -n, i = -i);\n        var s = Math.cos(n),\n          a = Xf(n);\n        _this25.n = n === i ? Math.sin(n) : Math.log(s / Math.cos(i)) / Math.log(Xf(i) / a), _this25.f = s * Math.pow(Xf(n), _this25.n) / _this25.n;\n        return _this25;\n      }\n      _createClass(Kf, [{\n        key: \"project\",\n        value: function project(t, e) {\n          e = x(e), this.southernCenter && (e = -e), t = x(t - this.center[0]);\n          var r = 1e-6,\n            n = this.n,\n            i = this.f;\n          i > 0 ? e < -Zf + r && (e = -Zf + r) : e > Zf - r && (e = Zf - r);\n          var s = i / Math.pow(Xf(e), n);\n          var a = s * Math.sin(n * t),\n            o = i - s * Math.cos(n * t);\n          return a = .5 * (a / Math.PI + .5), o = .5 * (o / Math.PI + .5), {\n            x: a,\n            y: this.southernCenter ? o : 1 - o,\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          t = (2 * t - .5) * Math.PI, this.southernCenter && (e = 1 - e), e = (2 * (1 - e) - .5) * Math.PI;\n          var r = this.n,\n            n = this.f,\n            i = n - e,\n            s = Math.sign(i),\n            a = Math.sign(r) * Math.sqrt(t * t + i * i);\n          var o = Math.atan2(t, Math.abs(i)) * s;\n          i * r < 0 && (o -= Math.PI * Math.sign(t) * s);\n          var l = S(v(o / r) + this.center[0], -180, 180),\n            u = S(v(2 * Math.atan(Math.pow(n / a, 1 / r)) - Zf), -cu, cu);\n          return new ru(l, this.southernCenter ? -u : u);\n        }\n      }]);\n      return Kf;\n    }(Ff);\n    var Yf = /*#__PURE__*/function (_Ff5) {\n      _inherits(Yf, _Ff5);\n      function Yf(t) {\n        var _this26;\n        _classCallCheck(this, Yf);\n        _this26 = _possibleConstructorReturn(this, _getPrototypeOf(Yf).call(this, t)), _this26.wrap = !0, _this26.supportsWorldCopies = !0, _this26.supportsTerrain = !0, _this26.supportsFog = !0, _this26.supportsFreeCamera = !0, _this26.isReprojectedInTileSpace = !1, _this26.unsupportedLayers = [], _this26.range = null;\n        return _this26;\n      }\n      _createClass(Yf, [{\n        key: \"project\",\n        value: function project(t, e) {\n          return {\n            x: iu(t),\n            y: su(e),\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          var r = ou(t),\n            n = lu(e);\n          return new ru(r, n);\n        }\n      }]);\n      return Yf;\n    }(Ff);\n    var Hf = x(cu);\n    var Wf = /*#__PURE__*/function (_Ff6) {\n      _inherits(Wf, _Ff6);\n      function Wf() {\n        _classCallCheck(this, Wf);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Wf).apply(this, arguments));\n      }\n      _createClass(Wf, [{\n        key: \"project\",\n        value: function project(t, e) {\n          var r = (e = x(e)) * e,\n            n = r * r;\n          return {\n            x: .5 * ((t = x(t)) * (.8707 - .131979 * r + n * (n * (.003971 * r - .001529 * n) - .013791)) / Math.PI + .5),\n            y: 1 - .5 * (e * (1.007226 + r * (.015085 + n * (.028874 * r - .044475 - .005916 * n))) / Math.PI + 1),\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          t = (2 * t - .5) * Math.PI;\n          var r = e = (2 * (1 - e) - 1) * Math.PI,\n            n = 25,\n            i = 0,\n            s = r * r;\n          do {\n            s = r * r;\n            var _t184 = s * s;\n            i = (r * (1.007226 + s * (.015085 + _t184 * (.028874 * s - .044475 - .005916 * _t184))) - e) / (1.007226 + s * (.045255 + _t184 * (.259866 * s - .311325 - .005916 * 11 * _t184))), r = S(r - i, -Hf, Hf);\n          } while (Math.abs(i) > 1e-6 && --n > 0);\n          s = r * r;\n          var a = S(v(t / (.8707 + s * (s * (s * s * s * (.003971 - .001529 * s) - .013791) - .131979))), -180, 180),\n            o = v(r);\n          return new ru(a, o);\n        }\n      }]);\n      return Wf;\n    }(Ff);\n    var Jf = x(cu);\n    var Qf = /*#__PURE__*/function (_Ff7) {\n      _inherits(Qf, _Ff7);\n      function Qf() {\n        _classCallCheck(this, Qf);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Qf).apply(this, arguments));\n      }\n      _createClass(Qf, [{\n        key: \"project\",\n        value: function project(t, e) {\n          e = x(e), t = x(t);\n          var r = Math.cos(e),\n            n = 2 / Math.PI,\n            i = Math.acos(r * Math.cos(t / 2)),\n            s = Math.sin(i) / i,\n            a = .5 * (t * n + 2 * r * Math.sin(t / 2) / s) || 0,\n            o = .5 * (e + Math.sin(e) / s) || 0;\n          return {\n            x: .5 * (a / Math.PI + .5),\n            y: 1 - .5 * (o / Math.PI + 1),\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          var r = t = (2 * t - .5) * Math.PI,\n            n = e = (2 * (1 - e) - 1) * Math.PI,\n            i = 25;\n          var s = 1e-6;\n          var a = 0,\n            o = 0;\n          do {\n            var _i100 = Math.cos(n),\n              _s76 = Math.sin(n),\n              _l30 = 2 * _s76 * _i100,\n              _u29 = _s76 * _s76,\n              _c18 = _i100 * _i100,\n              _h14 = Math.cos(r / 2),\n              _p13 = Math.sin(r / 2),\n              _f8 = 2 * _h14 * _p13,\n              _d10 = _p13 * _p13,\n              _y7 = 1 - _c18 * _h14 * _h14,\n              _m5 = _y7 ? 1 / _y7 : 0,\n              _g7 = _y7 ? Math.acos(_i100 * _h14) * Math.sqrt(1 / _y7) : 0,\n              _x7 = .5 * (2 * _g7 * _i100 * _p13 + 2 * r / Math.PI) - t,\n              _v6 = .5 * (_g7 * _s76 + n) - e,\n              _b6 = .5 * _m5 * (_c18 * _d10 + _g7 * _i100 * _h14 * _u29) + 1 / Math.PI,\n              _w6 = _m5 * (_f8 * _l30 / 4 - _g7 * _s76 * _p13),\n              _7 = .125 * _m5 * (_l30 * _p13 - _g7 * _s76 * _c18 * _f8),\n              _A6 = .5 * _m5 * (_u29 * _h14 + _g7 * _d10 * _i100) + .5,\n              _k4 = _w6 * _7 - _A6 * _b6;\n            a = (_v6 * _w6 - _x7 * _A6) / _k4, o = (_x7 * _7 - _v6 * _b6) / _k4, r = S(r - a, -Math.PI, Math.PI), n = S(n - o, -Jf, Jf);\n          } while ((Math.abs(a) > s || Math.abs(o) > s) && --i > 0);\n          return new ru(v(r), v(n));\n        }\n      }]);\n      return Qf;\n    }(Ff);\n    var td = /*#__PURE__*/function (_Ff8) {\n      _inherits(td, _Ff8);\n      function td(t) {\n        var _this27;\n        _classCallCheck(this, td);\n        _this27 = _possibleConstructorReturn(this, _getPrototypeOf(td).call(this, t)), _this27.center = t.center || [0, 0], _this27.parallels = t.parallels || [0, 0], _this27.cosPhi = Math.max(.01, Math.cos(x(_this27.parallels[0]))), _this27.scale = 1 / (2 * Math.max(Math.PI * _this27.cosPhi, 1 / _this27.cosPhi)), _this27.wrap = !0, _this27.supportsWorldCopies = !0;\n        return _this27;\n      }\n      _createClass(td, [{\n        key: \"project\",\n        value: function project(t, e) {\n          var r = this.scale,\n            n = this.cosPhi;\n          return {\n            x: x(t) * n * r + .5,\n            y: -Math.sin(x(e)) / n * r + .5,\n            z: 0\n          };\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(t, e) {\n          var r = this.scale,\n            n = this.cosPhi,\n            i = -(e - .5) / r,\n            s = S(v((t - .5) / r) / n, -180, 180),\n            a = Math.asin(S(i * n, -1, 1)),\n            o = S(v(a), -cu, cu);\n          return new ru(s, o);\n        }\n      }]);\n      return td;\n    }(Ff);\n    var ed = /*#__PURE__*/function (_Yf) {\n      _inherits(ed, _Yf);\n      function ed(t) {\n        var _this28;\n        _classCallCheck(this, ed);\n        _this28 = _possibleConstructorReturn(this, _getPrototypeOf(ed).call(this, t)), _this28.requiresDraping = !0, _this28.supportsWorldCopies = !1, _this28.supportsFog = !0, _this28.zAxisUnit = \"pixels\", _this28.unsupportedLayers = [\"debug\"], _this28.range = [3, 5];\n        return _this28;\n      }\n      _createClass(ed, [{\n        key: \"projectTilePoint\",\n        value: function projectTilePoint(t, e, r) {\n          var n = Ol(t, e, r);\n          return el(n, n, Gl(Pl(r))), {\n            x: n[0],\n            y: n[1],\n            z: n[2]\n          };\n        }\n      }, {\n        key: \"locationPoint\",\n        value: function locationPoint(t, e) {\n          var r = Ul(e.lat, e.lng),\n            n = Jo([], r),\n            i = t.elevation ? t.elevation.getAtPointOrZero(t.locationCoordinate(e), t._centerAltitude) : t._centerAltitude;\n          Wo(r, r, n, au(1, 0) * ko * i);\n          var s = Eo(new Float64Array(16));\n          return Po(s, t.pixelMatrix, t.globeMatrix), el(r, r, s), new d(r[0], r[1]);\n        }\n      }, {\n        key: \"pixelsPerMeter\",\n        value: function pixelsPerMeter(t, e) {\n          return au(1, 0) * e;\n        }\n      }, {\n        key: \"pixelSpaceConversion\",\n        value: function pixelSpaceConversion(t, e, r) {\n          var n = au(1, t) * e,\n            i = Mr(au(1, 45) * e, n, r);\n          return this.pixelsPerMeter(t, e) / i;\n        }\n      }, {\n        key: \"createTileMatrix\",\n        value: function createTileMatrix(t, e, r) {\n          var n = Zl(Pl(r.canonical));\n          return Po(new Float64Array(16), t.globeMatrix, n);\n        }\n      }, {\n        key: \"createInversionMatrix\",\n        value: function createInversionMatrix(t, e) {\n          var r = t.center,\n            n = Gl(Pl(e));\n          return Fo(n, n, x(r.lng)), Lo(n, n, x(r.lat)), Vo(n, n, [t._pixelsPerMercatorPixel, t._pixelsPerMercatorPixel, 1]), Float32Array.from(n);\n        }\n      }, {\n        key: \"pointCoordinate\",\n        value: function pointCoordinate(t, e, r, n) {\n          return Bl(t, e, r, !0) || new pu(0, 0);\n        }\n      }, {\n        key: \"pointCoordinate3D\",\n        value: function pointCoordinate3D(t, e, r) {\n          var n = this.pointCoordinate(t, e, r, 0);\n          return [n.x, n.y, n.z];\n        }\n      }, {\n        key: \"isPointAboveHorizon\",\n        value: function isPointAboveHorizon(t, e) {\n          return !Bl(t, e.x, e.y, !1);\n        }\n      }, {\n        key: \"farthestPixelDistance\",\n        value: function farthestPixelDistance(t) {\n          var e = function (t, e) {\n              var r = t.cameraToCenterDistance,\n                n = t._centerAltitude * e,\n                i = t._camera,\n                s = t._camera.forward(),\n                a = Go([], Ho([], s, -r), [0, 0, n]),\n                o = t.worldSize / (2 * Math.PI),\n                l = [0, 0, -o],\n                u = t.width / t.height,\n                c = Math.tan(t.fovAboveCenter),\n                h = Ho([], i.up(), c),\n                p = Ho([], i.right(), c * u),\n                f = Jo([], Go([], Go([], s, h), p)),\n                d = [];\n              var y;\n              if (new vl(a, f).closestPointOnSphere(l, o, d)) {\n                var _e171 = Go([], d, l),\n                  _r140 = il([], _e171, a);\n                y = Math.cos(t.fovAboveCenter) * qo(_r140);\n              } else {\n                var _t185 = il([], a, l),\n                  _e172 = il([], l, a);\n                Jo(_e172, _e172);\n                var _r141 = qo(_t185) - o;\n                y = Math.sqrt(_r141 * (_r141 + 2 * o));\n                var _n101 = Math.acos(y / (o + _r141)) - Math.acos(Qo(s, _e172));\n                y *= Math.cos(_n101);\n              }\n              return 1.01 * y;\n            }(t, this.pixelsPerMeter(t.center.lat, t.worldSize)),\n            r = Kl(t.zoom);\n          if (r > 0) {\n            var _n102 = Df(t, au(1, t.center.lat) * t.worldSize),\n              _i101 = t.worldSize / (2 * Math.PI),\n              _s77 = Math.max(t.width, t.height) / t.worldSize * Math.PI;\n            return Mr(e, _n102 + _i101 * (1 - Math.cos(_s77)), Math.pow(r, 10));\n          }\n          return e;\n        }\n      }, {\n        key: \"upVector\",\n        value: function upVector(t, e, r) {\n          return Ol(e, r, t, 1);\n        }\n      }, {\n        key: \"upVectorScale\",\n        value: function upVectorScale(t) {\n          return {\n            metersToTile: zl(ql(Pl(t)))\n          };\n        }\n      }]);\n      return ed;\n    }(Yf);\n    function rd(t) {\n      var e = t.parallels,\n        r = !!e && Math.abs(e[0] + e[1]) < .01;\n      switch (t.name) {\n        case \"mercator\":\n          return new Yf(t);\n        case \"equirectangular\":\n          return new Gf(t);\n        case \"naturalEarth\":\n          return new Wf(t);\n        case \"equalEarth\":\n          return new Nf(t);\n        case \"winkelTripel\":\n          return new Qf(t);\n        case \"albers\":\n          return r ? new td(t) : new Rf(t);\n        case \"lambertConformalConic\":\n          return r ? new td(t) : new Kf(t);\n        case \"globe\":\n          return new ed(t);\n      }\n      throw new Error(\"Invalid projection name: \".concat(t.name));\n    }\n    var nd = ah.types,\n      id = [{\n        name: \"a_fade_opacity\",\n        components: 1,\n        type: \"Uint8\",\n        offset: 0\n      }];\n    function sd(t, e, r, n, i, s, a, o, l, u, c, h, p) {\n      var f = o ? Math.min(Tf, Math.round(o[0])) : 0,\n        d = o ? Math.min(Tf, Math.round(o[1])) : 0;\n      t.emplaceBack(e, r, Math.round(32 * n), Math.round(32 * i), s, a, (f << 1) + (l ? 1 : 0), d, 16 * u, 16 * c, 256 * h, 256 * p);\n    }\n    function ad(t, e, r, n, i, s, a) {\n      t.emplaceBack(e, r, n, i, s, a);\n    }\n    function od(t, e, r, n, i) {\n      t.emplaceBack(e, r, n, i), t.emplaceBack(e, r, n, i), t.emplaceBack(e, r, n, i), t.emplaceBack(e, r, n, i);\n    }\n    function ld(t) {\n      var _iterator129 = _createForOfIteratorHelper(t.sections),\n        _step129;\n      try {\n        for (_iterator129.s(); !(_step129 = _iterator129.n()).done;) {\n          var _e173 = _step129.value;\n          if (Ms(_e173.text)) return !0;\n        }\n      } catch (err) {\n        _iterator129.e(err);\n      } finally {\n        _iterator129.f();\n      }\n      return !1;\n    }\n    var ud = /*#__PURE__*/function () {\n      function ud(t) {\n        _classCallCheck(this, ud);\n        this.layoutVertexArray = new fa(), this.indexArray = new wa(), this.programConfigurations = t, this.segments = new So(), this.dynamicLayoutVertexArray = new ua(), this.opacityVertexArray = new ya(), this.placedSymbolArray = new Pa(), this.globeExtVertexArray = new da();\n      }\n      _createClass(ud, [{\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return 0 === this.layoutVertexArray.length && 0 === this.indexArray.length && 0 === this.dynamicLayoutVertexArray.length && 0 === this.opacityVertexArray.length;\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t, e, r, n) {\n          this.isEmpty() || (r && (this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, Nh.members), this.indexBuffer = t.createIndexBuffer(this.indexArray, e), this.dynamicLayoutVertexBuffer = t.createVertexBuffer(this.dynamicLayoutVertexArray, Zh.members, !0), this.opacityVertexBuffer = t.createVertexBuffer(this.opacityVertexArray, id, !0), this.globeExtVertexArray.length > 0 && (this.globeExtVertexBuffer = t.createVertexBuffer(this.globeExtVertexArray, Gh.members, !0)), this.opacityVertexBuffer.itemSize = 1), (r || n) && this.programConfigurations.upload(t));\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.programConfigurations.destroy(), this.segments.destroy(), this.dynamicLayoutVertexBuffer.destroy(), this.opacityVertexBuffer.destroy(), this.globeExtVertexBuffer && this.globeExtVertexBuffer.destroy());\n        }\n      }]);\n      return ud;\n    }();\n    Oi(ud, \"SymbolBuffers\");\n    var cd = /*#__PURE__*/function () {\n      function cd(t, e, r) {\n        _classCallCheck(this, cd);\n        this.layoutVertexArray = new t(), this.layoutAttributes = e, this.indexArray = new r(), this.segments = new So(), this.collisionVertexArray = new va(), this.collisionVertexArrayExt = new ba();\n      }\n      _createClass(cd, [{\n        key: \"upload\",\n        value: function upload(t) {\n          this.layoutVertexBuffer = t.createVertexBuffer(this.layoutVertexArray, this.layoutAttributes), this.indexBuffer = t.createIndexBuffer(this.indexArray), this.collisionVertexBuffer = t.createVertexBuffer(this.collisionVertexArray, Xh.members, !0), this.collisionVertexBufferExt = t.createVertexBuffer(this.collisionVertexArrayExt, Kh.members, !0);\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.layoutVertexBuffer && (this.layoutVertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy(), this.collisionVertexBuffer.destroy(), this.collisionVertexBufferExt.destroy());\n        }\n      }]);\n      return cd;\n    }();\n    Oi(cd, \"CollisionBuffers\");\n    var hd = /*#__PURE__*/function () {\n      function hd(t) {\n        _classCallCheck(this, hd);\n        this.collisionBoxArray = t.collisionBoxArray, this.zoom = t.zoom, this.overscaling = t.overscaling, this.layers = t.layers, this.layerIds = this.layers.map(function (t) {\n          return t.id;\n        }), this.index = t.index, this.pixelRatio = t.pixelRatio, this.sourceLayerIndex = t.sourceLayerIndex, this.hasPattern = !1, this.hasRTLText = !1, this.fullyClipped = !1, this.sortKeyRanges = [], this.collisionCircleArray = [], this.placementInvProjMatrix = Eo([]), this.placementViewportMatrix = Eo([]);\n        var e = this.layers[0]._unevaluatedLayout._values;\n        this.textSizeData = Qh(this.zoom, e[\"text-size\"]), this.iconSizeData = Qh(this.zoom, e[\"icon-size\"]);\n        var r = this.layers[0].layout,\n          n = r.get(\"symbol-sort-key\"),\n          i = r.get(\"symbol-z-order\");\n        this.canOverlap = r.get(\"text-allow-overlap\") || r.get(\"icon-allow-overlap\") || r.get(\"text-ignore-placement\") || r.get(\"icon-ignore-placement\"), this.sortFeaturesByKey = \"viewport-y\" !== i && void 0 !== n.constantOr(1), this.sortFeaturesByY = (\"viewport-y\" === i || \"auto\" === i && !this.sortFeaturesByKey) && this.canOverlap, this.writingModes = r.get(\"text-writing-mode\").map(function (t) {\n          return Vp[t];\n        }), this.stateDependentLayerIds = this.layers.filter(function (t) {\n          return t.isStateDependent();\n        }).map(function (t) {\n          return t.id;\n        }), this.sourceID = t.sourceID, this.projection = t.projection;\n      }\n      _createClass(hd, [{\n        key: \"createArrays\",\n        value: function createArrays() {\n          this.text = new ud(new fo(this.layers, this.zoom, function (t) {\n            return /^text/.test(t);\n          })), this.icon = new ud(new fo(this.layers, this.zoom, function (t) {\n            return /^icon/.test(t);\n          })), this.glyphOffsetArray = new La(), this.lineVertexArray = new Fa(), this.symbolInstances = new Va();\n        }\n      }, {\n        key: \"calculateGlyphDependencies\",\n        value: function calculateGlyphDependencies(t, e, r, n, i) {\n          for (var _r142 = 0; _r142 < t.length; _r142++) if (e[t.charCodeAt(_r142)] = !0, n && i) {\n            var _n103 = ip[t.charAt(_r142)];\n            _n103 && (e[_n103.charCodeAt(0)] = !0);\n          }\n        }\n      }, {\n        key: \"populate\",\n        value: function populate(t, e, r, n) {\n          var _this29 = this;\n          var i = this.layers[0],\n            s = i.layout,\n            a = \"globe\" === this.projection.name,\n            o = s.get(\"text-font\"),\n            l = s.get(\"text-field\"),\n            u = s.get(\"icon-image\"),\n            c = (\"constant\" !== l.value.kind || l.value.value instanceof Be && !l.value.value.isEmpty() || l.value.value.toString().length > 0) && (\"constant\" !== o.value.kind || o.value.value.length > 0),\n            h = \"constant\" !== u.value.kind || !!u.value.value || Object.keys(u.parameters).length > 0,\n            p = s.get(\"symbol-sort-key\");\n          if (this.features = [], !c && !h) return;\n          var f = e.iconDependencies,\n            d = e.glyphDependencies,\n            y = e.availableImages,\n            m = new $s(this.zoom);\n          var _iterator130 = _createForOfIteratorHelper(t),\n            _step130;\n          try {\n            var _loop5 = function _loop5() {\n              var _step130$value = _step130.value,\n                e = _step130$value.feature,\n                l = _step130$value.id,\n                u = _step130$value.index,\n                g = _step130$value.sourceLayerIndex;\n              var t = i._featureFilter.needGeometry,\n                x = wu(e, t);\n              if (!i._featureFilter.filter(m, x, r)) return \"continue\";\n              if (t || (x.geometry = bu(e, r, n)), a && 1 !== e.type && r.z <= 5) {\n                var _t187 = x.geometry,\n                  _e174 = .98078528056,\n                  _n104 = function _n104(t, n) {\n                    return Qo(Ol(t.x, t.y, r, 1), Ol(n.x, n.y, r, 1)) < _e174;\n                  };\n                for (var _e175 = 0; _e175 < _t187.length; _e175++) _t187[_e175] = mu(_t187[_e175], _n104);\n              }\n              var v, b;\n              if (c) {\n                var _t188 = i.getValueAndResolveTokens(\"text-field\", x, r, y),\n                  _e176 = Be.factory(_t188);\n                ld(_e176) && (_this29.hasRTLText = !0), (!_this29.hasRTLText || \"unavailable\" === Fs() || _this29.hasRTLText && js.isParsed()) && (v = np(_e176, i, x));\n              }\n              if (h) {\n                var _t189 = i.getValueAndResolveTokens(\"icon-image\", x, r, y);\n                b = _t189 instanceof Ee ? _t189 : Ee.fromString(_t189);\n              }\n              if (!v && !b) return \"continue\";\n              var w = _this29.sortFeaturesByKey ? p.evaluate(x, {}, r) : void 0;\n              if (_this29.features.push({\n                id: l,\n                text: v,\n                icon: b,\n                index: u,\n                sourceLayerIndex: g,\n                geometry: x.geometry,\n                properties: e.properties,\n                type: nd[e.type],\n                sortKey: w\n              }), b && (f[b.name] = !0), v) {\n                var _t190 = o.evaluate(x, {}, r).join(\",\"),\n                  _e177 = \"map\" === s.get(\"text-rotation-alignment\") && \"point\" !== s.get(\"symbol-placement\");\n                _this29.allowVerticalPlacement = _this29.writingModes && _this29.writingModes.indexOf(Vp.vertical) >= 0;\n                var _iterator131 = _createForOfIteratorHelper(v.sections),\n                  _step131;\n                try {\n                  for (_iterator131.s(); !(_step131 = _iterator131.n()).done;) {\n                    var _r143 = _step131.value;\n                    if (_r143.image) f[_r143.image.name] = !0;else {\n                      var _n105 = bs(v.toString()),\n                        _i103 = _r143.fontStack || _t190,\n                        _s78 = d[_i103] = d[_i103] || {};\n                      _this29.calculateGlyphDependencies(_r143.text, _s78, _e177, _this29.allowVerticalPlacement, _n105);\n                    }\n                  }\n                } catch (err) {\n                  _iterator131.e(err);\n                } finally {\n                  _iterator131.f();\n                }\n              }\n            };\n            for (_iterator130.s(); !(_step130 = _iterator130.n()).done;) {\n              var _ret2 = _loop5();\n              if (_ret2 === \"continue\") continue;\n            }\n          } catch (err) {\n            _iterator130.e(err);\n          } finally {\n            _iterator130.f();\n          }\n          \"line\" === s.get(\"symbol-placement\") && (this.features = function (t) {\n            var e = {},\n              r = {},\n              n = [];\n            var i = 0;\n            function s(e) {\n              n.push(t[e]), i++;\n            }\n            function a(t, e, i) {\n              var s = r[t];\n              return delete r[t], r[e] = s, n[s].geometry[0].pop(), n[s].geometry[0] = n[s].geometry[0].concat(i[0]), s;\n            }\n            function o(t, r, i) {\n              var s = e[r];\n              return delete e[r], e[t] = s, n[s].geometry[0].shift(), n[s].geometry[0] = i[0].concat(n[s].geometry[0]), s;\n            }\n            function l(t, e, r) {\n              var n = r ? e[0][e[0].length - 1] : e[0][0];\n              return \"\".concat(t, \":\").concat(n.x, \":\").concat(n.y);\n            }\n            for (var _u30 = 0; _u30 < t.length; _u30++) {\n              var _c19 = t[_u30],\n                _h15 = _c19.geometry,\n                _p14 = _c19.text ? _c19.text.toString() : null;\n              if (!_p14) {\n                s(_u30);\n                continue;\n              }\n              var _f9 = l(_p14, _h15),\n                _d11 = l(_p14, _h15, !0);\n              if (_f9 in r && _d11 in e && r[_f9] !== e[_d11]) {\n                var _t186 = o(_f9, _d11, _h15),\n                  _i102 = a(_f9, _d11, n[_t186].geometry);\n                delete e[_f9], delete r[_d11], r[l(_p14, n[_i102].geometry, !0)] = _i102, n[_t186].geometry = null;\n              } else _f9 in r ? a(_f9, _d11, _h15) : _d11 in e ? o(_f9, _d11, _h15) : (s(_u30), e[_f9] = i - 1, r[_d11] = i - 1);\n            }\n            return n.filter(function (t) {\n              return t.geometry;\n            });\n          }(this.features)), this.sortFeaturesByKey && this.features.sort(function (t, e) {\n            return t.sortKey - e.sortKey;\n          });\n        }\n      }, {\n        key: \"update\",\n        value: function update(t, e, r, n) {\n          this.stateDependentLayers.length && (this.text.programConfigurations.updatePaintArrays(t, e, this.layers, r, n), this.icon.programConfigurations.updatePaintArrays(t, e, this.layers, r, n));\n        }\n      }, {\n        key: \"isEmpty\",\n        value: function isEmpty() {\n          return 0 === this.symbolInstances.length && !this.hasRTLText;\n        }\n      }, {\n        key: \"uploadPending\",\n        value: function uploadPending() {\n          return !this.uploaded || this.text.programConfigurations.needsUpload || this.icon.programConfigurations.needsUpload;\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          !this.uploaded && this.hasDebugData() && (this.textCollisionBox.upload(t), this.iconCollisionBox.upload(t)), this.text.upload(t, this.sortFeaturesByY, !this.uploaded, this.text.programConfigurations.needsUpload), this.icon.upload(t, this.sortFeaturesByY, !this.uploaded, this.icon.programConfigurations.needsUpload), this.uploaded = !0;\n        }\n      }, {\n        key: \"destroyDebugData\",\n        value: function destroyDebugData() {\n          this.textCollisionBox.destroy(), this.iconCollisionBox.destroy();\n        }\n      }, {\n        key: \"getProjection\",\n        value: function getProjection() {\n          return this.projectionInstance || (this.projectionInstance = rd(this.projection)), this.projectionInstance;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.text.destroy(), this.icon.destroy(), this.hasDebugData() && this.destroyDebugData();\n        }\n      }, {\n        key: \"addToLineVertexArray\",\n        value: function addToLineVertexArray(t, e) {\n          var r = this.lineVertexArray.length;\n          if (void 0 !== t.segment) {\n            var _iterator132 = _createForOfIteratorHelper(e),\n              _step132;\n            try {\n              for (_iterator132.s(); !(_step132 = _iterator132.n()).done;) {\n                var _step132$value = _step132.value,\n                  _t191 = _step132$value.x,\n                  _r144 = _step132$value.y;\n                this.lineVertexArray.emplaceBack(_t191, _r144);\n              }\n            } catch (err) {\n              _iterator132.e(err);\n            } finally {\n              _iterator132.f();\n            }\n          }\n          return {\n            lineStartIndex: r,\n            lineLength: this.lineVertexArray.length - r\n          };\n        }\n      }, {\n        key: \"addSymbols\",\n        value: function addSymbols(t, e, r, n, i, s, a, o, l, u, c, h, p, f) {\n          var d = t.indexArray,\n            y = t.layoutVertexArray,\n            m = t.globeExtVertexArray,\n            g = t.segments.prepareSegment(4 * e.length, y, d, this.canOverlap ? s.sortKey : void 0),\n            x = this.glyphOffsetArray.length,\n            v = g.vertexLength,\n            b = this.allowVerticalPlacement && a === Vp.vertical ? Math.PI / 2 : 0,\n            w = s.text && s.text.sections;\n          for (var _n106 = 0; _n106 < e.length; _n106++) {\n            var _e$_n = e[_n106],\n              _i104 = _e$_n.tl,\n              _a69 = _e$_n.tr,\n              _u31 = _e$_n.bl,\n              _c20 = _e$_n.br,\n              _h16 = _e$_n.tex,\n              _x8 = _e$_n.pixelOffsetTL,\n              _v7 = _e$_n.pixelOffsetBR,\n              _8 = _e$_n.minFontScaleX,\n              _A7 = _e$_n.minFontScaleY,\n              _S6 = _e$_n.glyphOffset,\n              _k5 = _e$_n.isSDF,\n              _I4 = _e$_n.sectionIndex,\n              _M4 = g.vertexLength,\n              _T3 = _S6[1];\n            if (sd(y, l.x, l.y, _i104.x, _T3 + _i104.y, _h16.x, _h16.y, r, _k5, _x8.x, _x8.y, _8, _A7), sd(y, l.x, l.y, _a69.x, _T3 + _a69.y, _h16.x + _h16.w, _h16.y, r, _k5, _v7.x, _x8.y, _8, _A7), sd(y, l.x, l.y, _u31.x, _T3 + _u31.y, _h16.x, _h16.y + _h16.h, r, _k5, _x8.x, _v7.y, _8, _A7), sd(y, l.x, l.y, _c20.x, _T3 + _c20.y, _h16.x + _h16.w, _h16.y + _h16.h, r, _k5, _v7.x, _v7.y, _8, _A7), o) {\n              var _o$anchor = o.anchor,\n                _e178 = _o$anchor.x,\n                _r145 = _o$anchor.y,\n                _n107 = _o$anchor.z,\n                _o$up = _slicedToArray(o.up, 3),\n                _i105 = _o$up[0],\n                _s79 = _o$up[1],\n                _a70 = _o$up[2];\n              ad(m, _e178, _r145, _n107, _i105, _s79, _a70), ad(m, _e178, _r145, _n107, _i105, _s79, _a70), ad(m, _e178, _r145, _n107, _i105, _s79, _a70), ad(m, _e178, _r145, _n107, _i105, _s79, _a70), od(t.dynamicLayoutVertexArray, _e178, _r145, _n107, b);\n            } else od(t.dynamicLayoutVertexArray, l.x, l.y, l.z, b);\n            d.emplaceBack(_M4, _M4 + 1, _M4 + 2), d.emplaceBack(_M4 + 1, _M4 + 2, _M4 + 3), g.vertexLength += 4, g.primitiveLength += 2, this.glyphOffsetArray.emplaceBack(_S6[0]), _n106 !== e.length - 1 && _I4 === e[_n106 + 1].sectionIndex || t.programConfigurations.populatePaintArrays(y.length, s, s.index, {}, p, f, w && w[_I4]);\n          }\n          var _ = o ? o.anchor : l;\n          t.placedSymbolArray.emplaceBack(_.x, _.y, _.z, l.x, l.y, x, this.glyphOffsetArray.length - x, v, u, c, l.segment, r ? r[0] : 0, r ? r[1] : 0, n[0], n[1], a, 0, !1, 0, h, 0);\n        }\n      }, {\n        key: \"_commitLayoutVertex\",\n        value: function _commitLayoutVertex(t, e, r, n, i, s, a) {\n          t.emplaceBack(e, r, n, i, s, Math.round(a.x), Math.round(a.y));\n        }\n      }, {\n        key: \"_addCollisionDebugVertices\",\n        value: function _addCollisionDebugVertices(t, e, r, n, i, s, a) {\n          var o = r.segments.prepareSegment(4, r.layoutVertexArray, r.indexArray),\n            l = o.vertexLength,\n            u = a.tileAnchorX,\n            c = a.tileAnchorY;\n          for (var _t192 = 0; _t192 < 4; _t192++) r.collisionVertexArray.emplaceBack(0, 0, 0, 0);\n          r.collisionVertexArrayExt.emplaceBack(e, -t.padding, -t.padding), r.collisionVertexArrayExt.emplaceBack(e, t.padding, -t.padding), r.collisionVertexArrayExt.emplaceBack(e, t.padding, t.padding), r.collisionVertexArrayExt.emplaceBack(e, -t.padding, t.padding), this._commitLayoutVertex(r.layoutVertexArray, n, i, s, u, c, new d(t.x1, t.y1)), this._commitLayoutVertex(r.layoutVertexArray, n, i, s, u, c, new d(t.x2, t.y1)), this._commitLayoutVertex(r.layoutVertexArray, n, i, s, u, c, new d(t.x2, t.y2)), this._commitLayoutVertex(r.layoutVertexArray, n, i, s, u, c, new d(t.x1, t.y2)), o.vertexLength += 4;\n          var h = r.indexArray;\n          h.emplaceBack(l, l + 1), h.emplaceBack(l + 1, l + 2), h.emplaceBack(l + 2, l + 3), h.emplaceBack(l + 3, l), o.primitiveLength += 4;\n        }\n      }, {\n        key: \"_addTextDebugCollisionBoxes\",\n        value: function _addTextDebugCollisionBoxes(t, e, r, n, i, s) {\n          for (var _a71 = n; _a71 < i; _a71++) {\n            var _n108 = r.get(_a71),\n              _i106 = this.getSymbolInstanceTextSize(t, s, e, _a71);\n            this._addCollisionDebugVertices(_n108, _i106, this.textCollisionBox, _n108.projectedAnchorX, _n108.projectedAnchorY, _n108.projectedAnchorZ, s);\n          }\n        }\n      }, {\n        key: \"_addIconDebugCollisionBoxes\",\n        value: function _addIconDebugCollisionBoxes(t, e, r, n, i, s) {\n          for (var _a72 = n; _a72 < i; _a72++) {\n            var _n109 = r.get(_a72),\n              _i107 = this.getSymbolInstanceIconSize(t, e, s.placedIconSymbolIndex);\n            this._addCollisionDebugVertices(_n109, _i107, this.iconCollisionBox, _n109.projectedAnchorX, _n109.projectedAnchorY, _n109.projectedAnchorZ, s);\n          }\n        }\n      }, {\n        key: \"generateCollisionDebugBuffers\",\n        value: function generateCollisionDebugBuffers(t, e) {\n          this.hasDebugData() && this.destroyDebugData(), this.textCollisionBox = new cd(ga, Yh.members, Ma), this.iconCollisionBox = new cd(ga, Yh.members, Ma);\n          var r = ep(this.iconSizeData, t),\n            n = ep(this.textSizeData, t);\n          for (var _i108 = 0; _i108 < this.symbolInstances.length; _i108++) {\n            var _s80 = this.symbolInstances.get(_i108);\n            this._addTextDebugCollisionBoxes(n, t, e, _s80.textBoxStartIndex, _s80.textBoxEndIndex, _s80), this._addTextDebugCollisionBoxes(n, t, e, _s80.verticalTextBoxStartIndex, _s80.verticalTextBoxEndIndex, _s80), this._addIconDebugCollisionBoxes(r, t, e, _s80.iconBoxStartIndex, _s80.iconBoxEndIndex, _s80), this._addIconDebugCollisionBoxes(r, t, e, _s80.verticalIconBoxStartIndex, _s80.verticalIconBoxEndIndex, _s80);\n          }\n        }\n      }, {\n        key: \"getSymbolInstanceTextSize\",\n        value: function getSymbolInstanceTextSize(t, e, r, n) {\n          var i = this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex >= 0 ? e.rightJustifiedTextSymbolIndex : e.centerJustifiedTextSymbolIndex >= 0 ? e.centerJustifiedTextSymbolIndex : e.leftJustifiedTextSymbolIndex >= 0 ? e.leftJustifiedTextSymbolIndex : e.verticalPlacedTextSymbolIndex >= 0 ? e.verticalPlacedTextSymbolIndex : n),\n            s = tp(this.textSizeData, t, i) / Wh;\n          return this.tilePixelRatio * s;\n        }\n      }, {\n        key: \"getSymbolInstanceIconSize\",\n        value: function getSymbolInstanceIconSize(t, e, r) {\n          var n = this.icon.placedSymbolArray.get(r),\n            i = tp(this.iconSizeData, t, n);\n          return this.tilePixelRatio * i;\n        }\n      }, {\n        key: \"_commitDebugCollisionVertexUpdate\",\n        value: function _commitDebugCollisionVertexUpdate(t, e, r) {\n          t.emplaceBack(e, -r, -r), t.emplaceBack(e, r, -r), t.emplaceBack(e, r, r), t.emplaceBack(e, -r, r);\n        }\n      }, {\n        key: \"_updateTextDebugCollisionBoxes\",\n        value: function _updateTextDebugCollisionBoxes(t, e, r, n, i, s) {\n          for (var _a73 = n; _a73 < i; _a73++) {\n            var _n110 = r.get(_a73),\n              _i109 = this.getSymbolInstanceTextSize(t, s, e, _a73);\n            this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt, _i109, _n110.padding);\n          }\n        }\n      }, {\n        key: \"_updateIconDebugCollisionBoxes\",\n        value: function _updateIconDebugCollisionBoxes(t, e, r, n, i, s) {\n          for (var _a74 = n; _a74 < i; _a74++) {\n            var _n111 = r.get(_a74),\n              _i110 = this.getSymbolInstanceIconSize(t, e, s);\n            this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt, _i110, _n111.padding);\n          }\n        }\n      }, {\n        key: \"updateCollisionDebugBuffers\",\n        value: function updateCollisionDebugBuffers(t, e) {\n          if (!this.hasDebugData()) return;\n          this.hasTextCollisionBoxData() && this.textCollisionBox.collisionVertexArrayExt.clear(), this.hasIconCollisionBoxData() && this.iconCollisionBox.collisionVertexArrayExt.clear();\n          var r = ep(this.iconSizeData, t),\n            n = ep(this.textSizeData, t);\n          for (var _i111 = 0; _i111 < this.symbolInstances.length; _i111++) {\n            var _s81 = this.symbolInstances.get(_i111);\n            this._updateTextDebugCollisionBoxes(n, t, e, _s81.textBoxStartIndex, _s81.textBoxEndIndex, _s81), this._updateTextDebugCollisionBoxes(n, t, e, _s81.verticalTextBoxStartIndex, _s81.verticalTextBoxEndIndex, _s81), this._updateIconDebugCollisionBoxes(r, t, e, _s81.iconBoxStartIndex, _s81.iconBoxEndIndex, _s81.placedIconSymbolIndex), this._updateIconDebugCollisionBoxes(r, t, e, _s81.verticalIconBoxStartIndex, _s81.verticalIconBoxEndIndex, _s81.placedIconSymbolIndex);\n          }\n          this.hasTextCollisionBoxData() && this.textCollisionBox.collisionVertexBufferExt && this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt), this.hasIconCollisionBoxData() && this.iconCollisionBox.collisionVertexBufferExt && this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt);\n        }\n      }, {\n        key: \"_deserializeCollisionBoxesForSymbol\",\n        value: function _deserializeCollisionBoxesForSymbol(t, e, r, n, i, s, a, o, l) {\n          var u = {};\n          if (e < r) {\n            var _t$get = t.get(e),\n              _r146 = _t$get.x1,\n              _n112 = _t$get.y1,\n              _i112 = _t$get.x2,\n              _s82 = _t$get.y2,\n              _a75 = _t$get.padding,\n              _o41 = _t$get.projectedAnchorX,\n              _l31 = _t$get.projectedAnchorY,\n              _c21 = _t$get.projectedAnchorZ,\n              _h17 = _t$get.tileAnchorX,\n              _p15 = _t$get.tileAnchorY,\n              _f10 = _t$get.featureIndex;\n            u.textBox = {\n              x1: _r146,\n              y1: _n112,\n              x2: _i112,\n              y2: _s82,\n              padding: _a75,\n              projectedAnchorX: _o41,\n              projectedAnchorY: _l31,\n              projectedAnchorZ: _c21,\n              tileAnchorX: _h17,\n              tileAnchorY: _p15\n            }, u.textFeatureIndex = _f10;\n          }\n          if (n < i) {\n            var _t$get2 = t.get(n),\n              _e179 = _t$get2.x1,\n              _r147 = _t$get2.y1,\n              _i113 = _t$get2.x2,\n              _s83 = _t$get2.y2,\n              _a76 = _t$get2.padding,\n              _o42 = _t$get2.projectedAnchorX,\n              _l32 = _t$get2.projectedAnchorY,\n              _c22 = _t$get2.projectedAnchorZ,\n              _h18 = _t$get2.tileAnchorX,\n              _p16 = _t$get2.tileAnchorY,\n              _f11 = _t$get2.featureIndex;\n            u.verticalTextBox = {\n              x1: _e179,\n              y1: _r147,\n              x2: _i113,\n              y2: _s83,\n              padding: _a76,\n              projectedAnchorX: _o42,\n              projectedAnchorY: _l32,\n              projectedAnchorZ: _c22,\n              tileAnchorX: _h18,\n              tileAnchorY: _p16\n            }, u.verticalTextFeatureIndex = _f11;\n          }\n          if (s < a) {\n            var _t$get3 = t.get(s),\n              _e180 = _t$get3.x1,\n              _r148 = _t$get3.y1,\n              _n113 = _t$get3.x2,\n              _i114 = _t$get3.y2,\n              _a77 = _t$get3.padding,\n              _o43 = _t$get3.projectedAnchorX,\n              _l33 = _t$get3.projectedAnchorY,\n              _c23 = _t$get3.projectedAnchorZ,\n              _h19 = _t$get3.tileAnchorX,\n              _p17 = _t$get3.tileAnchorY,\n              _f12 = _t$get3.featureIndex;\n            u.iconBox = {\n              x1: _e180,\n              y1: _r148,\n              x2: _n113,\n              y2: _i114,\n              padding: _a77,\n              projectedAnchorX: _o43,\n              projectedAnchorY: _l33,\n              projectedAnchorZ: _c23,\n              tileAnchorX: _h19,\n              tileAnchorY: _p17\n            }, u.iconFeatureIndex = _f12;\n          }\n          if (o < l) {\n            var _t$get4 = t.get(o),\n              _e181 = _t$get4.x1,\n              _r149 = _t$get4.y1,\n              _n114 = _t$get4.x2,\n              _i115 = _t$get4.y2,\n              _s84 = _t$get4.padding,\n              _a78 = _t$get4.projectedAnchorX,\n              _l34 = _t$get4.projectedAnchorY,\n              _c24 = _t$get4.projectedAnchorZ,\n              _h20 = _t$get4.tileAnchorX,\n              _p18 = _t$get4.tileAnchorY,\n              _f13 = _t$get4.featureIndex;\n            u.verticalIconBox = {\n              x1: _e181,\n              y1: _r149,\n              x2: _n114,\n              y2: _i115,\n              padding: _s84,\n              projectedAnchorX: _a78,\n              projectedAnchorY: _l34,\n              projectedAnchorZ: _c24,\n              tileAnchorX: _h20,\n              tileAnchorY: _p18\n            }, u.verticalIconFeatureIndex = _f13;\n          }\n          return u;\n        }\n      }, {\n        key: \"deserializeCollisionBoxes\",\n        value: function deserializeCollisionBoxes(t) {\n          this.collisionArrays = [];\n          for (var _e182 = 0; _e182 < this.symbolInstances.length; _e182++) {\n            var _r150 = this.symbolInstances.get(_e182);\n            this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t, _r150.textBoxStartIndex, _r150.textBoxEndIndex, _r150.verticalTextBoxStartIndex, _r150.verticalTextBoxEndIndex, _r150.iconBoxStartIndex, _r150.iconBoxEndIndex, _r150.verticalIconBoxStartIndex, _r150.verticalIconBoxEndIndex));\n          }\n        }\n      }, {\n        key: \"hasTextData\",\n        value: function hasTextData() {\n          return this.text.segments.get().length > 0;\n        }\n      }, {\n        key: \"hasIconData\",\n        value: function hasIconData() {\n          return this.icon.segments.get().length > 0;\n        }\n      }, {\n        key: \"hasDebugData\",\n        value: function hasDebugData() {\n          return this.textCollisionBox && this.iconCollisionBox;\n        }\n      }, {\n        key: \"hasTextCollisionBoxData\",\n        value: function hasTextCollisionBoxData() {\n          return this.hasDebugData() && this.textCollisionBox.segments.get().length > 0;\n        }\n      }, {\n        key: \"hasIconCollisionBoxData\",\n        value: function hasIconCollisionBoxData() {\n          return this.hasDebugData() && this.iconCollisionBox.segments.get().length > 0;\n        }\n      }, {\n        key: \"addIndicesForPlacedSymbol\",\n        value: function addIndicesForPlacedSymbol(t, e) {\n          var r = t.placedSymbolArray.get(e),\n            n = r.vertexStartIndex + 4 * r.numGlyphs;\n          for (var _e183 = r.vertexStartIndex; _e183 < n; _e183 += 4) t.indexArray.emplaceBack(_e183, _e183 + 1, _e183 + 2), t.indexArray.emplaceBack(_e183 + 1, _e183 + 2, _e183 + 3);\n        }\n      }, {\n        key: \"getSortedSymbolIndexes\",\n        value: function getSortedSymbolIndexes(t) {\n          if (this.sortedAngle === t && void 0 !== this.symbolInstanceIndexes) return this.symbolInstanceIndexes;\n          var e = Math.sin(t),\n            r = Math.cos(t),\n            n = [],\n            i = [],\n            s = [];\n          for (var _t193 = 0; _t193 < this.symbolInstances.length; ++_t193) {\n            s.push(_t193);\n            var _a79 = this.symbolInstances.get(_t193);\n            n.push(0 | Math.round(e * _a79.tileAnchorX + r * _a79.tileAnchorY)), i.push(_a79.featureIndex);\n          }\n          return s.sort(function (t, e) {\n            return n[t] - n[e] || i[e] - i[t];\n          }), s;\n        }\n      }, {\n        key: \"addToSortKeyRanges\",\n        value: function addToSortKeyRanges(t, e) {\n          var r = this.sortKeyRanges[this.sortKeyRanges.length - 1];\n          r && r.sortKey === e ? r.symbolInstanceEnd = t + 1 : this.sortKeyRanges.push({\n            sortKey: e,\n            symbolInstanceStart: t,\n            symbolInstanceEnd: t + 1\n          });\n        }\n      }, {\n        key: \"sortFeatures\",\n        value: function sortFeatures(t) {\n          if (this.sortFeaturesByY && this.sortedAngle !== t && !(this.text.segments.get().length > 1 || this.icon.segments.get().length > 1)) {\n            this.symbolInstanceIndexes = this.getSortedSymbolIndexes(t), this.sortedAngle = t, this.text.indexArray.clear(), this.icon.indexArray.clear(), this.featureSortOrder = [];\n            var _iterator133 = _createForOfIteratorHelper(this.symbolInstanceIndexes),\n              _step133;\n            try {\n              for (_iterator133.s(); !(_step133 = _iterator133.n()).done;) {\n                var _t194 = _step133.value;\n                var _e184 = this.symbolInstances.get(_t194);\n                this.featureSortOrder.push(_e184.featureIndex);\n                var _r151 = _e184.rightJustifiedTextSymbolIndex,\n                  _n115 = _e184.centerJustifiedTextSymbolIndex,\n                  _i116 = _e184.leftJustifiedTextSymbolIndex,\n                  _s85 = _e184.verticalPlacedTextSymbolIndex,\n                  _a80 = _e184.placedIconSymbolIndex,\n                  _o44 = _e184.verticalPlacedIconSymbolIndex;\n                _r151 >= 0 && this.addIndicesForPlacedSymbol(this.text, _r151), _n115 >= 0 && _n115 !== _r151 && this.addIndicesForPlacedSymbol(this.text, _n115), _i116 >= 0 && _i116 !== _n115 && _i116 !== _r151 && this.addIndicesForPlacedSymbol(this.text, _i116), _s85 >= 0 && this.addIndicesForPlacedSymbol(this.text, _s85), _a80 >= 0 && this.addIndicesForPlacedSymbol(this.icon, _a80), _o44 >= 0 && this.addIndicesForPlacedSymbol(this.icon, _o44);\n              }\n            } catch (err) {\n              _iterator133.e(err);\n            } finally {\n              _iterator133.f();\n            }\n            this.text.indexBuffer && this.text.indexBuffer.updateData(this.text.indexArray), this.icon.indexBuffer && this.icon.indexBuffer.updateData(this.icon.indexArray);\n          }\n        }\n      }]);\n      return hd;\n    }();\n    Oi(hd, \"SymbolBucket\", {\n      omit: [\"layers\", \"collisionBoxArray\", \"features\", \"compareText\"]\n    }), hd.MAX_GLYPHS = 65535, hd.addDynamicAttributes = od;\n    var pd = new Js({\n      \"symbol-placement\": new Ys(Ht.layout_symbol[\"symbol-placement\"]),\n      \"symbol-spacing\": new Ys(Ht.layout_symbol[\"symbol-spacing\"]),\n      \"symbol-avoid-edges\": new Ys(Ht.layout_symbol[\"symbol-avoid-edges\"]),\n      \"symbol-sort-key\": new Hs(Ht.layout_symbol[\"symbol-sort-key\"]),\n      \"symbol-z-order\": new Ys(Ht.layout_symbol[\"symbol-z-order\"]),\n      \"icon-allow-overlap\": new Ys(Ht.layout_symbol[\"icon-allow-overlap\"]),\n      \"icon-ignore-placement\": new Ys(Ht.layout_symbol[\"icon-ignore-placement\"]),\n      \"icon-optional\": new Ys(Ht.layout_symbol[\"icon-optional\"]),\n      \"icon-rotation-alignment\": new Ys(Ht.layout_symbol[\"icon-rotation-alignment\"]),\n      \"icon-size\": new Hs(Ht.layout_symbol[\"icon-size\"]),\n      \"icon-text-fit\": new Ys(Ht.layout_symbol[\"icon-text-fit\"]),\n      \"icon-text-fit-padding\": new Ys(Ht.layout_symbol[\"icon-text-fit-padding\"]),\n      \"icon-image\": new Hs(Ht.layout_symbol[\"icon-image\"]),\n      \"icon-rotate\": new Hs(Ht.layout_symbol[\"icon-rotate\"]),\n      \"icon-padding\": new Ys(Ht.layout_symbol[\"icon-padding\"]),\n      \"icon-keep-upright\": new Ys(Ht.layout_symbol[\"icon-keep-upright\"]),\n      \"icon-offset\": new Hs(Ht.layout_symbol[\"icon-offset\"]),\n      \"icon-anchor\": new Hs(Ht.layout_symbol[\"icon-anchor\"]),\n      \"icon-pitch-alignment\": new Ys(Ht.layout_symbol[\"icon-pitch-alignment\"]),\n      \"text-pitch-alignment\": new Ys(Ht.layout_symbol[\"text-pitch-alignment\"]),\n      \"text-rotation-alignment\": new Ys(Ht.layout_symbol[\"text-rotation-alignment\"]),\n      \"text-field\": new Hs(Ht.layout_symbol[\"text-field\"]),\n      \"text-font\": new Hs(Ht.layout_symbol[\"text-font\"]),\n      \"text-size\": new Hs(Ht.layout_symbol[\"text-size\"]),\n      \"text-max-width\": new Hs(Ht.layout_symbol[\"text-max-width\"]),\n      \"text-line-height\": new Hs(Ht.layout_symbol[\"text-line-height\"]),\n      \"text-letter-spacing\": new Hs(Ht.layout_symbol[\"text-letter-spacing\"]),\n      \"text-justify\": new Hs(Ht.layout_symbol[\"text-justify\"]),\n      \"text-radial-offset\": new Hs(Ht.layout_symbol[\"text-radial-offset\"]),\n      \"text-variable-anchor\": new Ys(Ht.layout_symbol[\"text-variable-anchor\"]),\n      \"text-anchor\": new Hs(Ht.layout_symbol[\"text-anchor\"]),\n      \"text-max-angle\": new Ys(Ht.layout_symbol[\"text-max-angle\"]),\n      \"text-writing-mode\": new Ys(Ht.layout_symbol[\"text-writing-mode\"]),\n      \"text-rotate\": new Hs(Ht.layout_symbol[\"text-rotate\"]),\n      \"text-padding\": new Ys(Ht.layout_symbol[\"text-padding\"]),\n      \"text-keep-upright\": new Ys(Ht.layout_symbol[\"text-keep-upright\"]),\n      \"text-transform\": new Hs(Ht.layout_symbol[\"text-transform\"]),\n      \"text-offset\": new Hs(Ht.layout_symbol[\"text-offset\"]),\n      \"text-allow-overlap\": new Ys(Ht.layout_symbol[\"text-allow-overlap\"]),\n      \"text-ignore-placement\": new Ys(Ht.layout_symbol[\"text-ignore-placement\"]),\n      \"text-optional\": new Ys(Ht.layout_symbol[\"text-optional\"])\n    });\n    var fd = {\n      paint: new Js({\n        \"icon-opacity\": new Hs(Ht.paint_symbol[\"icon-opacity\"]),\n        \"icon-color\": new Hs(Ht.paint_symbol[\"icon-color\"]),\n        \"icon-halo-color\": new Hs(Ht.paint_symbol[\"icon-halo-color\"]),\n        \"icon-halo-width\": new Hs(Ht.paint_symbol[\"icon-halo-width\"]),\n        \"icon-halo-blur\": new Hs(Ht.paint_symbol[\"icon-halo-blur\"]),\n        \"icon-translate\": new Ys(Ht.paint_symbol[\"icon-translate\"]),\n        \"icon-translate-anchor\": new Ys(Ht.paint_symbol[\"icon-translate-anchor\"]),\n        \"text-opacity\": new Hs(Ht.paint_symbol[\"text-opacity\"]),\n        \"text-color\": new Hs(Ht.paint_symbol[\"text-color\"], {\n          runtimeType: le,\n          getOverride: function getOverride(t) {\n            return t.textColor;\n          },\n          hasOverride: function hasOverride(t) {\n            return !!t.textColor;\n          }\n        }),\n        \"text-halo-color\": new Hs(Ht.paint_symbol[\"text-halo-color\"]),\n        \"text-halo-width\": new Hs(Ht.paint_symbol[\"text-halo-width\"]),\n        \"text-halo-blur\": new Hs(Ht.paint_symbol[\"text-halo-blur\"]),\n        \"text-translate\": new Ys(Ht.paint_symbol[\"text-translate\"]),\n        \"text-translate-anchor\": new Ys(Ht.paint_symbol[\"text-translate-anchor\"])\n      }),\n      layout: pd\n    };\n    var dd = /*#__PURE__*/function () {\n      function dd(t) {\n        _classCallCheck(this, dd);\n        this.type = t.property.overrides ? t.property.overrides.runtimeType : ie, this.defaultValue = t;\n      }\n      _createClass(dd, [{\n        key: \"evaluate\",\n        value: function evaluate(t) {\n          if (t.formattedSection) {\n            var _e185 = this.defaultValue.property.overrides;\n            if (_e185 && _e185.hasOverride(t.formattedSection)) return _e185.getOverride(t.formattedSection);\n          }\n          return t.feature && t.featureState ? this.defaultValue.evaluate(t.feature, t.featureState) : this.defaultValue.property.specification.default;\n        }\n      }, {\n        key: \"eachChild\",\n        value: function eachChild(t) {\n          this.defaultValue.isConstant() || t(this.defaultValue.value._styleExpression.expression);\n        }\n      }, {\n        key: \"outputDefined\",\n        value: function outputDefined() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return null;\n        }\n      }]);\n      return dd;\n    }();\n    Oi(dd, \"FormatSectionOverride\", {\n      omit: [\"defaultValue\"]\n    });\n    var yd = /*#__PURE__*/function (_wo) {\n      _inherits(yd, _wo);\n      function yd(t) {\n        _classCallCheck(this, yd);\n        return _possibleConstructorReturn(this, _getPrototypeOf(yd).call(this, t, fd));\n      }\n      _createClass(yd, [{\n        key: \"recalculate\",\n        value: function recalculate(t, e) {\n          _get(_getPrototypeOf(yd.prototype), \"recalculate\", this).call(this, t, e), \"auto\" === this.layout.get(\"icon-rotation-alignment\") && (this.layout._values[\"icon-rotation-alignment\"] = \"point\" !== this.layout.get(\"symbol-placement\") ? \"map\" : \"viewport\"), \"auto\" === this.layout.get(\"text-rotation-alignment\") && (this.layout._values[\"text-rotation-alignment\"] = \"point\" !== this.layout.get(\"symbol-placement\") ? \"map\" : \"viewport\"), \"auto\" === this.layout.get(\"text-pitch-alignment\") && (this.layout._values[\"text-pitch-alignment\"] = this.layout.get(\"text-rotation-alignment\")), \"auto\" === this.layout.get(\"icon-pitch-alignment\") && (this.layout._values[\"icon-pitch-alignment\"] = this.layout.get(\"icon-rotation-alignment\"));\n          var r = this.layout.get(\"text-writing-mode\");\n          if (r) {\n            var _t195 = [];\n            var _iterator134 = _createForOfIteratorHelper(r),\n              _step134;\n            try {\n              for (_iterator134.s(); !(_step134 = _iterator134.n()).done;) {\n                var _e186 = _step134.value;\n                _t195.indexOf(_e186) < 0 && _t195.push(_e186);\n              }\n            } catch (err) {\n              _iterator134.e(err);\n            } finally {\n              _iterator134.f();\n            }\n            this.layout._values[\"text-writing-mode\"] = _t195;\n          } else this.layout._values[\"text-writing-mode\"] = \"point\" === this.layout.get(\"symbol-placement\") ? [\"horizontal\"] : [\"horizontal\", \"vertical\"];\n          this._setPaintOverrides();\n        }\n      }, {\n        key: \"getValueAndResolveTokens\",\n        value: function getValueAndResolveTokens(t, e, r, n) {\n          var i = this.layout.get(t).evaluate(e, {}, r, n),\n            s = this._unevaluatedLayout._values[t];\n          return s.isDataDriven() || Nn(s.value) || !i ? i : function (t, e) {\n            return e.replace(/{([^{}]+)}/g, function (e, r) {\n              return r in t ? String(t[r]) : \"\";\n            });\n          }(e.properties, i);\n        }\n      }, {\n        key: \"createBucket\",\n        value: function createBucket(t) {\n          return new hd(t);\n        }\n      }, {\n        key: \"queryRadius\",\n        value: function queryRadius() {\n          return 0;\n        }\n      }, {\n        key: \"queryIntersectsFeature\",\n        value: function queryIntersectsFeature() {\n          return !1;\n        }\n      }, {\n        key: \"_setPaintOverrides\",\n        value: function _setPaintOverrides() {\n          var _iterator135 = _createForOfIteratorHelper(fd.paint.overridableProperties),\n            _step135;\n          try {\n            for (_iterator135.s(); !(_step135 = _iterator135.n()).done;) {\n              var _t196 = _step135.value;\n              if (!yd.hasPaintOverride(this.layout, _t196)) continue;\n              var _e187 = this.paint.get(_t196),\n                _r152 = new dd(_e187),\n                _n116 = new qn(_r152, _e187.property.specification);\n              var _i117 = null;\n              _i117 = \"constant\" === _e187.value.kind || \"source\" === _e187.value.kind ? new Zn(\"source\", _n116) : new Xn(\"composite\", _n116, _e187.value.zoomStops, _e187.value._interpolationType), this.paint._values[_t196] = new Xs(_e187.property, _i117, _e187.parameters);\n            }\n          } catch (err) {\n            _iterator135.e(err);\n          } finally {\n            _iterator135.f();\n          }\n        }\n      }, {\n        key: \"_handleOverridablePaintPropertyUpdate\",\n        value: function _handleOverridablePaintPropertyUpdate(t, e, r) {\n          return !(!this.layout || e.isDataDriven() || r.isDataDriven()) && yd.hasPaintOverride(this.layout, t);\n        }\n      }, {\n        key: \"getProgramConfiguration\",\n        value: function getProgramConfiguration(t) {\n          return new po(this, t);\n        }\n      }], [{\n        key: \"hasPaintOverride\",\n        value: function hasPaintOverride(t, e) {\n          var r = t.get(\"text-field\"),\n            n = fd.paint.properties[e];\n          var i = !1;\n          var s = function s(t) {\n            var _iterator136 = _createForOfIteratorHelper(t),\n              _step136;\n            try {\n              for (_iterator136.s(); !(_step136 = _iterator136.n()).done;) {\n                var _e188 = _step136.value;\n                if (n.overrides && n.overrides.hasOverride(_e188)) return void (i = !0);\n              }\n            } catch (err) {\n              _iterator136.e(err);\n            } finally {\n              _iterator136.f();\n            }\n          };\n          if (\"constant\" === r.value.kind && r.value.value instanceof Be) s(r.value.value.sections);else if (\"source\" === r.value.kind) {\n            var _t197 = function _t197(e) {\n                i || (e instanceof Fe && De(e.value) === pe ? s(e.value.sections) : e instanceof Oe ? s(e.sections) : e.eachChild(_t197));\n              },\n              _e189 = r.value;\n            _e189._styleExpression && _t197(_e189._styleExpression.expression);\n          }\n          return i;\n        }\n      }]);\n      return yd;\n    }(wo);\n    var md = {\n        paint: new Js({\n          \"background-color\": new Ys(Ht.paint_background[\"background-color\"]),\n          \"background-pattern\": new Ys(Ht.paint_background[\"background-pattern\"]),\n          \"background-opacity\": new Ys(Ht.paint_background[\"background-opacity\"])\n        })\n      },\n      gd = {\n        paint: new Js({\n          \"raster-opacity\": new Ys(Ht.paint_raster[\"raster-opacity\"]),\n          \"raster-hue-rotate\": new Ys(Ht.paint_raster[\"raster-hue-rotate\"]),\n          \"raster-brightness-min\": new Ys(Ht.paint_raster[\"raster-brightness-min\"]),\n          \"raster-brightness-max\": new Ys(Ht.paint_raster[\"raster-brightness-max\"]),\n          \"raster-saturation\": new Ys(Ht.paint_raster[\"raster-saturation\"]),\n          \"raster-contrast\": new Ys(Ht.paint_raster[\"raster-contrast\"]),\n          \"raster-resampling\": new Ys(Ht.paint_raster[\"raster-resampling\"]),\n          \"raster-fade-duration\": new Ys(Ht.paint_raster[\"raster-fade-duration\"])\n        })\n      };\n    var xd = /*#__PURE__*/function (_wo2) {\n      _inherits(xd, _wo2);\n      function xd(t) {\n        var _this30;\n        _classCallCheck(this, xd);\n        _this30 = _possibleConstructorReturn(this, _getPrototypeOf(xd).call(this, t, {})), _this30.implementation = t;\n        return _this30;\n      }\n      _createClass(xd, [{\n        key: \"is3D\",\n        value: function is3D() {\n          return \"3d\" === this.implementation.renderingMode;\n        }\n      }, {\n        key: \"hasOffscreenPass\",\n        value: function hasOffscreenPass() {\n          return void 0 !== this.implementation.prerender;\n        }\n      }, {\n        key: \"isLayerDraped\",\n        value: function isLayerDraped() {\n          return void 0 !== this.implementation.renderToTile;\n        }\n      }, {\n        key: \"shouldRedrape\",\n        value: function shouldRedrape() {\n          return !!this.implementation.shouldRerenderTiles && this.implementation.shouldRerenderTiles();\n        }\n      }, {\n        key: \"recalculate\",\n        value: function recalculate() {}\n      }, {\n        key: \"updateTransitions\",\n        value: function updateTransitions() {}\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return !1;\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {}\n      }, {\n        key: \"onAdd\",\n        value: function onAdd(t) {\n          this.implementation.onAdd && this.implementation.onAdd(t, t.painter.context.gl);\n        }\n      }, {\n        key: \"onRemove\",\n        value: function onRemove(t) {\n          this.implementation.onRemove && this.implementation.onRemove(t, t.painter.context.gl);\n        }\n      }]);\n      return xd;\n    }(wo);\n    var vd = {\n      paint: new Js({\n        \"sky-type\": new Ys(Ht.paint_sky[\"sky-type\"]),\n        \"sky-atmosphere-sun\": new Ys(Ht.paint_sky[\"sky-atmosphere-sun\"]),\n        \"sky-atmosphere-sun-intensity\": new Ys(Ht.paint_sky[\"sky-atmosphere-sun-intensity\"]),\n        \"sky-gradient-center\": new Ys(Ht.paint_sky[\"sky-gradient-center\"]),\n        \"sky-gradient-radius\": new Ys(Ht.paint_sky[\"sky-gradient-radius\"]),\n        \"sky-gradient\": new Ws(Ht.paint_sky[\"sky-gradient\"]),\n        \"sky-atmosphere-halo-color\": new Ys(Ht.paint_sky[\"sky-atmosphere-halo-color\"]),\n        \"sky-atmosphere-color\": new Ys(Ht.paint_sky[\"sky-atmosphere-color\"]),\n        \"sky-opacity\": new Ys(Ht.paint_sky[\"sky-opacity\"])\n      })\n    };\n    function bd(t, e, r) {\n      var n = [0, 0, 1],\n        i = hl([]);\n      return fl(i, i, r ? -x(t) + Math.PI : x(t)), pl(i, i, -x(e)), rl(n, n, i), Jo(n, n);\n    }\n    var wd = {\n      circle: /*#__PURE__*/function (_wo3) {\n        _inherits(circle, _wo3);\n        function circle(t) {\n          _classCallCheck(this, circle);\n          return _possibleConstructorReturn(this, _getPrototypeOf(circle).call(this, t, Ou));\n        }\n        _createClass(circle, [{\n          key: \"createBucket\",\n          value: function createBucket(t) {\n            return new Su(t);\n          }\n        }, {\n          key: \"queryRadius\",\n          value: function queryRadius(t) {\n            var e = t;\n            return Fu(\"circle-radius\", this, e) + Fu(\"circle-stroke-width\", this, e) + Ru(this.paint.get(\"circle-translate\"));\n          }\n        }, {\n          key: \"queryIntersectsFeature\",\n          value: function queryIntersectsFeature(t, e, r, n, i, s, a, o) {\n            var l = $u(this.paint.get(\"circle-translate\"), this.paint.get(\"circle-translate-anchor\"), s.angle, t.pixelToTileUnitsFactor),\n              u = this.paint.get(\"circle-radius\").evaluate(e, r) + this.paint.get(\"circle-stroke-width\").evaluate(e, r);\n            return qu(t, n, s, a, o, \"map\" === this.paint.get(\"circle-pitch-alignment\"), \"map\" === this.paint.get(\"circle-pitch-scale\"), l, u);\n          }\n        }, {\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            return [\"circle\"];\n          }\n        }, {\n          key: \"getProgramConfiguration\",\n          value: function getProgramConfiguration(t) {\n            return new po(this, t);\n          }\n        }]);\n        return circle;\n      }(wo),\n      heatmap: /*#__PURE__*/function (_wo4) {\n        _inherits(heatmap, _wo4);\n        _createClass(heatmap, [{\n          key: \"createBucket\",\n          value: function createBucket(t) {\n            return new Ku(t);\n          }\n        }]);\n        function heatmap(t) {\n          var _this31;\n          _classCallCheck(this, heatmap);\n          _this31 = _possibleConstructorReturn(this, _getPrototypeOf(heatmap).call(this, t, tc)), _this31._updateColorRamp();\n          return _this31;\n        }\n        _createClass(heatmap, [{\n          key: \"_handleSpecialPaintPropertyUpdate\",\n          value: function _handleSpecialPaintPropertyUpdate(t) {\n            \"heatmap-color\" === t && this._updateColorRamp();\n          }\n        }, {\n          key: \"_updateColorRamp\",\n          value: function _updateColorRamp() {\n            this.colorRamp = ec({\n              expression: this._transitionablePaint._values[\"heatmap-color\"].value.expression,\n              evaluationKey: \"heatmapDensity\",\n              image: this.colorRamp\n            }), this.colorRampTexture = null;\n          }\n        }, {\n          key: \"resize\",\n          value: function resize() {\n            this.heatmapFbo && (this.heatmapFbo.destroy(), this.heatmapFbo = null);\n          }\n        }, {\n          key: \"queryRadius\",\n          value: function queryRadius(t) {\n            return Fu(\"heatmap-radius\", this, t);\n          }\n        }, {\n          key: \"queryIntersectsFeature\",\n          value: function queryIntersectsFeature(t, e, r, n, i, s, a, o) {\n            var l = this.paint.get(\"heatmap-radius\").evaluate(e, r);\n            return qu(t, n, s, a, o, !0, !0, new d(0, 0), l);\n          }\n        }, {\n          key: \"hasOffscreenPass\",\n          value: function hasOffscreenPass() {\n            return 0 !== this.paint.get(\"heatmap-opacity\") && \"none\" !== this.visibility;\n          }\n        }, {\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            return [\"heatmap\", \"heatmapTexture\"];\n          }\n        }, {\n          key: \"getProgramConfiguration\",\n          value: function getProgramConfiguration(t) {\n            return new po(this, t);\n          }\n        }]);\n        return heatmap;\n      }(wo),\n      hillshade: /*#__PURE__*/function (_wo5) {\n        _inherits(hillshade, _wo5);\n        function hillshade(t) {\n          _classCallCheck(this, hillshade);\n          return _possibleConstructorReturn(this, _getPrototypeOf(hillshade).call(this, t, rc));\n        }\n        _createClass(hillshade, [{\n          key: \"hasOffscreenPass\",\n          value: function hasOffscreenPass() {\n            return 0 !== this.paint.get(\"hillshade-exaggeration\") && \"none\" !== this.visibility;\n          }\n        }, {\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            return [\"hillshade\", \"hillshadePrepare\"];\n          }\n        }]);\n        return hillshade;\n      }(wo),\n      fill: /*#__PURE__*/function (_wo6) {\n        _inherits(fill, _wo6);\n        function fill(t) {\n          _classCallCheck(this, fill);\n          return _possibleConstructorReturn(this, _getPrototypeOf(fill).call(this, t, Oc));\n        }\n        _createClass(fill, [{\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            var t = this.paint.get(\"fill-pattern\"),\n              e = t && t.constantOr(1),\n              r = [e ? \"fillPattern\" : \"fill\"];\n            return this.paint.get(\"fill-antialias\") && r.push(e && !this.getPaintProperty(\"fill-outline-color\") ? \"fillOutlinePattern\" : \"fillOutline\"), r;\n          }\n        }, {\n          key: \"getProgramConfiguration\",\n          value: function getProgramConfiguration(t) {\n            return new po(this, t);\n          }\n        }, {\n          key: \"recalculate\",\n          value: function recalculate(t, e) {\n            _get(_getPrototypeOf(fill.prototype), \"recalculate\", this).call(this, t, e);\n            var r = this.paint._values[\"fill-outline-color\"];\n            \"constant\" === r.value.kind && void 0 === r.value.value && (this.paint._values[\"fill-outline-color\"] = this.paint._values[\"fill-color\"]);\n          }\n        }, {\n          key: \"createBucket\",\n          value: function createBucket(t) {\n            return new $c(t);\n          }\n        }, {\n          key: \"queryRadius\",\n          value: function queryRadius() {\n            return Ru(this.paint.get(\"fill-translate\"));\n          }\n        }, {\n          key: \"queryIntersectsFeature\",\n          value: function queryIntersectsFeature(t, e, r, n, i, s) {\n            return !t.queryGeometry.isAboveHorizon && Mu(ju(t.tilespaceGeometry, this.paint.get(\"fill-translate\"), this.paint.get(\"fill-translate-anchor\"), s.angle, t.pixelToTileUnitsFactor), n);\n          }\n        }, {\n          key: \"isTileClipped\",\n          value: function isTileClipped() {\n            return !0;\n          }\n        }]);\n        return fill;\n      }(wo),\n      \"fill-extrusion\": /*#__PURE__*/function (_wo7) {\n        _inherits(fillExtrusion, _wo7);\n        function fillExtrusion(t) {\n          _classCallCheck(this, fillExtrusion);\n          return _possibleConstructorReturn(this, _getPrototypeOf(fillExtrusion).call(this, t, Ah));\n        }\n        _createClass(fillExtrusion, [{\n          key: \"createBucket\",\n          value: function createBucket(t) {\n            return new fh(t);\n          }\n        }, {\n          key: \"queryRadius\",\n          value: function queryRadius() {\n            return Ru(this.paint.get(\"fill-extrusion-translate\"));\n          }\n        }, {\n          key: \"is3D\",\n          value: function is3D() {\n            return !0;\n          }\n        }, {\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            return [this.paint.get(\"fill-extrusion-pattern\").constantOr(1) ? \"fillExtrusionPattern\" : \"fillExtrusion\"];\n          }\n        }, {\n          key: \"getProgramConfiguration\",\n          value: function getProgramConfiguration(t) {\n            return new po(this, t);\n          }\n        }, {\n          key: \"queryIntersectsFeature\",\n          value: function queryIntersectsFeature(t, e, r, n, i, s, a, o, l) {\n            var u = $u(this.paint.get(\"fill-extrusion-translate\"), this.paint.get(\"fill-extrusion-translate-anchor\"), s.angle, t.pixelToTileUnitsFactor),\n              c = this.paint.get(\"fill-extrusion-height\").evaluate(e, r),\n              h = this.paint.get(\"fill-extrusion-base\").evaluate(e, r),\n              p = [0, 0],\n              f = o && s.elevation,\n              y = s.elevation ? s.elevation.exaggeration() : 1,\n              m = t.tile.getBucket(this);\n            if (f && m instanceof fh) {\n              var _t198 = m.centroidVertexArray,\n                _e190 = l + 1;\n              _e190 < _t198.length && (p[0] = _t198.geta_centroid_pos0(_e190), p[1] = _t198.geta_centroid_pos1(_e190));\n            }\n            if (0 === p[0] && 1 === p[1]) return !1;\n            \"globe\" === s.projection.name && (n = wh([n], [new d(0, 0), new d(ko, ko)], t.tileID.canonical).map(function (t) {\n              return t.polygon;\n            }).flat());\n            var g = f ? o : null,\n              _ref124 = function (t, e, r, n, i, s, a, o, l, u, c) {\n                return \"globe\" === t.projection.name ? function (t, e, r, n, i, s, a, o, l, u, c) {\n                  var h = [],\n                    p = [],\n                    f = t.projection.upVectorScale(c, t.center.lat, t.worldSize).metersToTile,\n                    d = [0, 0, 0, 1],\n                    y = [0, 0, 0, 1],\n                    m = function m(t, e, r, n) {\n                      t[0] = e, t[1] = r, t[2] = n, t[3] = 1;\n                    },\n                    g = bh();\n                  r > 0 && (r += g), n += g;\n                  var _iterator137 = _createForOfIteratorHelper(e),\n                    _step137;\n                  try {\n                    for (_iterator137.s(); !(_step137 = _iterator137.n()).done;) {\n                      var _g8 = _step137.value;\n                      var _e191 = [],\n                        _x9 = [];\n                      var _iterator138 = _createForOfIteratorHelper(_g8),\n                        _step138;\n                      try {\n                        for (_iterator138.s(); !(_step138 = _iterator138.n()).done;) {\n                          var _h21 = _step138.value;\n                          var _p19 = _h21.x + i.x,\n                            _g9 = _h21.y + i.y,\n                            _v8 = t.projection.projectTilePoint(_p19, _g9, c),\n                            _b7 = t.projection.upVector(c, _h21.x, _h21.y);\n                          var _w7 = r,\n                            _9 = n;\n                          if (a) {\n                            var _t199 = Ch(_p19, _g9, r, n, a, o, l, u);\n                            _w7 += _t199.base, _9 += _t199.top;\n                          }\n                          0 !== r ? m(d, _v8.x + _b7[0] * f * _w7, _v8.y + _b7[1] * f * _w7, _v8.z + _b7[2] * f * _w7) : m(d, _v8.x, _v8.y, _v8.z), m(y, _v8.x + _b7[0] * f * _9, _v8.y + _b7[1] * f * _9, _v8.z + _b7[2] * f * _9), el(d, d, s), el(y, y, s), _e191.push(new zh(d[0], d[1], d[2])), _x9.push(new zh(y[0], y[1], y[2]));\n                        }\n                      } catch (err) {\n                        _iterator138.e(err);\n                      } finally {\n                        _iterator138.f();\n                      }\n                      h.push(_e191), p.push(_x9);\n                    }\n                  } catch (err) {\n                    _iterator137.e(err);\n                  } finally {\n                    _iterator137.f();\n                  }\n                  return [h, p];\n                }(t, e, r, n, i, s, a, o, l, u, c) : a ? function (t, e, r, n, i, s, a, o, l) {\n                  var u = [],\n                    c = [],\n                    h = [0, 0, 0, 1];\n                  var _iterator139 = _createForOfIteratorHelper(t),\n                    _step139;\n                  try {\n                    for (_iterator139.s(); !(_step139 = _iterator139.n()).done;) {\n                      var _p20 = _step139.value;\n                      var _t200 = [],\n                        _f14 = [];\n                      var _iterator140 = _createForOfIteratorHelper(_p20),\n                        _step140;\n                      try {\n                        for (_iterator140.s(); !(_step140 = _iterator140.n()).done;) {\n                          var _u32 = _step140.value;\n                          var _c25 = _u32.x + n.x,\n                            _p21 = _u32.y + n.y,\n                            _d12 = Ch(_c25, _p21, e, r, s, a, o, l);\n                          h[0] = _c25, h[1] = _p21, h[2] = _d12.base, h[3] = 1, ul(h, h, i), h[3] = Math.max(h[3], 1e-5);\n                          var _y8 = new zh(h[0] / h[3], h[1] / h[3], h[2] / h[3]);\n                          h[0] = _c25, h[1] = _p21, h[2] = _d12.top, h[3] = 1, ul(h, h, i), h[3] = Math.max(h[3], 1e-5);\n                          var _m6 = new zh(h[0] / h[3], h[1] / h[3], h[2] / h[3]);\n                          _t200.push(_y8), _f14.push(_m6);\n                        }\n                      } catch (err) {\n                        _iterator140.e(err);\n                      } finally {\n                        _iterator140.f();\n                      }\n                      u.push(_t200), c.push(_f14);\n                    }\n                  } catch (err) {\n                    _iterator139.e(err);\n                  } finally {\n                    _iterator139.f();\n                  }\n                  return [u, c];\n                }(e, r, n, i, s, a, o, l, u) : function (t, e, r, n, i) {\n                  var s = [],\n                    a = [],\n                    o = i[8] * e,\n                    l = i[9] * e,\n                    u = i[10] * e,\n                    c = i[11] * e,\n                    h = i[8] * r,\n                    p = i[9] * r,\n                    f = i[10] * r,\n                    d = i[11] * r;\n                  var _iterator141 = _createForOfIteratorHelper(t),\n                    _step141;\n                  try {\n                    for (_iterator141.s(); !(_step141 = _iterator141.n()).done;) {\n                      var _e192 = _step141.value;\n                      var _t201 = [],\n                        _r153 = [];\n                      var _iterator142 = _createForOfIteratorHelper(_e192),\n                        _step142;\n                      try {\n                        for (_iterator142.s(); !(_step142 = _iterator142.n()).done;) {\n                          var _s86 = _step142.value;\n                          var _e193 = _s86.x + n.x,\n                            _a81 = _s86.y + n.y,\n                            _y9 = i[0] * _e193 + i[4] * _a81 + i[12],\n                            _m7 = i[1] * _e193 + i[5] * _a81 + i[13],\n                            _g10 = i[2] * _e193 + i[6] * _a81 + i[14],\n                            _x10 = i[3] * _e193 + i[7] * _a81 + i[15],\n                            _v9 = _y9 + o,\n                            _b8 = _m7 + l,\n                            _w8 = _g10 + u,\n                            _10 = Math.max(_x10 + c, 1e-5),\n                            _A8 = _y9 + h,\n                            _S7 = _m7 + p,\n                            _k6 = _g10 + f,\n                            _I5 = Math.max(_x10 + d, 1e-5);\n                          _t201.push(new zh(_v9 / _10, _b8 / _10, _w8 / _10)), _r153.push(new zh(_A8 / _I5, _S7 / _I5, _k6 / _I5));\n                        }\n                      } catch (err) {\n                        _iterator142.e(err);\n                      } finally {\n                        _iterator142.f();\n                      }\n                      s.push(_t201), a.push(_r153);\n                    }\n                  } catch (err) {\n                    _iterator141.e(err);\n                  } finally {\n                    _iterator141.f();\n                  }\n                  return [s, a];\n                }(e, r, n, i, s);\n              }(s, n, h, c, u, a, g, p, y, s.center.lat, t.tileID.canonical),\n              _ref125 = _slicedToArray(_ref124, 2),\n              x = _ref125[0],\n              v = _ref125[1],\n              b = t.queryGeometry;\n            return function (t, e, r) {\n              var n = 1 / 0;\n              Mu(r, e) && (n = Eh(r, e[0]));\n              for (var _i118 = 0; _i118 < e.length; _i118++) {\n                var _s87 = e[_i118],\n                  _a82 = t[_i118];\n                for (var _t202 = 0; _t202 < _s87.length - 1; _t202++) {\n                  var _e194 = _s87[_t202],\n                    _i119 = [_e194, _s87[_t202 + 1], _a82[_t202 + 1], _a82[_t202], _e194];\n                  ku(r, _i119) && (n = Math.min(n, Eh(r, _i119)));\n                }\n              }\n              return n !== 1 / 0 && n;\n            }(x, v, b.isPointQuery() ? b.screenBounds : b.screenGeometry);\n          }\n        }]);\n        return fillExtrusion;\n      }(wo),\n      line: /*#__PURE__*/function (_wo8) {\n        _inherits(line, _wo8);\n        function line(t) {\n          var _this32;\n          _classCallCheck(this, line);\n          _this32 = _possibleConstructorReturn(this, _getPrototypeOf(line).call(this, t, Uh)), _this32.gradientVersion = 0;\n          return _this32;\n        }\n        _createClass(line, [{\n          key: \"_handleSpecialPaintPropertyUpdate\",\n          value: function _handleSpecialPaintPropertyUpdate(t) {\n            if (\"line-gradient\" === t) {\n              var _t203 = this._transitionablePaint._values[\"line-gradient\"].value.expression;\n              this.stepInterpolant = _t203._styleExpression && _t203._styleExpression.expression instanceof Ir, this.gradientVersion = (this.gradientVersion + 1) % Number.MAX_SAFE_INTEGER;\n            }\n          }\n        }, {\n          key: \"gradientExpression\",\n          value: function gradientExpression() {\n            return this._transitionablePaint._values[\"line-gradient\"].value.expression;\n          }\n        }, {\n          key: \"widthExpression\",\n          value: function widthExpression() {\n            return this._transitionablePaint._values[\"line-width\"].value.expression;\n          }\n        }, {\n          key: \"recalculate\",\n          value: function recalculate(t, e) {\n            _get(_getPrototypeOf(line.prototype), \"recalculate\", this).call(this, t, e), this.paint._values[\"line-floorwidth\"] = Oh.possiblyEvaluate(this._transitioningPaint._values[\"line-width\"].value, t);\n          }\n        }, {\n          key: \"createBucket\",\n          value: function createBucket(t) {\n            return new jh(t);\n          }\n        }, {\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            return [this.paint.get(\"line-pattern\").constantOr(1) ? \"linePattern\" : \"line\"];\n          }\n        }, {\n          key: \"getProgramConfiguration\",\n          value: function getProgramConfiguration(t) {\n            return new po(this, t);\n          }\n        }, {\n          key: \"queryRadius\",\n          value: function queryRadius(t) {\n            var e = t,\n              r = qh(Fu(\"line-width\", this, e), Fu(\"line-gap-width\", this, e)),\n              n = Fu(\"line-offset\", this, e);\n            return r / 2 + Math.abs(n) + Ru(this.paint.get(\"line-translate\"));\n          }\n        }, {\n          key: \"queryIntersectsFeature\",\n          value: function queryIntersectsFeature(t, e, r, n, i, s) {\n            if (t.queryGeometry.isAboveHorizon) return !1;\n            var a = ju(t.tilespaceGeometry, this.paint.get(\"line-translate\"), this.paint.get(\"line-translate-anchor\"), s.angle, t.pixelToTileUnitsFactor),\n              o = t.pixelToTileUnitsFactor / 2 * qh(this.paint.get(\"line-width\").evaluate(e, r), this.paint.get(\"line-gap-width\").evaluate(e, r)),\n              l = this.paint.get(\"line-offset\").evaluate(e, r);\n            return l && (n = function (t, e) {\n              var r = [],\n                n = new d(0, 0);\n              for (var _i120 = 0; _i120 < t.length; _i120++) {\n                var _s88 = t[_i120],\n                  _a83 = [];\n                for (var _t204 = 0; _t204 < _s88.length; _t204++) {\n                  var _r154 = _s88[_t204 - 1],\n                    _i121 = _s88[_t204],\n                    _o45 = _s88[_t204 + 1],\n                    _l35 = 0 === _t204 ? n : _i121.sub(_r154)._unit()._perp(),\n                    _u33 = _t204 === _s88.length - 1 ? n : _o45.sub(_i121)._unit()._perp(),\n                    _c26 = _l35._add(_u33)._unit();\n                  _c26._mult(1 / (_c26.x * _u33.x + _c26.y * _u33.y)), _a83.push(_c26._mult(e)._add(_i121));\n                }\n                r.push(_a83);\n              }\n              return r;\n            }(n, l * t.pixelToTileUnitsFactor)), function (t, e, r) {\n              for (var _n117 = 0; _n117 < e.length; _n117++) {\n                var _i122 = e[_n117];\n                if (t.length >= 3) for (var _e195 = 0; _e195 < _i122.length; _e195++) if (Du(t, _i122[_e195])) return !0;\n                if (Tu(t, _i122, r)) return !0;\n              }\n              return !1;\n            }(a, n, o);\n          }\n        }, {\n          key: \"isTileClipped\",\n          value: function isTileClipped() {\n            return !0;\n          }\n        }]);\n        return line;\n      }(wo),\n      symbol: yd,\n      background: /*#__PURE__*/function (_wo9) {\n        _inherits(background, _wo9);\n        function background(t) {\n          _classCallCheck(this, background);\n          return _possibleConstructorReturn(this, _getPrototypeOf(background).call(this, t, md));\n        }\n        _createClass(background, [{\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            return [this.paint.get(\"background-pattern\") ? \"backgroundPattern\" : \"background\"];\n          }\n        }]);\n        return background;\n      }(wo),\n      raster: /*#__PURE__*/function (_wo10) {\n        _inherits(raster, _wo10);\n        function raster(t) {\n          _classCallCheck(this, raster);\n          return _possibleConstructorReturn(this, _getPrototypeOf(raster).call(this, t, gd));\n        }\n        _createClass(raster, [{\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            return [\"raster\"];\n          }\n        }]);\n        return raster;\n      }(wo),\n      sky: /*#__PURE__*/function (_wo11) {\n        _inherits(sky, _wo11);\n        function sky(t) {\n          var _this33;\n          _classCallCheck(this, sky);\n          _this33 = _possibleConstructorReturn(this, _getPrototypeOf(sky).call(this, t, vd)), _this33._updateColorRamp();\n          return _this33;\n        }\n        _createClass(sky, [{\n          key: \"_handleSpecialPaintPropertyUpdate\",\n          value: function _handleSpecialPaintPropertyUpdate(t) {\n            \"sky-gradient\" === t ? this._updateColorRamp() : \"sky-atmosphere-sun\" !== t && \"sky-atmosphere-halo-color\" !== t && \"sky-atmosphere-color\" !== t && \"sky-atmosphere-sun-intensity\" !== t || (this._skyboxInvalidated = !0);\n          }\n        }, {\n          key: \"_updateColorRamp\",\n          value: function _updateColorRamp() {\n            this.colorRamp = ec({\n              expression: this._transitionablePaint._values[\"sky-gradient\"].value.expression,\n              evaluationKey: \"skyRadialProgress\"\n            }), this.colorRampTexture && (this.colorRampTexture.destroy(), this.colorRampTexture = null);\n          }\n        }, {\n          key: \"needsSkyboxCapture\",\n          value: function needsSkyboxCapture(t) {\n            if (this._skyboxInvalidated || !this.skyboxTexture || !this.skyboxGeometry) return !0;\n            if (!this.paint.get(\"sky-atmosphere-sun\")) {\n              var _e196 = t.style.light.properties.get(\"position\");\n              return this._lightPosition.azimuthal !== _e196.azimuthal || this._lightPosition.polar !== _e196.polar;\n            }\n            return !1;\n          }\n        }, {\n          key: \"getCenter\",\n          value: function getCenter(t, e) {\n            if (\"atmosphere\" === this.paint.get(\"sky-type\")) {\n              var _r155 = this.paint.get(\"sky-atmosphere-sun\"),\n                _n118 = !_r155,\n                _i123 = t.style.light,\n                _s89 = _i123.properties.get(\"position\");\n              return _n118 && \"viewport\" === _i123.properties.get(\"anchor\") && U(\"The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly.\"), _n118 ? bd(_s89.azimuthal, 90 - _s89.polar, e) : bd(_r155[0], 90 - _r155[1], e);\n            }\n            var r = this.paint.get(\"sky-gradient-center\");\n            return bd(r[0], 90 - r[1], e);\n          }\n        }, {\n          key: \"is3D\",\n          value: function is3D() {\n            return !1;\n          }\n        }, {\n          key: \"isSky\",\n          value: function isSky() {\n            return !0;\n          }\n        }, {\n          key: \"markSkyboxValid\",\n          value: function markSkyboxValid(t) {\n            this._skyboxInvalidated = !1, this._lightPosition = t.style.light.properties.get(\"position\");\n          }\n        }, {\n          key: \"hasOffscreenPass\",\n          value: function hasOffscreenPass() {\n            return !0;\n          }\n        }, {\n          key: \"getProgramIds\",\n          value: function getProgramIds() {\n            var t = this.paint.get(\"sky-type\");\n            return \"atmosphere\" === t ? [\"skyboxCapture\", \"skybox\"] : \"gradient\" === t ? [\"skyboxGradient\"] : null;\n          }\n        }]);\n        return sky;\n      }(wo)\n    };\n    var _d = /*#__PURE__*/function () {\n      function _d(t, e, r, n) {\n        _classCallCheck(this, _d);\n        this.context = t, this.format = r, this.texture = t.gl.createTexture(), this.update(e, n);\n      }\n      _createClass(_d, [{\n        key: \"update\",\n        value: function update(t, r, n) {\n          var i = t.width,\n            s = t.height,\n            a = this.context,\n            o = a.gl,\n            l = e.HTMLImageElement,\n            u = e.HTMLCanvasElement,\n            c = e.HTMLVideoElement,\n            h = e.ImageData,\n            p = e.ImageBitmap;\n          if (o.bindTexture(o.TEXTURE_2D, this.texture), a.pixelStoreUnpackFlipY.set(!1), a.pixelStoreUnpack.set(1), a.pixelStoreUnpackPremultiplyAlpha.set(this.format === o.RGBA && (!r || !1 !== r.premultiply)), n || this.size && this.size[0] === i && this.size[1] === s) {\n            var _ref126 = n || {\n                x: 0,\n                y: 0\n              },\n              _e197 = _ref126.x,\n              _r156 = _ref126.y;\n            t instanceof l || t instanceof u || t instanceof c || t instanceof h || p && t instanceof p ? o.texSubImage2D(o.TEXTURE_2D, 0, _e197, _r156, o.RGBA, o.UNSIGNED_BYTE, t) : o.texSubImage2D(o.TEXTURE_2D, 0, _e197, _r156, i, s, o.RGBA, o.UNSIGNED_BYTE, t.data);\n          } else this.size = [i, s], t instanceof l || t instanceof u || t instanceof c || t instanceof h || p && t instanceof p ? o.texImage2D(o.TEXTURE_2D, 0, this.format, this.format, o.UNSIGNED_BYTE, t) : o.texImage2D(o.TEXTURE_2D, 0, this.format, i, s, 0, this.format, o.UNSIGNED_BYTE, t.data);\n          this.useMipmap = Boolean(r && r.useMipmap && this.isSizePowerOfTwo()), this.useMipmap && o.generateMipmap(o.TEXTURE_2D);\n        }\n      }, {\n        key: \"bind\",\n        value: function bind(t, e) {\n          var r = this.context,\n            n = r.gl;\n          n.bindTexture(n.TEXTURE_2D, this.texture), t !== this.filter && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, t), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, this.useMipmap ? t === n.NEAREST ? n.NEAREST_MIPMAP_NEAREST : n.LINEAR_MIPMAP_NEAREST : t), this.filter = t), e !== this.wrap && (n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, e), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, e), this.wrap = e);\n        }\n      }, {\n        key: \"isSizePowerOfTwo\",\n        value: function isSizePowerOfTwo() {\n          return this.size[0] === this.size[1] && Math.log(this.size[0]) / Math.LN2 % 1 == 0;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          var t = this.context.gl;\n          t.deleteTexture(this.texture), this.texture = null;\n        }\n      }]);\n      return _d;\n    }();\n    var Ad = /*#__PURE__*/function () {\n      function Ad(t) {\n        var _this34 = this;\n        _classCallCheck(this, Ad);\n        this._callback = t, this._triggered = !1, \"undefined\" != typeof MessageChannel && (this._channel = new MessageChannel(), this._channel.port2.onmessage = function () {\n          _this34._triggered = !1, _this34._callback();\n        });\n      }\n      _createClass(Ad, [{\n        key: \"trigger\",\n        value: function trigger() {\n          var _this35 = this;\n          this._triggered || (this._triggered = !0, this._channel ? this._channel.port1.postMessage(!0) : setTimeout(function () {\n            _this35._triggered = !1, _this35._callback();\n          }, 0));\n        }\n      }, {\n        key: \"remove\",\n        value: function remove() {\n          this._channel = void 0, this._callback = function () {};\n        }\n      }]);\n      return Ad;\n    }();\n    var Sd = /*#__PURE__*/function () {\n      function Sd() {\n        _classCallCheck(this, Sd);\n        this.tasks = {}, this.taskQueue = [], V([\"process\"], this), this.invoker = new Ad(this.process), this.nextId = 0;\n      }\n      _createClass(Sd, [{\n        key: \"add\",\n        value: function add(t, e) {\n          var _this36 = this;\n          var r = this.nextId++,\n            n = function (_ref127) {\n              var t = _ref127.type,\n                e = _ref127.isSymbolTile,\n                r = _ref127.zoom;\n              return r = r || 0, \"message\" === t ? 0 : \"maybePrepare\" !== t || e ? \"parseTile\" !== t || e ? \"parseTile\" === t && e ? 300 - r : \"maybePrepare\" === t && e ? 400 - r : 500 : 200 - r : 100 - r;\n            }(e);\n          if (0 === n) {\n            N();\n            try {\n              t();\n            } finally {}\n            return {\n              cancel: function cancel() {}\n            };\n          }\n          return this.tasks[r] = {\n            fn: t,\n            metadata: e,\n            priority: n,\n            id: r\n          }, this.taskQueue.push(r), this.invoker.trigger(), {\n            cancel: function cancel() {\n              delete _this36.tasks[r];\n            }\n          };\n        }\n      }, {\n        key: \"process\",\n        value: function process() {\n          var _this37 = this;\n          N();\n          try {\n            if (this.taskQueue = this.taskQueue.filter(function (t) {\n              return !!_this37.tasks[t];\n            }), !this.taskQueue.length) return;\n            var _t205 = this.pick();\n            if (null === _t205) return;\n            var _e198 = this.tasks[_t205];\n            if (delete this.tasks[_t205], this.taskQueue.length && this.invoker.trigger(), !_e198) return;\n            _e198.fn();\n          } finally {}\n        }\n      }, {\n        key: \"pick\",\n        value: function pick() {\n          var t = null,\n            e = 1 / 0;\n          for (var _r157 = 0; _r157 < this.taskQueue.length; _r157++) {\n            var _n119 = this.tasks[this.taskQueue[_r157]];\n            _n119.priority < e && (e = _n119.priority, t = _r157);\n          }\n          if (null === t) return null;\n          var r = this.taskQueue[t];\n          return this.taskQueue.splice(t, 1), r;\n        }\n      }, {\n        key: \"remove\",\n        value: function remove() {\n          this.invoker.remove();\n        }\n      }]);\n      return Sd;\n    }();\n    var kd = /*#__PURE__*/function () {\n      function kd(t) {\n        _classCallCheck(this, kd);\n        this._stringToNumber = {}, this._numberToString = [];\n        for (var _e199 = 0; _e199 < t.length; _e199++) {\n          var _r158 = t[_e199];\n          this._stringToNumber[_r158] = _e199, this._numberToString[_e199] = _r158;\n        }\n      }\n      _createClass(kd, [{\n        key: \"encode\",\n        value: function encode(t) {\n          return this._stringToNumber[t];\n        }\n      }, {\n        key: \"decode\",\n        value: function decode(t) {\n          return this._numberToString[t];\n        }\n      }]);\n      return kd;\n    }();\n    var Id = [\"tile\", \"layer\", \"source\", \"sourceLayer\", \"state\"];\n    var Md = /*#__PURE__*/function () {\n      function Md(t, e, r, n, i) {\n        _classCallCheck(this, Md);\n        this.type = \"Feature\", this._vectorTileFeature = t, this._z = e, this._x = r, this._y = n, this.properties = t.properties, this.id = i;\n      }\n      _createClass(Md, [{\n        key: \"toJSON\",\n        value: function toJSON() {\n          var t = {\n            type: \"Feature\",\n            state: void 0,\n            geometry: this.geometry,\n            properties: this.properties\n          };\n          void 0 !== this.id && (t.id = this.id);\n          for (var _i124 = 0, _Id = Id; _i124 < _Id.length; _i124++) {\n            var _e200 = _Id[_i124];\n            void 0 !== this[_e200] && (t[_e200] = this[_e200]);\n          }\n          return t;\n        }\n      }, {\n        key: \"geometry\",\n        get: function get() {\n          return void 0 === this._geometry && (this._geometry = this._vectorTileFeature.toGeoJSON(this._x, this._y, this._z).geometry), this._geometry;\n        },\n        set: function set(t) {\n          this._geometry = t;\n        }\n      }]);\n      return Md;\n    }();\n    var Td = 32,\n      zd = 33,\n      Bd = new Uint16Array(8184);\n    for (var _t206 = 0; _t206 < 2046; _t206++) {\n      var _e201 = _t206 + 2,\n        _r159 = 0,\n        _n120 = 0,\n        _i125 = 0,\n        _s90 = 0,\n        _a84 = 0,\n        _o46 = 0;\n      for (1 & _e201 ? _i125 = _s90 = _a84 = Td : _r159 = _n120 = _o46 = Td; (_e201 >>= 1) > 1;) {\n        var _t207 = _r159 + _i125 >> 1,\n          _l36 = _n120 + _s90 >> 1;\n        1 & _e201 ? (_i125 = _r159, _s90 = _n120, _r159 = _a84, _n120 = _o46) : (_r159 = _i125, _n120 = _s90, _i125 = _a84, _s90 = _o46), _a84 = _t207, _o46 = _l36;\n      }\n      var _l37 = 4 * _t206;\n      Bd[_l37 + 0] = _r159, Bd[_l37 + 1] = _n120, Bd[_l37 + 2] = _i125, Bd[_l37 + 3] = _s90;\n    }\n    var Ed = new Uint16Array(2178),\n      Cd = new Uint8Array(1089),\n      Pd = new Uint16Array(1089);\n    function Dd(t) {\n      return 0 === t ? -.03125 : 32 === t ? .03125 : 0;\n    }\n    var Vd = na([{\n      name: \"a_pos\",\n      type: \"Int16\",\n      components: 2\n    }, {\n      name: \"a_texture_pos\",\n      type: \"Int16\",\n      components: 2\n    }]);\n    var Ld = {\n      type: 2,\n      extent: ko,\n      loadGeometry: function loadGeometry() {\n        return [[new d(0, 0), new d(8193, 0), new d(8193, 8193), new d(0, 8193), new d(0, 0)]];\n      }\n    };\n    var Fd = /*#__PURE__*/function () {\n      function Fd(t, e, r, n, i) {\n        _classCallCheck(this, Fd);\n        this.tileID = t, this.uid = E(), this.uses = 0, this.tileSize = e, this.tileZoom = r, this.buckets = {}, this.expirationTime = null, this.queryPadding = 0, this.hasSymbolBuckets = !1, this.hasRTLText = !1, this.dependencies = {}, this.isRaster = i, this.expiredRequestCount = 0, this.state = \"loading\", n && n.transform && (this.projection = n.transform.projection);\n      }\n      _createClass(Fd, [{\n        key: \"registerFadeDuration\",\n        value: function registerFadeDuration(t) {\n          var e = t + this.timeAdded;\n          e < Nt.now() || this.fadeEndTime && e < this.fadeEndTime || (this.fadeEndTime = e);\n        }\n      }, {\n        key: \"wasRequested\",\n        value: function wasRequested() {\n          return \"errored\" === this.state || \"loaded\" === this.state || \"reloading\" === this.state;\n        }\n      }, {\n        key: \"loadVectorData\",\n        value: function loadVectorData(t, e, r) {\n          if (this.unloadVectorData(), this.state = \"loaded\", t) {\n            t.featureIndex && (this.latestFeatureIndex = t.featureIndex, t.rawTileData ? (this.latestRawTileData = t.rawTileData, this.latestFeatureIndex.rawTileData = t.rawTileData) : this.latestRawTileData && (this.latestFeatureIndex.rawTileData = this.latestRawTileData)), this.collisionBoxArray = t.collisionBoxArray, this.buckets = function (t, e) {\n              var r = {};\n              if (!e) return r;\n              var _iterator143 = _createForOfIteratorHelper(t),\n                _step143;\n              try {\n                var _loop6 = function _loop6() {\n                  var n = _step143.value;\n                  var t = n.layerIds.map(function (t) {\n                    return e.getLayer(t);\n                  }).filter(Boolean);\n                  if (0 !== t.length) {\n                    n.layers = t, n.stateDependentLayerIds && (n.stateDependentLayers = n.stateDependentLayerIds.map(function (e) {\n                      return t.filter(function (t) {\n                        return t.id === e;\n                      })[0];\n                    }));\n                    var _iterator144 = _createForOfIteratorHelper(t),\n                      _step144;\n                    try {\n                      for (_iterator144.s(); !(_step144 = _iterator144.n()).done;) {\n                        var _e202 = _step144.value;\n                        r[_e202.id] = n;\n                      }\n                    } catch (err) {\n                      _iterator144.e(err);\n                    } finally {\n                      _iterator144.f();\n                    }\n                  }\n                };\n                for (_iterator143.s(); !(_step143 = _iterator143.n()).done;) {\n                  _loop6();\n                }\n              } catch (err) {\n                _iterator143.e(err);\n              } finally {\n                _iterator143.f();\n              }\n              return r;\n            }(t.buckets, e.style), this.hasSymbolBuckets = !1;\n            for (var _t208 in this.buckets) {\n              var _e203 = this.buckets[_t208];\n              if (_e203 instanceof hd) {\n                if (this.hasSymbolBuckets = !0, !r) break;\n                _e203.justReloaded = !0;\n              }\n            }\n            if (this.hasRTLText = !1, this.hasSymbolBuckets) for (var _t209 in this.buckets) {\n              var _e204 = this.buckets[_t209];\n              if (_e204 instanceof hd && _e204.hasRTLText) {\n                this.hasRTLText = !0, js.isLoading() || js.isLoaded() || \"deferred\" !== Fs() || Rs();\n                break;\n              }\n            }\n            this.queryPadding = 0;\n            for (var _t210 in this.buckets) {\n              var _r160 = this.buckets[_t210];\n              this.queryPadding = Math.max(this.queryPadding, e.style.getLayer(_t210).queryRadius(_r160));\n            }\n            t.imageAtlas && (this.imageAtlas = t.imageAtlas), t.glyphAtlasImage && (this.glyphAtlasImage = t.glyphAtlasImage), t.lineAtlas && (this.lineAtlas = t.lineAtlas);\n          } else this.collisionBoxArray = new Ea();\n        }\n      }, {\n        key: \"unloadVectorData\",\n        value: function unloadVectorData() {\n          if (this.hasData()) {\n            for (var _t211 in this.buckets) this.buckets[_t211].destroy();\n            this.buckets = {}, this.imageAtlas && (this.imageAtlas = null), this.lineAtlas && (this.lineAtlas = null), this.imageAtlasTexture && this.imageAtlasTexture.destroy(), this.glyphAtlasTexture && this.glyphAtlasTexture.destroy(), this.lineAtlasTexture && this.lineAtlasTexture.destroy(), this._tileBoundsBuffer && (this._tileBoundsBuffer.destroy(), this._tileBoundsIndexBuffer.destroy(), this._tileBoundsSegments.destroy(), this._tileBoundsBuffer = null), this._tileDebugBuffer && (this._tileDebugBuffer.destroy(), this._tileDebugSegments.destroy(), this._tileDebugBuffer = null), this._tileDebugIndexBuffer && (this._tileDebugIndexBuffer.destroy(), this._tileDebugIndexBuffer = null), this._globeTileDebugBorderBuffer && (this._globeTileDebugBorderBuffer.destroy(), this._globeTileDebugBorderBuffer = null), this._tileDebugTextBuffer && (this._tileDebugTextBuffer.destroy(), this._tileDebugTextSegments.destroy(), this._tileDebugTextIndexBuffer.destroy(), this._tileDebugTextBuffer = null), this._globeTileDebugTextBuffer && (this._globeTileDebugTextBuffer.destroy(), this._globeTileDebugTextBuffer = null), this.latestFeatureIndex = null, this.state = \"unloaded\";\n          }\n        }\n      }, {\n        key: \"getBucket\",\n        value: function getBucket(t) {\n          return this.buckets[t.id];\n        }\n      }, {\n        key: \"upload\",\n        value: function upload(t) {\n          for (var _e205 in this.buckets) {\n            var _r161 = this.buckets[_e205];\n            _r161.uploadPending() && _r161.upload(t);\n          }\n          var e = t.gl;\n          this.imageAtlas && !this.imageAtlas.uploaded && (this.imageAtlasTexture = new _d(t, this.imageAtlas.image, e.RGBA), this.imageAtlas.uploaded = !0), this.glyphAtlasImage && (this.glyphAtlasTexture = new _d(t, this.glyphAtlasImage, e.ALPHA), this.glyphAtlasImage = null), this.lineAtlas && !this.lineAtlas.uploaded && (this.lineAtlasTexture = new _d(t, this.lineAtlas.image, e.ALPHA), this.lineAtlas.uploaded = !0);\n        }\n      }, {\n        key: \"prepare\",\n        value: function prepare(t) {\n          this.imageAtlas && this.imageAtlas.patchUpdatedImages(t, this.imageAtlasTexture);\n        }\n      }, {\n        key: \"queryRenderedFeatures\",\n        value: function queryRenderedFeatures(t, e, r, n, i, s, a, o) {\n          return this.latestFeatureIndex && this.latestFeatureIndex.rawTileData ? this.latestFeatureIndex.query({\n            tileResult: n,\n            pixelPosMatrix: a,\n            transform: s,\n            params: i,\n            tileTransform: this.tileTransform\n          }, t, e, r) : {};\n        }\n      }, {\n        key: \"querySourceFeatures\",\n        value: function querySourceFeatures(t, e) {\n          var r = this.latestFeatureIndex;\n          if (!r || !r.rawTileData) return;\n          var n = r.loadVTLayers(),\n            i = e ? e.sourceLayer : \"\",\n            s = n._geojsonTileLayer || n[i];\n          if (!s) return;\n          var a = ai(e && e.filter),\n            _this$tileID$canonica = this.tileID.canonical,\n            o = _this$tileID$canonica.z,\n            l = _this$tileID$canonica.x,\n            u = _this$tileID$canonica.y,\n            c = {\n              z: o,\n              x: l,\n              y: u\n            };\n          for (var _e206 = 0; _e206 < s.length; _e206++) {\n            var _n121 = s.feature(_e206);\n            if (a.needGeometry) {\n              var _t212 = wu(_n121, !0);\n              if (!a.filter(new $s(this.tileID.overscaledZ), _t212, this.tileID.canonical)) continue;\n            } else if (!a.filter(new $s(this.tileID.overscaledZ), _n121)) continue;\n            var _h22 = r.getId(_n121, i),\n              _p22 = new Md(_n121, o, l, u, _h22);\n            _p22.tile = c, t.push(_p22);\n          }\n        }\n      }, {\n        key: \"hasData\",\n        value: function hasData() {\n          return \"loaded\" === this.state || \"reloading\" === this.state || \"expired\" === this.state;\n        }\n      }, {\n        key: \"patternsLoaded\",\n        value: function patternsLoaded() {\n          return !!this.imageAtlas && !!Object.keys(this.imageAtlas.patternPositions).length;\n        }\n      }, {\n        key: \"setExpiryData\",\n        value: function setExpiryData(t) {\n          var e = this.expirationTime;\n          if (t.cacheControl) {\n            var _e207 = G(t.cacheControl);\n            _e207[\"max-age\"] && (this.expirationTime = Date.now() + 1e3 * _e207[\"max-age\"]);\n          } else t.expires && (this.expirationTime = new Date(t.expires).getTime());\n          if (this.expirationTime) {\n            var _t213 = Date.now();\n            var _r162 = !1;\n            if (this.expirationTime > _t213) _r162 = !1;else if (e) {\n              if (this.expirationTime < e) _r162 = !0;else {\n                var _n122 = this.expirationTime - e;\n                _n122 ? this.expirationTime = _t213 + Math.max(_n122, 3e4) : _r162 = !0;\n              }\n            } else _r162 = !0;\n            _r162 ? (this.expiredRequestCount++, this.state = \"expired\") : this.expiredRequestCount = 0;\n          }\n        }\n      }, {\n        key: \"getExpiryTimeout\",\n        value: function getExpiryTimeout() {\n          if (this.expirationTime) return this.expiredRequestCount ? 1e3 * (1 << Math.min(this.expiredRequestCount - 1, 31)) : Math.min(this.expirationTime - new Date().getTime(), Math.pow(2, 31) - 1);\n        }\n      }, {\n        key: \"setFeatureState\",\n        value: function setFeatureState(t, e) {\n          if (!this.latestFeatureIndex || !this.latestFeatureIndex.rawTileData || 0 === Object.keys(t).length || !e) return;\n          var r = this.latestFeatureIndex.loadVTLayers(),\n            n = e.style.listImages();\n          for (var _i126 in this.buckets) {\n            if (!e.style.hasLayer(_i126)) continue;\n            var _s91 = this.buckets[_i126],\n              _a85 = _s91.layers[0].sourceLayer || \"_geojsonTileLayer\",\n              _o47 = r[_a85],\n              _l38 = t[_a85];\n            if (!_o47 || !_l38 || 0 === Object.keys(_l38).length) continue;\n            if (_s91.update(_l38, _o47, n, this.imageAtlas && this.imageAtlas.patternPositions || {}), _s91 instanceof jh || _s91 instanceof $c) {\n              var _t214 = e.style._getSourceCache(_s91.layers[0].source);\n              e._terrain && e._terrain.enabled && _t214 && _s91.programConfigurations.needsUpload && e._terrain._clearRenderCacheForTile(_t214.id, this.tileID);\n            }\n            var _u34 = e && e.style && e.style.getLayer(_i126);\n            _u34 && (this.queryPadding = Math.max(this.queryPadding, _u34.queryRadius(_s91)));\n          }\n        }\n      }, {\n        key: \"holdingForFade\",\n        value: function holdingForFade() {\n          return void 0 !== this.symbolFadeHoldUntil;\n        }\n      }, {\n        key: \"symbolFadeFinished\",\n        value: function symbolFadeFinished() {\n          return !this.symbolFadeHoldUntil || this.symbolFadeHoldUntil < Nt.now();\n        }\n      }, {\n        key: \"clearFadeHold\",\n        value: function clearFadeHold() {\n          this.symbolFadeHoldUntil = void 0;\n        }\n      }, {\n        key: \"setHoldDuration\",\n        value: function setHoldDuration(t) {\n          this.symbolFadeHoldUntil = Nt.now() + t;\n        }\n      }, {\n        key: \"setTexture\",\n        value: function setTexture(t, e) {\n          var r = e.context,\n            n = r.gl;\n          this.texture = this.texture || e.getTileTexture(t.width), this.texture ? this.texture.update(t, {\n            useMipmap: !0\n          }) : (this.texture = new _d(r, t, n.RGBA, {\n            useMipmap: !0\n          }), this.texture.bind(n.LINEAR, n.CLAMP_TO_EDGE));\n        }\n      }, {\n        key: \"setDependencies\",\n        value: function setDependencies(t, e) {\n          var r = {};\n          var _iterator145 = _createForOfIteratorHelper(e),\n            _step145;\n          try {\n            for (_iterator145.s(); !(_step145 = _iterator145.n()).done;) {\n              var _t215 = _step145.value;\n              r[_t215] = !0;\n            }\n          } catch (err) {\n            _iterator145.e(err);\n          } finally {\n            _iterator145.f();\n          }\n          this.dependencies[t] = r;\n        }\n      }, {\n        key: \"hasDependency\",\n        value: function hasDependency(t, e) {\n          var _iterator146 = _createForOfIteratorHelper(t),\n            _step146;\n          try {\n            for (_iterator146.s(); !(_step146 = _iterator146.n()).done;) {\n              var _r163 = _step146.value;\n              var _t216 = this.dependencies[_r163];\n              if (_t216) {\n                var _iterator147 = _createForOfIteratorHelper(e),\n                  _step147;\n                try {\n                  for (_iterator147.s(); !(_step147 = _iterator147.n()).done;) {\n                    var _r164 = _step147.value;\n                    if (_t216[_r164]) return !0;\n                  }\n                } catch (err) {\n                  _iterator147.e(err);\n                } finally {\n                  _iterator147.f();\n                }\n              }\n            }\n          } catch (err) {\n            _iterator146.e(err);\n          } finally {\n            _iterator146.f();\n          }\n          return !1;\n        }\n      }, {\n        key: \"clearQueryDebugViz\",\n        value: function clearQueryDebugViz() {}\n      }, {\n        key: \"_makeDebugTileBoundsBuffers\",\n        value: function _makeDebugTileBoundsBuffers(t, e) {\n          if (!e || \"mercator\" === e.name || this._tileDebugBuffer) return;\n          var r = bu(Ld, this.tileID.canonical, this.tileTransform)[0],\n            n = new sa(),\n            i = new Ta();\n          for (var _t217 = 0; _t217 < r.length; _t217++) {\n            var _r$_t = r[_t217],\n              _e208 = _r$_t.x,\n              _s92 = _r$_t.y;\n            n.emplaceBack(_e208, _s92), i.emplaceBack(_t217);\n          }\n          i.emplaceBack(0), this._tileDebugIndexBuffer = t.createIndexBuffer(i), this._tileDebugBuffer = t.createVertexBuffer(n, xl.members), this._tileDebugSegments = So.simpleSegment(0, 0, n.length, i.length);\n        }\n      }, {\n        key: \"_makeTileBoundsBuffers\",\n        value: function _makeTileBoundsBuffers(t, e) {\n          if (this._tileBoundsBuffer || !e || \"mercator\" === e.name) return;\n          var r = bu(Ld, this.tileID.canonical, this.tileTransform)[0];\n          var n, i;\n          if (this.isRaster) {\n            var _t218 = function (t, e) {\n              var r = Vf(t, e),\n                n = Math.pow(2, t.z);\n              for (var _i127 = 0; _i127 < zd; _i127++) for (var _s93 = 0; _s93 < zd; _s93++) {\n                var _a86 = ou((t.x + (_s93 + Dd(_s93)) / Td) / n),\n                  _o48 = lu((t.y + (_i127 + Dd(_i127)) / Td) / n),\n                  _l39 = e.project(_a86, _o48),\n                  _u35 = _i127 * zd + _s93;\n                Ed[2 * _u35 + 0] = Math.round((_l39.x * r.scale - r.x) * ko), Ed[2 * _u35 + 1] = Math.round((_l39.y * r.scale - r.y) * ko);\n              }\n              Cd.fill(0), Pd.fill(0);\n              for (var _t219 = 2045; _t219 >= 0; _t219--) {\n                var _e209 = 4 * _t219,\n                  _r165 = Bd[_e209 + 0],\n                  _n123 = Bd[_e209 + 1],\n                  _i128 = Bd[_e209 + 2],\n                  _s94 = Bd[_e209 + 3],\n                  _a87 = _r165 + _i128 >> 1,\n                  _o49 = _n123 + _s94 >> 1,\n                  _l40 = _a87 + _o49 - _n123,\n                  _u36 = _o49 + _r165 - _a87,\n                  _c27 = _n123 * zd + _r165,\n                  _h23 = _s94 * zd + _i128,\n                  _p23 = _o49 * zd + _a87,\n                  _f15 = Math.hypot((Ed[2 * _c27 + 0] + Ed[2 * _h23 + 0]) / 2 - Ed[2 * _p23 + 0], (Ed[2 * _c27 + 1] + Ed[2 * _h23 + 1]) / 2 - Ed[2 * _p23 + 1]) >= 16;\n                if (Cd[_p23] = Cd[_p23] || (_f15 ? 1 : 0), _t219 < 1022) {\n                  var _t220 = (_n123 + _u36 >> 1) * zd + (_r165 + _l40 >> 1),\n                    _e210 = (_s94 + _u36 >> 1) * zd + (_i128 + _l40 >> 1);\n                  Cd[_p23] = Cd[_p23] || Cd[_t220] || Cd[_e210];\n                }\n              }\n              var i = new oa(),\n                s = new wa();\n              var a = 0;\n              function o(t, e) {\n                var r = e * zd + t;\n                return 0 === Pd[r] && (i.emplaceBack(Ed[2 * r + 0], Ed[2 * r + 1], t * ko / Td, e * ko / Td), Pd[r] = ++a), Pd[r] - 1;\n              }\n              function l(t, e, r, n, i, a) {\n                var u = t + r >> 1,\n                  c = e + n >> 1;\n                if (Math.abs(t - i) + Math.abs(e - a) > 1 && Cd[c * zd + u]) l(i, a, t, e, u, c), l(r, n, i, a, u, c);else {\n                  var _l41 = o(t, e),\n                    _u37 = o(r, n),\n                    _c28 = o(i, a);\n                  s.emplaceBack(_l41, _u37, _c28);\n                }\n              }\n              return l(0, 0, Td, Td, Td, 0), l(Td, Td, 0, 0, 0, Td), {\n                vertices: i,\n                indices: s\n              };\n            }(this.tileID.canonical, e);\n            n = _t218.vertices, i = _t218.indices;\n          } else {\n            n = new oa(), i = new wa();\n            var _iterator148 = _createForOfIteratorHelper(r),\n              _step148;\n            try {\n              for (_iterator148.s(); !(_step148 = _iterator148.n()).done;) {\n                var _step148$value = _step148.value,\n                  _t222 = _step148$value.x,\n                  _e212 = _step148$value.y;\n                n.emplaceBack(_t222, _e212, 0, 0);\n              }\n            } catch (err) {\n              _iterator148.e(err);\n            } finally {\n              _iterator148.f();\n            }\n            var _t221 = sc(n.int16, void 0, 4);\n            for (var _e211 = 0; _e211 < _t221.length; _e211 += 3) i.emplaceBack(_t221[_e211], _t221[_e211 + 1], _t221[_e211 + 2]);\n          }\n          this._tileBoundsBuffer = t.createVertexBuffer(n, Vd.members), this._tileBoundsIndexBuffer = t.createIndexBuffer(i), this._tileBoundsSegments = So.simpleSegment(0, 0, n.length, i.length);\n        }\n      }, {\n        key: \"_makeGlobeTileDebugBuffers\",\n        value: function _makeGlobeTileDebugBuffers(t, e) {\n          var r = e.projection;\n          if (!r || \"globe\" !== r.name || e.freezeTileCoverage) return;\n          var n = this.tileID.canonical,\n            i = Gl(Vl(n, e)),\n            s = Kl(e.zoom);\n          var a;\n          s > 0 && (a = Co(new Float64Array(16), e.globeMatrix)), this._makeGlobeTileDebugBorderBuffer(t, n, e, i, a, s), this._makeGlobeTileDebugTextBuffer(t, n, e, i, a, s);\n        }\n      }, {\n        key: \"_globePoint\",\n        value: function _globePoint(t, e, r, n, i, s, a) {\n          var o = Ol(t, e, r);\n          if (s) {\n            var _i129 = 1 << r.z,\n              _l42 = iu(n.center.lng),\n              _u38 = su(n.center.lat),\n              _c29 = (r.x + .5) / _i129 - _l42;\n            var _h24 = 0;\n            _c29 > .5 ? _h24 = -1 : _c29 < -.5 && (_h24 = 1);\n            var _p24 = (t / ko + r.x) / _i129 + _h24,\n              _f16 = (e / ko + r.y) / _i129;\n            _p24 = (_p24 - _l42) * n._pixelsPerMercatorPixel + _l42, _f16 = (_f16 - _u38) * n._pixelsPerMercatorPixel + _u38;\n            var _d13 = [_p24 * n.worldSize, _f16 * n.worldSize, 0];\n            el(_d13, _d13, s), o = Dl(o, _d13, a);\n          }\n          return el(o, o, i);\n        }\n      }, {\n        key: \"_makeGlobeTileDebugBorderBuffer\",\n        value: function _makeGlobeTileDebugBorderBuffer(t, e, r, n, i, s) {\n          var _this38 = this;\n          var a = new sa(),\n            o = new Ta(),\n            l = new aa(),\n            u = function u(t, _u39, c, h, p) {\n              var f = (c - t) / (p - 1),\n                d = (h - _u39) / (p - 1),\n                y = a.length;\n              for (var _c30 = 0; _c30 < p; _c30++) {\n                var _h25 = t + _c30 * f,\n                  _p25 = _u39 + _c30 * d;\n                a.emplaceBack(_h25, _p25);\n                var _m8 = _this38._globePoint(_h25, _p25, e, r, n, i, s);\n                l.emplaceBack(_m8[0], _m8[1], _m8[2]), o.emplaceBack(y + _c30);\n              }\n            },\n            c = ko;\n          u(0, 0, c, 0, 16), u(c, 0, c, c, 16), u(c, c, 0, c, 16), u(0, c, 0, 0, 16), this._tileDebugIndexBuffer = t.createIndexBuffer(o), this._tileDebugBuffer = t.createVertexBuffer(a, xl.members), this._globeTileDebugBorderBuffer = t.createVertexBuffer(l, gl.members), this._tileDebugSegments = So.simpleSegment(0, 0, a.length, o.length);\n        }\n      }, {\n        key: \"_makeGlobeTileDebugTextBuffer\",\n        value: function _makeGlobeTileDebugTextBuffer(t, e, r, n, i, s) {\n          var a = new sa(),\n            o = new wa(),\n            l = new aa(),\n            u = 25;\n          o.reserve(32), a.reserve(u), l.reserve(u);\n          var c = function c(t, e) {\n            return u * t + e;\n          };\n          for (var _t223 = 0; _t223 < u; _t223++) {\n            var _o50 = 2048 * _t223;\n            for (var _t224 = 0; _t224 < u; _t224++) {\n              var _u40 = 2048 * _t224;\n              a.emplaceBack(_u40, _o50);\n              var _c31 = this._globePoint(_u40, _o50, e, r, n, i, s);\n              l.emplaceBack(_c31[0], _c31[1], _c31[2]);\n            }\n          }\n          for (var _t225 = 0; _t225 < 4; _t225++) for (var _e213 = 0; _e213 < 4; _e213++) {\n            var _r166 = c(_t225, _e213),\n              _n124 = c(_t225, _e213 + 1),\n              _i130 = c(_t225 + 1, _e213),\n              _s95 = c(_t225 + 1, _e213 + 1);\n            o.emplaceBack(_r166, _n124, _i130), o.emplaceBack(_i130, _n124, _s95);\n          }\n          this._tileDebugTextIndexBuffer = t.createIndexBuffer(o), this._tileDebugTextBuffer = t.createVertexBuffer(a, xl.members), this._globeTileDebugTextBuffer = t.createVertexBuffer(l, gl.members), this._tileDebugTextSegments = So.simpleSegment(0, 0, u, 32);\n        }\n      }, {\n        key: \"tileTransform\",\n        get: function get() {\n          return this._tileTransform || (this._tileTransform = Vf(this.tileID.canonical, this.projection)), this._tileTransform;\n        }\n      }]);\n      return Fd;\n    }();\n    var Rd = /*#__PURE__*/function () {\n      function Rd() {\n        _classCallCheck(this, Rd);\n        this.state = {}, this.stateChanges = {}, this.deletedStates = {};\n      }\n      _createClass(Rd, [{\n        key: \"updateState\",\n        value: function updateState(t, e, r) {\n          var n = String(e);\n          if (this.stateChanges[t] = this.stateChanges[t] || {}, this.stateChanges[t][n] = this.stateChanges[t][n] || {}, z(this.stateChanges[t][n], r), null === this.deletedStates[t]) {\n            this.deletedStates[t] = {};\n            for (var _e214 in this.state[t]) _e214 !== n && (this.deletedStates[t][_e214] = null);\n          } else if (this.deletedStates[t] && null === this.deletedStates[t][n]) {\n            this.deletedStates[t][n] = {};\n            for (var _e215 in this.state[t][n]) r[_e215] || (this.deletedStates[t][n][_e215] = null);\n          } else for (var _e216 in r) this.deletedStates[t] && this.deletedStates[t][n] && null === this.deletedStates[t][n][_e216] && delete this.deletedStates[t][n][_e216];\n        }\n      }, {\n        key: \"removeFeatureState\",\n        value: function removeFeatureState(t, e, r) {\n          if (null === this.deletedStates[t]) return;\n          var n = String(e);\n          if (this.deletedStates[t] = this.deletedStates[t] || {}, r && void 0 !== e) null !== this.deletedStates[t][n] && (this.deletedStates[t][n] = this.deletedStates[t][n] || {}, this.deletedStates[t][n][r] = null);else if (void 0 !== e) {\n            if (this.stateChanges[t] && this.stateChanges[t][n]) for (r in this.deletedStates[t][n] = {}, this.stateChanges[t][n]) this.deletedStates[t][n][r] = null;else this.deletedStates[t][n] = null;\n          } else this.deletedStates[t] = null;\n        }\n      }, {\n        key: \"getState\",\n        value: function getState(t, e) {\n          var r = String(e),\n            n = z({}, (this.state[t] || {})[r], (this.stateChanges[t] || {})[r]);\n          if (null === this.deletedStates[t]) return {};\n          if (this.deletedStates[t]) {\n            var _r167 = this.deletedStates[t][e];\n            if (null === _r167) return {};\n            for (var _t226 in _r167) delete n[_t226];\n          }\n          return n;\n        }\n      }, {\n        key: \"initializeTileState\",\n        value: function initializeTileState(t, e) {\n          t.setFeatureState(this.state, e);\n        }\n      }, {\n        key: \"coalesceChanges\",\n        value: function coalesceChanges(t, e) {\n          var r = {};\n          for (var _t227 in this.stateChanges) {\n            this.state[_t227] = this.state[_t227] || {};\n            var _e217 = {};\n            for (var _r168 in this.stateChanges[_t227]) this.state[_t227][_r168] || (this.state[_t227][_r168] = {}), z(this.state[_t227][_r168], this.stateChanges[_t227][_r168]), _e217[_r168] = this.state[_t227][_r168];\n            r[_t227] = _e217;\n          }\n          for (var _t228 in this.deletedStates) {\n            this.state[_t228] = this.state[_t228] || {};\n            var _e218 = {};\n            if (null === this.deletedStates[_t228]) for (var _r169 in this.state[_t228]) _e218[_r169] = {}, this.state[_t228][_r169] = {};else for (var _r170 in this.deletedStates[_t228]) {\n              if (null === this.deletedStates[_t228][_r170]) this.state[_t228][_r170] = {};else if (this.state[_t228][_r170]) for (var _i131 = 0, _Object$keys10 = Object.keys(this.deletedStates[_t228][_r170]); _i131 < _Object$keys10.length; _i131++) {\n                var _e219 = _Object$keys10[_i131];\n                delete this.state[_t228][_r170][_e219];\n              }\n              _e218[_r170] = this.state[_t228][_r170];\n            }\n            r[_t228] = r[_t228] || {}, z(r[_t228], _e218);\n          }\n          if (this.stateChanges = {}, this.deletedStates = {}, 0 !== Object.keys(r).length) for (var _n125 in t) t[_n125].setFeatureState(r, e);\n        }\n      }]);\n      return Rd;\n    }();\n    var jd = /*#__PURE__*/function () {\n      function jd(t) {\n        _classCallCheck(this, jd);\n        this.size = t, this.minimums = [], this.maximums = [], this.leaves = [];\n      }\n      _createClass(jd, [{\n        key: \"getElevation\",\n        value: function getElevation(t, e) {\n          var r = this.toIdx(t, e);\n          return {\n            min: this.minimums[r],\n            max: this.maximums[r]\n          };\n        }\n      }, {\n        key: \"isLeaf\",\n        value: function isLeaf(t, e) {\n          return this.leaves[this.toIdx(t, e)];\n        }\n      }, {\n        key: \"toIdx\",\n        value: function toIdx(t, e) {\n          return e * this.size + t;\n        }\n      }]);\n      return jd;\n    }();\n    function $d(t, e, r, n) {\n      var i = 0,\n        s = Number.MAX_VALUE;\n      for (var _a88 = 0; _a88 < 3; _a88++) if (Math.abs(n[_a88]) < 1e-15) {\n        if (r[_a88] < t[_a88] || r[_a88] > e[_a88]) return null;\n      } else {\n        var _o51 = 1 / n[_a88];\n        var _l43 = (t[_a88] - r[_a88]) * _o51,\n          _u41 = (e[_a88] - r[_a88]) * _o51;\n        if (_l43 > _u41) {\n          var _t229 = _l43;\n          _l43 = _u41, _u41 = _t229;\n        }\n        if (_l43 > i && (i = _l43), _u41 < s && (s = _u41), i > s) return null;\n      }\n      return i;\n    }\n    function Ud(t, e, r, n, i, s, a, o, l, u, c) {\n      var h = n - t,\n        p = i - e,\n        f = s - r,\n        d = a - t,\n        y = o - e,\n        m = l - r,\n        g = c[1] * m - c[2] * y,\n        x = c[2] * d - c[0] * m,\n        v = c[0] * y - c[1] * d,\n        b = h * g + p * x + f * v;\n      if (Math.abs(b) < 1e-15) return null;\n      var w = 1 / b,\n        _ = u[0] - t,\n        A = u[1] - e,\n        S = u[2] - r,\n        k = (_ * g + A * x + S * v) * w;\n      if (k < 0 || k > 1) return null;\n      var I = A * f - S * p,\n        M = S * h - _ * f,\n        T = _ * p - A * h,\n        z = (c[0] * I + c[1] * M + c[2] * T) * w;\n      return z < 0 || k + z > 1 ? null : (d * I + y * M + m * T) * w;\n    }\n    function Od(t, e, r) {\n      return (t - e) / (r - e);\n    }\n    function qd(t, e, r, n, i, s, a, o, l) {\n      var u = 1 << r,\n        c = s - n,\n        h = a - i,\n        p = (t + 1) / u * c + n,\n        f = (e + 0) / u * h + i,\n        d = (e + 1) / u * h + i;\n      o[0] = (t + 0) / u * c + n, o[1] = f, l[0] = p, l[1] = d;\n    }\n    var Nd = /*#__PURE__*/function () {\n      function Nd(t) {\n        _classCallCheck(this, Nd);\n        if (this.maximums = [], this.minimums = [], this.leaves = [], this.childOffsets = [], this.nodeCount = 0, this.dem = t, this._siblingOffset = [[0, 0], [1, 0], [0, 1], [1, 1]], !this.dem) return;\n        var e = function (t) {\n            var e = Math.ceil(Math.log2(t.dim / 8)),\n              r = [];\n            var n = Math.ceil(Math.pow(2, e));\n            var i = 1 / n,\n              s = function s(t, e, r, n, i) {\n                var s = n ? 1 : 0,\n                  a = (t + 1) * r - s,\n                  o = e * r,\n                  l = (e + 1) * r - s;\n                i[0] = t * r, i[1] = o, i[2] = a, i[3] = l;\n              };\n            var a = new jd(n);\n            var o = [];\n            for (var _e220 = 0; _e220 < n * n; _e220++) {\n              s(_e220 % n, Math.floor(_e220 / n), i, !1, o);\n              var _r171 = Zd(o[0], o[1], t),\n                _l44 = Zd(o[2], o[1], t),\n                _u42 = Zd(o[2], o[3], t),\n                _c32 = Zd(o[0], o[3], t);\n              a.minimums.push(Math.min(_r171, _l44, _u42, _c32)), a.maximums.push(Math.max(_r171, _l44, _u42, _c32)), a.leaves.push(1);\n            }\n            for (r.push(a), n /= 2; n >= 1; n /= 2) {\n              var _t230 = r[r.length - 1];\n              a = new jd(n);\n              for (var _e221 = 0; _e221 < n * n; _e221++) {\n                s(_e221 % n, Math.floor(_e221 / n), 2, !0, o);\n                var _r172 = _t230.getElevation(o[0], o[1]),\n                  _i132 = _t230.getElevation(o[2], o[1]),\n                  _l45 = _t230.getElevation(o[2], o[3]),\n                  _u43 = _t230.getElevation(o[0], o[3]),\n                  _c33 = _t230.isLeaf(o[0], o[1]),\n                  _h26 = _t230.isLeaf(o[2], o[1]),\n                  _p26 = _t230.isLeaf(o[2], o[3]),\n                  _f17 = _t230.isLeaf(o[0], o[3]),\n                  _d14 = Math.min(_r172.min, _i132.min, _l45.min, _u43.min),\n                  _y10 = Math.max(_r172.max, _i132.max, _l45.max, _u43.max),\n                  _m9 = _c33 && _h26 && _p26 && _f17;\n                a.maximums.push(_y10), a.minimums.push(_d14), a.leaves.push(_y10 - _d14 <= 5 && _m9 ? 1 : 0);\n              }\n              r.push(a);\n            }\n            return r;\n          }(this.dem),\n          r = e.length - 1,\n          n = e[r];\n        this._addNode(n.minimums[0], n.maximums[0], n.leaves[0]), this._construct(e, 0, 0, r, 0);\n      }\n      _createClass(Nd, [{\n        key: \"raycastRoot\",\n        value: function raycastRoot(t, e, r, n, i, s) {\n          var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;\n          return $d([t, e, -100], [r, n, this.maximums[0] * a], i, s);\n        }\n      }, {\n        key: \"raycast\",\n        value: function raycast(t, e, r, n, i, s) {\n          var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;\n          if (!this.nodeCount) return null;\n          var o = this.raycastRoot(t, e, r, n, i, s, a);\n          if (null == o) return null;\n          var l = [],\n            u = [],\n            c = [],\n            h = [],\n            p = [{\n              idx: 0,\n              t: o,\n              nodex: 0,\n              nodey: 0,\n              depth: 0\n            }];\n          for (; p.length > 0;) {\n            var _p$pop = p.pop(),\n              _o52 = _p$pop.idx,\n              _f18 = _p$pop.t,\n              _d15 = _p$pop.nodex,\n              _y11 = _p$pop.nodey,\n              _m10 = _p$pop.depth;\n            if (this.leaves[_o52]) {\n              qd(_d15, _y11, _m10, t, e, r, n, c, h);\n              var _o53 = 1 << _m10,\n                _l46 = (_d15 + 0) / _o53,\n                _u44 = (_d15 + 1) / _o53,\n                _p27 = (_y11 + 0) / _o53,\n                _g11 = (_y11 + 1) / _o53,\n                _x11 = Zd(_l46, _p27, this.dem) * a,\n                _v10 = Zd(_u44, _p27, this.dem) * a,\n                _b9 = Zd(_u44, _g11, this.dem) * a,\n                _w9 = Zd(_l46, _g11, this.dem) * a,\n                _11 = Ud(c[0], c[1], _x11, h[0], c[1], _v10, h[0], h[1], _b9, i, s),\n                _A9 = Ud(h[0], h[1], _b9, c[0], h[1], _w9, c[0], c[1], _x11, i, s),\n                _S8 = Math.min(null !== _11 ? _11 : Number.MAX_VALUE, null !== _A9 ? _A9 : Number.MAX_VALUE);\n              if (_S8 !== Number.MAX_VALUE) return _S8;\n              {\n                var _t231 = Wo([], i, s, _f18);\n                if (Gd(_x11, _v10, _w9, _b9, Od(_t231[0], c[0], h[0]), Od(_t231[1], c[1], h[1])) >= _t231[2]) return _f18;\n              }\n              continue;\n            }\n            var _g12 = 0;\n            for (var _p28 = 0; _p28 < this._siblingOffset.length; _p28++) {\n              qd((_d15 << 1) + this._siblingOffset[_p28][0], (_y11 << 1) + this._siblingOffset[_p28][1], _m10 + 1, t, e, r, n, c, h), c[2] = -100, h[2] = this.maximums[this.childOffsets[_o52] + _p28] * a;\n              var _f19 = $d(c, h, i, s);\n              if (null != _f19) {\n                var _t232 = _f19;\n                l[_p28] = _t232;\n                var _e222 = !1;\n                for (var _r173 = 0; _r173 < _g12 && !_e222; _r173++) _t232 >= l[u[_r173]] && (u.splice(_r173, 0, _p28), _e222 = !0);\n                _e222 || (u[_g12] = _p28), _g12++;\n              }\n            }\n            for (var _t233 = 0; _t233 < _g12; _t233++) {\n              var _e223 = u[_t233];\n              p.push({\n                idx: this.childOffsets[_o52] + _e223,\n                t: l[_e223],\n                nodex: (_d15 << 1) + this._siblingOffset[_e223][0],\n                nodey: (_y11 << 1) + this._siblingOffset[_e223][1],\n                depth: _m10 + 1\n              });\n            }\n          }\n          return null;\n        }\n      }, {\n        key: \"_addNode\",\n        value: function _addNode(t, e, r) {\n          return this.minimums.push(t), this.maximums.push(e), this.leaves.push(r), this.childOffsets.push(0), this.nodeCount++;\n        }\n      }, {\n        key: \"_construct\",\n        value: function _construct(t, e, r, n, i) {\n          if (1 === t[n].isLeaf(e, r)) return;\n          this.childOffsets[i] || (this.childOffsets[i] = this.nodeCount);\n          var s = n - 1,\n            a = t[s];\n          var o = 0,\n            l = 0;\n          for (var _t234 = 0; _t234 < this._siblingOffset.length; _t234++) {\n            var _n126 = 2 * e + this._siblingOffset[_t234][0],\n              _i133 = 2 * r + this._siblingOffset[_t234][1],\n              _s96 = a.getElevation(_n126, _i133),\n              _u45 = a.isLeaf(_n126, _i133),\n              _c34 = this._addNode(_s96.min, _s96.max, _u45);\n            _u45 && (o |= 1 << _t234), l || (l = _c34);\n          }\n          for (var _n127 = 0; _n127 < this._siblingOffset.length; _n127++) o & 1 << _n127 || this._construct(t, 2 * e + this._siblingOffset[_n127][0], 2 * r + this._siblingOffset[_n127][1], s, l + _n127);\n        }\n      }]);\n      return Nd;\n    }();\n    function Gd(t, e, r, n, i, s) {\n      return Mr(Mr(t, r, s), Mr(e, n, s), i);\n    }\n    function Zd(t, e, r) {\n      var n = r.dim,\n        i = S(t * n - .5, 0, n - 1),\n        s = S(e * n - .5, 0, n - 1),\n        a = Math.floor(i),\n        o = Math.floor(s),\n        l = Math.min(a + 1, n - 1),\n        u = Math.min(o + 1, n - 1);\n      return Gd(r.get(a, o), r.get(l, o), r.get(a, u), r.get(l, u), i - a, s - o);\n    }\n    var Xd = {\n      mapbox: [6553.6, 25.6, .1, 1e4],\n      terrarium: [256, 1, 1 / 256, 32768]\n    };\n    function Kd(t, e, r) {\n      return (256 * t * 256 + 256 * e + r) / 10 - 1e4;\n    }\n    function Yd(t, e, r) {\n      return 256 * t + e + r / 256 - 32768;\n    }\n    var Hd = /*#__PURE__*/function () {\n      _createClass(Hd, [{\n        key: \"tree\",\n        get: function get() {\n          return this._tree || this._buildQuadTree(), this._tree;\n        }\n      }]);\n      function Hd(t, e, r) {\n        var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;\n        var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;\n        _classCallCheck(this, Hd);\n        if (this.uid = t, e.height !== e.width) throw new RangeError(\"DEM tiles must be square\");\n        if (r && \"mapbox\" !== r && \"terrarium\" !== r) return U(\"\\\"\".concat(r, \"\\\" is not a valid encoding type. Valid types include \\\"mapbox\\\" and \\\"terrarium\\\".\"));\n        this.stride = e.height;\n        var s = this.dim = e.height - 2,\n          a = new Uint32Array(e.data.buffer);\n        if (this.pixels = new Uint8Array(e.data.buffer), this.encoding = r || \"mapbox\", this.borderReady = n, !n) {\n          for (var _t235 = 0; _t235 < s; _t235++) a[this._idx(-1, _t235)] = a[this._idx(0, _t235)], a[this._idx(s, _t235)] = a[this._idx(s - 1, _t235)], a[this._idx(_t235, -1)] = a[this._idx(_t235, 0)], a[this._idx(_t235, s)] = a[this._idx(_t235, s - 1)];\n          a[this._idx(-1, -1)] = a[this._idx(0, 0)], a[this._idx(s, -1)] = a[this._idx(s - 1, 0)], a[this._idx(-1, s)] = a[this._idx(0, s - 1)], a[this._idx(s, s)] = a[this._idx(s - 1, s - 1)], i && this._buildQuadTree();\n        }\n      }\n      _createClass(Hd, [{\n        key: \"_buildQuadTree\",\n        value: function _buildQuadTree() {\n          this._tree = new Nd(this);\n        }\n      }, {\n        key: \"get\",\n        value: function get(t, e) {\n          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n          r && (t = S(t, -1, this.dim), e = S(e, -1, this.dim));\n          var n = 4 * this._idx(t, e);\n          return (\"terrarium\" === this.encoding ? Yd : Kd)(this.pixels[n], this.pixels[n + 1], this.pixels[n + 2]);\n        }\n      }, {\n        key: \"_idx\",\n        value: function _idx(t, e) {\n          if (t < -1 || t >= this.dim + 1 || e < -1 || e >= this.dim + 1) throw new RangeError(\"out of range source coordinates for DEM data\");\n          return (e + 1) * this.stride + (t + 1);\n        }\n      }, {\n        key: \"getPixels\",\n        value: function getPixels() {\n          return new Qu({\n            width: this.stride,\n            height: this.stride\n          }, this.pixels);\n        }\n      }, {\n        key: \"backfillBorder\",\n        value: function backfillBorder(t, e, r) {\n          if (this.dim !== t.dim) throw new Error(\"dem dimension mismatch\");\n          var n = e * this.dim,\n            i = e * this.dim + this.dim,\n            s = r * this.dim,\n            a = r * this.dim + this.dim;\n          switch (e) {\n            case -1:\n              n = i - 1;\n              break;\n            case 1:\n              i = n + 1;\n          }\n          switch (r) {\n            case -1:\n              s = a - 1;\n              break;\n            case 1:\n              a = s + 1;\n          }\n          var o = -e * this.dim,\n            l = -r * this.dim;\n          for (var _e224 = s; _e224 < a; _e224++) for (var _r174 = n; _r174 < i; _r174++) {\n            var _n128 = 4 * this._idx(_r174, _e224),\n              _i134 = 4 * this._idx(_r174 + o, _e224 + l);\n            this.pixels[_n128 + 0] = t.pixels[_i134 + 0], this.pixels[_n128 + 1] = t.pixels[_i134 + 1], this.pixels[_n128 + 2] = t.pixels[_i134 + 2], this.pixels[_n128 + 3] = t.pixels[_i134 + 3];\n          }\n        }\n      }, {\n        key: \"onDeserialize\",\n        value: function onDeserialize() {\n          this._tree && (this._tree.dem = this);\n        }\n      }, {\n        key: \"unpackVector\",\n        get: function get() {\n          return Xd[this.encoding];\n        }\n      }], [{\n        key: \"getUnpackVector\",\n        value: function getUnpackVector(t) {\n          return Xd[t];\n        }\n      }, {\n        key: \"pack\",\n        value: function pack(t, e) {\n          var r = [0, 0, 0, 0],\n            n = Hd.getUnpackVector(e);\n          var i = Math.floor((t + n[3]) / n[2]);\n          return r[2] = i % 256, i = Math.floor(i / 256), r[1] = i % 256, i = Math.floor(i / 256), r[0] = i, r;\n        }\n      }]);\n      return Hd;\n    }();\n    Oi(Hd, \"DEMData\"), Oi(Nd, \"DemMinMaxQuadTree\", {\n      omit: [\"dem\"]\n    });\n    var Wd = /*#__PURE__*/function () {\n      function Wd(t, e) {\n        _classCallCheck(this, Wd);\n        this.max = t, this.onRemove = e, this.reset();\n      }\n      _createClass(Wd, [{\n        key: \"reset\",\n        value: function reset() {\n          for (var _t236 in this.data) {\n            var _iterator149 = _createForOfIteratorHelper(this.data[_t236]),\n              _step149;\n            try {\n              for (_iterator149.s(); !(_step149 = _iterator149.n()).done;) {\n                var _e225 = _step149.value;\n                _e225.timeout && clearTimeout(_e225.timeout), this.onRemove(_e225.value);\n              }\n            } catch (err) {\n              _iterator149.e(err);\n            } finally {\n              _iterator149.f();\n            }\n          }\n          return this.data = {}, this.order = [], this;\n        }\n      }, {\n        key: \"add\",\n        value: function add(t, e, r) {\n          var _this39 = this;\n          var n = t.wrapped().key;\n          void 0 === this.data[n] && (this.data[n] = []);\n          var i = {\n            value: e,\n            timeout: void 0\n          };\n          if (void 0 !== r && (i.timeout = setTimeout(function () {\n            _this39.remove(t, i);\n          }, r)), this.data[n].push(i), this.order.push(n), this.order.length > this.max) {\n            var _t237 = this._getAndRemoveByKey(this.order[0]);\n            _t237 && this.onRemove(_t237);\n          }\n          return this;\n        }\n      }, {\n        key: \"has\",\n        value: function has(t) {\n          return t.wrapped().key in this.data;\n        }\n      }, {\n        key: \"getAndRemove\",\n        value: function getAndRemove(t) {\n          return this.has(t) ? this._getAndRemoveByKey(t.wrapped().key) : null;\n        }\n      }, {\n        key: \"_getAndRemoveByKey\",\n        value: function _getAndRemoveByKey(t) {\n          var e = this.data[t].shift();\n          return e.timeout && clearTimeout(e.timeout), 0 === this.data[t].length && delete this.data[t], this.order.splice(this.order.indexOf(t), 1), e.value;\n        }\n      }, {\n        key: \"getByKey\",\n        value: function getByKey(t) {\n          var e = this.data[t];\n          return e ? e[0].value : null;\n        }\n      }, {\n        key: \"get\",\n        value: function get(t) {\n          return this.has(t) ? this.data[t.wrapped().key][0].value : null;\n        }\n      }, {\n        key: \"remove\",\n        value: function remove(t, e) {\n          if (!this.has(t)) return this;\n          var r = t.wrapped().key,\n            n = void 0 === e ? 0 : this.data[r].indexOf(e),\n            i = this.data[r][n];\n          return this.data[r].splice(n, 1), i.timeout && clearTimeout(i.timeout), 0 === this.data[r].length && delete this.data[r], this.onRemove(i.value), this.order.splice(this.order.indexOf(r), 1), this;\n        }\n      }, {\n        key: \"setMaxSize\",\n        value: function setMaxSize(t) {\n          for (this.max = t; this.order.length > this.max;) {\n            var _t238 = this._getAndRemoveByKey(this.order[0]);\n            _t238 && this.onRemove(_t238);\n          }\n          return this;\n        }\n      }, {\n        key: \"filter\",\n        value: function filter(t) {\n          var e = [];\n          for (var _r175 in this.data) {\n            var _iterator150 = _createForOfIteratorHelper(this.data[_r175]),\n              _step150;\n            try {\n              for (_iterator150.s(); !(_step150 = _iterator150.n()).done;) {\n                var _n129 = _step150.value;\n                t(_n129.value) || e.push(_n129);\n              }\n            } catch (err) {\n              _iterator150.e(err);\n            } finally {\n              _iterator150.f();\n            }\n          }\n          for (var _i135 = 0, _e226 = e; _i135 < _e226.length; _i135++) {\n            var _t239 = _e226[_i135];\n            this.remove(_t239.value.tileID, _t239);\n          }\n        }\n      }]);\n      return Wd;\n    }();\n    var Jd = function Jd(t, e, r) {\n      _classCallCheck(this, Jd);\n      this.func = t, this.mask = e, this.range = r;\n    };\n    Jd.ReadOnly = !1, Jd.ReadWrite = !0, Jd.disabled = new Jd(519, Jd.ReadOnly, [0, 1]);\n    var Qd = 7680;\n    var ty = function ty(t, e, r, n, i, s) {\n      _classCallCheck(this, ty);\n      this.test = t, this.ref = e, this.mask = r, this.fail = n, this.depthFail = i, this.pass = s;\n    };\n    ty.disabled = new ty({\n      func: 519,\n      mask: 0\n    }, 0, 0, Qd, Qd, Qd);\n    var ey = function ey(t, e, r) {\n      _classCallCheck(this, ey);\n      this.blendFunction = t, this.blendColor = e, this.mask = r;\n    };\n    ey.Replace = [1, 0], ey.disabled = new ey(ey.Replace, Me.transparent, [!1, !1, !1, !1]), ey.unblended = new ey(ey.Replace, Me.transparent, [!0, !0, !0, !0]), ey.alphaBlended = new ey([1, 771], Me.transparent, [!0, !0, !0, !0]);\n    var ry = 1029,\n      ny = 2305;\n    var iy = function iy(t, e, r) {\n      _classCallCheck(this, iy);\n      this.enable = t, this.mode = e, this.frontFace = r;\n    };\n    iy.disabled = new iy(!1, ry, ny), iy.backCCW = new iy(!0, ry, ny), iy.backCW = new iy(!0, ry, 2304), iy.frontCW = new iy(!0, 1028, 2304), iy.frontCCW = new iy(!0, 1028, ny);\n    var sy = /*#__PURE__*/function (_Yt2) {\n      _inherits(sy, _Yt2);\n      function sy(t, e, r) {\n        var _this40;\n        _classCallCheck(this, sy);\n        _this40 = _possibleConstructorReturn(this, _getPrototypeOf(sy).call(this)), _this40.id = t, _this40._onlySymbols = r, e.on(\"data\", function (t) {\n          \"source\" === t.dataType && \"metadata\" === t.sourceDataType && (_this40._sourceLoaded = !0), _this40._sourceLoaded && !_this40._paused && \"source\" === t.dataType && \"content\" === t.sourceDataType && (_this40.reload(), _this40.transform && _this40.update(_this40.transform));\n        }), e.on(\"error\", function () {\n          _this40._sourceErrored = !0;\n        }), _this40._source = e, _this40._tiles = {}, _this40._cache = new Wd(0, _this40._unloadTile.bind(_assertThisInitialized(_assertThisInitialized(_this40)))), _this40._timers = {}, _this40._cacheTimers = {}, _this40._minTileCacheSize = e.minTileCacheSize, _this40._maxTileCacheSize = e.maxTileCacheSize, _this40._loadedParentTiles = {}, _this40._coveredTiles = {}, _this40._state = new Rd(), _this40._isRaster = \"raster\" === _this40._source.type || \"raster-dem\" === _this40._source.type || \"custom\" === _this40._source.type && \"raster\" === _this40._source._dataType;\n        return _this40;\n      }\n      _createClass(sy, [{\n        key: \"onAdd\",\n        value: function onAdd(t) {\n          this.map = t, this._minTileCacheSize = void 0 === this._minTileCacheSize && t ? t._minTileCacheSize : this._minTileCacheSize, this._maxTileCacheSize = void 0 === this._maxTileCacheSize && t ? t._maxTileCacheSize : this._maxTileCacheSize;\n        }\n      }, {\n        key: \"loaded\",\n        value: function loaded() {\n          if (this._sourceErrored) return !0;\n          if (!this._sourceLoaded) return !1;\n          if (!this._source.loaded()) return !1;\n          for (var _t240 in this._tiles) {\n            var _e227 = this._tiles[_t240];\n            if (\"loaded\" !== _e227.state && \"errored\" !== _e227.state) return !1;\n          }\n          return !0;\n        }\n      }, {\n        key: \"getSource\",\n        value: function getSource() {\n          return this._source;\n        }\n      }, {\n        key: \"pause\",\n        value: function pause() {\n          this._paused = !0;\n        }\n      }, {\n        key: \"resume\",\n        value: function resume() {\n          if (!this._paused) return;\n          var t = this._shouldReloadOnResume;\n          this._paused = !1, this._shouldReloadOnResume = !1, t && this.reload(), this.transform && this.update(this.transform);\n        }\n      }, {\n        key: \"_loadTile\",\n        value: function _loadTile(t, e) {\n          return t.isSymbolTile = this._onlySymbols, this._source.loadTile(t, e);\n        }\n      }, {\n        key: \"_unloadTile\",\n        value: function _unloadTile(t) {\n          if (this._source.unloadTile) return this._source.unloadTile(t, function () {});\n        }\n      }, {\n        key: \"_abortTile\",\n        value: function _abortTile(t) {\n          if (this._source.abortTile) return this._source.abortTile(t, function () {});\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return this._source.serialize();\n        }\n      }, {\n        key: \"prepare\",\n        value: function prepare(t) {\n          this._source.prepare && this._source.prepare(), this._state.coalesceChanges(this._tiles, this.map ? this.map.painter : null);\n          for (var _e228 in this._tiles) {\n            var _r176 = this._tiles[_e228];\n            _r176.upload(t), _r176.prepare(this.map.style.imageManager);\n          }\n        }\n      }, {\n        key: \"getIds\",\n        value: function getIds() {\n          return T(this._tiles).map(function (t) {\n            return t.tileID;\n          }).sort(ay).map(function (t) {\n            return t.key;\n          });\n        }\n      }, {\n        key: \"getRenderableIds\",\n        value: function getRenderableIds(t) {\n          var _this41 = this;\n          var e = [];\n          for (var _r177 in this._tiles) this._isIdRenderable(+_r177, t) && e.push(this._tiles[_r177]);\n          return t ? e.sort(function (t, e) {\n            var r = t.tileID,\n              n = e.tileID,\n              i = new d(r.canonical.x, r.canonical.y)._rotate(_this41.transform.angle),\n              s = new d(n.canonical.x, n.canonical.y)._rotate(_this41.transform.angle);\n            return r.overscaledZ - n.overscaledZ || s.y - i.y || s.x - i.x;\n          }).map(function (t) {\n            return t.tileID.key;\n          }) : e.map(function (t) {\n            return t.tileID;\n          }).sort(ay).map(function (t) {\n            return t.key;\n          });\n        }\n      }, {\n        key: \"hasRenderableParent\",\n        value: function hasRenderableParent(t) {\n          var e = this.findLoadedParent(t, 0);\n          return !!e && this._isIdRenderable(e.tileID.key);\n        }\n      }, {\n        key: \"_isIdRenderable\",\n        value: function _isIdRenderable(t, e) {\n          return this._tiles[t] && this._tiles[t].hasData() && !this._coveredTiles[t] && (e || !this._tiles[t].holdingForFade());\n        }\n      }, {\n        key: \"reload\",\n        value: function reload() {\n          if (this._paused) this._shouldReloadOnResume = !0;else {\n            this._cache.reset();\n            for (var _t241 in this._tiles) \"errored\" !== this._tiles[_t241].state && this._reloadTile(+_t241, \"reloading\");\n          }\n        }\n      }, {\n        key: \"_reloadTile\",\n        value: function _reloadTile(t, e) {\n          var r = this._tiles[t];\n          r && (\"loading\" !== r.state && (r.state = e), this._loadTile(r, this._tileLoaded.bind(this, r, t, e)));\n        }\n      }, {\n        key: \"_tileLoaded\",\n        value: function _tileLoaded(t, e, r, n) {\n          if (n) {\n            if (t.state = \"errored\", 404 !== n.status) this._source.fire(new Kt(n, {\n              tile: t\n            }));else if (\"raster-dem\" === this._source.type && this.usedForTerrain && this.map.painter.terrain) {\n              var _t242 = this.map.painter.terrain;\n              this.update(this.transform, _t242.getScaledDemTileSize(), !0), _t242.resetTileLookupCache(this.id);\n            } else this.update(this.transform);\n          } else t.timeAdded = Nt.now(), \"expired\" === r && (t.refreshedUponExpiration = !0), this._setTileReloadTimer(e, t), \"raster-dem\" === this._source.type && t.dem && this._backfillDEM(t), this._state.initializeTileState(t, this.map ? this.map.painter : null), this._source.fire(new Xt(\"data\", {\n            dataType: \"source\",\n            tile: t,\n            coord: t.tileID,\n            sourceCacheId: this.id\n          }));\n        }\n      }, {\n        key: \"_backfillDEM\",\n        value: function _backfillDEM(t) {\n          var e = this.getRenderableIds();\n          for (var _n130 = 0; _n130 < e.length; _n130++) {\n            var _i136 = e[_n130];\n            if (t.neighboringTiles && t.neighboringTiles[_i136]) {\n              var _e229 = this.getTileByID(_i136);\n              r(t, _e229), r(_e229, t);\n            }\n          }\n          function r(t, e) {\n            if (!t.dem || t.dem.borderReady) return;\n            t.needsHillshadePrepare = !0, t.needsDEMTextureUpload = !0;\n            var r = e.tileID.canonical.x - t.tileID.canonical.x;\n            var n = e.tileID.canonical.y - t.tileID.canonical.y,\n              i = Math.pow(2, t.tileID.canonical.z),\n              s = e.tileID.key;\n            0 === r && 0 === n || Math.abs(n) > 1 || (Math.abs(r) > 1 && (1 === Math.abs(r + i) ? r += i : 1 === Math.abs(r - i) && (r -= i)), e.dem && t.dem && (t.dem.backfillBorder(e.dem, r, n), t.neighboringTiles && t.neighboringTiles[s] && (t.neighboringTiles[s].backfilled = !0)));\n          }\n        }\n      }, {\n        key: \"getTile\",\n        value: function getTile(t) {\n          return this.getTileByID(t.key);\n        }\n      }, {\n        key: \"getTileByID\",\n        value: function getTileByID(t) {\n          return this._tiles[t];\n        }\n      }, {\n        key: \"_retainLoadedChildren\",\n        value: function _retainLoadedChildren(t, e, r, n) {\n          for (var _i137 in this._tiles) {\n            var _s97 = this._tiles[_i137];\n            if (n[_i137] || !_s97.hasData() || _s97.tileID.overscaledZ <= e || _s97.tileID.overscaledZ > r) continue;\n            var _a89 = _s97.tileID;\n            for (; _s97 && _s97.tileID.overscaledZ > e + 1;) {\n              var _t243 = _s97.tileID.scaledTo(_s97.tileID.overscaledZ - 1);\n              _s97 = this._tiles[_t243.key], _s97 && _s97.hasData() && (_a89 = _t243);\n            }\n            var _o54 = _a89;\n            for (; _o54.overscaledZ > e;) if (_o54 = _o54.scaledTo(_o54.overscaledZ - 1), t[_o54.key]) {\n              n[_a89.key] = _a89;\n              break;\n            }\n          }\n        }\n      }, {\n        key: \"findLoadedParent\",\n        value: function findLoadedParent(t, e) {\n          if (t.key in this._loadedParentTiles) {\n            var _r178 = this._loadedParentTiles[t.key];\n            return _r178 && _r178.tileID.overscaledZ >= e ? _r178 : null;\n          }\n          for (var _r179 = t.overscaledZ - 1; _r179 >= e; _r179--) {\n            var _e230 = t.scaledTo(_r179),\n              _n131 = this._getLoadedTile(_e230);\n            if (_n131) return _n131;\n          }\n        }\n      }, {\n        key: \"_getLoadedTile\",\n        value: function _getLoadedTile(t) {\n          var e = this._tiles[t.key];\n          return e && e.hasData() ? e : this._cache.getByKey(this._source.reparseOverscaled ? t.wrapped().key : t.canonical.key);\n        }\n      }, {\n        key: \"updateCacheSize\",\n        value: function updateCacheSize(t, e) {\n          e = e || this._source.tileSize;\n          var r = Math.ceil(t.width / e) + 1,\n            n = Math.ceil(t.height / e) + 1,\n            i = Math.floor(r * n * 5),\n            s = \"number\" == typeof this._minTileCacheSize ? Math.max(this._minTileCacheSize, i) : i,\n            a = \"number\" == typeof this._maxTileCacheSize ? Math.min(this._maxTileCacheSize, s) : s;\n          this._cache.setMaxSize(a);\n        }\n      }, {\n        key: \"handleWrapJump\",\n        value: function handleWrapJump(t) {\n          var e = Math.round((t - (void 0 === this._prevLng ? t : this._prevLng)) / 360);\n          if (this._prevLng = t, e) {\n            var _t244 = {};\n            for (var _r180 in this._tiles) {\n              var _n132 = this._tiles[_r180];\n              _n132.tileID = _n132.tileID.unwrapTo(_n132.tileID.wrap + e), _t244[_n132.tileID.key] = _n132;\n            }\n            this._tiles = _t244;\n            for (var _t245 in this._timers) clearTimeout(this._timers[_t245]), delete this._timers[_t245];\n            for (var _t246 in this._tiles) this._setTileReloadTimer(+_t246, this._tiles[_t246]);\n          }\n        }\n      }, {\n        key: \"update\",\n        value: function update(t, e, r) {\n          var _this42 = this;\n          if (this.transform = t, !this._sourceLoaded || this._paused || this.transform.freezeTileCoverage) return;\n          if (this.usedForTerrain && !r) return;\n          var n;\n          this.updateCacheSize(t, e), \"globe\" !== this.transform.projection.name && this.handleWrapJump(this.transform.center.lng), this._coveredTiles = {}, this.used || this.usedForTerrain ? this._source.tileID ? n = t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function (t) {\n            return new Mh(t.canonical.z, t.wrap, t.canonical.z, t.canonical.x, t.canonical.y);\n          }) : (n = t.coveringTiles({\n            tileSize: e || this._source.tileSize,\n            minzoom: this._source.minzoom,\n            maxzoom: this._source.maxzoom,\n            roundZoom: this._source.roundZoom && !r,\n            reparseOverscaled: this._source.reparseOverscaled,\n            isTerrainDEM: this.usedForTerrain\n          }), this._source.hasTile && (n = n.filter(function (t) {\n            return _this42._source.hasTile(t);\n          }))) : n = [];\n          var i = this._updateRetainedTiles(n);\n          if (oy(this._source.type) && 0 !== n.length) {\n            var _t247 = {},\n              _e231 = {},\n              _r181 = Object.keys(i);\n            for (var _i138 = 0, _r182 = _r181; _i138 < _r182.length; _i138++) {\n              var _n133 = _r182[_i138];\n              var _r183 = i[_n133],\n                _s98 = this._tiles[_n133];\n              if (!_s98 || _s98.fadeEndTime && _s98.fadeEndTime <= Nt.now()) continue;\n              var _a90 = this.findLoadedParent(_r183, Math.max(_r183.overscaledZ - sy.maxOverzooming, this._source.minzoom));\n              _a90 && (this._addTile(_a90.tileID), _t247[_a90.tileID.key] = _a90.tileID), _e231[_n133] = _r183;\n            }\n            var _s99 = n[n.length - 1].overscaledZ;\n            for (var _t248 in this._tiles) {\n              var _r184 = this._tiles[_t248];\n              if (i[_t248] || !_r184.hasData()) continue;\n              var _n134 = _r184.tileID;\n              for (; _n134.overscaledZ > _s99;) {\n                _n134 = _n134.scaledTo(_n134.overscaledZ - 1);\n                var _s100 = this._tiles[_n134.key];\n                if (_s100 && _s100.hasData() && _e231[_n134.key]) {\n                  i[_t248] = _r184.tileID;\n                  break;\n                }\n              }\n            }\n            for (var _e232 in _t247) i[_e232] || (this._coveredTiles[_e232] = !0, i[_e232] = _t247[_e232]);\n          }\n          for (var _t249 in i) this._tiles[_t249].clearFadeHold();\n          var s = function (t, e) {\n            var r = [];\n            for (var _n135 in t) _n135 in e || r.push(_n135);\n            return r;\n          }(this._tiles, i);\n          var _iterator151 = _createForOfIteratorHelper(s),\n            _step151;\n          try {\n            for (_iterator151.s(); !(_step151 = _iterator151.n()).done;) {\n              var _t250 = _step151.value;\n              var _e233 = this._tiles[_t250];\n              _e233.hasSymbolBuckets && !_e233.holdingForFade() ? _e233.setHoldDuration(this.map._fadeDuration) : _e233.hasSymbolBuckets && !_e233.symbolFadeFinished() || this._removeTile(+_t250);\n            }\n          } catch (err) {\n            _iterator151.e(err);\n          } finally {\n            _iterator151.f();\n          }\n          this._updateLoadedParentTileCache(), this._onlySymbols && this._source.afterUpdate && this._source.afterUpdate();\n        }\n      }, {\n        key: \"releaseSymbolFadeTiles\",\n        value: function releaseSymbolFadeTiles() {\n          for (var _t251 in this._tiles) this._tiles[_t251].holdingForFade() && this._removeTile(+_t251);\n        }\n      }, {\n        key: \"_updateRetainedTiles\",\n        value: function _updateRetainedTiles(t) {\n          var e = {};\n          if (0 === t.length) return e;\n          var r = {},\n            n = t.reduce(function (t, e) {\n              return Math.min(t, e.overscaledZ);\n            }, 1 / 0),\n            i = t[0].overscaledZ,\n            s = Math.max(i - sy.maxOverzooming, this._source.minzoom),\n            a = Math.max(i + sy.maxUnderzooming, this._source.minzoom),\n            o = {};\n          var _iterator152 = _createForOfIteratorHelper(t),\n            _step152;\n          try {\n            for (_iterator152.s(); !(_step152 = _iterator152.n()).done;) {\n              var _r185 = _step152.value;\n              var _t252 = this._addTile(_r185);\n              e[_r185.key] = _r185, _t252.hasData() || n < this._source.maxzoom && (o[_r185.key] = _r185);\n            }\n          } catch (err) {\n            _iterator152.e(err);\n          } finally {\n            _iterator152.f();\n          }\n          this._retainLoadedChildren(o, n, a, e);\n          var _iterator153 = _createForOfIteratorHelper(t),\n            _step153;\n          try {\n            for (_iterator153.s(); !(_step153 = _iterator153.n()).done;) {\n              var _n136 = _step153.value;\n              var _t253 = this._tiles[_n136.key];\n              if (_t253.hasData()) continue;\n              if (_n136.canonical.z >= this._source.maxzoom) {\n                var _t254 = _n136.children(this._source.maxzoom)[0],\n                  _r186 = this.getTile(_t254);\n                if (_r186 && _r186.hasData()) {\n                  e[_t254.key] = _t254;\n                  continue;\n                }\n              } else {\n                var _t255 = _n136.children(this._source.maxzoom);\n                if (e[_t255[0].key] && e[_t255[1].key] && e[_t255[2].key] && e[_t255[3].key]) continue;\n              }\n              var _i139 = _t253.wasRequested();\n              for (var _a91 = _n136.overscaledZ - 1; _a91 >= s; --_a91) {\n                var _s101 = _n136.scaledTo(_a91);\n                if (r[_s101.key]) break;\n                if (r[_s101.key] = !0, _t253 = this.getTile(_s101), !_t253 && _i139 && (_t253 = this._addTile(_s101)), _t253 && (e[_s101.key] = _s101, _i139 = _t253.wasRequested(), _t253.hasData())) break;\n              }\n            }\n          } catch (err) {\n            _iterator153.e(err);\n          } finally {\n            _iterator153.f();\n          }\n          return e;\n        }\n      }, {\n        key: \"_updateLoadedParentTileCache\",\n        value: function _updateLoadedParentTileCache() {\n          this._loadedParentTiles = {};\n          for (var _t256 in this._tiles) {\n            var _e234 = [];\n            var _r187 = void 0,\n              _n137 = this._tiles[_t256].tileID;\n            for (; _n137.overscaledZ > 0;) {\n              if (_n137.key in this._loadedParentTiles) {\n                _r187 = this._loadedParentTiles[_n137.key];\n                break;\n              }\n              _e234.push(_n137.key);\n              var _t257 = _n137.scaledTo(_n137.overscaledZ - 1);\n              if (_r187 = this._getLoadedTile(_t257), _r187) break;\n              _n137 = _t257;\n            }\n            for (var _i140 = 0, _e235 = _e234; _i140 < _e235.length; _i140++) {\n              var _t258 = _e235[_i140];\n              this._loadedParentTiles[_t258] = _r187;\n            }\n          }\n        }\n      }, {\n        key: \"_addTile\",\n        value: function _addTile(t) {\n          var e = this._tiles[t.key];\n          if (e) return e;\n          e = this._cache.getAndRemove(t), e && (this._setTileReloadTimer(t.key, e), e.tileID = t, this._state.initializeTileState(e, this.map ? this.map.painter : null), this._cacheTimers[t.key] && (clearTimeout(this._cacheTimers[t.key]), delete this._cacheTimers[t.key], this._setTileReloadTimer(t.key, e)));\n          var r = Boolean(e);\n          if (!r) {\n            var _r188 = this.map ? this.map.painter : null;\n            e = new Fd(t, this._source.tileSize * t.overscaleFactor(), this.transform.tileZoom, _r188, this._isRaster), this._loadTile(e, this._tileLoaded.bind(this, e, t.key, e.state));\n          }\n          return e ? (e.uses++, this._tiles[t.key] = e, r || this._source.fire(new Xt(\"dataloading\", {\n            tile: e,\n            coord: e.tileID,\n            dataType: \"source\"\n          })), e) : null;\n        }\n      }, {\n        key: \"_setTileReloadTimer\",\n        value: function _setTileReloadTimer(t, e) {\n          var _this43 = this;\n          t in this._timers && (clearTimeout(this._timers[t]), delete this._timers[t]);\n          var r = e.getExpiryTimeout();\n          r && (this._timers[t] = setTimeout(function () {\n            _this43._reloadTile(t, \"expired\"), delete _this43._timers[t];\n          }, r));\n        }\n      }, {\n        key: \"_removeTile\",\n        value: function _removeTile(t) {\n          var e = this._tiles[t];\n          e && (e.uses--, delete this._tiles[t], this._timers[t] && (clearTimeout(this._timers[t]), delete this._timers[t]), e.uses > 0 || (e.hasData() && \"reloading\" !== e.state ? this._cache.add(e.tileID, e, e.getExpiryTimeout()) : (e.aborted = !0, this._abortTile(e), this._unloadTile(e))));\n        }\n      }, {\n        key: \"clearTiles\",\n        value: function clearTiles() {\n          this._shouldReloadOnResume = !1, this._paused = !1;\n          for (var _t259 in this._tiles) this._removeTile(+_t259);\n          this._source._clear && this._source._clear(), this._cache.reset(), this.map && this.usedForTerrain && this.map.painter.terrain && this.map.painter.terrain.resetTileLookupCache(this.id);\n        }\n      }, {\n        key: \"tilesIn\",\n        value: function tilesIn(t, e, r) {\n          var n = [],\n            i = this.transform;\n          if (!i) return n;\n          var s = \"globe\" === i.projection.name,\n            a = iu(i.center.lng);\n          for (var _o55 in this._tiles) {\n            var _l47 = this._tiles[_o55];\n            if (r && _l47.clearQueryDebugViz(), _l47.holdingForFade()) continue;\n            var _u46 = void 0;\n            if (s) {\n              var _t260 = _l47.tileID.canonical;\n              if (0 === _t260.z) {\n                var _e236 = [Math.abs(S.apply(void 0, [a].concat(_toConsumableArray(ly(_t260, -1)))) - a), Math.abs(S.apply(void 0, [a].concat(_toConsumableArray(ly(_t260, 1)))) - a)];\n                _u46 = [0, 2 * _e236.indexOf(Math.min.apply(Math, _e236)) - 1];\n              } else {\n                var _e237 = [Math.abs(S.apply(void 0, [a].concat(_toConsumableArray(ly(_t260, -1)))) - a), Math.abs(S.apply(void 0, [a].concat(_toConsumableArray(ly(_t260, 0)))) - a), Math.abs(S.apply(void 0, [a].concat(_toConsumableArray(ly(_t260, 1)))) - a)];\n                _u46 = [_e237.indexOf(Math.min.apply(Math, _e237)) - 1];\n              }\n            } else _u46 = [0];\n            var _iterator154 = _createForOfIteratorHelper(_u46),\n              _step154;\n            try {\n              for (_iterator154.s(); !(_step154 = _iterator154.n()).done;) {\n                var _r189 = _step154.value;\n                var _s102 = t.containsTile(_l47, i, e, _r189);\n                _s102 && n.push(_s102);\n              }\n            } catch (err) {\n              _iterator154.e(err);\n            } finally {\n              _iterator154.f();\n            }\n          }\n          return n;\n        }\n      }, {\n        key: \"getVisibleCoordinates\",\n        value: function getVisibleCoordinates(t) {\n          var _this44 = this;\n          var e = this.getRenderableIds(t).map(function (t) {\n            return _this44._tiles[t].tileID;\n          });\n          var _iterator155 = _createForOfIteratorHelper(e),\n            _step155;\n          try {\n            for (_iterator155.s(); !(_step155 = _iterator155.n()).done;) {\n              var _t261 = _step155.value;\n              _t261.projMatrix = this.transform.calculateProjMatrix(_t261.toUnwrapped());\n            }\n          } catch (err) {\n            _iterator155.e(err);\n          } finally {\n            _iterator155.f();\n          }\n          return e;\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          if (this._source.hasTransition()) return !0;\n          if (oy(this._source.type)) for (var _t262 in this._tiles) {\n            var _e238 = this._tiles[_t262];\n            if (void 0 !== _e238.fadeEndTime && _e238.fadeEndTime >= Nt.now()) return !0;\n          }\n          return !1;\n        }\n      }, {\n        key: \"setFeatureState\",\n        value: function setFeatureState(t, e, r) {\n          this._state.updateState(t = t || \"_geojsonTileLayer\", e, r);\n        }\n      }, {\n        key: \"removeFeatureState\",\n        value: function removeFeatureState(t, e, r) {\n          this._state.removeFeatureState(t = t || \"_geojsonTileLayer\", e, r);\n        }\n      }, {\n        key: \"getFeatureState\",\n        value: function getFeatureState(t, e) {\n          return this._state.getState(t = t || \"_geojsonTileLayer\", e);\n        }\n      }, {\n        key: \"setDependencies\",\n        value: function setDependencies(t, e, r) {\n          var n = this._tiles[t];\n          n && n.setDependencies(e, r);\n        }\n      }, {\n        key: \"reloadTilesForDependencies\",\n        value: function reloadTilesForDependencies(t, e) {\n          for (var _r190 in this._tiles) this._tiles[_r190].hasDependency(t, e) && this._reloadTile(+_r190, \"reloading\");\n          this._cache.filter(function (r) {\n            return !r.hasDependency(t, e);\n          });\n        }\n      }, {\n        key: \"_preloadTiles\",\n        value: function _preloadTiles(t, e) {\n          var _this45 = this;\n          var r = new Map(),\n            n = Array.isArray(t) ? t : [t],\n            i = this.map.painter.terrain,\n            s = this.usedForTerrain && i ? i.getScaledDemTileSize() : this._source.tileSize;\n          var _iterator156 = _createForOfIteratorHelper(n),\n            _step156;\n          try {\n            for (_iterator156.s(); !(_step156 = _iterator156.n()).done;) {\n              var _t263 = _step156.value;\n              var _e239 = _t263.coveringTiles({\n                tileSize: s,\n                minzoom: this._source.minzoom,\n                maxzoom: this._source.maxzoom,\n                roundZoom: this._source.roundZoom && !this.usedForTerrain,\n                reparseOverscaled: this._source.reparseOverscaled,\n                isTerrainDEM: this.usedForTerrain\n              });\n              var _iterator157 = _createForOfIteratorHelper(_e239),\n                _step157;\n              try {\n                for (_iterator157.s(); !(_step157 = _iterator157.n()).done;) {\n                  var _t264 = _step157.value;\n                  r.set(_t264.key, _t264);\n                }\n              } catch (err) {\n                _iterator157.e(err);\n              } finally {\n                _iterator157.f();\n              }\n              this.usedForTerrain && _t263.updateElevation(!1);\n            }\n          } catch (err) {\n            _iterator156.e(err);\n          } finally {\n            _iterator156.f();\n          }\n          M(Array.from(r.values()), function (t, e) {\n            var r = new Fd(t, _this45._source.tileSize * t.overscaleFactor(), _this45.transform.tileZoom, _this45.map.painter, _this45._isRaster);\n            _this45._loadTile(r, function (t) {\n              \"raster-dem\" === _this45._source.type && r.dem && _this45._backfillDEM(r), e(t, r);\n            });\n          }, e);\n        }\n      }]);\n      return sy;\n    }(Yt);\n    function ay(t, e) {\n      var r = Math.abs(2 * t.wrap) - +(t.wrap < 0),\n        n = Math.abs(2 * e.wrap) - +(e.wrap < 0);\n      return t.overscaledZ - e.overscaledZ || n - r || e.canonical.y - t.canonical.y || e.canonical.x - t.canonical.x;\n    }\n    function oy(t) {\n      return \"raster\" === t || \"image\" === t || \"video\" === t || \"custom\" === t;\n    }\n    function ly(t, e) {\n      var r = 1 << t.z;\n      return [t.x / r + e, (t.x + 1) / r + e];\n    }\n    sy.maxOverzooming = 10, sy.maxUnderzooming = 3;\n    var uy = /*#__PURE__*/function () {\n      function uy(t, e, r) {\n        _classCallCheck(this, uy);\n        this._demTile = t, this._dem = this._demTile.dem, this._scale = e, this._offset = r;\n      }\n      _createClass(uy, [{\n        key: \"tileCoordToPixel\",\n        value: function tileCoordToPixel(t, e) {\n          var r = e * this._scale + this._offset[1],\n            n = Math.floor(t * this._scale + this._offset[0]),\n            i = Math.floor(r);\n          return new d(n, i);\n        }\n      }, {\n        key: \"getElevationAt\",\n        value: function getElevationAt(t, e, r, n) {\n          var i = t * this._scale + this._offset[0],\n            s = e * this._scale + this._offset[1],\n            a = Math.floor(i),\n            o = Math.floor(s),\n            l = this._dem;\n          return n = !!n, r ? Mr(Mr(l.get(a, o, n), l.get(a, o + 1, n), s - o), Mr(l.get(a + 1, o, n), l.get(a + 1, o + 1, n), s - o), i - a) : l.get(a, o, n);\n        }\n      }, {\n        key: \"getElevationAtPixel\",\n        value: function getElevationAtPixel(t, e, r) {\n          return this._dem.get(t, e, !!r);\n        }\n      }, {\n        key: \"getMeterToDEM\",\n        value: function getMeterToDEM(t) {\n          return (1 << this._demTile.tileID.canonical.z) * au(1, t) * this._dem.stride;\n        }\n      }], [{\n        key: \"create\",\n        value: function create(t, e, r) {\n          var n = r || t.findDEMTileFor(e);\n          if (!n || !n.dem) return;\n          var i = n.dem,\n            s = n.tileID,\n            a = 1 << e.canonical.z - s.canonical.z;\n          return new uy(n, n.tileSize / ko / a, [(e.canonical.x / a - s.canonical.x) * i.dim, (e.canonical.y / a - s.canonical.y) * i.dim]);\n        }\n      }]);\n      return uy;\n    }();\n    var cy = /*#__PURE__*/function () {\n      function cy(t, e) {\n        _classCallCheck(this, cy);\n        this.tileID = t, this.x = t.canonical.x, this.y = t.canonical.y, this.z = t.canonical.z, this.grid = new ji(ko, 16, 0), this.featureIndexArray = new ja(), this.promoteId = e;\n      }\n      _createClass(cy, [{\n        key: \"insert\",\n        value: function insert(t, e, r, n, i) {\n          var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n          var a = this.featureIndexArray.length;\n          this.featureIndexArray.emplaceBack(r, n, i, s);\n          var o = this.grid;\n          for (var _t265 = 0; _t265 < e.length; _t265++) {\n            var _r191 = e[_t265],\n              _n138 = [1 / 0, 1 / 0, -1 / 0, -1 / 0];\n            for (var _t266 = 0; _t266 < _r191.length; _t266++) {\n              var _e240 = _r191[_t266];\n              _n138[0] = Math.min(_n138[0], _e240.x), _n138[1] = Math.min(_n138[1], _e240.y), _n138[2] = Math.max(_n138[2], _e240.x), _n138[3] = Math.max(_n138[3], _e240.y);\n            }\n            _n138[0] < ko && _n138[1] < ko && _n138[2] >= 0 && _n138[3] >= 0 && o.insert(a, _n138[0], _n138[1], _n138[2], _n138[3]);\n          }\n        }\n      }, {\n        key: \"loadVTLayers\",\n        value: function loadVTLayers() {\n          if (!this.vtLayers) {\n            this.vtLayers = new sh(new op(this.rawTileData)).layers, this.sourceLayerCoder = new kd(this.vtLayers ? Object.keys(this.vtLayers).sort() : [\"_geojsonTileLayer\"]), this.vtFeatures = {};\n            for (var _t267 in this.vtLayers) this.vtFeatures[_t267] = [];\n          }\n          return this.vtLayers;\n        }\n      }, {\n        key: \"query\",\n        value: function query(t, e, r, n) {\n          var _this46 = this;\n          this.loadVTLayers();\n          var i = t.params || {},\n            s = ai(i.filter),\n            a = t.tileResult,\n            o = t.transform,\n            l = a.bufferedTilespaceBounds,\n            u = this.grid.query(l.min.x, l.min.y, l.max.x, l.max.y, function (t, e, r, n) {\n              return Vu(a.bufferedTilespaceGeometry, t, e, r, n);\n            });\n          u.sort(py);\n          var c = null;\n          o.elevation && u.length > 0 && (c = uy.create(o.elevation, this.tileID));\n          var h = {};\n          var p;\n          var _loop7 = function _loop7() {\n            var l = u[_o56];\n            if (l === p) return \"continue\";\n            p = l;\n            var f = _this46.featureIndexArray.get(l);\n            var d = null;\n            _this46.loadMatchingFeature(h, f, s, i.layers, i.availableImages, e, r, n, function (e, r, n) {\n              var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n              return d || (d = bu(e, _this46.tileID.canonical, t.tileTransform)), r.queryIntersectsFeature(a, e, n, d, _this46.z, t.transform, t.pixelPosMatrix, c, i);\n            });\n          };\n          for (var _o56 = 0; _o56 < u.length; _o56++) {\n            var _ret3 = _loop7();\n            if (_ret3 === \"continue\") continue;\n          }\n          return h;\n        }\n      }, {\n        key: \"loadMatchingFeature\",\n        value: function loadMatchingFeature(t, e, r, n, i, s, a, o, l) {\n          var u = e.featureIndex,\n            c = e.bucketIndex,\n            h = e.sourceLayerIndex,\n            p = e.layoutVertexArrayOffset,\n            f = this.bucketLayerIDs[c];\n          if (n && !function (t, e) {\n            for (var _r192 = 0; _r192 < t.length; _r192++) if (e.indexOf(t[_r192]) >= 0) return !0;\n            return !1;\n          }(n, f)) return;\n          var d = this.sourceLayerCoder.decode(h),\n            y = this.vtLayers[d].feature(u);\n          if (r.needGeometry) {\n            var _t268 = wu(y, !0);\n            if (!r.filter(new $s(this.tileID.overscaledZ), _t268, this.tileID.canonical)) return;\n          } else if (!r.filter(new $s(this.tileID.overscaledZ), y)) return;\n          var m = this.getId(y, d);\n          for (var _e241 = 0; _e241 < f.length; _e241++) {\n            var _r193 = f[_e241];\n            if (n && n.indexOf(_r193) < 0) continue;\n            var _c35 = s[_r193];\n            if (!_c35) continue;\n            var _h27 = {};\n            void 0 !== m && o && (_h27 = o.getState(_c35.sourceLayer || \"_geojsonTileLayer\", m));\n            var _d16 = z({}, a[_r193]);\n            _d16.paint = hy(_d16.paint, _c35.paint, y, _h27, i), _d16.layout = hy(_d16.layout, _c35.layout, y, _h27, i);\n            var _g13 = !l || l(y, _c35, _h27, p);\n            if (!_g13) continue;\n            var _x12 = new Md(y, this.z, this.x, this.y, m);\n            _x12.layer = _d16;\n            var _v11 = t[_r193];\n            void 0 === _v11 && (_v11 = t[_r193] = []), _v11.push({\n              featureIndex: u,\n              feature: _x12,\n              intersectionZ: _g13\n            });\n          }\n        }\n      }, {\n        key: \"lookupSymbolFeatures\",\n        value: function lookupSymbolFeatures(t, e, r, n, i, s, a, o) {\n          var l = {};\n          this.loadVTLayers();\n          var u = ai(i);\n          var _iterator158 = _createForOfIteratorHelper(t),\n            _step158;\n          try {\n            for (_iterator158.s(); !(_step158 = _iterator158.n()).done;) {\n              var _i141 = _step158.value;\n              this.loadMatchingFeature(l, {\n                bucketIndex: r,\n                sourceLayerIndex: n,\n                featureIndex: _i141,\n                layoutVertexArrayOffset: 0\n              }, u, s, a, o, e);\n            }\n          } catch (err) {\n            _iterator158.e(err);\n          } finally {\n            _iterator158.f();\n          }\n          return l;\n        }\n      }, {\n        key: \"loadFeature\",\n        value: function loadFeature(t) {\n          var e = t.featureIndex,\n            r = t.sourceLayerIndex;\n          this.loadVTLayers();\n          var n = this.sourceLayerCoder.decode(r),\n            i = this.vtFeatures[n];\n          if (i[e]) return i[e];\n          var s = this.vtLayers[n].feature(e);\n          return i[e] = s, s;\n        }\n      }, {\n        key: \"hasLayer\",\n        value: function hasLayer(t) {\n          var _iterator159 = _createForOfIteratorHelper(this.bucketLayerIDs),\n            _step159;\n          try {\n            for (_iterator159.s(); !(_step159 = _iterator159.n()).done;) {\n              var _e242 = _step159.value;\n              var _iterator160 = _createForOfIteratorHelper(_e242),\n                _step160;\n              try {\n                for (_iterator160.s(); !(_step160 = _iterator160.n()).done;) {\n                  var _r194 = _step160.value;\n                  if (t === _r194) return !0;\n                }\n              } catch (err) {\n                _iterator160.e(err);\n              } finally {\n                _iterator160.f();\n              }\n            }\n          } catch (err) {\n            _iterator159.e(err);\n          } finally {\n            _iterator159.f();\n          }\n          return !1;\n        }\n      }, {\n        key: \"getId\",\n        value: function getId(t, e) {\n          var r = t.id;\n          if (this.promoteId) {\n            var _n139 = \"string\" == typeof this.promoteId ? this.promoteId : this.promoteId[e];\n            null != _n139 && (r = t.properties[_n139]), \"boolean\" == typeof r && (r = Number(r));\n          }\n          return r;\n        }\n      }]);\n      return cy;\n    }();\n    function hy(t, e, r, n, i) {\n      return F(t, function (t, s) {\n        var a = e instanceof Ks ? e.get(s) : null;\n        return a && a.evaluate ? a.evaluate(r, n, i) : a;\n      });\n    }\n    function py(t, e) {\n      return e - t;\n    }\n    Oi(cy, \"FeatureIndex\", {\n      omit: [\"rawTileData\", \"sourceLayerCoder\"]\n    });\n    var fy = /*#__PURE__*/function () {\n      function fy(t, e) {\n        _classCallCheck(this, fy);\n        this.width = t, this.height = e, this.nextRow = 0, this.image = new Ju({\n          width: t,\n          height: e\n        }), this.positions = {}, this.uploaded = !1;\n      }\n      _createClass(fy, [{\n        key: \"getDash\",\n        value: function getDash(t, e) {\n          var r = this.getKey(t, e);\n          return this.positions[r];\n        }\n      }, {\n        key: \"trim\",\n        value: function trim() {\n          var t = this.width,\n            e = this.height = P(this.nextRow);\n          this.image.resize({\n            width: t,\n            height: e\n          });\n        }\n      }, {\n        key: \"getKey\",\n        value: function getKey(t, e) {\n          return t.join(\",\") + e;\n        }\n      }, {\n        key: \"getDashRanges\",\n        value: function getDashRanges(t, e, r) {\n          var n = [];\n          var i = t.length % 2 == 1 ? -t[t.length - 1] * r : 0,\n            s = t[0] * r,\n            a = !0;\n          n.push({\n            left: i,\n            right: s,\n            isDash: a,\n            zeroLength: 0 === t[0]\n          });\n          var o = t[0];\n          for (var _e243 = 1; _e243 < t.length; _e243++) {\n            a = !a;\n            var _l48 = t[_e243];\n            i = o * r, o += _l48, s = o * r, n.push({\n              left: i,\n              right: s,\n              isDash: a,\n              zeroLength: 0 === _l48\n            });\n          }\n          return n;\n        }\n      }, {\n        key: \"addRoundDash\",\n        value: function addRoundDash(t, e, r) {\n          var n = e / 2;\n          for (var _e244 = -r; _e244 <= r; _e244++) {\n            var _i142 = this.width * (this.nextRow + r + _e244);\n            var _s103 = 0,\n              _a92 = t[_s103];\n            for (var _o57 = 0; _o57 < this.width; _o57++) {\n              _o57 / _a92.right > 1 && (_a92 = t[++_s103]);\n              var _l49 = Math.abs(_o57 - _a92.left),\n                _u47 = Math.abs(_o57 - _a92.right),\n                _c36 = Math.min(_l49, _u47);\n              var _h28 = void 0;\n              var _p29 = _e244 / r * (n + 1);\n              if (_a92.isDash) {\n                var _t269 = n - Math.abs(_p29);\n                _h28 = Math.sqrt(_c36 * _c36 + _t269 * _t269);\n              } else _h28 = n - Math.sqrt(_c36 * _c36 + _p29 * _p29);\n              this.image.data[_i142 + _o57] = Math.max(0, Math.min(255, _h28 + 128));\n            }\n          }\n        }\n      }, {\n        key: \"addRegularDash\",\n        value: function addRegularDash(t, e) {\n          for (var _e245 = t.length - 1; _e245 >= 0; --_e245) {\n            var _r195 = t[_e245],\n              _n140 = t[_e245 + 1];\n            _r195.zeroLength ? t.splice(_e245, 1) : _n140 && _n140.isDash === _r195.isDash && (_n140.left = _r195.left, t.splice(_e245, 1));\n          }\n          var r = t[0],\n            n = t[t.length - 1];\n          r.isDash === n.isDash && (r.left = n.left - this.width, n.right = r.right + this.width);\n          var i = this.width * this.nextRow;\n          var s = 0,\n            a = t[s];\n          for (var _r196 = 0; _r196 < this.width; _r196++) {\n            _r196 / a.right > 1 && (a = t[++s]);\n            var _n141 = Math.abs(_r196 - a.left),\n              _o58 = Math.abs(_r196 - a.right),\n              _l50 = Math.min(_n141, _o58);\n            this.image.data[i + _r196] = Math.max(0, Math.min(255, (a.isDash ? _l50 : -_l50) + e + 128));\n          }\n        }\n      }, {\n        key: \"addDash\",\n        value: function addDash(t, e) {\n          var r = this.getKey(t, e);\n          if (this.positions[r]) return this.positions[r];\n          var n = \"round\" === e,\n            i = n ? 7 : 0,\n            s = 2 * i + 1;\n          if (this.nextRow + s > this.height) return U(\"LineAtlas out of space\"), null;\n          0 === t.length && t.push(1);\n          var a = 0;\n          for (var _e246 = 0; _e246 < t.length; _e246++) t[_e246] < 0 && (U(\"Negative value is found in line dasharray, replacing values with 0\"), t[_e246] = 0), a += t[_e246];\n          if (0 !== a) {\n            var _r197 = this.width / a,\n              _s104 = this.getDashRanges(t, this.width, _r197);\n            n ? this.addRoundDash(_s104, _r197, i) : this.addRegularDash(_s104, \"square\" === e ? .5 * _r197 : 0);\n          }\n          var o = this.nextRow + i;\n          this.nextRow += s;\n          var l = {\n            tl: [o, i],\n            br: [a, 0]\n          };\n          return this.positions[r] = l, l;\n        }\n      }]);\n      return fy;\n    }();\n    Oi(fy, \"LineAtlas\");\n    var dy = function dy(t) {\n      _classCallCheck(this, dy);\n      var e = {},\n        r = [];\n      for (var _n142 in t) {\n        var _i143 = t[_n142],\n          _s105 = e[_n142] = {};\n        for (var _t270 in _i143.glyphs) {\n          var _e247 = _i143.glyphs[+_t270];\n          if (!_e247 || 0 === _e247.bitmap.width || 0 === _e247.bitmap.height) continue;\n          var _n143 = _e247.metrics.localGlyph ? 2 : 1,\n            _a93 = {\n              x: 0,\n              y: 0,\n              w: _e247.bitmap.width + 2 * _n143,\n              h: _e247.bitmap.height + 2 * _n143\n            };\n          r.push(_a93), _s105[_t270] = _a93;\n        }\n      }\n      var _Cp2 = Cp(r),\n        n = _Cp2.w,\n        i = _Cp2.h,\n        s = new Ju({\n          width: n || 1,\n          height: i || 1\n        });\n      for (var _r198 in t) {\n        var _n144 = t[_r198];\n        for (var _t271 in _n144.glyphs) {\n          var _i144 = _n144.glyphs[+_t271];\n          if (!_i144 || 0 === _i144.bitmap.width || 0 === _i144.bitmap.height) continue;\n          var _a94 = e[_r198][_t271],\n            _o59 = _i144.metrics.localGlyph ? 2 : 1;\n          Ju.copy(_i144.bitmap, s, {\n            x: 0,\n            y: 0\n          }, {\n            x: _a94.x + _o59,\n            y: _a94.y + _o59\n          }, _i144.bitmap);\n        }\n      }\n      this.image = s, this.positions = e;\n    };\n    Oi(dy, \"GlyphAtlas\");\n    var yy = /*#__PURE__*/function () {\n      function yy(t) {\n        _classCallCheck(this, yy);\n        this.tileID = new Mh(t.tileID.overscaledZ, t.tileID.wrap, t.tileID.canonical.z, t.tileID.canonical.x, t.tileID.canonical.y), this.tileZoom = t.tileZoom, this.uid = t.uid, this.zoom = t.zoom, this.canonical = t.tileID.canonical, this.pixelRatio = t.pixelRatio, this.tileSize = t.tileSize, this.source = t.source, this.overscaling = this.tileID.overscaleFactor(), this.showCollisionBoxes = t.showCollisionBoxes, this.collectResourceTiming = !!t.collectResourceTiming, this.returnDependencies = !!t.returnDependencies, this.promoteId = t.promoteId, this.enableTerrain = !!t.enableTerrain, this.isSymbolTile = t.isSymbolTile, this.tileTransform = Vf(t.tileID.canonical, t.projection), this.projection = t.projection;\n      }\n      _createClass(yy, [{\n        key: \"parse\",\n        value: function parse(t, e, r, n, i) {\n          var _this47 = this;\n          this.status = \"parsing\", this.data = t, this.collisionBoxArray = new Ea();\n          var s = new kd(Object.keys(t.layers).sort()),\n            a = new cy(this.tileID, this.promoteId);\n          a.bucketLayerIDs = [];\n          var o = {},\n            l = new fy(256, 256),\n            u = {\n              featureIndex: a,\n              iconDependencies: {},\n              patternDependencies: {},\n              glyphDependencies: {},\n              lineAtlas: l,\n              availableImages: r\n            },\n            c = e.familiesBySource[this.source];\n          for (var _e248 in c) {\n            var _n145 = t.layers[_e248];\n            if (!_n145) continue;\n            var _i145 = !1,\n              _l51 = !1;\n            var _iterator161 = _createForOfIteratorHelper(c[_e248]),\n              _step161;\n            try {\n              for (_iterator161.s(); !(_step161 = _iterator161.n()).done;) {\n                var _t273 = _step161.value;\n                \"symbol\" === _t273[0].type ? _i145 = !0 : _l51 = !0;\n              }\n            } catch (err) {\n              _iterator161.e(err);\n            } finally {\n              _iterator161.f();\n            }\n            if (!0 === this.isSymbolTile && !_i145) continue;\n            if (!1 === this.isSymbolTile && !_l51) continue;\n            1 === _n145.version && U(\"Vector tile source \\\"\".concat(this.source, \"\\\" layer \\\"\").concat(_e248, \"\\\" does not use vector tile spec v2 and therefore may have some rendering errors.\"));\n            var _h29 = s.encode(_e248),\n              _p30 = [];\n            for (var _t272 = 0; _t272 < _n145.length; _t272++) {\n              var _r199 = _n145.feature(_t272),\n                _i146 = a.getId(_r199, _e248);\n              _p30.push({\n                feature: _r199,\n                id: _i146,\n                index: _t272,\n                sourceLayerIndex: _h29\n              });\n            }\n            var _iterator162 = _createForOfIteratorHelper(c[_e248]),\n              _step162;\n            try {\n              for (_iterator162.s(); !(_step162 = _iterator162.n()).done;) {\n                var _t274 = _step162.value;\n                var _e249 = _t274[0];\n                void 0 !== this.isSymbolTile && \"symbol\" === _e249.type !== this.isSymbolTile || _e249.minzoom && this.zoom < Math.floor(_e249.minzoom) || _e249.maxzoom && this.zoom >= _e249.maxzoom || \"none\" !== _e249.visibility && (my(_t274, this.zoom, r), (o[_e249.id] = _e249.createBucket({\n                  index: a.bucketLayerIDs.length,\n                  layers: _t274,\n                  zoom: this.zoom,\n                  canonical: this.canonical,\n                  pixelRatio: this.pixelRatio,\n                  overscaling: this.overscaling,\n                  collisionBoxArray: this.collisionBoxArray,\n                  sourceLayerIndex: _h29,\n                  sourceID: this.source,\n                  enableTerrain: this.enableTerrain,\n                  projection: this.projection.spec,\n                  availableImages: r\n                })).populate(_p30, u, this.tileID.canonical, this.tileTransform), a.bucketLayerIDs.push(_t274.map(function (t) {\n                  return t.id;\n                })));\n              }\n            } catch (err) {\n              _iterator162.e(err);\n            } finally {\n              _iterator162.f();\n            }\n          }\n          var h, p, f, d;\n          l.trim();\n          var y = {\n              type: \"maybePrepare\",\n              isSymbolTile: this.isSymbolTile,\n              zoom: this.zoom\n            },\n            m = F(u.glyphDependencies, function (t) {\n              return Object.keys(t).map(Number);\n            });\n          Object.keys(m).length ? n.send(\"getGlyphs\", {\n            uid: this.uid,\n            stacks: m\n          }, function (t, e) {\n            h || (h = t, p = e, v.call(_this47));\n          }, void 0, !1, y) : p = {};\n          var g = Object.keys(u.iconDependencies);\n          g.length ? n.send(\"getImages\", {\n            icons: g,\n            source: this.source,\n            tileID: this.tileID,\n            type: \"icons\"\n          }, function (t, e) {\n            h || (h = t, f = e, v.call(_this47));\n          }, void 0, !1, y) : f = {};\n          var x = Object.keys(u.patternDependencies);\n          function v() {\n            if (h) return i(h);\n            if (p && f && d) {\n              var _t275 = new dy(p),\n                _e250 = new Dp(f, d);\n              for (var _n146 in o) {\n                var _i147 = o[_n146];\n                _i147 instanceof hd ? (my(_i147.layers, this.zoom, r), kf(_i147, p, _t275.positions, f, _e250.iconPositions, this.showCollisionBoxes, r, this.tileID.canonical, this.tileZoom, this.projection)) : _i147.hasPattern && (_i147 instanceof jh || _i147 instanceof $c || _i147 instanceof fh) && (my(_i147.layers, this.zoom, r), _i147.addFeatures(u, this.tileID.canonical, _e250.patternPositions, r, this.tileTransform));\n              }\n              this.status = \"done\", i(null, {\n                buckets: T(o).filter(function (t) {\n                  return !t.isEmpty();\n                }),\n                featureIndex: a,\n                collisionBoxArray: this.collisionBoxArray,\n                glyphAtlasImage: _t275.image,\n                lineAtlas: l,\n                imageAtlas: _e250,\n                glyphMap: this.returnDependencies ? p : null,\n                iconMap: this.returnDependencies ? f : null,\n                glyphPositions: this.returnDependencies ? _t275.positions : null\n              });\n            }\n          }\n          x.length ? n.send(\"getImages\", {\n            icons: x,\n            source: this.source,\n            tileID: this.tileID,\n            type: \"patterns\"\n          }, function (t, e) {\n            h || (h = t, d = e, v.call(_this47));\n          }, void 0, !1, y) : d = {}, v.call(this);\n        }\n      }]);\n      return yy;\n    }();\n    function my(t, e, r) {\n      var n = new $s(e);\n      var _iterator163 = _createForOfIteratorHelper(t),\n        _step163;\n      try {\n        for (_iterator163.s(); !(_step163 = _iterator163.n()).done;) {\n          var _e251 = _step163.value;\n          _e251.recalculate(n, r);\n        }\n      } catch (err) {\n        _iterator163.e(err);\n      } finally {\n        _iterator163.f();\n      }\n    }\n    var gy = /*#__PURE__*/function () {\n      function gy(t) {\n        _classCallCheck(this, gy);\n        this.entries = {}, this.scheduler = t;\n      }\n      _createClass(gy, [{\n        key: \"request\",\n        value: function request(t, e, r, n) {\n          var _this48 = this;\n          var i = this.entries[t] = this.entries[t] || {\n            callbacks: []\n          };\n          if (i.result) {\n            var _i$result = _slicedToArray(i.result, 2),\n              _t276 = _i$result[0],\n              _r200 = _i$result[1];\n            return this.scheduler ? this.scheduler.add(function () {\n              n(_t276, _r200);\n            }, e) : n(_t276, _r200), function () {};\n          }\n          return i.callbacks.push(n), i.cancel || (i.cancel = r(function (r, n) {\n            i.result = [r, n];\n            var _iterator164 = _createForOfIteratorHelper(i.callbacks),\n              _step164;\n            try {\n              var _loop8 = function _loop8() {\n                var t = _step164.value;\n                _this48.scheduler ? _this48.scheduler.add(function () {\n                  t(r, n);\n                }, e) : t(r, n);\n              };\n              for (_iterator164.s(); !(_step164 = _iterator164.n()).done;) {\n                _loop8();\n              }\n            } catch (err) {\n              _iterator164.e(err);\n            } finally {\n              _iterator164.f();\n            }\n            setTimeout(function () {\n              return delete _this48.entries[t];\n            }, 3e3);\n          })), function () {\n            i.result || (i.callbacks = i.callbacks.filter(function (t) {\n              return t !== n;\n            }), i.callbacks.length || (i.cancel(), delete _this48.entries[t]));\n          };\n        }\n      }]);\n      return gy;\n    }();\n    function xy(t, e, r) {\n      var n = JSON.stringify(t.request);\n      return t.data && (this.deduped.entries[n] = {\n        result: [null, t.data]\n      }), this.deduped.request(n, {\n        type: \"parseTile\",\n        isSymbolTile: t.isSymbolTile,\n        zoom: t.tileZoom\n      }, function (e) {\n        var n = ut(t.request, function (t, n, i, s) {\n          t ? e(t) : n && e(null, {\n            vectorTile: r ? void 0 : new sh(new op(n)),\n            rawData: n,\n            cacheControl: i,\n            expires: s\n          });\n        });\n        return function () {\n          n.cancel(), e();\n        };\n      }, e);\n    }\n    t.ARRAY_TYPE = To, t.AUTH_ERR_MSG = yt, t.Aabb = _l, t.Actor = /*#__PURE__*/function () {\n      function _class7(t, r, n) {\n        _classCallCheck(this, _class7);\n        this.target = t, this.parent = r, this.mapId = n, this.callbacks = {}, this.cancelCallbacks = {}, V([\"receive\"], this), this.target.addEventListener(\"message\", this.receive, !1), this.globalScope = N() ? t : e, this.scheduler = new Sd();\n      }\n      _createClass(_class7, [{\n        key: \"send\",\n        value: function send(t, e, r, n) {\n          var _this49 = this;\n          var i = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;\n          var s = arguments.length > 5 ? arguments[5] : undefined;\n          var a = Math.round(1e18 * Math.random()).toString(36).substring(0, 10);\n          r && (r.metadata = s, this.callbacks[a] = r);\n          var o = X(this.globalScope) ? void 0 : [];\n          return this.target.postMessage({\n            id: a,\n            type: t,\n            hasCallback: !!r,\n            targetMapId: n,\n            mustQueue: i,\n            sourceMapId: this.mapId,\n            data: Gi(e, o)\n          }, o), {\n            cancel: function cancel() {\n              r && delete _this49.callbacks[a], _this49.target.postMessage({\n                id: a,\n                type: \"<cancel>\",\n                targetMapId: n,\n                sourceMapId: _this49.mapId\n              });\n            }\n          };\n        }\n      }, {\n        key: \"receive\",\n        value: function receive(t) {\n          var _this50 = this;\n          var e = t.data,\n            r = e.id;\n          if (r && (!e.targetMapId || this.mapId === e.targetMapId)) if (\"<cancel>\" === e.type) {\n            var _t277 = this.cancelCallbacks[r];\n            delete this.cancelCallbacks[r], _t277 && _t277.cancel();\n          } else if (e.mustQueue || N()) {\n            var _t278 = this.callbacks[r];\n            this.cancelCallbacks[r] = this.scheduler.add(function () {\n              return _this50.processTask(r, e);\n            }, _t278 && _t278.metadata || {\n              type: \"message\"\n            });\n          } else this.processTask(r, e);\n        }\n      }, {\n        key: \"processTask\",\n        value: function processTask(t, e) {\n          var _this51 = this;\n          if (\"<response>\" === e.type) {\n            var _r201 = this.callbacks[t];\n            delete this.callbacks[t], _r201 && (e.error ? _r201(Zi(e.error)) : _r201(null, Zi(e.data)));\n          } else {\n            var _r202 = X(this.globalScope) ? void 0 : [],\n              _n147 = e.hasCallback ? function (e, n) {\n                delete _this51.cancelCallbacks[t], _this51.target.postMessage({\n                  id: t,\n                  type: \"<response>\",\n                  sourceMapId: _this51.mapId,\n                  error: e ? Gi(e) : null,\n                  data: Gi(n, _r202)\n                }, _r202);\n              } : function (t) {},\n              _i148 = Zi(e.data);\n            if (this.parent[e.type]) this.parent[e.type](e.sourceMapId, _i148, _n147);else if (this.parent.getWorkerSource) {\n              var _t279 = e.type.split(\".\");\n              this.parent.getWorkerSource(e.sourceMapId, _t279[0], _i148.source)[_t279[1]](_i148, _n147);\n            } else _n147(new Error(\"Could not find function \".concat(e.type)));\n          }\n        }\n      }, {\n        key: \"remove\",\n        value: function remove() {\n          this.scheduler.remove(), this.target.removeEventListener(\"message\", this.receive, !1);\n        }\n      }]);\n      return _class7;\n    }(), t.CanonicalTileID = kh, t.Color = Me, t.ColorMode = ey, t.CullFaceMode = iy, t.DEMData = Hd, t.DataConstantProperty = Ys, t.DedupedRequest = gy, t.DepthMode = Jd, t.EXTENT = ko, t.Elevation = /*#__PURE__*/function () {\n      function _class8() {\n        _classCallCheck(this, _class8);\n      }\n      _createClass(_class8, [{\n        key: \"isDataAvailableAtPoint\",\n        value: function isDataAvailableAtPoint(t) {\n          var e = this._source();\n          if (this.isUsingMockSource() || !e || t.y < 0 || t.y > 1) return !1;\n          var r = e.getSource().maxzoom,\n            n = 1 << r,\n            i = Math.floor(t.x),\n            s = Math.floor((t.x - i) * n),\n            a = Math.floor(t.y * n),\n            o = this.findDEMTileFor(new Mh(r, i, r, s, a));\n          return !(!o || !o.dem);\n        }\n      }, {\n        key: \"getAtPointOrZero\",\n        value: function getAtPointOrZero(t) {\n          var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n          return this.getAtPoint(t, e) || 0;\n        }\n      }, {\n        key: \"getAtPoint\",\n        value: function getAtPoint(t, e) {\n          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;\n          if (this.isUsingMockSource()) return null;\n          null == e && (e = null);\n          var n = this._source();\n          if (!n) return e;\n          if (t.y < 0 || t.y > 1) return e;\n          var i = n.getSource().maxzoom,\n            s = 1 << i,\n            a = Math.floor(t.x),\n            o = t.x - a,\n            l = new Mh(i, a, i, Math.floor(o * s), Math.floor(t.y * s)),\n            u = this.findDEMTileFor(l);\n          if (!u || !u.dem) return e;\n          var c = u.dem,\n            h = 1 << u.tileID.canonical.z,\n            p = (o * h - u.tileID.canonical.x) * c.dim,\n            f = (t.y * h - u.tileID.canonical.y) * c.dim,\n            d = Math.floor(p),\n            y = Math.floor(f);\n          return (r ? this.exaggeration() : 1) * Mr(Mr(c.get(d, y), c.get(d, y + 1), f - y), Mr(c.get(d + 1, y), c.get(d + 1, y + 1), f - y), p - d);\n        }\n      }, {\n        key: \"getAtTileOffset\",\n        value: function getAtTileOffset(t, e, r) {\n          var n = 1 << t.canonical.z;\n          return this.getAtPointOrZero(new pu(t.wrap + (t.canonical.x + e / ko) / n, (t.canonical.y + r / ko) / n));\n        }\n      }, {\n        key: \"getAtTileOffsetFunc\",\n        value: function getAtTileOffsetFunc(t, e, r, n) {\n          var _this52 = this;\n          return function (i) {\n            var s = _this52.getAtTileOffset(t, i.x, i.y),\n              a = n.upVector(t.canonical, i.x, i.y);\n            return Ho(a, a, s * n.upVectorScale(t.canonical, e, r).metersToTile), a;\n          };\n        }\n      }, {\n        key: \"getForTilePoints\",\n        value: function getForTilePoints(t, e, r, n) {\n          var _this53 = this;\n          if (this.isUsingMockSource()) return !1;\n          var i = uy.create(this, t, n);\n          return !!i && (e.forEach(function (t) {\n            t[2] = _this53.exaggeration() * i.getElevationAt(t[0], t[1], r);\n          }), !0);\n        }\n      }, {\n        key: \"getMinMaxForTile\",\n        value: function getMinMaxForTile(t) {\n          if (this.isUsingMockSource()) return null;\n          var e = this.findDEMTileFor(t);\n          if (!e || !e.dem) return null;\n          var r = e.dem.tree,\n            n = e.tileID,\n            i = 1 << t.canonical.z - n.canonical.z;\n          var s = t.canonical.x / i - n.canonical.x,\n            a = t.canonical.y / i - n.canonical.y,\n            o = 0;\n          for (var _e252 = 0; _e252 < t.canonical.z - n.canonical.z && !r.leaves[o]; _e252++) {\n            s *= 2, a *= 2;\n            var _t280 = 2 * Math.floor(a) + Math.floor(s);\n            o = r.childOffsets[o] + _t280, s %= 1, a %= 1;\n          }\n          return {\n            min: this.exaggeration() * r.minimums[o],\n            max: this.exaggeration() * r.maximums[o]\n          };\n        }\n      }, {\n        key: \"getMinElevationBelowMSL\",\n        value: function getMinElevationBelowMSL() {\n          throw new Error(\"Pure virtual method called.\");\n        }\n      }, {\n        key: \"raycast\",\n        value: function raycast(t, e, r) {\n          throw new Error(\"Pure virtual method called.\");\n        }\n      }, {\n        key: \"pointCoordinate\",\n        value: function pointCoordinate(t) {\n          throw new Error(\"Pure virtual method called.\");\n        }\n      }, {\n        key: \"_source\",\n        value: function _source() {\n          throw new Error(\"Pure virtual method called.\");\n        }\n      }, {\n        key: \"isUsingMockSource\",\n        value: function isUsingMockSource() {\n          throw new Error(\"Pure virtual method called.\");\n        }\n      }, {\n        key: \"exaggeration\",\n        value: function exaggeration() {\n          throw new Error(\"Pure virtual method called.\");\n        }\n      }, {\n        key: \"findDEMTileFor\",\n        value: function findDEMTileFor(t) {\n          throw new Error(\"Pure virtual method called.\");\n        }\n      }, {\n        key: \"visibleDemTiles\",\n        get: function get() {\n          throw new Error(\"Getter must be implemented in subclass.\");\n        }\n      }]);\n      return _class8;\n    }(), t.ErrorEvent = Kt, t.EvaluationParameters = $s, t.Event = Xt, t.Evented = Yt, t.FillExtrusionBucket = fh, t.Frustum = wl, t.FrustumCorners = bl, t.GLOBE_RADIUS = Al, t.GLOBE_SCALE_MATCH_LATITUDE = 45, t.GLOBE_ZOOM_THRESHOLD_MAX = 6, t.GLOBE_ZOOM_THRESHOLD_MIN = 5, t.GlobeSharedBuffers = /*#__PURE__*/function () {\n      function _class9(t) {\n        _classCallCheck(this, _class9);\n        this._createGrid(t), this._createPoles(t);\n      }\n      _createClass(_class9, [{\n        key: \"destroy\",\n        value: function destroy() {\n          this._poleIndexBuffer.destroy(), this._gridBuffer.destroy(), this._gridIndexBuffer.destroy(), this._poleNorthVertexBuffer.destroy(), this._poleSouthVertexBuffer.destroy();\n          var _iterator165 = _createForOfIteratorHelper(this._poleSegments),\n            _step165;\n          try {\n            for (_iterator165.s(); !(_step165 = _iterator165.n()).done;) {\n              var _t282 = _step165.value;\n              _t282.destroy();\n            }\n          } catch (err) {\n            _iterator165.e(err);\n          } finally {\n            _iterator165.f();\n          }\n          var _iterator166 = _createForOfIteratorHelper(this._gridSegments),\n            _step166;\n          try {\n            for (_iterator166.s(); !(_step166 = _iterator166.n()).done;) {\n              var _t283 = _step166.value;\n              _t283.withSkirts.destroy(), _t283.withoutSkirts.destroy();\n            }\n          } catch (err) {\n            _iterator166.e(err);\n          } finally {\n            _iterator166.f();\n          }\n          if (this._wireframeIndexBuffer) {\n            this._wireframeIndexBuffer.destroy();\n            var _iterator167 = _createForOfIteratorHelper(this._wireframeSegments),\n              _step167;\n            try {\n              for (_iterator167.s(); !(_step167 = _iterator167.n()).done;) {\n                var _t281 = _step167.value;\n                _t281.destroy();\n              }\n            } catch (err) {\n              _iterator167.e(err);\n            } finally {\n              _iterator167.f();\n            }\n          }\n        }\n      }, {\n        key: \"_fillGridMeshWithLods\",\n        value: function _fillGridMeshWithLods(t, e) {\n          var r = new sa(),\n            n = new wa(),\n            i = [],\n            s = t + 1 + 2,\n            a = e[0] + 1,\n            o = e[0] + 1 + (1 + e.length),\n            l = function l(t, e, r) {\n              var n = t === s - 1 ? t - 2 : 0 === t ? t : t - 1;\n              return n += r ? 24575 : 0, [n, e];\n            };\n          for (var _t284 = 0; _t284 < s; ++_t284) r.emplaceBack.apply(r, _toConsumableArray(l(_t284, 0, !0)));\n          for (var _t285 = 0; _t285 < a; ++_t285) for (var _e253 = 0; _e253 < s; ++_e253) r.emplaceBack.apply(r, _toConsumableArray(l(_e253, _t285, (0 === _e253 || _e253 === s - 1) && !0)));\n          for (var _t286 = 0; _t286 < e.length; ++_t286) {\n            var _n148 = e[_t286];\n            for (var _t287 = 0; _t287 < s; ++_t287) r.emplaceBack.apply(r, _toConsumableArray(l(_t287, _n148, !0)));\n          }\n          for (var _t288 = 0; _t288 < e.length; ++_t288) {\n            var _a95 = n.length,\n              _l52 = e[_t288] + 1 + 2,\n              _u48 = new wa();\n            for (var _r203 = 0; _r203 < _l52 - 1; _r203++) {\n              var _i149 = _r203 === _l52 - 2,\n                _a96 = _i149 ? s * (o - e.length + _t288 - _r203) : s;\n              for (var _t289 = 0; _t289 < s - 1; _t289++) {\n                var _e254 = _r203 * s + _t289;\n                0 === _r203 || _i149 || 0 === _t289 || _t289 === s - 2 ? (_u48.emplaceBack(_e254 + 1, _e254, _e254 + _a96), _u48.emplaceBack(_e254 + _a96, _e254 + _a96 + 1, _e254 + 1)) : (n.emplaceBack(_e254 + 1, _e254, _e254 + _a96), n.emplaceBack(_e254 + _a96, _e254 + _a96 + 1, _e254 + 1));\n              }\n            }\n            var _c37 = So.simpleSegment(0, _a95, r.length, n.length - _a95);\n            for (var _t290 = 0; _t290 < _u48.uint16.length; _t290 += 3) n.emplaceBack(_u48.uint16[_t290], _u48.uint16[_t290 + 1], _u48.uint16[_t290 + 2]);\n            var _h30 = So.simpleSegment(0, _a95, r.length, n.length - _a95);\n            i.push({\n              withoutSkirts: _c37,\n              withSkirts: _h30\n            });\n          }\n          return {\n            vertices: r,\n            indices: n,\n            segments: i\n          };\n        }\n      }, {\n        key: \"_createGrid\",\n        value: function _createGrid(t) {\n          var e = this._fillGridMeshWithLods(Sl, kl);\n          this._gridSegments = e.segments, this._gridBuffer = t.createVertexBuffer(e.vertices, xl.members), this._gridIndexBuffer = t.createIndexBuffer(e.indices, !0);\n        }\n      }, {\n        key: \"_createPoles\",\n        value: function _createPoles(t) {\n          var e = new wa();\n          for (var _t291 = 0; _t291 <= Sl; _t291++) e.emplaceBack(0, _t291 + 1, _t291 + 2);\n          this._poleIndexBuffer = t.createIndexBuffer(e, !0);\n          var r = new ka(),\n            n = new ka();\n          this._poleSegments = [];\n          for (var _t292 = 0, _e255 = 0; _t292 < 5; _t292++) {\n            var _i150 = 360 / (1 << _t292);\n            r.emplaceBack(0, -Al, 0, .5, 0), n.emplaceBack(0, -Al, 0, .5, 1);\n            for (var _t293 = 0; _t293 <= Sl; _t293++) {\n              var _e256 = _t293 / Sl,\n                _s106 = Mr(0, _i150, _e256),\n                _$l = $l(Jl, Ql, _s106, Al),\n                _$l2 = _slicedToArray(_$l, 3),\n                _a97 = _$l2[0],\n                _o60 = _$l2[1],\n                _l53 = _$l2[2];\n              r.emplaceBack(_a97, _o60, _l53, _e256, 0), n.emplaceBack(_a97, _o60, _l53, _e256, 1);\n            }\n            this._poleSegments.push(So.simpleSegment(_e255, 0, 66, 64)), _e255 += 66;\n          }\n          this._poleNorthVertexBuffer = t.createVertexBuffer(r, ml, !1), this._poleSouthVertexBuffer = t.createVertexBuffer(n, ml, !1);\n        }\n      }, {\n        key: \"getGridBuffers\",\n        value: function getGridBuffers(t, e) {\n          return [this._gridBuffer, this._gridIndexBuffer, e ? this._gridSegments[t].withSkirts : this._gridSegments[t].withoutSkirts];\n        }\n      }, {\n        key: \"getPoleBuffers\",\n        value: function getPoleBuffers(t) {\n          return [this._poleNorthVertexBuffer, this._poleSouthVertexBuffer, this._poleIndexBuffer, this._poleSegments[t]];\n        }\n      }, {\n        key: \"getWirefameBuffers\",\n        value: function getWirefameBuffers(t, e) {\n          if (!this._wireframeSegments) {\n            var _e257 = new Ma(),\n              _r204 = Sl,\n              _n149 = _r204 + 1 + 2,\n              _i151 = 1;\n            this._wireframeSegments = [];\n            for (var _t294 = 0, _s107 = 0; _t294 < kl.length; _t294++) {\n              var _a98 = kl[_t294];\n              for (var _t295 = _i151; _t295 < _a98 + _i151; _t295++) for (var _s108 = _i151; _s108 < _r204 + _i151; _s108++) {\n                var _r205 = _t295 * _n149 + _s108;\n                _e257.emplaceBack(_r205, _r205 + 1), _e257.emplaceBack(_r205, _r205 + _n149), _e257.emplaceBack(_r205, _r205 + _n149 + 1);\n              }\n              var _o61 = _a98 * _r204 * 3;\n              this._wireframeSegments.push(So.simpleSegment(0, _s107, (_a98 + 1) * _n149, _o61)), _s107 += _o61;\n            }\n            this._wireframeIndexBuffer = t.createIndexBuffer(_e257);\n          }\n          return [this._gridBuffer, this._wireframeIndexBuffer, this._wireframeSegments[e]];\n        }\n      }]);\n      return _class9;\n    }(), t.GlyphManager = cf, t.ImagePosition = Pp, t.LivePerformanceUtils = Lt, t.LngLat = ru, t.LngLatBounds = Io, t.LocalGlyphMode = uf, t.MAX_MERCATOR_LATITUDE = cu, t.MercatorCoordinate = pu, t.ONE_EM = Wh, t.OverscaledTileID = Mh, t.PerformanceMarkers = Vt, t.Properties = Js, t.RGBAImage = Qu, t.Ray = vl, t.RequestManager = /*#__PURE__*/function () {\n      function _class10(t, e, r) {\n        _classCallCheck(this, _class10);\n        this._transformRequestFn = t, this._customAccessToken = e, this._silenceAuthErrors = !!r, this._createSkuToken();\n      }\n      _createClass(_class10, [{\n        key: \"_createSkuToken\",\n        value: function _createSkuToken() {\n          var t = function () {\n            var t = \"\";\n            for (var _e258 = 0; _e258 < 10; _e258++) t += \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"[Math.floor(62 * Math.random())];\n            return {\n              token: [\"1\", h, t].join(\"\"),\n              tokenExpiresAt: Date.now() + 432e5\n            };\n          }();\n          this._skuToken = t.token, this._skuTokenExpiresAt = t.tokenExpiresAt;\n        }\n      }, {\n        key: \"_isSkuTokenExpired\",\n        value: function _isSkuTokenExpired() {\n          return Date.now() > this._skuTokenExpiresAt;\n        }\n      }, {\n        key: \"transformRequest\",\n        value: function transformRequest(t, e) {\n          return this._transformRequestFn && this._transformRequestFn(t, e) || {\n            url: t\n          };\n        }\n      }, {\n        key: \"normalizeStyleURL\",\n        value: function normalizeStyleURL(t, e) {\n          if (!mt(t)) return t;\n          var r = _t(t);\n          return r.path = \"/styles/v1\".concat(r.path), this._makeAPIURL(r, this._customAccessToken || e);\n        }\n      }, {\n        key: \"normalizeGlyphsURL\",\n        value: function normalizeGlyphsURL(t, e) {\n          if (!mt(t)) return t;\n          var r = _t(t);\n          return r.path = \"/fonts/v1\".concat(r.path), this._makeAPIURL(r, this._customAccessToken || e);\n        }\n      }, {\n        key: \"normalizeSourceURL\",\n        value: function normalizeSourceURL(t, e, r, n) {\n          if (!mt(t)) return t;\n          var i = _t(t);\n          return i.path = \"/v4/\".concat(i.authority, \".json\"), i.params.push(\"secure\"), r && i.params.push(\"language=\".concat(r)), n && i.params.push(\"worldview=\".concat(n)), this._makeAPIURL(i, this._customAccessToken || e);\n        }\n      }, {\n        key: \"normalizeSpriteURL\",\n        value: function normalizeSpriteURL(t, e, r, n) {\n          var i = _t(t);\n          return mt(t) ? (i.path = \"/styles/v1\".concat(i.path, \"/sprite\").concat(e).concat(r), this._makeAPIURL(i, this._customAccessToken || n)) : (i.path += \"\".concat(e).concat(r), At(i));\n        }\n      }, {\n        key: \"normalizeTileURL\",\n        value: function normalizeTileURL(t, e, r) {\n          if (this._isSkuTokenExpired() && this._createSkuToken(), t && !mt(t)) return t;\n          var n = _t(t);\n          n.path = n.path.replace(/(\\.(png|jpg)\\d*)(?=$)/, \"\".concat(e || r && \"raster\" !== n.authority && 512 === r ? \"@2x\" : \"\").concat(s.supported ? \".webp\" : \"$1\")), \"raster\" === n.authority ? n.path = \"/\".concat(i.RASTER_URL_PREFIX).concat(n.path) : (n.path = n.path.replace(/^.+\\/v4\\//, \"/\"), n.path = \"/\".concat(i.TILE_URL_VERSION).concat(n.path));\n          var a = this._customAccessToken || function (t) {\n            var _iterator168 = _createForOfIteratorHelper(t),\n              _step168;\n            try {\n              for (_iterator168.s(); !(_step168 = _iterator168.n()).done;) {\n                var _e259 = _step168.value;\n                var _t296 = _e259.match(/^access_token=(.*)$/);\n                if (_t296) return _t296[1];\n              }\n            } catch (err) {\n              _iterator168.e(err);\n            } finally {\n              _iterator168.f();\n            }\n            return null;\n          }(n.params) || i.ACCESS_TOKEN;\n          return i.REQUIRE_ACCESS_TOKEN && a && this._skuToken && n.params.push(\"sku=\".concat(this._skuToken)), this._makeAPIURL(n, a);\n        }\n      }, {\n        key: \"canonicalizeTileURL\",\n        value: function canonicalizeTileURL(t, e) {\n          var r = _t(t);\n          if (!r.path.match(/^(\\/v4\\/|\\/raster\\/v1\\/)/) || !r.path.match(/\\.[\\w]+$/)) return t;\n          var n = \"mapbox://\";\n          r.path.match(/^\\/raster\\/v1\\//) ? n += \"raster/\".concat(r.path.replace(\"/\".concat(i.RASTER_URL_PREFIX, \"/\"), \"\")) : n += \"tiles/\".concat(r.path.replace(\"/\".concat(i.TILE_URL_VERSION, \"/\"), \"\"));\n          var s = r.params;\n          return e && (s = s.filter(function (t) {\n            return !t.match(/^access_token=/);\n          })), s.length && (n += \"?\".concat(s.join(\"&\"))), n;\n        }\n      }, {\n        key: \"canonicalizeTileset\",\n        value: function canonicalizeTileset(t, e) {\n          var r = !!e && mt(e),\n            n = [];\n          var _iterator169 = _createForOfIteratorHelper(t.tiles || []),\n            _step169;\n          try {\n            for (_iterator169.s(); !(_step169 = _iterator169.n()).done;) {\n              var _e260 = _step169.value;\n              gt(_e260) ? n.push(this.canonicalizeTileURL(_e260, r)) : n.push(_e260);\n            }\n          } catch (err) {\n            _iterator169.e(err);\n          } finally {\n            _iterator169.f();\n          }\n          return n;\n        }\n      }, {\n        key: \"_makeAPIURL\",\n        value: function _makeAPIURL(t, e) {\n          var r = \"See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes\",\n            n = _t(i.API_URL);\n          if (t.protocol = n.protocol, t.authority = n.authority, \"http\" === t.protocol) {\n            var _e261 = t.params.indexOf(\"secure\");\n            _e261 >= 0 && t.params.splice(_e261, 1);\n          }\n          if (\"/\" !== n.path && (t.path = \"\".concat(n.path).concat(t.path)), !i.REQUIRE_ACCESS_TOKEN) return At(t);\n          if (e = e || i.ACCESS_TOKEN, !this._silenceAuthErrors) {\n            if (!e) throw new Error(\"An API access token is required to use Mapbox GL. \".concat(r));\n            if (\"s\" === e[0]) throw new Error(\"Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). \".concat(r));\n          }\n          return t.params = t.params.filter(function (t) {\n            return -1 === t.indexOf(\"access_token\");\n          }), t.params.push(\"access_token=\".concat(e || \"\")), At(t);\n        }\n      }]);\n      return _class10;\n    }(), t.ResourceType = st, t.SegmentVector = So, t.SourceCache = sy, t.StencilMode = ty, t.StructArrayLayout1ui2 = Ta, t.StructArrayLayout2f1f2i16 = xa, t.StructArrayLayout2i4 = sa, t.StructArrayLayout2ui4 = Ma, t.StructArrayLayout3f12 = ba, t.StructArrayLayout3ui6 = wa, t.StructArrayLayout4i8 = oa, t.StructArrayLayout5f20 = ka, t.Texture = _d, t.Tile = Fd, t.Transitionable = qs, t.Uniform1f = to, t.Uniform1i = /*#__PURE__*/function (_Qa4) {\n      _inherits(_class11, _Qa4);\n      function _class11(t) {\n        var _this54;\n        _classCallCheck(this, _class11);\n        _this54 = _possibleConstructorReturn(this, _getPrototypeOf(_class11).call(this, t)), _this54.current = 0;\n        return _this54;\n      }\n      _createClass(_class11, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          this.fetchUniformLocation(t, e) && this.current !== r && (this.current = r, this.gl.uniform1i(this.location, r));\n        }\n      }]);\n      return _class11;\n    }(Qa), t.Uniform2f = /*#__PURE__*/function (_Qa5) {\n      _inherits(_class12, _Qa5);\n      function _class12(t) {\n        var _this55;\n        _classCallCheck(this, _class12);\n        _this55 = _possibleConstructorReturn(this, _getPrototypeOf(_class12).call(this, t)), _this55.current = [0, 0];\n        return _this55;\n      }\n      _createClass(_class12, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          this.fetchUniformLocation(t, e) && (r[0] === this.current[0] && r[1] === this.current[1] || (this.current = r, this.gl.uniform2f(this.location, r[0], r[1])));\n        }\n      }]);\n      return _class12;\n    }(Qa), t.Uniform3f = /*#__PURE__*/function (_Qa6) {\n      _inherits(_class13, _Qa6);\n      function _class13(t) {\n        var _this56;\n        _classCallCheck(this, _class13);\n        _this56 = _possibleConstructorReturn(this, _getPrototypeOf(_class13).call(this, t)), _this56.current = [0, 0, 0];\n        return _this56;\n      }\n      _createClass(_class13, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          this.fetchUniformLocation(t, e) && (r[0] === this.current[0] && r[1] === this.current[1] && r[2] === this.current[2] || (this.current = r, this.gl.uniform3f(this.location, r[0], r[1], r[2])));\n        }\n      }]);\n      return _class13;\n    }(Qa), t.Uniform4f = eo, t.UniformColor = ro, t.UniformMatrix2f = /*#__PURE__*/function (_Qa7) {\n      _inherits(_class14, _Qa7);\n      function _class14(t) {\n        var _this57;\n        _classCallCheck(this, _class14);\n        _this57 = _possibleConstructorReturn(this, _getPrototypeOf(_class14).call(this, t)), _this57.current = so;\n        return _this57;\n      }\n      _createClass(_class14, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          if (this.fetchUniformLocation(t, e)) for (var _t297 = 0; _t297 < 4; _t297++) if (r[_t297] !== this.current[_t297]) {\n            this.current = r, this.gl.uniformMatrix2fv(this.location, !1, r);\n            break;\n          }\n        }\n      }]);\n      return _class14;\n    }(Qa), t.UniformMatrix3f = /*#__PURE__*/function (_Qa8) {\n      _inherits(_class15, _Qa8);\n      function _class15(t) {\n        var _this58;\n        _classCallCheck(this, _class15);\n        _this58 = _possibleConstructorReturn(this, _getPrototypeOf(_class15).call(this, t)), _this58.current = io;\n        return _this58;\n      }\n      _createClass(_class15, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          if (this.fetchUniformLocation(t, e)) for (var _t298 = 0; _t298 < 9; _t298++) if (r[_t298] !== this.current[_t298]) {\n            this.current = r, this.gl.uniformMatrix3fv(this.location, !1, r);\n            break;\n          }\n        }\n      }]);\n      return _class15;\n    }(Qa), t.UniformMatrix4f = /*#__PURE__*/function (_Qa9) {\n      _inherits(_class16, _Qa9);\n      function _class16(t) {\n        var _this59;\n        _classCallCheck(this, _class16);\n        _this59 = _possibleConstructorReturn(this, _getPrototypeOf(_class16).call(this, t)), _this59.current = no;\n        return _this59;\n      }\n      _createClass(_class16, [{\n        key: \"set\",\n        value: function set(t, e, r) {\n          if (this.fetchUniformLocation(t, e)) {\n            if (r[12] !== this.current[12] || r[0] !== this.current[0]) return this.current = r, void this.gl.uniformMatrix4fv(this.location, !1, r);\n            for (var _t299 = 1; _t299 < 16; _t299++) if (r[_t299] !== this.current[_t299]) {\n              this.current = r, this.gl.uniformMatrix4fv(this.location, !1, r);\n              break;\n            }\n          }\n        }\n      }]);\n      return _class16;\n    }(Qa), t.UnwrappedTileID = Ih, t.ValidationError = Wn, t.VectorTileFeature = ah, t.VectorTileWorkerSource = /*#__PURE__*/function (_Yt3) {\n      _inherits(_class17, _Yt3);\n      function _class17(t, e, r, n, i) {\n        var _this60;\n        _classCallCheck(this, _class17);\n        _this60 = _possibleConstructorReturn(this, _getPrototypeOf(_class17).call(this)), _this60.actor = t, _this60.layerIndex = e, _this60.availableImages = r, _this60.loadVectorData = i || xy, _this60.loading = {}, _this60.loaded = {}, _this60.deduped = new gy(t.scheduler), _this60.isSpriteLoaded = n, _this60.scheduler = t.scheduler;\n        return _this60;\n      }\n      _createClass(_class17, [{\n        key: \"loadTile\",\n        value: function loadTile(t, e) {\n          var _this61 = this;\n          var r = t.uid,\n            n = t && t.request,\n            i = n && n.collectResourceTiming,\n            s = this.loading[r] = new yy(t);\n          s.abort = this.loadVectorData(t, function (a, o) {\n            var l = !_this61.loading[r];\n            if (delete _this61.loading[r], l || a || !o) return s.status = \"done\", l || (_this61.loaded[r] = s), e(a);\n            var u = o.rawData,\n              c = {};\n            o.expires && (c.expires = o.expires), o.cacheControl && (c.cacheControl = o.cacheControl), s.vectorTile = o.vectorTile || new sh(new op(u));\n            var h = function h() {\n              s.parse(s.vectorTile, _this61.layerIndex, _this61.availableImages, _this61.actor, function (t, r) {\n                if (t || !r) return e(t);\n                var s = {};\n                if (i) {\n                  var _t300 = jt(n);\n                  _t300.length > 0 && (s.resourceTiming = JSON.parse(JSON.stringify(_t300)));\n                }\n                e(null, z({\n                  rawTileData: u.slice(0)\n                }, r, c, s));\n              });\n            };\n            _this61.isSpriteLoaded ? h() : _this61.once(\"isSpriteLoaded\", function () {\n              _this61.scheduler ? _this61.scheduler.add(h, {\n                type: \"parseTile\",\n                isSymbolTile: t.isSymbolTile,\n                zoom: t.tileZoom\n              }) : h();\n            }), _this61.loaded = _this61.loaded || {}, _this61.loaded[r] = s;\n          });\n        }\n      }, {\n        key: \"reloadTile\",\n        value: function reloadTile(t, e) {\n          var _this62 = this;\n          var r = this.loaded,\n            n = t.uid,\n            i = this;\n          if (r && r[n]) {\n            var _s109 = r[n];\n            _s109.showCollisionBoxes = t.showCollisionBoxes, _s109.enableTerrain = !!t.enableTerrain, _s109.projection = t.projection, _s109.tileTransform = Vf(t.tileID.canonical, t.projection);\n            var _a99 = function _a99(t, r) {\n              var n = _s109.reloadCallback;\n              n && (delete _s109.reloadCallback, _s109.parse(_s109.vectorTile, i.layerIndex, _this62.availableImages, i.actor, n)), e(t, r);\n            };\n            \"parsing\" === _s109.status ? _s109.reloadCallback = _a99 : \"done\" === _s109.status && (_s109.vectorTile ? _s109.parse(_s109.vectorTile, this.layerIndex, this.availableImages, this.actor, _a99) : _a99());\n          }\n        }\n      }, {\n        key: \"abortTile\",\n        value: function abortTile(t, e) {\n          var r = t.uid,\n            n = this.loading[r];\n          n && (n.abort && n.abort(), delete this.loading[r]), e();\n        }\n      }, {\n        key: \"removeTile\",\n        value: function removeTile(t, e) {\n          var r = this.loaded,\n            n = t.uid;\n          r && r[n] && delete r[n], e();\n        }\n      }]);\n      return _class17;\n    }(Yt), t.WritingMode = Vp, t.ZoomDependentExpression = Xn, t.add = Go, t.addDynamicAttributes = od, t.adjoint = function (t, e) {\n      var r = e[0],\n        n = e[1],\n        i = e[2],\n        s = e[3],\n        a = e[4],\n        o = e[5],\n        l = e[6],\n        u = e[7],\n        c = e[8];\n      return t[0] = a * c - o * u, t[1] = i * u - n * c, t[2] = n * o - i * a, t[3] = o * l - s * c, t[4] = r * c - i * l, t[5] = i * s - r * o, t[6] = s * u - a * l, t[7] = n * l - r * u, t[8] = r * a - n * s, t;\n    }, t.asyncAll = M, t.bezier = _, t.bindAll = V, t.boundsAttributes = Vd, t.bufferConvexPolygon = function (t, e) {\n      var r = [];\n      for (var _n150 = 0; _n150 < t.length; _n150++) {\n        var _i152 = I(_n150 - 1, -1, t.length - 1),\n          _s110 = I(_n150 + 1, -1, t.length - 1),\n          _a100 = t[_n150],\n          _o62 = t[_s110],\n          _l54 = t[_i152].sub(_a100).unit(),\n          _u49 = _o62.sub(_a100).unit(),\n          _c38 = _u49.angleWithSep(_l54.x, _l54.y),\n          _h31 = _l54.add(_u49).unit().mult(-1 * e / Math.sin(_c38 / 2));\n        r.push(_a100.add(_h31));\n      }\n      return r;\n    }, t.cacheEntryPossiblyAdded = function (t) {\n      it++, it > tt && (t.getActor().send(\"enforceCacheSizeLimit\", Q), it = 0);\n    }, t.calculateGlobeLabelMatrix = function (t, e) {\n      var _t$point = t.point,\n        r = _t$point.x,\n        n = _t$point.y,\n        i = Xl(r, n, t.worldSize / t._pixelsPerMercatorPixel, 0, 0);\n      return Po(i, i, Zl(Pl(e)));\n    }, t.calculateGlobeMatrix = function (t) {\n      var _t$point2 = t.point,\n        e = _t$point2.x,\n        r = _t$point2.y,\n        _t$_center = t._center,\n        n = _t$_center.lng,\n        i = _t$_center.lat;\n      return Xl(e, r, t.worldSize, n, i);\n    }, t.calculateGlobeMercatorMatrix = function (t) {\n      var e = t.pixelsPerMeter,\n        r = e / au(1, t.center.lat),\n        n = Eo(new Float64Array(16));\n      return Do(n, n, [t.point.x, t.point.y, 0]), Vo(n, n, [r, r, e]), Float32Array.from(n);\n    }, t.circumferenceAtLatitude = nu, t.clamp = S, t.clearTileCache = function (t) {\n      if (!et()) return;\n      var r = e.caches.delete(H);\n      t && r.catch(t).then(function () {\n        return t();\n      });\n    }, t.clipLine = sf, t.clone = function (t) {\n      var e = new To(16);\n      return e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[3], e[4] = t[4], e[5] = t[5], e[6] = t[6], e[7] = t[7], e[8] = t[8], e[9] = t[9], e[10] = t[10], e[11] = t[11], e[12] = t[12], e[13] = t[13], e[14] = t[14], e[15] = t[15], e;\n    }, t.clone$1 = j, t.collisionCircleLayout = Hh, t.config = i, t.conjugate = function (t, e) {\n      return t[0] = -e[0], t[1] = -e[1], t[2] = -e[2], t[3] = e[3], t;\n    }, t.create = function () {\n      var t = new To(16);\n      return To != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0), t[0] = 1, t[5] = 1, t[10] = 1, t[15] = 1, t;\n    }, t.create$1 = zo, t.createExpression = Gn, t.createLayout = na, t.createStyleLayer = function (t) {\n      return \"custom\" === t.type ? new xd(t) : new wd[t.type](t);\n    }, t.cross = tl, t.degToRad = x, t.distance = function (t, e) {\n      return Math.hypot(e[0] - t[0], e[1] - t[1], e[2] - t[2]);\n    }, t.div = function (t, e, r) {\n      return t[0] = e[0] / r[0], t[1] = e[1] / r[1], t[2] = e[2] / r[2], t;\n    }, t.dot = Qo, t.earthRadius = tu, t.ease = A, t.easeCubicInOut = w, t.ecefToLatLng = function (_ref128) {\n      var _ref129 = _slicedToArray(_ref128, 3),\n        t = _ref129[0],\n        e = _ref129[1],\n        r = _ref129[2];\n      var n = Math.hypot(t, e, r),\n        i = Math.atan2(t, r),\n        s = .5 * Math.PI - Math.acos(-e / n);\n      return new ru(v(i), v(s));\n    }, t.emitValidationErrors = Ri, t.endsWith = L, t.enforceCacheSizeLimit = function (t) {\n      rt(), W && W.then(function (e) {\n        e.keys().then(function (r) {\n          for (var _n151 = 0; _n151 < r.length - t; _n151++) e.delete(r[_n151]);\n        });\n      });\n    }, t.evaluateSizeForFeature = tp, t.evaluateSizeForZoom = ep, t.evaluateVariableOffset = Sf, t.evented = Ls, t.exactEquals = function (t, e) {\n      return t[0] === e[0] && t[1] === e[1] && t[2] === e[2] && t[3] === e[3];\n    }, t.exactEquals$1 = function (t, e) {\n      return t[0] === e[0] && t[1] === e[1] && t[2] === e[2];\n    }, t.exported = Nt, t.exported$1 = s, t.extend = z, t.extend$1 = Wt, t.fillExtrusionHeightLift = bh, t.filterObject = R, t.fromMat4 = function (t, e) {\n      return t[0] = e[0], t[1] = e[1], t[2] = e[2], t[3] = e[4], t[4] = e[5], t[5] = e[6], t[6] = e[8], t[7] = e[9], t[8] = e[10], t;\n    }, t.fromQuat = function (t, e) {\n      var r = e[0],\n        n = e[1],\n        i = e[2],\n        s = e[3],\n        a = r + r,\n        o = n + n,\n        l = i + i,\n        u = r * a,\n        c = n * a,\n        h = n * o,\n        p = i * a,\n        f = i * o,\n        d = i * l,\n        y = s * a,\n        m = s * o,\n        g = s * l;\n      return t[0] = 1 - h - d, t[1] = c + g, t[2] = p - m, t[3] = 0, t[4] = c - g, t[5] = 1 - u - d, t[6] = f + y, t[7] = 0, t[8] = p + m, t[9] = f - y, t[10] = 1 - u - h, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }, t.fromRotation = function (t, e) {\n      var r = Math.sin(e),\n        n = Math.cos(e);\n      return t[0] = n, t[1] = r, t[2] = 0, t[3] = -r, t[4] = n, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t;\n    }, t.fromScaling = Ro, t.furthestTileCorner = function (t) {\n      var e = Math.round((t + 45 + 360) % 360 / 90) % 4;\n      return b[e];\n    }, t.getAABBPointSquareDist = function (t, e, r) {\n      var n = 0;\n      for (var _i153 = 0; _i153 < 2; ++_i153) {\n        var _s111 = r ? r[_i153] : 0;\n        t[_i153] > _s111 && (n += (t[_i153] - _s111) * (t[_i153] - _s111)), e[_i153] < _s111 && (n += (_s111 - e[_i153]) * (_s111 - e[_i153]));\n      }\n      return n;\n    }, t.getAnchorAlignment = Zp, t.getAnchorJustification = If, t.getBounds = function (t) {\n      var e = 1 / 0,\n        r = 1 / 0,\n        n = -1 / 0,\n        i = -1 / 0;\n      var _iterator170 = _createForOfIteratorHelper(t),\n        _step170;\n      try {\n        for (_iterator170.s(); !(_step170 = _iterator170.n()).done;) {\n          var _s112 = _step170.value;\n          e = Math.min(e, _s112.x), r = Math.min(r, _s112.y), n = Math.max(n, _s112.x), i = Math.max(i, _s112.y);\n        }\n      } catch (err) {\n        _iterator170.e(err);\n      } finally {\n        _iterator170.f();\n      }\n      return {\n        min: new d(e, r),\n        max: new d(n, i)\n      };\n    }, t.getColumn = Y, t.getGridMatrix = function (t, e, r, n) {\n      var i = e.getNorth(),\n        s = e.getSouth(),\n        a = e.getWest(),\n        o = e.getEast(),\n        l = 1 << t.z,\n        u = o - a,\n        c = i - s,\n        h = u / Sl,\n        p = -c / kl[r],\n        f = [0, h, 0, p, 0, 0, i, a, 0];\n      if (t.z > 0) {\n        var _t301 = 180 / n;\n        Bo(f, f, [_t301 / u + 1, 0, 0, 0, _t301 / c + 1, 0, -.5 * _t301 / h, .5 * _t301 / p, 1]);\n      }\n      return f[2] = l, f[5] = t.x, f[8] = t.y, f;\n    }, t.getImage = dt, t.getJSON = function (t, e) {\n      return lt(z(t, {\n        type: \"json\"\n      }), e);\n    }, t.getLatitudinalLod = function (t) {\n      var e = cu - 5;\n      t = S(t, -e, e) / e * 90;\n      var r = Math.pow(Math.abs(Math.sin(x(t))), 3);\n      return Math.round(r * (kl.length - 1));\n    }, t.getMapSessionAPI = Pt, t.getPerformanceMeasurement = jt, t.getProjection = rd, t.getRTLTextPluginStatus = Fs, t.getReferrer = ot, t.getTilePoint = function (t, _ref130) {\n      var e = _ref130.x,\n        r = _ref130.y;\n      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      return new d(((e - n) * t.scale - t.x) * ko, (r * t.scale - t.y) * ko);\n    }, t.getTileVec3 = function (t, e) {\n      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      return No(((e.x - r) * t.scale - t.x) * ko, (e.y * t.scale - t.y) * ko, uu(e.z, e.y));\n    }, t.getVideo = function (t, r) {\n      var n = e.document.createElement(\"video\");\n      n.muted = !0, n.onloadstart = function () {\n        r(null, n);\n      };\n      for (var _r206 = 0; _r206 < t.length; _r206++) {\n        var _i154 = e.document.createElement(\"source\");\n        ct(t[_r206]) || (n.crossOrigin = \"Anonymous\"), _i154.src = t[_r206], n.appendChild(_i154);\n      }\n      return {\n        cancel: function cancel() {}\n      };\n    }, t.globeCenterToScreenPoint = function (t) {\n      var e = [0, 0, 0],\n        r = Eo(new Float64Array(16));\n      return Po(r, t.pixelMatrix, t.globeMatrix), el(e, e, r), new d(e[0], e[1]);\n    }, t.globeDenormalizeECEF = Zl, t.globeECEFOrigin = function (t, e) {\n      var r = [0, 0, 0];\n      return el(r, r, Gl(Pl(e.canonical))), el(r, r, t), r;\n    }, t.globeMetersToEcef = zl, t.globeNormalizeECEF = Gl, t.globePixelsToTileUnits = function (t, e) {\n      return ko / (512 * Math.pow(2, t)) * ql(Pl(e));\n    }, t.globePoleMatrixForTile = function (t, e, r) {\n      var n = Eo(new Float64Array(16)),\n        i = (e / (1 << t) - .5) * Math.PI * 2;\n      return Fo(n, r.globeMatrix, i), Float32Array.from(n);\n    }, t.globeTileBounds = Pl, t.globeTiltAtLngLat = Yl, t.globeToMercatorTransition = Kl, t.globeUseCustomAntiAliasing = function (t, e, r) {\n      var n = Kl(r.zoom),\n        i = t.style.map._antialias,\n        s = !!e.extStandardDerivatives,\n        a = e.extStandardDerivativesForceOff || t.terrain && t.terrain.exaggeration() > 0;\n      return 0 === n && !i && !a && s;\n    }, t.identity = Eo, t.identity$1 = hl, t.invert = Co, t.isFullscreen = function () {\n      return !!e.document.fullscreenElement || !!e.document.webkitFullscreenElement;\n    }, t.isLngLatBehindGlobe = Hl, t.isMapAuthenticated = function (t) {\n      return Dt.has(t);\n    }, t.isMapboxURL = mt, t.isSafariWithAntialiasingBug = function (t) {\n      var e = t.navigator ? t.navigator.userAgent : null;\n      return !!X(t) && e && (e.match(\"Version/15.4\") || e.match(\"Version/15.5\") || e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/));\n    }, t.latFromMercatorY = lu, t.latLngToECEF = Ul, t.len = al, t.length = qo, t.length$1 = function (t) {\n      return Math.hypot(t[0], t[1], t[2], t[3]);\n    }, t.lngFromMercatorX = ou, t.loadVectorTile = xy, t.makeRequest = lt, t.mapValue = function (t, e, r, n, i) {\n      return S((t - e) / (r - e) * (i - n) + n, n, i);\n    }, t.mercatorScale = hu, t.mercatorXfromLng = iu, t.mercatorYfromLat = su, t.mercatorZfromAltitude = au, t.mul = $o, t.mul$1 = sl, t.multiply = Po, t.multiply$1 = Bo, t.multiply$2 = Xo, t.nextPowerOfTwo = P, t.normalize = Jo, t.normalize$1 = dl, t.normalize$2 = ll, t.number = Mr, t.ortho = function (t, e, r, n, i, s, a) {\n      var o = 1 / (e - r),\n        l = 1 / (n - i),\n        u = 1 / (s - a);\n      return t[0] = -2 * o, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = -2 * l, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 2 * u, t[11] = 0, t[12] = (e + r) * o, t[13] = (i + n) * l, t[14] = (a + s) * u, t[15] = 1, t;\n    }, t.pbf = op, t.perspective = function (t, e, r, n, i) {\n      var s,\n        a = 1 / Math.tan(e / 2);\n      return t[0] = a / r, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = a, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = -1, t[12] = 0, t[13] = 0, t[15] = 0, null != i && i !== 1 / 0 ? (t[10] = (i + n) * (s = 1 / (n - i)), t[14] = 2 * i * n * s) : (t[10] = -1, t[14] = -2 * n), t;\n    }, t.pick = function (t, e) {\n      var r = {};\n      for (var _n152 = 0; _n152 < e.length; _n152++) {\n        var _i155 = e[_n152];\n        _i155 in t && (r[_i155] = t[_i155]);\n      }\n      return r;\n    }, t.plugin = js, t.pointGeometry = d, t.polesInViewport = function (t) {\n      var e = Eo(new Float64Array(16));\n      Po(e, t.pixelMatrix, t.globeMatrix);\n      var r = [0, Il, 0],\n        n = [0, Ml, 0];\n      return el(r, r, e), el(n, n, e), [r[0] > 0 && r[0] <= t.width && r[1] > 0 && r[1] <= t.height && !Hl(t, new ru(t.center.lat, 90)), n[0] > 0 && n[0] <= t.width && n[1] > 0 && n[1] <= t.height && !Hl(t, new ru(t.center.lat, -90))];\n    }, t.polygonContainsPoint = Du, t.polygonIntersectsBox = Vu, t.polygonIntersectsPolygon = ku, t.polygonizeBounds = function (t, e) {\n      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !0;\n      var i = new d(r, r),\n        s = t.sub(i),\n        a = e.add(i),\n        o = [s, new d(a.x, s.y), a, new d(s.x, a.y)];\n      return n && o.push(s.clone()), o;\n    }, t.posAttributes = xl, t.postMapLoadEvent = zt, t.postPerformanceEvent = Et, t.postTurnstileEvent = Mt, t.potpack = Cp, t.prevPowerOfTwo = function (t) {\n      return t <= 1 ? 1 : Math.pow(2, Math.floor(Math.log(t) / Math.LN2));\n    }, t.radToDeg = v, t.refProperties = [\"type\", \"source\", \"source-layer\", \"minzoom\", \"maxzoom\", \"filter\", \"layout\"], t.registerForPluginStateChange = function (t) {\n      return t({\n        pluginStatus: Cs,\n        pluginURL: Ps\n      }), Ls.on(\"pluginStateChange\", t), t;\n    }, t.removeAuthState = function (t) {\n      Dt.delete(t);\n    }, t.renderColorRamp = ec, t.resample = du, t.rotateX = Lo, t.rotateX$1 = pl, t.rotateY = Fo, t.rotateY$1 = fl, t.rotateZ = function (t, e, r) {\n      var n = Math.sin(r),\n        i = Math.cos(r),\n        s = e[0],\n        a = e[1],\n        o = e[2],\n        l = e[3],\n        u = e[4],\n        c = e[5],\n        h = e[6],\n        p = e[7];\n      return e !== t && (t[8] = e[8], t[9] = e[9], t[10] = e[10], t[11] = e[11], t[12] = e[12], t[13] = e[13], t[14] = e[14], t[15] = e[15]), t[0] = s * i + u * n, t[1] = a * i + c * n, t[2] = o * i + h * n, t[3] = l * i + p * n, t[4] = u * i - s * n, t[5] = c * i - a * n, t[6] = h * i - o * n, t[7] = p * i - l * n, t;\n    }, t.rotateZ$1 = function (t, e, r) {\n      r *= .5;\n      var n = e[0],\n        i = e[1],\n        s = e[2],\n        a = e[3],\n        o = Math.sin(r),\n        l = Math.cos(r);\n      return t[0] = n * l + i * o, t[1] = i * l - n * o, t[2] = s * l + a * o, t[3] = a * l - s * o, t;\n    }, t.scale = Vo, t.scale$1 = ol, t.scale$2 = Ho, t.scaleAndAdd = Wo, t.set = function (t, e, r, n) {\n      return t[0] = e, t[1] = r, t[2] = n, t;\n    }, t.setCacheLimits = function (t, e) {\n      Q = t, tt = e;\n    }, t.setColumn = function (t, e, r) {\n      t[4 * e + 0] = r[0], t[4 * e + 1] = r[1], t[4 * e + 2] = r[2], t[4 * e + 3] = r[3];\n    }, t.setRTLTextPlugin = function (t, e) {\n      var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n      if (Cs === Ts || Cs === zs || Cs === Bs) throw new Error(\"setRTLTextPlugin cannot be called multiple times.\");\n      Ps = Nt.resolveURL(t), Cs = Ts, Es = e, Vs(), r || Rs();\n    }, t.smoothstep = k, t.spec = Ht, t.squaredLength = function (t) {\n      var e = t[0],\n        r = t[1],\n        n = t[2];\n      return e * e + r * r + n * n;\n    }, t.storeAuthState = function (t, e) {\n      e ? Dt.add(t) : Dt.delete(t);\n    }, t.sub = il, t.subtract = Zo, t.symbolSize = rp, t.tileAABB = function (t, e, r, n, i, s, a, o, l) {\n      if (\"globe\" === l.name) return Fl(t, e, new kh(r, n, i));\n      var u = Vf({\n        z: r,\n        x: n,\n        y: i\n      }, l);\n      return new _l([(s + u.x / u.scale) * e, e * (u.y / u.scale), a], [(s + u.x2 / u.scale) * e, e * (u.y2 / u.scale), o]);\n    }, t.tileCornersToBounds = Rl, t.tileTransform = Vf, t.transformMat3 = function (t, e, r) {\n      var n = e[0],\n        i = e[1],\n        s = e[2];\n      return t[0] = n * r[0] + i * r[3] + s * r[6], t[1] = n * r[1] + i * r[4] + s * r[7], t[2] = n * r[2] + i * r[5] + s * r[8], t;\n    }, t.transformMat4 = el, t.transformMat4$1 = ul, t.transformQuat = rl, t.transitionTileAABBinECEF = Vl, t.translate = Do, t.transpose = function (t, e) {\n      if (t === e) {\n        var r = e[1],\n          n = e[2],\n          i = e[5];\n        t[1] = e[3], t[2] = e[6], t[3] = r, t[5] = e[7], t[6] = n, t[7] = i;\n      } else t[0] = e[0], t[1] = e[3], t[2] = e[6], t[3] = e[1], t[4] = e[4], t[5] = e[7], t[6] = e[2], t[7] = e[5], t[8] = e[8];\n      return t;\n    }, t.triggerPluginCompletionEvent = Ds, t.uniqueId = E, t.updateGlobeVertexNormal = function (t, e, r, n, i) {\n      var s = 5 * e + 2;\n      t.float32[s + 0] = r, t.float32[s + 1] = n, t.float32[s + 2] = i;\n    }, t.validateCustomStyleLayer = function (t) {\n      var e = [],\n        r = t.id;\n      return void 0 === r && e.push({\n        message: \"layers.\".concat(r, \": missing required property \\\"id\\\"\")\n      }), void 0 === t.render && e.push({\n        message: \"layers.\".concat(r, \": missing required method \\\"render\\\"\")\n      }), t.renderingMode && \"2d\" !== t.renderingMode && \"3d\" !== t.renderingMode && e.push({\n        message: \"layers.\".concat(r, \": property \\\"renderingMode\\\" must be either \\\"2d\\\" or \\\"3d\\\"\")\n      }), e;\n    }, t.validateFilter = function (t) {\n      return Fi(xi(t));\n    }, t.validateFog = function (t) {\n      return Fi(Bi(t));\n    }, t.validateLayer = function (t) {\n      return Fi(Ai(t));\n    }, t.validateLight = function (t) {\n      return Fi(Ti(t));\n    }, t.validateSource = function (t) {\n      return Fi(Ii(t));\n    }, t.validateStyle = Di, t.validateTerrain = function (t) {\n      return Fi(zi(t));\n    }, t.values = T, t.vectorTile = Xc, t.version = r, t.warnOnce = U, t.window = e, t.wrap = I;\n  });\n  define([\"./shared\"], function (e) {\n    \"use strict\";\n\n    function t(e) {\n      if (\"number\" == typeof e || \"boolean\" == typeof e || \"string\" == typeof e || null == e) return JSON.stringify(e);\n      if (Array.isArray(e)) {\n        var _r207 = \"[\";\n        var _iterator171 = _createForOfIteratorHelper(e),\n          _step171;\n        try {\n          for (_iterator171.s(); !(_step171 = _iterator171.n()).done;) {\n            var _o63 = _step171.value;\n            _r207 += \"\".concat(t(_o63), \",\");\n          }\n        } catch (err) {\n          _iterator171.e(err);\n        } finally {\n          _iterator171.f();\n        }\n        return \"\".concat(_r207, \"]\");\n      }\n      var r = \"{\";\n      var _iterator172 = _createForOfIteratorHelper(Object.keys(e).sort()),\n        _step172;\n      try {\n        for (_iterator172.s(); !(_step172 = _iterator172.n()).done;) {\n          var _o64 = _step172.value;\n          r += \"\".concat(_o64, \":\").concat(t(e[_o64]), \",\");\n        }\n      } catch (err) {\n        _iterator172.e(err);\n      } finally {\n        _iterator172.f();\n      }\n      return \"\".concat(r, \"}\");\n    }\n    function r(r) {\n      var o = \"\";\n      var _iterator173 = _createForOfIteratorHelper(e.refProperties),\n        _step173;\n      try {\n        for (_iterator173.s(); !(_step173 = _iterator173.n()).done;) {\n          var _n153 = _step173.value;\n          o += \"/\".concat(t(r[_n153]));\n        }\n      } catch (err) {\n        _iterator173.e(err);\n      } finally {\n        _iterator173.f();\n      }\n      return o;\n    }\n    var o = /*#__PURE__*/function () {\n      function o(e) {\n        _classCallCheck(this, o);\n        this.keyCache = {}, e && this.replace(e);\n      }\n      _createClass(o, [{\n        key: \"replace\",\n        value: function replace(e) {\n          this._layerConfigs = {}, this._layers = {}, this.update(e, []);\n        }\n      }, {\n        key: \"update\",\n        value: function update(t, o) {\n          var _this63 = this;\n          var _iterator174 = _createForOfIteratorHelper(t),\n            _step174;\n          try {\n            for (_iterator174.s(); !(_step174 = _iterator174.n()).done;) {\n              var _r208 = _step174.value;\n              this._layerConfigs[_r208.id] = _r208, (this._layers[_r208.id] = e.createStyleLayer(_r208)).compileFilter(), this.keyCache[_r208.id] && delete this.keyCache[_r208.id];\n            }\n          } catch (err) {\n            _iterator174.e(err);\n          } finally {\n            _iterator174.f();\n          }\n          var _iterator175 = _createForOfIteratorHelper(o),\n            _step175;\n          try {\n            for (_iterator175.s(); !(_step175 = _iterator175.n()).done;) {\n              var _e263 = _step175.value;\n              delete this.keyCache[_e263], delete this._layerConfigs[_e263], delete this._layers[_e263];\n            }\n          } catch (err) {\n            _iterator175.e(err);\n          } finally {\n            _iterator175.f();\n          }\n          this.familiesBySource = {};\n          var n = function (e, t) {\n            var o = {};\n            for (var _n154 = 0; _n154 < e.length; _n154++) {\n              var _i156 = t && t[e[_n154].id] || r(e[_n154]);\n              t && (t[e[_n154].id] = _i156);\n              var _s113 = o[_i156];\n              _s113 || (_s113 = o[_i156] = []), _s113.push(e[_n154]);\n            }\n            var n = [];\n            for (var _e262 in o) n.push(o[_e262]);\n            return n;\n          }(e.values(this._layerConfigs), this.keyCache);\n          var _iterator176 = _createForOfIteratorHelper(n),\n            _step176;\n          try {\n            for (_iterator176.s(); !(_step176 = _iterator176.n()).done;) {\n              var _e264 = _step176.value;\n              var _t302 = _e264.map(function (e) {\n                  return _this63._layers[e.id];\n                }),\n                _r209 = _t302[0];\n              if (\"none\" === _r209.visibility) continue;\n              var _o65 = _r209.source || \"\";\n              var _n155 = this.familiesBySource[_o65];\n              _n155 || (_n155 = this.familiesBySource[_o65] = {});\n              var _i157 = _r209.sourceLayer || \"_geojsonTileLayer\";\n              var _s114 = _n155[_i157];\n              _s114 || (_s114 = _n155[_i157] = []), _s114.push(_t302);\n            }\n          } catch (err) {\n            _iterator176.e(err);\n          } finally {\n            _iterator176.f();\n          }\n        }\n      }]);\n      return o;\n    }();\n    var n = /*#__PURE__*/function () {\n      function n() {\n        _classCallCheck(this, n);\n      }\n      _createClass(n, [{\n        key: \"loadTile\",\n        value: function loadTile(t, r) {\n          var o = t.uid,\n            n = t.encoding,\n            i = t.rawImageData,\n            s = t.padding,\n            a = t.buildQuadTree,\n            l = e.window.ImageBitmap && i instanceof e.window.ImageBitmap ? this.getImageData(i, s) : i;\n          r(null, new e.DEMData(o, l, n, s < 1, a));\n        }\n      }, {\n        key: \"getImageData\",\n        value: function getImageData(e, t) {\n          this.offscreenCanvas && this.offscreenCanvasContext || (this.offscreenCanvas = new OffscreenCanvas(e.width, e.height), this.offscreenCanvasContext = this.offscreenCanvas.getContext(\"2d\", {\n            willReadFrequently: !0\n          })), this.offscreenCanvas.width = e.width, this.offscreenCanvas.height = e.height, this.offscreenCanvasContext.drawImage(e, 0, 0, e.width, e.height);\n          var r = this.offscreenCanvasContext.getImageData(-t, -t, e.width + 2 * t, e.height + 2 * t);\n          return this.offscreenCanvasContext.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height), r;\n        }\n      }]);\n      return n;\n    }();\n    var i = function e(t, r) {\n      var o,\n        n = t && t.type;\n      if (\"FeatureCollection\" === n) for (o = 0; o < t.features.length; o++) e(t.features[o], r);else if (\"GeometryCollection\" === n) for (o = 0; o < t.geometries.length; o++) e(t.geometries[o], r);else if (\"Feature\" === n) e(t.geometry, r);else if (\"Polygon\" === n) s(t.coordinates, r);else if (\"MultiPolygon\" === n) for (o = 0; o < t.coordinates.length; o++) s(t.coordinates[o], r);\n      return t;\n    };\n    function s(e, t) {\n      if (0 !== e.length) {\n        a(e[0], t);\n        for (var r = 1; r < e.length; r++) a(e[r], !t);\n      }\n    }\n    function a(e, t) {\n      for (var r = 0, o = 0, n = 0, i = e.length, s = i - 1; n < i; s = n++) {\n        var a = (e[n][0] - e[s][0]) * (e[s][1] + e[n][1]),\n          l = r + a;\n        o += Math.abs(r) >= Math.abs(a) ? r - l + a : a - l + r, r = l;\n      }\n      r + o >= 0 != !!t && e.reverse();\n    }\n    var l = e.VectorTileFeature.prototype.toGeoJSON;\n    var u = /*#__PURE__*/function () {\n      function u(t) {\n        _classCallCheck(this, u);\n        this._feature = t, this.extent = e.EXTENT, this.type = t.type, this.properties = t.tags, \"id\" in t && !isNaN(t.id) && (this.id = parseInt(t.id, 10));\n      }\n      _createClass(u, [{\n        key: \"loadGeometry\",\n        value: function loadGeometry() {\n          if (1 === this._feature.type) {\n            var _t303 = [];\n            var _iterator177 = _createForOfIteratorHelper(this._feature.geometry),\n              _step177;\n            try {\n              for (_iterator177.s(); !(_step177 = _iterator177.n()).done;) {\n                var _r210 = _step177.value;\n                _t303.push([new e.pointGeometry(_r210[0], _r210[1])]);\n              }\n            } catch (err) {\n              _iterator177.e(err);\n            } finally {\n              _iterator177.f();\n            }\n            return _t303;\n          }\n          {\n            var _t304 = [];\n            var _iterator178 = _createForOfIteratorHelper(this._feature.geometry),\n              _step178;\n            try {\n              for (_iterator178.s(); !(_step178 = _iterator178.n()).done;) {\n                var _r211 = _step178.value;\n                var _o66 = [];\n                var _iterator179 = _createForOfIteratorHelper(_r211),\n                  _step179;\n                try {\n                  for (_iterator179.s(); !(_step179 = _iterator179.n()).done;) {\n                    var _t305 = _step179.value;\n                    _o66.push(new e.pointGeometry(_t305[0], _t305[1]));\n                  }\n                } catch (err) {\n                  _iterator179.e(err);\n                } finally {\n                  _iterator179.f();\n                }\n                _t304.push(_o66);\n              }\n            } catch (err) {\n              _iterator178.e(err);\n            } finally {\n              _iterator178.f();\n            }\n            return _t304;\n          }\n        }\n      }, {\n        key: \"toGeoJSON\",\n        value: function toGeoJSON(e, t, r) {\n          return l.call(this, e, t, r);\n        }\n      }]);\n      return u;\n    }();\n    var h = /*#__PURE__*/function () {\n      function h(t) {\n        _classCallCheck(this, h);\n        this.layers = {\n          _geojsonTileLayer: this\n        }, this.name = \"_geojsonTileLayer\", this.extent = e.EXTENT, this.length = t.length, this._features = t;\n      }\n      _createClass(h, [{\n        key: \"feature\",\n        value: function feature(e) {\n          return new u(this._features[e]);\n        }\n      }]);\n      return h;\n    }();\n    var c = {},\n      f = {\n        get exports() {\n          return c;\n        },\n        set exports(e) {\n          c = e;\n        }\n      },\n      p = e.pointGeometry,\n      g = e.vectorTile.VectorTileFeature,\n      d = m;\n    function m(e, t) {\n      this.options = t || {}, this.features = e, this.length = e.length;\n    }\n    function y(e, t) {\n      this.id = \"number\" == typeof e.id ? e.id : void 0, this.type = e.type, this.rawGeometry = 1 === e.type ? [e.geometry] : e.geometry, this.properties = e.tags, this.extent = t || 4096;\n    }\n    m.prototype.feature = function (e) {\n      return new y(this.features[e], this.options.extent);\n    }, y.prototype.loadGeometry = function () {\n      var e = this.rawGeometry;\n      this.geometry = [];\n      for (var t = 0; t < e.length; t++) {\n        for (var r = e[t], o = [], n = 0; n < r.length; n++) o.push(new p(r[n][0], r[n][1]));\n        this.geometry.push(o);\n      }\n      return this.geometry;\n    }, y.prototype.bbox = function () {\n      this.geometry || this.loadGeometry();\n      for (var e = this.geometry, t = 1 / 0, r = -1 / 0, o = 1 / 0, n = -1 / 0, i = 0; i < e.length; i++) for (var s = e[i], a = 0; a < s.length; a++) {\n        var l = s[a];\n        t = Math.min(t, l.x), r = Math.max(r, l.x), o = Math.min(o, l.y), n = Math.max(n, l.y);\n      }\n      return [t, o, r, n];\n    }, y.prototype.toGeoJSON = g.prototype.toGeoJSON;\n    var v = e.pbf,\n      x = d;\n    function w(e) {\n      var t = new v();\n      return function (e, t) {\n        for (var r in e.layers) t.writeMessage(3, S, e.layers[r]);\n      }(e, t), t.finish();\n    }\n    function S(e, t) {\n      var r;\n      t.writeVarintField(15, e.version || 1), t.writeStringField(1, e.name || \"\"), t.writeVarintField(5, e.extent || 4096);\n      var o = {\n        keys: [],\n        values: [],\n        keycache: {},\n        valuecache: {}\n      };\n      for (r = 0; r < e.length; r++) o.feature = e.feature(r), t.writeMessage(2, M, o);\n      var n = o.keys;\n      for (r = 0; r < n.length; r++) t.writeStringField(3, n[r]);\n      var i = o.values;\n      for (r = 0; r < i.length; r++) t.writeMessage(4, T, i[r]);\n    }\n    function M(e, t) {\n      var r = e.feature;\n      void 0 !== r.id && t.writeVarintField(1, r.id), t.writeMessage(2, P, e), t.writeVarintField(3, r.type), t.writeMessage(4, I, r);\n    }\n    function P(e, t) {\n      var r = e.feature,\n        o = e.keys,\n        n = e.values,\n        i = e.keycache,\n        s = e.valuecache;\n      for (var a in r.properties) {\n        var l = r.properties[a],\n          u = i[a];\n        if (null !== l) {\n          void 0 === u && (o.push(a), i[a] = u = o.length - 1), t.writeVarint(u);\n          var h = typeof l;\n          \"string\" !== h && \"boolean\" !== h && \"number\" !== h && (l = JSON.stringify(l));\n          var c = h + \":\" + l,\n            f = s[c];\n          void 0 === f && (n.push(l), s[c] = f = n.length - 1), t.writeVarint(f);\n        }\n      }\n    }\n    function b(e, t) {\n      return (t << 3) + (7 & e);\n    }\n    function k(e) {\n      return e << 1 ^ e >> 31;\n    }\n    function I(e, t) {\n      for (var r = e.loadGeometry(), o = e.type, n = 0, i = 0, s = r.length, a = 0; a < s; a++) {\n        var l = r[a],\n          u = 1;\n        1 === o && (u = l.length), t.writeVarint(b(1, u));\n        for (var h = 3 === o ? l.length - 1 : l.length, c = 0; c < h; c++) {\n          1 === c && 1 !== o && t.writeVarint(b(2, h - 1));\n          var f = l[c].x - n,\n            p = l[c].y - i;\n          t.writeVarint(k(f)), t.writeVarint(k(p)), n += f, i += p;\n        }\n        3 === o && t.writeVarint(b(7, 1));\n      }\n    }\n    function T(e, t) {\n      var r = typeof e;\n      \"string\" === r ? t.writeStringField(1, e) : \"boolean\" === r ? t.writeBooleanField(7, e) : \"number\" === r && (e % 1 != 0 ? t.writeDoubleField(3, e) : e < 0 ? t.writeSVarintField(6, e) : t.writeVarintField(5, e));\n    }\n    function _(e, t, r, o, n, i) {\n      if (n - o <= r) return;\n      var s = o + n >> 1;\n      L(e, t, s, o, n, i % 2), _(e, t, r, o, s - 1, i + 1), _(e, t, r, s + 1, n, i + 1);\n    }\n    function L(e, t, r, o, n, i) {\n      for (; n > o;) {\n        if (n - o > 600) {\n          var _s115 = n - o + 1,\n            _a101 = r - o + 1,\n            _l55 = Math.log(_s115),\n            _u50 = .5 * Math.exp(2 * _l55 / 3),\n            _h32 = .5 * Math.sqrt(_l55 * _u50 * (_s115 - _u50) / _s115) * (_a101 - _s115 / 2 < 0 ? -1 : 1);\n          L(e, t, r, Math.max(o, Math.floor(r - _a101 * _u50 / _s115 + _h32)), Math.min(n, Math.floor(r + (_s115 - _a101) * _u50 / _s115 + _h32)), i);\n        }\n        var _s116 = t[2 * r + i];\n        var _a102 = o,\n          _l56 = n;\n        for (C(e, t, o, r), t[2 * n + i] > _s116 && C(e, t, o, n); _a102 < _l56;) {\n          for (C(e, t, _a102, _l56), _a102++, _l56--; t[2 * _a102 + i] < _s116;) _a102++;\n          for (; t[2 * _l56 + i] > _s116;) _l56--;\n        }\n        t[2 * o + i] === _s116 ? C(e, t, o, _l56) : (_l56++, C(e, t, _l56, n)), _l56 <= r && (o = _l56 + 1), r <= _l56 && (n = _l56 - 1);\n      }\n    }\n    function C(e, t, r, o) {\n      O(e, r, o), O(t, 2 * r, 2 * o), O(t, 2 * r + 1, 2 * o + 1);\n    }\n    function O(e, t, r) {\n      var o = e[t];\n      e[t] = e[r], e[r] = o;\n    }\n    function z(e, t, r, o) {\n      var n = e - r,\n        i = t - o;\n      return n * n + i * i;\n    }\n    f.exports = w, c.fromVectorTileJs = w, c.fromGeojsonVt = function (e, t) {\n      t = t || {};\n      var r = {};\n      for (var o in e) r[o] = new x(e[o].features, t), r[o].name = o, r[o].version = t.version, r[o].extent = t.extent;\n      return w({\n        layers: r\n      });\n    }, c.GeoJSONWrapper = x;\n    var E = function E(e) {\n        return e[0];\n      },\n      F = function F(e) {\n        return e[1];\n      };\n    var N = /*#__PURE__*/function () {\n      function N(e) {\n        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : E;\n        var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : F;\n        var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 64;\n        var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : Float64Array;\n        _classCallCheck(this, N);\n        this.nodeSize = o, this.points = e;\n        var i = e.length < 65536 ? Uint16Array : Uint32Array,\n          s = this.ids = new i(e.length),\n          a = this.coords = new n(2 * e.length);\n        for (var _o67 = 0; _o67 < e.length; _o67++) s[_o67] = _o67, a[2 * _o67] = t(e[_o67]), a[2 * _o67 + 1] = r(e[_o67]);\n        _(s, a, o, 0, s.length - 1, 0);\n      }\n      _createClass(N, [{\n        key: \"range\",\n        value: function range(e, t, r, o) {\n          return function (e, t, r, o, n, i, s) {\n            var a = [0, e.length - 1, 0],\n              l = [];\n            var u, h;\n            for (; a.length;) {\n              var _c39 = a.pop(),\n                _f20 = a.pop(),\n                _p31 = a.pop();\n              if (_f20 - _p31 <= s) {\n                for (var _s117 = _p31; _s117 <= _f20; _s117++) u = t[2 * _s117], h = t[2 * _s117 + 1], u >= r && u <= n && h >= o && h <= i && l.push(e[_s117]);\n                continue;\n              }\n              var _g14 = Math.floor((_p31 + _f20) / 2);\n              u = t[2 * _g14], h = t[2 * _g14 + 1], u >= r && u <= n && h >= o && h <= i && l.push(e[_g14]);\n              var _d17 = (_c39 + 1) % 2;\n              (0 === _c39 ? r <= u : o <= h) && (a.push(_p31), a.push(_g14 - 1), a.push(_d17)), (0 === _c39 ? n >= u : i >= h) && (a.push(_g14 + 1), a.push(_f20), a.push(_d17));\n            }\n            return l;\n          }(this.ids, this.coords, e, t, r, o, this.nodeSize);\n        }\n      }, {\n        key: \"within\",\n        value: function within(e, t, r) {\n          return function (e, t, r, o, n, i) {\n            var s = [0, e.length - 1, 0],\n              a = [],\n              l = n * n;\n            for (; s.length;) {\n              var _u51 = s.pop(),\n                _h33 = s.pop(),\n                _c40 = s.pop();\n              if (_h33 - _c40 <= i) {\n                for (var _n156 = _c40; _n156 <= _h33; _n156++) z(t[2 * _n156], t[2 * _n156 + 1], r, o) <= l && a.push(e[_n156]);\n                continue;\n              }\n              var _f21 = Math.floor((_c40 + _h33) / 2),\n                _p32 = t[2 * _f21],\n                _g15 = t[2 * _f21 + 1];\n              z(_p32, _g15, r, o) <= l && a.push(e[_f21]);\n              var _d18 = (_u51 + 1) % 2;\n              (0 === _u51 ? r - n <= _p32 : o - n <= _g15) && (s.push(_c40), s.push(_f21 - 1), s.push(_d18)), (0 === _u51 ? r + n >= _p32 : o + n >= _g15) && (s.push(_f21 + 1), s.push(_h33), s.push(_d18));\n            }\n            return a;\n          }(this.ids, this.coords, e, t, r, this.nodeSize);\n        }\n      }]);\n      return N;\n    }();\n    var j = {\n        minZoom: 0,\n        maxZoom: 16,\n        minPoints: 2,\n        radius: 40,\n        extent: 512,\n        nodeSize: 64,\n        log: !1,\n        generateId: !1,\n        reduce: null,\n        map: function map(e) {\n          return e;\n        }\n      },\n      Z = Math.fround || (G = new Float32Array(1), function (e) {\n        return G[0] = +e, G[0];\n      });\n    var G;\n    var J = /*#__PURE__*/function () {\n      function J(e) {\n        _classCallCheck(this, J);\n        this.options = B(Object.create(j), e), this.trees = new Array(this.options.maxZoom + 1);\n      }\n      _createClass(J, [{\n        key: \"load\",\n        value: function load(e) {\n          var _this$options = this.options,\n            t = _this$options.log,\n            r = _this$options.minZoom,\n            o = _this$options.maxZoom,\n            n = _this$options.nodeSize;\n          t && console.time(\"total time\");\n          var i = \"prepare \".concat(e.length, \" points\");\n          t && console.time(i), this.points = e;\n          var s = [];\n          for (var _t306 = 0; _t306 < e.length; _t306++) e[_t306].geometry && s.push(Y(e[_t306], _t306));\n          this.trees[o + 1] = new N(s, R, q, n, Float32Array), t && console.timeEnd(i);\n          for (var _e265 = o; _e265 >= r; _e265--) {\n            var _r212 = +Date.now();\n            s = this._cluster(s, _e265), this.trees[_e265] = new N(s, R, q, n, Float32Array), t && console.log(\"z%d: %d clusters in %dms\", _e265, s.length, +Date.now() - _r212);\n          }\n          return t && console.timeEnd(\"total time\"), this;\n        }\n      }, {\n        key: \"getClusters\",\n        value: function getClusters(e, t) {\n          var r = ((e[0] + 180) % 360 + 360) % 360 - 180;\n          var o = Math.max(-90, Math.min(90, e[1]));\n          var n = 180 === e[2] ? 180 : ((e[2] + 180) % 360 + 360) % 360 - 180;\n          var i = Math.max(-90, Math.min(90, e[3]));\n          if (e[2] - e[0] >= 360) r = -180, n = 180;else if (r > n) {\n            var _e266 = this.getClusters([r, o, 180, i], t),\n              _s118 = this.getClusters([-180, o, n, i], t);\n            return _e266.concat(_s118);\n          }\n          var s = this.trees[this._limitZoom(t)],\n            a = s.range(A(r), D(i), A(n), D(o)),\n            l = [];\n          var _iterator180 = _createForOfIteratorHelper(a),\n            _step180;\n          try {\n            for (_iterator180.s(); !(_step180 = _iterator180.n()).done;) {\n              var _e267 = _step180.value;\n              var _t307 = s.points[_e267];\n              l.push(_t307.numPoints ? X(_t307) : this.points[_t307.index]);\n            }\n          } catch (err) {\n            _iterator180.e(err);\n          } finally {\n            _iterator180.f();\n          }\n          return l;\n        }\n      }, {\n        key: \"getChildren\",\n        value: function getChildren(e) {\n          var t = this._getOriginId(e),\n            r = this._getOriginZoom(e),\n            o = \"No cluster with the specified id.\",\n            n = this.trees[r];\n          if (!n) throw new Error(o);\n          var i = n.points[t];\n          if (!i) throw new Error(o);\n          var s = this.options.radius / (this.options.extent * Math.pow(2, r - 1)),\n            a = n.within(i.x, i.y, s),\n            l = [];\n          var _iterator181 = _createForOfIteratorHelper(a),\n            _step181;\n          try {\n            for (_iterator181.s(); !(_step181 = _iterator181.n()).done;) {\n              var _t308 = _step181.value;\n              var _r213 = n.points[_t308];\n              _r213.parentId === e && l.push(_r213.numPoints ? X(_r213) : this.points[_r213.index]);\n            }\n          } catch (err) {\n            _iterator181.e(err);\n          } finally {\n            _iterator181.f();\n          }\n          if (0 === l.length) throw new Error(o);\n          return l;\n        }\n      }, {\n        key: \"getLeaves\",\n        value: function getLeaves(e, t, r) {\n          var o = [];\n          return this._appendLeaves(o, e, t = t || 10, r = r || 0, 0), o;\n        }\n      }, {\n        key: \"getTile\",\n        value: function getTile(e, t, r) {\n          var o = this.trees[this._limitZoom(e)],\n            n = Math.pow(2, e),\n            _this$options2 = this.options,\n            i = _this$options2.extent,\n            s = _this$options2.radius,\n            a = s / i,\n            l = (r - a) / n,\n            u = (r + 1 + a) / n,\n            h = {\n              features: []\n            };\n          return this._addTileFeatures(o.range((t - a) / n, l, (t + 1 + a) / n, u), o.points, t, r, n, h), 0 === t && this._addTileFeatures(o.range(1 - a / n, l, 1, u), o.points, n, r, n, h), t === n - 1 && this._addTileFeatures(o.range(0, l, a / n, u), o.points, -1, r, n, h), h.features.length ? h : null;\n        }\n      }, {\n        key: \"getClusterExpansionZoom\",\n        value: function getClusterExpansionZoom(e) {\n          var t = this._getOriginZoom(e) - 1;\n          for (; t <= this.options.maxZoom;) {\n            var _r214 = this.getChildren(e);\n            if (t++, 1 !== _r214.length) break;\n            e = _r214[0].properties.cluster_id;\n          }\n          return t;\n        }\n      }, {\n        key: \"_appendLeaves\",\n        value: function _appendLeaves(e, t, r, o, n) {\n          var i = this.getChildren(t);\n          var _iterator182 = _createForOfIteratorHelper(i),\n            _step182;\n          try {\n            for (_iterator182.s(); !(_step182 = _iterator182.n()).done;) {\n              var _t309 = _step182.value;\n              var _i158 = _t309.properties;\n              if (_i158 && _i158.cluster ? n + _i158.point_count <= o ? n += _i158.point_count : n = this._appendLeaves(e, _i158.cluster_id, r, o, n) : n < o ? n++ : e.push(_t309), e.length === r) break;\n            }\n          } catch (err) {\n            _iterator182.e(err);\n          } finally {\n            _iterator182.f();\n          }\n          return n;\n        }\n      }, {\n        key: \"_addTileFeatures\",\n        value: function _addTileFeatures(e, t, r, o, n, i) {\n          var _iterator183 = _createForOfIteratorHelper(e),\n            _step183;\n          try {\n            for (_iterator183.s(); !(_step183 = _iterator183.n()).done;) {\n              var _s119 = _step183.value;\n              var _e268 = t[_s119],\n                _a103 = _e268.numPoints;\n              var _l57 = void 0,\n                _u52 = void 0,\n                _h34 = void 0;\n              if (_a103) _l57 = V(_e268), _u52 = _e268.x, _h34 = _e268.y;else {\n                var _t310 = this.points[_e268.index];\n                _l57 = _t310.properties, _u52 = A(_t310.geometry.coordinates[0]), _h34 = D(_t310.geometry.coordinates[1]);\n              }\n              var _c41 = {\n                type: 1,\n                geometry: [[Math.round(this.options.extent * (_u52 * n - r)), Math.round(this.options.extent * (_h34 * n - o))]],\n                tags: _l57\n              };\n              var _f22 = void 0;\n              _a103 ? _f22 = _e268.id : this.options.generateId ? _f22 = _e268.index : this.points[_e268.index].id && (_f22 = this.points[_e268.index].id), void 0 !== _f22 && (_c41.id = _f22), i.features.push(_c41);\n            }\n          } catch (err) {\n            _iterator183.e(err);\n          } finally {\n            _iterator183.f();\n          }\n        }\n      }, {\n        key: \"_limitZoom\",\n        value: function _limitZoom(e) {\n          return Math.max(this.options.minZoom, Math.min(Math.floor(+e), this.options.maxZoom + 1));\n        }\n      }, {\n        key: \"_cluster\",\n        value: function _cluster(e, t) {\n          var r = [],\n            _this$options3 = this.options,\n            o = _this$options3.radius,\n            n = _this$options3.extent,\n            i = _this$options3.reduce,\n            s = _this$options3.minPoints,\n            a = o / (n * Math.pow(2, t));\n          for (var _o68 = 0; _o68 < e.length; _o68++) {\n            var _n157 = e[_o68];\n            if (_n157.zoom <= t) continue;\n            _n157.zoom = t;\n            var _l58 = this.trees[t + 1],\n              _u53 = _l58.within(_n157.x, _n157.y, a),\n              _h35 = _n157.numPoints || 1;\n            var _c42 = _h35;\n            var _iterator184 = _createForOfIteratorHelper(_u53),\n              _step184;\n            try {\n              for (_iterator184.s(); !(_step184 = _iterator184.n()).done;) {\n                var _e271 = _step184.value;\n                var _r216 = _l58.points[_e271];\n                _r216.zoom > t && (_c42 += _r216.numPoints || 1);\n              }\n            } catch (err) {\n              _iterator184.e(err);\n            } finally {\n              _iterator184.f();\n            }\n            if (_c42 > _h35 && _c42 >= s) {\n              var _e269 = _n157.x * _h35,\n                _s120 = _n157.y * _h35,\n                _a104 = i && _h35 > 1 ? this._map(_n157, !0) : null;\n              var _f23 = (_o68 << 5) + (t + 1) + this.points.length;\n              var _iterator185 = _createForOfIteratorHelper(_u53),\n                _step185;\n              try {\n                for (_iterator185.s(); !(_step185 = _iterator185.n()).done;) {\n                  var _r215 = _step185.value;\n                  var _o69 = _l58.points[_r215];\n                  if (_o69.zoom <= t) continue;\n                  _o69.zoom = t;\n                  var _u54 = _o69.numPoints || 1;\n                  _e269 += _o69.x * _u54, _s120 += _o69.y * _u54, _o69.parentId = _f23, i && (_a104 || (_a104 = this._map(_n157, !0)), i(_a104, this._map(_o69)));\n                }\n              } catch (err) {\n                _iterator185.e(err);\n              } finally {\n                _iterator185.f();\n              }\n              _n157.parentId = _f23, r.push(W(_e269 / _c42, _s120 / _c42, _f23, _c42, _a104));\n            } else if (r.push(_n157), _c42 > 1) {\n              var _iterator186 = _createForOfIteratorHelper(_u53),\n                _step186;\n              try {\n                for (_iterator186.s(); !(_step186 = _iterator186.n()).done;) {\n                  var _e270 = _step186.value;\n                  var _o70 = _l58.points[_e270];\n                  _o70.zoom <= t || (_o70.zoom = t, r.push(_o70));\n                }\n              } catch (err) {\n                _iterator186.e(err);\n              } finally {\n                _iterator186.f();\n              }\n            }\n          }\n          return r;\n        }\n      }, {\n        key: \"_getOriginId\",\n        value: function _getOriginId(e) {\n          return e - this.points.length >> 5;\n        }\n      }, {\n        key: \"_getOriginZoom\",\n        value: function _getOriginZoom(e) {\n          return (e - this.points.length) % 32;\n        }\n      }, {\n        key: \"_map\",\n        value: function _map(e, t) {\n          if (e.numPoints) return t ? B({}, e.properties) : e.properties;\n          var r = this.points[e.index].properties,\n            o = this.options.map(r);\n          return t && o === r ? B({}, o) : o;\n        }\n      }]);\n      return J;\n    }();\n    function W(e, t, r, o, n) {\n      return {\n        x: Z(e),\n        y: Z(t),\n        zoom: 1 / 0,\n        id: r,\n        parentId: -1,\n        numPoints: o,\n        properties: n\n      };\n    }\n    function Y(e, t) {\n      var _e$geometry$coordinat = _slicedToArray(e.geometry.coordinates, 2),\n        r = _e$geometry$coordinat[0],\n        o = _e$geometry$coordinat[1];\n      return {\n        x: Z(A(r)),\n        y: Z(D(o)),\n        zoom: 1 / 0,\n        index: t,\n        parentId: -1\n      };\n    }\n    function X(e) {\n      return {\n        type: \"Feature\",\n        id: e.id,\n        properties: V(e),\n        geometry: {\n          type: \"Point\",\n          coordinates: [(t = e.x, 360 * (t - .5)), $(e.y)]\n        }\n      };\n      var t;\n    }\n    function V(e) {\n      var t = e.numPoints,\n        r = t >= 1e4 ? \"\".concat(Math.round(t / 1e3), \"k\") : t >= 1e3 ? Math.round(t / 100) / 10 + \"k\" : t;\n      return B(B({}, e.properties), {\n        cluster: !0,\n        cluster_id: e.id,\n        point_count: t,\n        point_count_abbreviated: r\n      });\n    }\n    function A(e) {\n      return e / 360 + .5;\n    }\n    function D(e) {\n      var t = Math.sin(e * Math.PI / 180),\n        r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;\n      return r < 0 ? 0 : r > 1 ? 1 : r;\n    }\n    function $(e) {\n      var t = (180 - 360 * e) * Math.PI / 180;\n      return 360 * Math.atan(Math.exp(t)) / Math.PI - 90;\n    }\n    function B(e, t) {\n      for (var _r217 in t) e[_r217] = t[_r217];\n      return e;\n    }\n    function R(e) {\n      return e.x;\n    }\n    function q(e) {\n      return e.y;\n    }\n    function U(e, t, r, o) {\n      for (var n, i = o, s = r - t >> 1, a = r - t, l = e[t], u = e[t + 1], h = e[r], c = e[r + 1], f = t + 3; f < r; f += 3) {\n        var p = Q(e[f], e[f + 1], l, u, h, c);\n        if (p > i) n = f, i = p;else if (p === i) {\n          var g = Math.abs(f - s);\n          g < a && (n = f, a = g);\n        }\n      }\n      i > o && (n - t > 3 && U(e, t, n, o), e[n + 2] = i, r - n > 3 && U(e, n, r, o));\n    }\n    function Q(e, t, r, o, n, i) {\n      var s = n - r,\n        a = i - o;\n      if (0 !== s || 0 !== a) {\n        var l = ((e - r) * s + (t - o) * a) / (s * s + a * a);\n        l > 1 ? (r = n, o = i) : l > 0 && (r += s * l, o += a * l);\n      }\n      return (s = e - r) * s + (a = t - o) * a;\n    }\n    function H(e, t, r, o) {\n      var n = {\n        id: void 0 === e ? null : e,\n        type: t,\n        geometry: r,\n        tags: o,\n        minX: 1 / 0,\n        minY: 1 / 0,\n        maxX: -1 / 0,\n        maxY: -1 / 0\n      };\n      return function (e) {\n        var t = e.geometry,\n          r = e.type;\n        if (\"Point\" === r || \"MultiPoint\" === r || \"LineString\" === r) K(e, t);else if (\"Polygon\" === r || \"MultiLineString\" === r) for (var o = 0; o < t.length; o++) K(e, t[o]);else if (\"MultiPolygon\" === r) for (o = 0; o < t.length; o++) for (var n = 0; n < t[o].length; n++) K(e, t[o][n]);\n      }(n), n;\n    }\n    function K(e, t) {\n      for (var r = 0; r < t.length; r += 3) e.minX = Math.min(e.minX, t[r]), e.minY = Math.min(e.minY, t[r + 1]), e.maxX = Math.max(e.maxX, t[r]), e.maxY = Math.max(e.maxY, t[r + 1]);\n    }\n    function ee(e, t, r, o) {\n      if (t.geometry) {\n        var n = t.geometry.coordinates,\n          i = t.geometry.type,\n          s = Math.pow(r.tolerance / ((1 << r.maxZoom) * r.extent), 2),\n          a = [],\n          l = t.id;\n        if (r.promoteId ? l = t.properties[r.promoteId] : r.generateId && (l = o || 0), \"Point\" === i) te(n, a);else if (\"MultiPoint\" === i) for (var u = 0; u < n.length; u++) te(n[u], a);else if (\"LineString\" === i) re(n, a, s, !1);else if (\"MultiLineString\" === i) {\n          if (r.lineMetrics) {\n            for (u = 0; u < n.length; u++) re(n[u], a = [], s, !1), e.push(H(l, \"LineString\", a, t.properties));\n            return;\n          }\n          oe(n, a, s, !1);\n        } else if (\"Polygon\" === i) oe(n, a, s, !0);else {\n          if (\"MultiPolygon\" !== i) {\n            if (\"GeometryCollection\" === i) {\n              for (u = 0; u < t.geometry.geometries.length; u++) ee(e, {\n                id: l,\n                geometry: t.geometry.geometries[u],\n                properties: t.properties\n              }, r, o);\n              return;\n            }\n            throw new Error(\"Input data is not a valid GeoJSON object.\");\n          }\n          for (u = 0; u < n.length; u++) {\n            var h = [];\n            oe(n[u], h, s, !0), a.push(h);\n          }\n        }\n        e.push(H(l, i, a, t.properties));\n      }\n    }\n    function te(e, t) {\n      t.push(ne(e[0])), t.push(ie(e[1])), t.push(0);\n    }\n    function re(e, t, r, o) {\n      for (var n, i, s = 0, a = 0; a < e.length; a++) {\n        var l = ne(e[a][0]),\n          u = ie(e[a][1]);\n        t.push(l), t.push(u), t.push(0), a > 0 && (s += o ? (n * u - l * i) / 2 : Math.sqrt(Math.pow(l - n, 2) + Math.pow(u - i, 2))), n = l, i = u;\n      }\n      var h = t.length - 3;\n      t[2] = 1, U(t, 0, h, r), t[h + 2] = 1, t.size = Math.abs(s), t.start = 0, t.end = t.size;\n    }\n    function oe(e, t, r, o) {\n      for (var n = 0; n < e.length; n++) {\n        var i = [];\n        re(e[n], i, r, o), t.push(i);\n      }\n    }\n    function ne(e) {\n      return e / 360 + .5;\n    }\n    function ie(e) {\n      var t = Math.sin(e * Math.PI / 180),\n        r = .5 - .25 * Math.log((1 + t) / (1 - t)) / Math.PI;\n      return r < 0 ? 0 : r > 1 ? 1 : r;\n    }\n    function se(e, t, r, o, n, i, s, a) {\n      if (o /= t, i >= (r /= t) && s < o) return e;\n      if (s < r || i >= o) return null;\n      for (var l = [], u = 0; u < e.length; u++) {\n        var h = e[u],\n          c = h.geometry,\n          f = h.type,\n          p = 0 === n ? h.minX : h.minY,\n          g = 0 === n ? h.maxX : h.maxY;\n        if (p >= r && g < o) l.push(h);else if (!(g < r || p >= o)) {\n          var d = [];\n          if (\"Point\" === f || \"MultiPoint\" === f) ae(c, d, r, o, n);else if (\"LineString\" === f) le(c, d, r, o, n, !1, a.lineMetrics);else if (\"MultiLineString\" === f) he(c, d, r, o, n, !1);else if (\"Polygon\" === f) he(c, d, r, o, n, !0);else if (\"MultiPolygon\" === f) for (var m = 0; m < c.length; m++) {\n            var y = [];\n            he(c[m], y, r, o, n, !0), y.length && d.push(y);\n          }\n          if (d.length) {\n            if (a.lineMetrics && \"LineString\" === f) {\n              for (m = 0; m < d.length; m++) l.push(H(h.id, f, d[m], h.tags));\n              continue;\n            }\n            \"LineString\" !== f && \"MultiLineString\" !== f || (1 === d.length ? (f = \"LineString\", d = d[0]) : f = \"MultiLineString\"), \"Point\" !== f && \"MultiPoint\" !== f || (f = 3 === d.length ? \"Point\" : \"MultiPoint\"), l.push(H(h.id, f, d, h.tags));\n          }\n        }\n      }\n      return l.length ? l : null;\n    }\n    function ae(e, t, r, o, n) {\n      for (var i = 0; i < e.length; i += 3) {\n        var s = e[i + n];\n        s >= r && s <= o && (t.push(e[i]), t.push(e[i + 1]), t.push(e[i + 2]));\n      }\n    }\n    function le(e, t, r, o, n, i, s) {\n      for (var a, l, u = ue(e), h = 0 === n ? fe : pe, c = e.start, f = 0; f < e.length - 3; f += 3) {\n        var p = e[f],\n          g = e[f + 1],\n          d = e[f + 2],\n          m = e[f + 3],\n          y = e[f + 4],\n          v = 0 === n ? p : g,\n          x = 0 === n ? m : y,\n          w = !1;\n        s && (a = Math.sqrt(Math.pow(p - m, 2) + Math.pow(g - y, 2))), v < r ? x > r && (l = h(u, p, g, m, y, r), s && (u.start = c + a * l)) : v > o ? x < o && (l = h(u, p, g, m, y, o), s && (u.start = c + a * l)) : ce(u, p, g, d), x < r && v >= r && (l = h(u, p, g, m, y, r), w = !0), x > o && v <= o && (l = h(u, p, g, m, y, o), w = !0), !i && w && (s && (u.end = c + a * l), t.push(u), u = ue(e)), s && (c += a);\n      }\n      var S = e.length - 3;\n      p = e[S], g = e[S + 1], d = e[S + 2], (v = 0 === n ? p : g) >= r && v <= o && ce(u, p, g, d), S = u.length - 3, i && S >= 3 && (u[S] !== u[0] || u[S + 1] !== u[1]) && ce(u, u[0], u[1], u[2]), u.length && t.push(u);\n    }\n    function ue(e) {\n      var t = [];\n      return t.size = e.size, t.start = e.start, t.end = e.end, t;\n    }\n    function he(e, t, r, o, n, i) {\n      for (var s = 0; s < e.length; s++) le(e[s], t, r, o, n, i, !1);\n    }\n    function ce(e, t, r, o) {\n      e.push(t), e.push(r), e.push(o);\n    }\n    function fe(e, t, r, o, n, i) {\n      var s = (i - t) / (o - t);\n      return e.push(i), e.push(r + (n - r) * s), e.push(1), s;\n    }\n    function pe(e, t, r, o, n, i) {\n      var s = (i - r) / (n - r);\n      return e.push(t + (o - t) * s), e.push(i), e.push(1), s;\n    }\n    function ge(e, t) {\n      for (var r = [], o = 0; o < e.length; o++) {\n        var n,\n          i = e[o],\n          s = i.type;\n        if (\"Point\" === s || \"MultiPoint\" === s || \"LineString\" === s) n = de(i.geometry, t);else if (\"MultiLineString\" === s || \"Polygon\" === s) {\n          n = [];\n          for (var a = 0; a < i.geometry.length; a++) n.push(de(i.geometry[a], t));\n        } else if (\"MultiPolygon\" === s) for (n = [], a = 0; a < i.geometry.length; a++) {\n          for (var l = [], u = 0; u < i.geometry[a].length; u++) l.push(de(i.geometry[a][u], t));\n          n.push(l);\n        }\n        r.push(H(i.id, s, n, i.tags));\n      }\n      return r;\n    }\n    function de(e, t) {\n      var r = [];\n      r.size = e.size, void 0 !== e.start && (r.start = e.start, r.end = e.end);\n      for (var o = 0; o < e.length; o += 3) r.push(e[o] + t, e[o + 1], e[o + 2]);\n      return r;\n    }\n    function me(e, t) {\n      if (e.transformed) return e;\n      var r,\n        o,\n        n,\n        i = 1 << e.z,\n        s = e.x,\n        a = e.y;\n      for (r = 0; r < e.features.length; r++) {\n        var l = e.features[r],\n          u = l.geometry,\n          h = l.type;\n        if (l.geometry = [], 1 === h) for (o = 0; o < u.length; o += 2) l.geometry.push(ye(u[o], u[o + 1], t, i, s, a));else for (o = 0; o < u.length; o++) {\n          var c = [];\n          for (n = 0; n < u[o].length; n += 2) c.push(ye(u[o][n], u[o][n + 1], t, i, s, a));\n          l.geometry.push(c);\n        }\n      }\n      return e.transformed = !0, e;\n    }\n    function ye(e, t, r, o, n, i) {\n      return [Math.round(r * (e * o - n)), Math.round(r * (t * o - i))];\n    }\n    function ve(e, t, r, o, n) {\n      for (var i = t === n.maxZoom ? 0 : n.tolerance / ((1 << t) * n.extent), s = {\n          features: [],\n          numPoints: 0,\n          numSimplified: 0,\n          numFeatures: 0,\n          source: null,\n          x: r,\n          y: o,\n          z: t,\n          transformed: !1,\n          minX: 2,\n          minY: 1,\n          maxX: -1,\n          maxY: 0\n        }, a = 0; a < e.length; a++) {\n        s.numFeatures++, xe(s, e[a], i, n);\n        var l = e[a].minX,\n          u = e[a].minY,\n          h = e[a].maxX,\n          c = e[a].maxY;\n        l < s.minX && (s.minX = l), u < s.minY && (s.minY = u), h > s.maxX && (s.maxX = h), c > s.maxY && (s.maxY = c);\n      }\n      return s;\n    }\n    function xe(e, t, r, o) {\n      var n = t.geometry,\n        i = t.type,\n        s = [];\n      if (\"Point\" === i || \"MultiPoint\" === i) for (var a = 0; a < n.length; a += 3) s.push(n[a]), s.push(n[a + 1]), e.numPoints++, e.numSimplified++;else if (\"LineString\" === i) we(s, n, e, r, !1, !1);else if (\"MultiLineString\" === i || \"Polygon\" === i) for (a = 0; a < n.length; a++) we(s, n[a], e, r, \"Polygon\" === i, 0 === a);else if (\"MultiPolygon\" === i) for (var l = 0; l < n.length; l++) {\n        var u = n[l];\n        for (a = 0; a < u.length; a++) we(s, u[a], e, r, !0, 0 === a);\n      }\n      if (s.length) {\n        var h = t.tags || null;\n        if (\"LineString\" === i && o.lineMetrics) {\n          for (var c in h = {}, t.tags) h[c] = t.tags[c];\n          h.mapbox_clip_start = n.start / n.size, h.mapbox_clip_end = n.end / n.size;\n        }\n        var f = {\n          geometry: s,\n          type: \"Polygon\" === i || \"MultiPolygon\" === i ? 3 : \"LineString\" === i || \"MultiLineString\" === i ? 2 : 1,\n          tags: h\n        };\n        null !== t.id && (f.id = t.id), e.features.push(f);\n      }\n    }\n    function we(e, t, r, o, n, i) {\n      var s = o * o;\n      if (o > 0 && t.size < (n ? s : o)) r.numPoints += t.length / 3;else {\n        for (var a = [], l = 0; l < t.length; l += 3) (0 === o || t[l + 2] > s) && (r.numSimplified++, a.push(t[l]), a.push(t[l + 1])), r.numPoints++;\n        n && function (e, t) {\n          for (var r = 0, o = 0, n = e.length, i = n - 2; o < n; i = o, o += 2) r += (e[o] - e[i]) * (e[o + 1] + e[i + 1]);\n          if (r > 0 === t) for (o = 0, n = e.length; o < n / 2; o += 2) {\n            var s = e[o],\n              a = e[o + 1];\n            e[o] = e[n - 2 - o], e[o + 1] = e[n - 1 - o], e[n - 2 - o] = s, e[n - 1 - o] = a;\n          }\n        }(a, i), e.push(a);\n      }\n    }\n    function Se(e, t) {\n      var r = (t = this.options = function (e, t) {\n        for (var r in t) e[r] = t[r];\n        return e;\n      }(Object.create(this.options), t)).debug;\n      if (r && console.time(\"preprocess data\"), t.maxZoom < 0 || t.maxZoom > 24) throw new Error(\"maxZoom should be in the 0-24 range\");\n      if (t.promoteId && t.generateId) throw new Error(\"promoteId and generateId cannot be used together.\");\n      var o = function (e, t) {\n        var r = [];\n        if (\"FeatureCollection\" === e.type) for (var o = 0; o < e.features.length; o++) ee(r, e.features[o], t, o);else ee(r, \"Feature\" === e.type ? e : {\n          geometry: e\n        }, t);\n        return r;\n      }(e, t);\n      this.tiles = {}, this.tileCoords = [], r && (console.timeEnd(\"preprocess data\"), console.log(\"index: maxZoom: %d, maxPoints: %d\", t.indexMaxZoom, t.indexMaxPoints), console.time(\"generate tiles\"), this.stats = {}, this.total = 0), o = function (e, t) {\n        var r = t.buffer / t.extent,\n          o = e,\n          n = se(e, 1, -1 - r, r, 0, -1, 2, t),\n          i = se(e, 1, 1 - r, 2 + r, 0, -1, 2, t);\n        return (n || i) && (o = se(e, 1, -r, 1 + r, 0, -1, 2, t) || [], n && (o = ge(n, 1).concat(o)), i && (o = o.concat(ge(i, -1)))), o;\n      }(o, t), o.length && this.splitTile(o, 0, 0, 0), r && (o.length && console.log(\"features: %d, points: %d\", this.tiles[0].numFeatures, this.tiles[0].numPoints), console.timeEnd(\"generate tiles\"), console.log(\"tiles generated:\", this.total, JSON.stringify(this.stats)));\n    }\n    function Me(e, t, r) {\n      return 32 * ((1 << e) * r + t) + e;\n    }\n    function Pe(e, t) {\n      var r = e.tileID.canonical;\n      if (!this._geoJSONIndex) return t(null, null);\n      var o = this._geoJSONIndex.getTile(r.z, r.x, r.y);\n      if (!o) return t(null, null);\n      var n = new h(o.features);\n      var i = c(n);\n      0 === i.byteOffset && i.byteLength === i.buffer.byteLength || (i = new Uint8Array(i)), t(null, {\n        vectorTile: n,\n        rawData: i.buffer\n      });\n    }\n    Se.prototype.options = {\n      maxZoom: 14,\n      indexMaxZoom: 5,\n      indexMaxPoints: 1e5,\n      tolerance: 3,\n      extent: 4096,\n      buffer: 64,\n      lineMetrics: !1,\n      promoteId: null,\n      generateId: !1,\n      debug: 0\n    }, Se.prototype.splitTile = function (e, t, r, o, n, i, s) {\n      for (var a = [e, t, r, o], l = this.options, u = l.debug; a.length;) {\n        o = a.pop(), r = a.pop(), t = a.pop(), e = a.pop();\n        var h = 1 << t,\n          c = Me(t, r, o),\n          f = this.tiles[c];\n        if (!f && (u > 1 && console.time(\"creation\"), f = this.tiles[c] = ve(e, t, r, o, l), this.tileCoords.push({\n          z: t,\n          x: r,\n          y: o\n        }), u)) {\n          u > 1 && (console.log(\"tile z%d-%d-%d (features: %d, points: %d, simplified: %d)\", t, r, o, f.numFeatures, f.numPoints, f.numSimplified), console.timeEnd(\"creation\"));\n          var p = \"z\" + t;\n          this.stats[p] = (this.stats[p] || 0) + 1, this.total++;\n        }\n        if (f.source = e, n) {\n          if (t === l.maxZoom || t === n) continue;\n          var g = 1 << n - t;\n          if (r !== Math.floor(i / g) || o !== Math.floor(s / g)) continue;\n        } else if (t === l.indexMaxZoom || f.numPoints <= l.indexMaxPoints) continue;\n        if (f.source = null, 0 !== e.length) {\n          u > 1 && console.time(\"clipping\");\n          var d,\n            m,\n            y,\n            v,\n            x,\n            w,\n            S = .5 * l.buffer / l.extent,\n            M = .5 - S,\n            P = .5 + S,\n            b = 1 + S;\n          d = m = y = v = null, x = se(e, h, r - S, r + P, 0, f.minX, f.maxX, l), w = se(e, h, r + M, r + b, 0, f.minX, f.maxX, l), e = null, x && (d = se(x, h, o - S, o + P, 1, f.minY, f.maxY, l), m = se(x, h, o + M, o + b, 1, f.minY, f.maxY, l), x = null), w && (y = se(w, h, o - S, o + P, 1, f.minY, f.maxY, l), v = se(w, h, o + M, o + b, 1, f.minY, f.maxY, l), w = null), u > 1 && console.timeEnd(\"clipping\"), a.push(d || [], t + 1, 2 * r, 2 * o), a.push(m || [], t + 1, 2 * r, 2 * o + 1), a.push(y || [], t + 1, 2 * r + 1, 2 * o), a.push(v || [], t + 1, 2 * r + 1, 2 * o + 1);\n        }\n      }\n    }, Se.prototype.getTile = function (e, t, r) {\n      var o = this.options,\n        n = o.extent,\n        i = o.debug;\n      if (e < 0 || e > 24) return null;\n      var s = 1 << e,\n        a = Me(e, t = (t % s + s) % s, r);\n      if (this.tiles[a]) return me(this.tiles[a], n);\n      i > 1 && console.log(\"drilling down to z%d-%d-%d\", e, t, r);\n      for (var l, u = e, h = t, c = r; !l && u > 0;) u--, h = Math.floor(h / 2), c = Math.floor(c / 2), l = this.tiles[Me(u, h, c)];\n      return l && l.source ? (i > 1 && console.log(\"found parent tile z%d-%d-%d\", u, h, c), i > 1 && console.time(\"drilling down\"), this.splitTile(l.source, u, h, c, e, t, r), i > 1 && console.timeEnd(\"drilling down\"), this.tiles[a] ? me(this.tiles[a], n) : null) : null;\n    };\n    var be = /*#__PURE__*/function (_e$VectorTileWorkerSo) {\n      _inherits(be, _e$VectorTileWorkerSo);\n      function be(e, t, r, o, n) {\n        var _this64;\n        _classCallCheck(this, be);\n        _this64 = _possibleConstructorReturn(this, _getPrototypeOf(be).call(this, e, t, r, o, Pe)), n && (_this64.loadGeoJSON = n);\n        return _this64;\n      }\n      _createClass(be, [{\n        key: \"loadData\",\n        value: function loadData(t, r) {\n          var _this65 = this;\n          var o = t && t.request,\n            n = o && o.collectResourceTiming;\n          this.loadGeoJSON(t, function (s, a) {\n            if (s || !a) return r(s);\n            if (\"object\" != typeof a) return r(new Error(\"Input data given to '\".concat(t.source, \"' is not a valid GeoJSON object.\")));\n            {\n              i(a, !0);\n              try {\n                if (t.filter) {\n                  var _r218 = e.createExpression(t.filter, {\n                    type: \"boolean\",\n                    \"property-type\": \"data-driven\",\n                    overridable: !1,\n                    transition: !1\n                  });\n                  if (\"error\" === _r218.result) throw new Error(_r218.value.map(function (e) {\n                    return \"\".concat(e.key, \": \").concat(e.message);\n                  }).join(\", \"));\n                  var _o71 = a.features.filter(function (e) {\n                    return _r218.value.evaluate({\n                      zoom: 0\n                    }, e);\n                  });\n                  a = {\n                    type: \"FeatureCollection\",\n                    features: _o71\n                  };\n                }\n                _this65._geoJSONIndex = t.cluster ? new J(function (_ref131) {\n                  var t = _ref131.superclusterOptions,\n                    r = _ref131.clusterProperties;\n                  if (!r || !t) return t;\n                  var o = {},\n                    n = {},\n                    i = {\n                      accumulated: null,\n                      zoom: 0\n                    },\n                    s = {\n                      properties: null\n                    },\n                    a = Object.keys(r);\n                  for (var _i159 = 0, _a105 = a; _i159 < _a105.length; _i159++) {\n                    var _t311 = _a105[_i159];\n                    var _r$_t2 = _slicedToArray(r[_t311], 2),\n                      _i160 = _r$_t2[0],\n                      _s121 = _r$_t2[1],\n                      _a106 = e.createExpression(_s121),\n                      _l59 = e.createExpression(\"string\" == typeof _i160 ? [_i160, [\"accumulated\"], [\"get\", _t311]] : _i160);\n                    o[_t311] = _a106.value, n[_t311] = _l59.value;\n                  }\n                  return t.map = function (e) {\n                    s.properties = e;\n                    var t = {};\n                    for (var _i161 = 0, _a107 = a; _i161 < _a107.length; _i161++) {\n                      var _e272 = _a107[_i161];\n                      t[_e272] = o[_e272].evaluate(i, s);\n                    }\n                    return t;\n                  }, t.reduce = function (e, t) {\n                    s.properties = t;\n                    for (var _i162 = 0, _a108 = a; _i162 < _a108.length; _i162++) {\n                      var _t312 = _a108[_i162];\n                      i.accumulated = e[_t312], e[_t312] = n[_t312].evaluate(i, s);\n                    }\n                  }, t;\n                }(t)).load(a.features) : function (e, t) {\n                  return new Se(e, t);\n                }(a, t.geojsonVtOptions);\n              } catch (s) {\n                return r(s);\n              }\n              _this65.loaded = {};\n              var _l60 = {};\n              if (n) {\n                var _r219 = e.getPerformanceMeasurement(o);\n                _r219 && (_l60.resourceTiming = {}, _l60.resourceTiming[t.source] = JSON.parse(JSON.stringify(_r219)));\n              }\n              r(null, _l60);\n            }\n          });\n        }\n      }, {\n        key: \"reloadTile\",\n        value: function reloadTile(e, t) {\n          var r = this.loaded;\n          return r && r[e.uid] ? _get(_getPrototypeOf(be.prototype), \"reloadTile\", this).call(this, e, t) : this.loadTile(e, t);\n        }\n      }, {\n        key: \"loadGeoJSON\",\n        value: function loadGeoJSON(t, r) {\n          if (t.request) e.getJSON(t.request, r);else {\n            if (\"string\" != typeof t.data) return r(new Error(\"Input data given to '\".concat(t.source, \"' is not a valid GeoJSON object.\")));\n            try {\n              return r(null, JSON.parse(t.data));\n            } catch (e) {\n              return r(new Error(\"Input data given to '\".concat(t.source, \"' is not a valid GeoJSON object.\")));\n            }\n          }\n        }\n      }, {\n        key: \"getClusterExpansionZoom\",\n        value: function getClusterExpansionZoom(e, t) {\n          try {\n            t(null, this._geoJSONIndex.getClusterExpansionZoom(e.clusterId));\n          } catch (e) {\n            t(e);\n          }\n        }\n      }, {\n        key: \"getClusterChildren\",\n        value: function getClusterChildren(e, t) {\n          try {\n            t(null, this._geoJSONIndex.getChildren(e.clusterId));\n          } catch (e) {\n            t(e);\n          }\n        }\n      }, {\n        key: \"getClusterLeaves\",\n        value: function getClusterLeaves(e, t) {\n          try {\n            t(null, this._geoJSONIndex.getLeaves(e.clusterId, e.limit, e.offset));\n          } catch (e) {\n            t(e);\n          }\n        }\n      }]);\n      return be;\n    }(e.VectorTileWorkerSource);\n    var ke = /*#__PURE__*/function () {\n      function ke(t) {\n        var _this66 = this;\n        _classCallCheck(this, ke);\n        this.self = t, this.actor = new e.Actor(t, this), this.layerIndexes = {}, this.availableImages = {}, this.isSpriteLoaded = {}, this.projections = {}, this.defaultProjection = e.getProjection({\n          name: \"mercator\"\n        }), this.workerSourceTypes = {\n          vector: e.VectorTileWorkerSource,\n          geojson: be\n        }, this.workerSources = {}, this.demWorkerSources = {}, this.self.registerWorkerSource = function (e, t) {\n          if (_this66.workerSourceTypes[e]) throw new Error(\"Worker source with name \\\"\".concat(e, \"\\\" already registered.\"));\n          _this66.workerSourceTypes[e] = t;\n        }, this.self.registerRTLTextPlugin = function (t) {\n          if (e.plugin.isParsed()) throw new Error(\"RTL text plugin already registered.\");\n          e.plugin.applyArabicShaping = t.applyArabicShaping, e.plugin.processBidirectionalText = t.processBidirectionalText, e.plugin.processStyledBidirectionalText = t.processStyledBidirectionalText;\n        };\n      }\n      _createClass(ke, [{\n        key: \"clearCaches\",\n        value: function clearCaches(e, t, r) {\n          delete this.layerIndexes[e], delete this.availableImages[e], delete this.workerSources[e], delete this.demWorkerSources[e], r();\n        }\n      }, {\n        key: \"checkIfReady\",\n        value: function checkIfReady(e, t, r) {\n          r();\n        }\n      }, {\n        key: \"setReferrer\",\n        value: function setReferrer(e, t) {\n          this.referrer = t;\n        }\n      }, {\n        key: \"spriteLoaded\",\n        value: function spriteLoaded(t, r) {\n          this.isSpriteLoaded[t] = r;\n          for (var _o72 in this.workerSources[t]) {\n            var _n158 = this.workerSources[t][_o72];\n            for (var _t313 in _n158) _n158[_t313] instanceof e.VectorTileWorkerSource && (_n158[_t313].isSpriteLoaded = r, _n158[_t313].fire(new e.Event(\"isSpriteLoaded\")));\n          }\n        }\n      }, {\n        key: \"setImages\",\n        value: function setImages(e, t, r) {\n          this.availableImages[e] = t;\n          for (var _r220 in this.workerSources[e]) {\n            var _o73 = this.workerSources[e][_r220];\n            for (var _e273 in _o73) _o73[_e273].availableImages = t;\n          }\n          r();\n        }\n      }, {\n        key: \"enableTerrain\",\n        value: function enableTerrain(e, t, r) {\n          this.terrain = t, r();\n        }\n      }, {\n        key: \"setProjection\",\n        value: function setProjection(t, r) {\n          this.projections[t] = e.getProjection(r);\n        }\n      }, {\n        key: \"setLayers\",\n        value: function setLayers(e, t, r) {\n          this.getLayerIndex(e).replace(t), r();\n        }\n      }, {\n        key: \"updateLayers\",\n        value: function updateLayers(e, t, r) {\n          this.getLayerIndex(e).update(t.layers, t.removedIds), r();\n        }\n      }, {\n        key: \"loadTile\",\n        value: function loadTile(t, r, o) {\n          var n = this.enableTerrain ? e.extend({\n            enableTerrain: this.terrain\n          }, r) : r;\n          n.projection = this.projections[t] || this.defaultProjection, this.getWorkerSource(t, r.type, r.source).loadTile(n, o);\n        }\n      }, {\n        key: \"loadDEMTile\",\n        value: function loadDEMTile(t, r, o) {\n          var n = this.enableTerrain ? e.extend({\n            buildQuadTree: this.terrain\n          }, r) : r;\n          this.getDEMWorkerSource(t, r.source).loadTile(n, o);\n        }\n      }, {\n        key: \"reloadTile\",\n        value: function reloadTile(t, r, o) {\n          var n = this.enableTerrain ? e.extend({\n            enableTerrain: this.terrain\n          }, r) : r;\n          n.projection = this.projections[t] || this.defaultProjection, this.getWorkerSource(t, r.type, r.source).reloadTile(n, o);\n        }\n      }, {\n        key: \"abortTile\",\n        value: function abortTile(e, t, r) {\n          this.getWorkerSource(e, t.type, t.source).abortTile(t, r);\n        }\n      }, {\n        key: \"removeTile\",\n        value: function removeTile(e, t, r) {\n          this.getWorkerSource(e, t.type, t.source).removeTile(t, r);\n        }\n      }, {\n        key: \"removeSource\",\n        value: function removeSource(e, t, r) {\n          if (!this.workerSources[e] || !this.workerSources[e][t.type] || !this.workerSources[e][t.type][t.source]) return;\n          var o = this.workerSources[e][t.type][t.source];\n          delete this.workerSources[e][t.type][t.source], void 0 !== o.removeSource ? o.removeSource(t, r) : r();\n        }\n      }, {\n        key: \"loadWorkerSource\",\n        value: function loadWorkerSource(e, t, r) {\n          try {\n            this.self.importScripts(t.url), r();\n          } catch (e) {\n            r(e.toString());\n          }\n        }\n      }, {\n        key: \"syncRTLPluginState\",\n        value: function syncRTLPluginState(t, r, o) {\n          try {\n            e.plugin.setState(r);\n            var _t314 = e.plugin.getPluginURL();\n            if (e.plugin.isLoaded() && !e.plugin.isParsed() && null != _t314) {\n              this.self.importScripts(_t314);\n              var _r221 = e.plugin.isParsed();\n              o(_r221 ? void 0 : new Error(\"RTL Text Plugin failed to import scripts from \".concat(_t314)), _r221);\n            }\n          } catch (e) {\n            o(e.toString());\n          }\n        }\n      }, {\n        key: \"getAvailableImages\",\n        value: function getAvailableImages(e) {\n          var t = this.availableImages[e];\n          return t || (t = []), t;\n        }\n      }, {\n        key: \"getLayerIndex\",\n        value: function getLayerIndex(e) {\n          var t = this.layerIndexes[e];\n          return t || (t = this.layerIndexes[e] = new o()), t;\n        }\n      }, {\n        key: \"getWorkerSource\",\n        value: function getWorkerSource(e, t, r) {\n          var _this67 = this;\n          if (this.workerSources[e] || (this.workerSources[e] = {}), this.workerSources[e][t] || (this.workerSources[e][t] = {}), !this.workerSources[e][t][r]) {\n            var _o74 = {\n              send: function send(t, r, o, n, i, s) {\n                _this67.actor.send(t, r, o, e, i, s);\n              },\n              scheduler: this.actor.scheduler\n            };\n            this.workerSources[e][t][r] = new this.workerSourceTypes[t](_o74, this.getLayerIndex(e), this.getAvailableImages(e), this.isSpriteLoaded[e]);\n          }\n          return this.workerSources[e][t][r];\n        }\n      }, {\n        key: \"getDEMWorkerSource\",\n        value: function getDEMWorkerSource(e, t) {\n          return this.demWorkerSources[e] || (this.demWorkerSources[e] = {}), this.demWorkerSources[e][t] || (this.demWorkerSources[e][t] = new n()), this.demWorkerSources[e][t];\n        }\n      }, {\n        key: \"enforceCacheSizeLimit\",\n        value: function enforceCacheSizeLimit(t, r) {\n          e.enforceCacheSizeLimit(r);\n        }\n      }, {\n        key: \"getWorkerPerformanceMetrics\",\n        value: function getWorkerPerformanceMetrics(e, t, r) {\n          r(void 0, void 0);\n        }\n      }]);\n      return ke;\n    }();\n    return \"undefined\" != typeof WorkerGlobalScope && \"undefined\" != typeof self && self instanceof WorkerGlobalScope && (self.worker = new ke(self)), ke;\n  });\n  define([\"./shared\"], function (e) {\n    \"use strict\";\n\n    function t(e, i) {\n      if (Array.isArray(e)) {\n        if (!Array.isArray(i) || e.length !== i.length) return !1;\n        for (var _o75 = 0; _o75 < e.length; _o75++) if (!t(e[_o75], i[_o75])) return !1;\n        return !0;\n      }\n      if (\"object\" == typeof e && null !== e && null !== i) {\n        if (\"object\" != typeof i) return !1;\n        if (Object.keys(e).length !== Object.keys(i).length) return !1;\n        for (var _o76 in e) if (!t(e[_o76], i[_o76])) return !1;\n        return !0;\n      }\n      return e === i;\n    }\n    var i = o;\n    function o(e) {\n      return !function (e) {\n        return \"undefined\" == typeof window || \"undefined\" == typeof document ? \"not a browser\" : Array.prototype && Array.prototype.every && Array.prototype.filter && Array.prototype.forEach && Array.prototype.indexOf && Array.prototype.lastIndexOf && Array.prototype.map && Array.prototype.some && Array.prototype.reduce && Array.prototype.reduceRight && Array.isArray ? Function.prototype && Function.prototype.bind ? Object.keys && Object.create && Object.getPrototypeOf && Object.getOwnPropertyNames && Object.isSealed && Object.isFrozen && Object.isExtensible && Object.getOwnPropertyDescriptor && Object.defineProperty && Object.defineProperties && Object.seal && Object.freeze && Object.preventExtensions ? \"JSON\" in window && \"parse\" in JSON && \"stringify\" in JSON ? function () {\n          if (!(\"Worker\" in window && \"Blob\" in window && \"URL\" in window)) return !1;\n          var e,\n            t,\n            i = new Blob([\"\"], {\n              type: \"text/javascript\"\n            }),\n            o = URL.createObjectURL(i);\n          try {\n            t = new Worker(o), e = !0;\n          } catch (t) {\n            e = !1;\n          }\n          return t && t.terminate(), URL.revokeObjectURL(o), e;\n        }() ? \"Uint8ClampedArray\" in window ? ArrayBuffer.isView ? function () {\n          var e = document.createElement(\"canvas\");\n          e.width = e.height = 1;\n          var t = e.getContext(\"2d\");\n          if (!t) return !1;\n          var i = t.getImageData(0, 0, 1, 1);\n          return i && i.width === e.width;\n        }() ? (void 0 === r[t = e && e.failIfMajorPerformanceCaveat] && (r[t] = function (e) {\n          var t,\n            i = function (e) {\n              var t = document.createElement(\"canvas\"),\n                i = Object.create(o.webGLContextAttributes);\n              return i.failIfMajorPerformanceCaveat = e, t.getContext(\"webgl\", i) || t.getContext(\"experimental-webgl\", i);\n            }(e);\n          if (!i) return !1;\n          try {\n            t = i.createShader(i.VERTEX_SHADER);\n          } catch (e) {\n            return !1;\n          }\n          return !(!t || i.isContextLost()) && (i.shaderSource(t, \"void main() {}\"), i.compileShader(t), !0 === i.getShaderParameter(t, i.COMPILE_STATUS));\n        }(t)), r[t] ? document.documentMode ? \"insufficient ECMAScript 6 support\" : void 0 : \"insufficient WebGL support\") : \"insufficient Canvas/getImageData support\" : \"insufficient ArrayBuffer support\" : \"insufficient Uint8ClampedArray support\" : \"insufficient worker support\" : \"insufficient JSON support\" : \"insufficient Object support\" : \"insufficient Function support\" : \"insufficent Array support\";\n        var t;\n      }(e);\n    }\n    var r = {};\n    function n(t, i, o) {\n      var r = e.window.document.createElement(t);\n      return void 0 !== i && (r.className = i), o && o.appendChild(r), r;\n    }\n    function s(t, i, o) {\n      var r = e.window.document.createElementNS(\"http://www.w3.org/2000/svg\", t);\n      for (var _i163 = 0, _Object$keys11 = Object.keys(i); _i163 < _Object$keys11.length; _i163++) {\n        var _e274 = _Object$keys11[_i163];\n        r.setAttributeNS(null, _e274, i[_e274]);\n      }\n      return o && o.appendChild(r), r;\n    }\n    o.webGLContextAttributes = {\n      antialias: !1,\n      alpha: !0,\n      stencil: !0,\n      depth: !0\n    };\n    var a = e.window.document && e.window.document.documentElement.style,\n      l = a && void 0 !== a.userSelect ? \"userSelect\" : \"WebkitUserSelect\";\n    var c;\n    function h() {\n      a && l && (c = a[l], a[l] = \"none\");\n    }\n    function u() {\n      a && l && (a[l] = c);\n    }\n    function _(t) {\n      t.preventDefault(), t.stopPropagation(), e.window.removeEventListener(\"click\", _, !0);\n    }\n    function d() {\n      e.window.addEventListener(\"click\", _, !0), e.window.setTimeout(function () {\n        e.window.removeEventListener(\"click\", _, !0);\n      }, 0);\n    }\n    function p(e, t) {\n      var i = e.getBoundingClientRect();\n      return g(e, i, t);\n    }\n    function m(e, t) {\n      var i = e.getBoundingClientRect(),\n        o = [];\n      for (var _r222 = 0; _r222 < t.length; _r222++) o.push(g(e, i, t[_r222]));\n      return o;\n    }\n    function f(t) {\n      return void 0 !== e.window.InstallTrigger && 2 === t.button && t.ctrlKey && e.window.navigator.platform.toUpperCase().indexOf(\"MAC\") >= 0 ? 0 : t.button;\n    }\n    function g(t, i, o) {\n      var r = t.offsetWidth === i.width ? 1 : t.offsetWidth / i.width;\n      return new e.pointGeometry((o.clientX - i.left) * r, (o.clientY - i.top) * r);\n    }\n    function v(e, t) {\n      var i = t[0],\n        o = t[1],\n        r = t[2],\n        n = t[3],\n        s = i * n - r * o;\n      return s ? (e[0] = n * (s = 1 / s), e[1] = -o * s, e[2] = -r * s, e[3] = i * s, e) : null;\n    }\n    function x(e) {\n      var t = e.userImage;\n      return !!(t && t.render && t.render()) && (e.data.replace(new Uint8Array(t.data.buffer)), !0);\n    }\n    var y = /*#__PURE__*/function (_e$Evented) {\n      _inherits(y, _e$Evented);\n      function y() {\n        var _this68;\n        _classCallCheck(this, y);\n        _this68 = _possibleConstructorReturn(this, _getPrototypeOf(y).call(this)), _this68.images = {}, _this68.updatedImages = {}, _this68.callbackDispatchedThisFrame = {}, _this68.loaded = !1, _this68.requestors = [], _this68.patterns = {}, _this68.atlasImage = new e.RGBAImage({\n          width: 1,\n          height: 1\n        }), _this68.dirty = !0;\n        return _this68;\n      }\n      _createClass(y, [{\n        key: \"isLoaded\",\n        value: function isLoaded() {\n          return this.loaded;\n        }\n      }, {\n        key: \"setLoaded\",\n        value: function setLoaded(e) {\n          if (this.loaded !== e && (this.loaded = e, e)) {\n            var _iterator187 = _createForOfIteratorHelper(this.requestors),\n              _step187;\n            try {\n              for (_iterator187.s(); !(_step187 = _iterator187.n()).done;) {\n                var _step187$value = _step187.value,\n                  _e275 = _step187$value.ids,\n                  _t315 = _step187$value.callback;\n                this._notify(_e275, _t315);\n              }\n            } catch (err) {\n              _iterator187.e(err);\n            } finally {\n              _iterator187.f();\n            }\n            this.requestors = [];\n          }\n        }\n      }, {\n        key: \"hasImage\",\n        value: function hasImage(e) {\n          return !!this.getImage(e);\n        }\n      }, {\n        key: \"getImage\",\n        value: function getImage(e) {\n          return this.images[e];\n        }\n      }, {\n        key: \"addImage\",\n        value: function addImage(e, t) {\n          this._validate(e, t) && (this.images[e] = t);\n        }\n      }, {\n        key: \"_validate\",\n        value: function _validate(t, i) {\n          var o = !0;\n          return this._validateStretch(i.stretchX, i.data && i.data.width) || (this.fire(new e.ErrorEvent(new Error(\"Image \\\"\".concat(t, \"\\\" has invalid \\\"stretchX\\\" value\")))), o = !1), this._validateStretch(i.stretchY, i.data && i.data.height) || (this.fire(new e.ErrorEvent(new Error(\"Image \\\"\".concat(t, \"\\\" has invalid \\\"stretchY\\\" value\")))), o = !1), this._validateContent(i.content, i) || (this.fire(new e.ErrorEvent(new Error(\"Image \\\"\".concat(t, \"\\\" has invalid \\\"content\\\" value\")))), o = !1), o;\n        }\n      }, {\n        key: \"_validateStretch\",\n        value: function _validateStretch(e, t) {\n          if (!e) return !0;\n          var i = 0;\n          var _iterator188 = _createForOfIteratorHelper(e),\n            _step188;\n          try {\n            for (_iterator188.s(); !(_step188 = _iterator188.n()).done;) {\n              var _o77 = _step188.value;\n              if (_o77[0] < i || _o77[1] < _o77[0] || t < _o77[1]) return !1;\n              i = _o77[1];\n            }\n          } catch (err) {\n            _iterator188.e(err);\n          } finally {\n            _iterator188.f();\n          }\n          return !0;\n        }\n      }, {\n        key: \"_validateContent\",\n        value: function _validateContent(e, t) {\n          return !(e && (4 !== e.length || e[0] < 0 || t.data.width < e[0] || e[1] < 0 || t.data.height < e[1] || e[2] < 0 || t.data.width < e[2] || e[3] < 0 || t.data.height < e[3] || e[2] < e[0] || e[3] < e[1]));\n        }\n      }, {\n        key: \"updateImage\",\n        value: function updateImage(e, t) {\n          t.version = this.images[e].version + 1, this.images[e] = t, this.updatedImages[e] = !0;\n        }\n      }, {\n        key: \"removeImage\",\n        value: function removeImage(e) {\n          var t = this.images[e];\n          delete this.images[e], delete this.patterns[e], t.userImage && t.userImage.onRemove && t.userImage.onRemove();\n        }\n      }, {\n        key: \"listImages\",\n        value: function listImages() {\n          return Object.keys(this.images);\n        }\n      }, {\n        key: \"getImages\",\n        value: function getImages(e, t) {\n          var i = !0;\n          if (!this.isLoaded()) {\n            var _iterator189 = _createForOfIteratorHelper(e),\n              _step189;\n            try {\n              for (_iterator189.s(); !(_step189 = _iterator189.n()).done;) {\n                var _t316 = _step189.value;\n                this.images[_t316] || (i = !1);\n              }\n            } catch (err) {\n              _iterator189.e(err);\n            } finally {\n              _iterator189.f();\n            }\n          }\n          this.isLoaded() || i ? this._notify(e, t) : this.requestors.push({\n            ids: e,\n            callback: t\n          });\n        }\n      }, {\n        key: \"_notify\",\n        value: function _notify(t, i) {\n          var o = {};\n          var _iterator190 = _createForOfIteratorHelper(t),\n            _step190;\n          try {\n            for (_iterator190.s(); !(_step190 = _iterator190.n()).done;) {\n              var _i164 = _step190.value;\n              this.images[_i164] || this.fire(new e.Event(\"styleimagemissing\", {\n                id: _i164\n              }));\n              var _t317 = this.images[_i164];\n              _t317 ? o[_i164] = {\n                data: _t317.data.clone(),\n                pixelRatio: _t317.pixelRatio,\n                sdf: _t317.sdf,\n                version: _t317.version,\n                stretchX: _t317.stretchX,\n                stretchY: _t317.stretchY,\n                content: _t317.content,\n                hasRenderCallback: Boolean(_t317.userImage && _t317.userImage.render)\n              } : e.warnOnce(\"Image \\\"\".concat(_i164, \"\\\" could not be loaded. Please make sure you have added the image with map.addImage() or a \\\"sprite\\\" property in your style. You can provide missing images by listening for the \\\"styleimagemissing\\\" map event.\"));\n            }\n          } catch (err) {\n            _iterator190.e(err);\n          } finally {\n            _iterator190.f();\n          }\n          i(null, o);\n        }\n      }, {\n        key: \"getPixelSize\",\n        value: function getPixelSize() {\n          var _this$atlasImage = this.atlasImage,\n            e = _this$atlasImage.width,\n            t = _this$atlasImage.height;\n          return {\n            width: e,\n            height: t\n          };\n        }\n      }, {\n        key: \"getPattern\",\n        value: function getPattern(t) {\n          var i = this.patterns[t],\n            o = this.getImage(t);\n          if (!o) return null;\n          if (i && i.position.version === o.version) return i.position;\n          if (i) i.position.version = o.version;else {\n            var _i165 = {\n                w: o.data.width + 2,\n                h: o.data.height + 2,\n                x: 0,\n                y: 0\n              },\n              _r223 = new e.ImagePosition(_i165, o);\n            this.patterns[t] = {\n              bin: _i165,\n              position: _r223\n            };\n          }\n          return this._updatePatternAtlas(), this.patterns[t].position;\n        }\n      }, {\n        key: \"bind\",\n        value: function bind(t) {\n          var i = t.gl;\n          this.atlasTexture ? this.dirty && (this.atlasTexture.update(this.atlasImage), this.dirty = !1) : this.atlasTexture = new e.Texture(t, this.atlasImage, i.RGBA), this.atlasTexture && this.atlasTexture.bind(i.LINEAR, i.CLAMP_TO_EDGE);\n        }\n      }, {\n        key: \"_updatePatternAtlas\",\n        value: function _updatePatternAtlas() {\n          var t = [];\n          for (var _e276 in this.patterns) t.push(this.patterns[_e276].bin);\n          var _e$potpack = e.potpack(t),\n            i = _e$potpack.w,\n            o = _e$potpack.h,\n            r = this.atlasImage;\n          r.resize({\n            width: i || 1,\n            height: o || 1\n          });\n          for (var _t318 in this.patterns) {\n            var _i166 = this.patterns[_t318].bin,\n              _o78 = _i166.x + 1,\n              _n159 = _i166.y + 1,\n              _s122 = this.images[_t318].data,\n              _a109 = _s122.width,\n              _l61 = _s122.height;\n            e.RGBAImage.copy(_s122, r, {\n              x: 0,\n              y: 0\n            }, {\n              x: _o78,\n              y: _n159\n            }, {\n              width: _a109,\n              height: _l61\n            }), e.RGBAImage.copy(_s122, r, {\n              x: 0,\n              y: _l61 - 1\n            }, {\n              x: _o78,\n              y: _n159 - 1\n            }, {\n              width: _a109,\n              height: 1\n            }), e.RGBAImage.copy(_s122, r, {\n              x: 0,\n              y: 0\n            }, {\n              x: _o78,\n              y: _n159 + _l61\n            }, {\n              width: _a109,\n              height: 1\n            }), e.RGBAImage.copy(_s122, r, {\n              x: _a109 - 1,\n              y: 0\n            }, {\n              x: _o78 - 1,\n              y: _n159\n            }, {\n              width: 1,\n              height: _l61\n            }), e.RGBAImage.copy(_s122, r, {\n              x: 0,\n              y: 0\n            }, {\n              x: _o78 + _a109,\n              y: _n159\n            }, {\n              width: 1,\n              height: _l61\n            });\n          }\n          this.dirty = !0;\n        }\n      }, {\n        key: \"beginFrame\",\n        value: function beginFrame() {\n          this.callbackDispatchedThisFrame = {};\n        }\n      }, {\n        key: \"dispatchRenderCallbacks\",\n        value: function dispatchRenderCallbacks(e) {\n          var _iterator191 = _createForOfIteratorHelper(e),\n            _step191;\n          try {\n            for (_iterator191.s(); !(_step191 = _iterator191.n()).done;) {\n              var _t319 = _step191.value;\n              if (this.callbackDispatchedThisFrame[_t319]) continue;\n              this.callbackDispatchedThisFrame[_t319] = !0;\n              var _e277 = this.images[_t319];\n              x(_e277) && this.updateImage(_t319, _e277);\n            }\n          } catch (err) {\n            _iterator191.e(err);\n          } finally {\n            _iterator191.f();\n          }\n        }\n      }]);\n      return y;\n    }(e.Evented);\n    var b = new e.Properties({\n        anchor: new e.DataConstantProperty(e.spec.light.anchor),\n        position: new ( /*#__PURE__*/function () {\n          function _class18() {\n            _classCallCheck(this, _class18);\n            this.specification = e.spec.light.position;\n          }\n          _createClass(_class18, [{\n            key: \"possiblyEvaluate\",\n            value: function possiblyEvaluate(t, i) {\n              return function (_ref132) {\n                var _ref133 = _slicedToArray(_ref132, 3),\n                  t = _ref133[0],\n                  i = _ref133[1],\n                  o = _ref133[2];\n                var r = e.degToRad(i + 90),\n                  n = e.degToRad(o);\n                return {\n                  x: t * Math.cos(r) * Math.sin(n),\n                  y: t * Math.sin(r) * Math.sin(n),\n                  z: t * Math.cos(n),\n                  azimuthal: i,\n                  polar: o\n                };\n              }(t.expression.evaluate(i));\n            }\n          }, {\n            key: \"interpolate\",\n            value: function interpolate(t, i, o) {\n              return {\n                x: e.number(t.x, i.x, o),\n                y: e.number(t.y, i.y, o),\n                z: e.number(t.z, i.z, o),\n                azimuthal: e.number(t.azimuthal, i.azimuthal, o),\n                polar: e.number(t.polar, i.polar, o)\n              };\n            }\n          }]);\n          return _class18;\n        }())(),\n        color: new e.DataConstantProperty(e.spec.light.color),\n        intensity: new e.DataConstantProperty(e.spec.light.intensity)\n      }),\n      w = \"-transition\";\n    var T = /*#__PURE__*/function (_e$Evented2) {\n      _inherits(T, _e$Evented2);\n      function T(t) {\n        var _this69;\n        _classCallCheck(this, T);\n        _this69 = _possibleConstructorReturn(this, _getPrototypeOf(T).call(this)), _this69._transitionable = new e.Transitionable(b), _this69.setLight(t), _this69._transitioning = _this69._transitionable.untransitioned();\n        return _this69;\n      }\n      _createClass(T, [{\n        key: \"getLight\",\n        value: function getLight() {\n          return this._transitionable.serialize();\n        }\n      }, {\n        key: \"setLight\",\n        value: function setLight(t) {\n          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n          if (!this._validate(e.validateLight, t, i)) for (var _i167 in t) {\n            var _o79 = t[_i167];\n            e.endsWith(_i167, w) ? this._transitionable.setTransition(_i167.slice(0, -w.length), _o79) : this._transitionable.setValue(_i167, _o79);\n          }\n        }\n      }, {\n        key: \"updateTransitions\",\n        value: function updateTransitions(e) {\n          this._transitioning = this._transitionable.transitioned(e, this._transitioning);\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return this._transitioning.hasTransition();\n        }\n      }, {\n        key: \"recalculate\",\n        value: function recalculate(e) {\n          this.properties = this._transitioning.possiblyEvaluate(e);\n        }\n      }, {\n        key: \"_validate\",\n        value: function _validate(t, i, o) {\n          return (!o || !1 !== o.validate) && e.emitValidationErrors(this, t.call(e.validateStyle, e.extend({\n            value: i,\n            style: {\n              glyphs: !0,\n              sprite: !0\n            },\n            styleSpec: e.spec\n          })));\n        }\n      }]);\n      return T;\n    }(e.Evented);\n    var E = new e.Properties({\n        source: new e.DataConstantProperty(e.spec.terrain.source),\n        exaggeration: new e.DataConstantProperty(e.spec.terrain.exaggeration)\n      }),\n      C = \"-transition\";\n    var M = /*#__PURE__*/function (_e$Evented3) {\n      _inherits(M, _e$Evented3);\n      function M(t, i) {\n        var _this70;\n        _classCallCheck(this, M);\n        _this70 = _possibleConstructorReturn(this, _getPrototypeOf(M).call(this)), _this70._transitionable = new e.Transitionable(E), _this70.set(t), _this70._transitioning = _this70._transitionable.untransitioned(), _this70.drapeRenderMode = i;\n        return _this70;\n      }\n      _createClass(M, [{\n        key: \"get\",\n        value: function get() {\n          return this._transitionable.serialize();\n        }\n      }, {\n        key: \"set\",\n        value: function set(t) {\n          for (var _i168 in t) {\n            var _o80 = t[_i168];\n            e.endsWith(_i168, C) ? this._transitionable.setTransition(_i168.slice(0, -C.length), _o80) : this._transitionable.setValue(_i168, _o80);\n          }\n        }\n      }, {\n        key: \"updateTransitions\",\n        value: function updateTransitions(e) {\n          this._transitioning = this._transitionable.transitioned(e, this._transitioning);\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return this._transitioning.hasTransition();\n        }\n      }, {\n        key: \"recalculate\",\n        value: function recalculate(e) {\n          this.properties = this._transitioning.possiblyEvaluate(e);\n        }\n      }]);\n      return M;\n    }(e.Evented);\n    function I(t, i, o, r) {\n      var n = e.smoothstep(45, 65, o),\n        _S9 = S(t, r),\n        _S10 = _slicedToArray(_S9, 2),\n        s = _S10[0],\n        a = _S10[1],\n        l = e.length(i);\n      var c = 1 - Math.min(1, Math.exp((l - s) / (a - s) * -6));\n      return c *= c * c, c = Math.min(1, 1.00747 * c), c * n * t.alpha;\n    }\n    function S(e, t) {\n      var i = .5 / Math.tan(.5 * t);\n      return [e.range[0] + i, e.range[1] + i];\n    }\n    var D = new e.Properties({\n        range: new e.DataConstantProperty(e.spec.fog.range),\n        color: new e.DataConstantProperty(e.spec.fog.color),\n        \"high-color\": new e.DataConstantProperty(e.spec.fog[\"high-color\"]),\n        \"space-color\": new e.DataConstantProperty(e.spec.fog[\"space-color\"]),\n        \"horizon-blend\": new e.DataConstantProperty(e.spec.fog[\"horizon-blend\"]),\n        \"star-intensity\": new e.DataConstantProperty(e.spec.fog[\"star-intensity\"])\n      }),\n      L = \"-transition\";\n    var A = /*#__PURE__*/function (_e$Evented4) {\n      _inherits(A, _e$Evented4);\n      function A(t, i) {\n        var _this71;\n        _classCallCheck(this, A);\n        _this71 = _possibleConstructorReturn(this, _getPrototypeOf(A).call(this)), _this71._transitionable = new e.Transitionable(D), _this71.set(t), _this71._transitioning = _this71._transitionable.untransitioned(), _this71._transform = i;\n        return _this71;\n      }\n      _createClass(A, [{\n        key: \"get\",\n        value: function get() {\n          return this._transitionable.serialize();\n        }\n      }, {\n        key: \"set\",\n        value: function set(t) {\n          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n          if (!this._validate(e.validateFog, t, i)) {\n            for (var _i169 = 0, _Object$keys12 = Object.keys(e.spec.fog); _i169 < _Object$keys12.length; _i169++) {\n              var _i170 = _Object$keys12[_i169];\n              t && void 0 === t[_i170] && (t[_i170] = e.spec.fog[_i170].default);\n            }\n            for (var _i171 in t) {\n              var _o81 = t[_i171];\n              e.endsWith(_i171, L) ? this._transitionable.setTransition(_i171.slice(0, -L.length), _o81) : this._transitionable.setValue(_i171, _o81);\n            }\n          }\n        }\n      }, {\n        key: \"getOpacity\",\n        value: function getOpacity(t) {\n          if (!this._transform.projection.supportsFog) return 0;\n          var i = this.properties && this.properties.get(\"color\") || 1;\n          return (\"globe\" === this._transform.projection.name ? 1 : e.smoothstep(45, 65, t)) * i.a;\n        }\n      }, {\n        key: \"getOpacityAtLatLng\",\n        value: function getOpacityAtLatLng(t, i) {\n          return this._transform.projection.supportsFog ? function (t, i, o) {\n            var r = e.MercatorCoordinate.fromLngLat(i),\n              n = o.elevation ? o.elevation.getAtPointOrZero(r) : 0,\n              s = [r.x, r.y, n];\n            return e.transformMat4(s, s, o.mercatorFogMatrix), I(t, s, o.pitch, o._fov);\n          }(this.state, t, i) : 0;\n        }\n      }, {\n        key: \"getFovAdjustedRange\",\n        value: function getFovAdjustedRange(e) {\n          return this._transform.projection.supportsFog ? S(this.state, e) : [0, 1];\n        }\n      }, {\n        key: \"updateTransitions\",\n        value: function updateTransitions(e) {\n          this._transitioning = this._transitionable.transitioned(e, this._transitioning);\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return this._transitioning.hasTransition();\n        }\n      }, {\n        key: \"recalculate\",\n        value: function recalculate(e) {\n          this.properties = this._transitioning.possiblyEvaluate(e);\n        }\n      }, {\n        key: \"_validate\",\n        value: function _validate(t, i, o) {\n          return (!o || !1 !== o.validate) && e.emitValidationErrors(this, t.call(e.validateStyle, e.extend({\n            value: i,\n            style: {\n              glyphs: !0,\n              sprite: !0\n            },\n            styleSpec: e.spec\n          })));\n        }\n      }, {\n        key: \"state\",\n        get: function get() {\n          var t = this._transform,\n            i = \"globe\" === t.projection.name,\n            o = e.globeToMercatorTransition(t.zoom),\n            r = this.properties.get(\"range\"),\n            n = [.5, 3];\n          return {\n            range: i ? [e.number(n[0], r[0], o), e.number(n[1], r[1], o)] : r,\n            horizonBlend: this.properties.get(\"horizon-blend\"),\n            alpha: this.properties.get(\"color\").a\n          };\n        }\n      }]);\n      return A;\n    }(e.Evented);\n    var z = /*#__PURE__*/function () {\n      function z(t, i) {\n        var _this72 = this;\n        _classCallCheck(this, z);\n        this.workerPool = t, this.actors = [], this.currentActor = 0, this.id = e.uniqueId();\n        var o = this.workerPool.acquire(this.id);\n        for (var _e278 = 0; _e278 < o.length; _e278++) {\n          var _t320 = new z.Actor(o[_e278], i, this.id);\n          _t320.name = \"Worker \".concat(_e278), this.actors.push(_t320);\n        }\n        this.ready = !1, this.broadcast(\"checkIfReady\", null, function () {\n          _this72.ready = !0;\n        });\n      }\n      _createClass(z, [{\n        key: \"broadcast\",\n        value: function broadcast(t, i, o) {\n          e.asyncAll(this.actors, function (e, o) {\n            e.send(t, i, o);\n          }, o = o || function () {});\n        }\n      }, {\n        key: \"getActor\",\n        value: function getActor() {\n          return this.currentActor = (this.currentActor + 1) % this.actors.length, this.actors[this.currentActor];\n        }\n      }, {\n        key: \"remove\",\n        value: function remove() {\n          this.actors.forEach(function (e) {\n            e.remove();\n          }), this.actors = [], this.workerPool.release(this.id);\n        }\n      }]);\n      return z;\n    }();\n    function P(t, i, o) {\n      return i * (e.EXTENT / (t.tileSize * Math.pow(2, o - t.tileID.overscaledZ)));\n    }\n    z.Actor = e.Actor;\n    var R = /*#__PURE__*/function () {\n      function R(e, t, i, o) {\n        _classCallCheck(this, R);\n        this.screenBounds = e, this.cameraPoint = t, this._screenRaycastCache = {}, this._cameraRaycastCache = {}, this.isAboveHorizon = i, this.screenGeometry = this.bufferedScreenGeometry(0), this.screenGeometryMercator = this._bufferedScreenMercator(0, o);\n      }\n      _createClass(R, [{\n        key: \"isPointQuery\",\n        value: function isPointQuery() {\n          return 1 === this.screenBounds.length;\n        }\n      }, {\n        key: \"bufferedScreenGeometry\",\n        value: function bufferedScreenGeometry(t) {\n          return e.polygonizeBounds(this.screenBounds[0], 1 === this.screenBounds.length ? this.screenBounds[0] : this.screenBounds[1], t);\n        }\n      }, {\n        key: \"bufferedCameraGeometry\",\n        value: function bufferedCameraGeometry(t) {\n          var i = this.screenBounds[0],\n            o = 1 === this.screenBounds.length ? this.screenBounds[0].add(new e.pointGeometry(1, 1)) : this.screenBounds[1],\n            r = e.polygonizeBounds(i, o, 0, !1);\n          return this.cameraPoint.y > o.y && (this.cameraPoint.x > i.x && this.cameraPoint.x < o.x ? r.splice(3, 0, this.cameraPoint) : this.cameraPoint.x >= o.x ? r[2] = this.cameraPoint : this.cameraPoint.x <= i.x && (r[3] = this.cameraPoint)), e.bufferConvexPolygon(r, t);\n        }\n      }, {\n        key: \"bufferedCameraGeometryGlobe\",\n        value: function bufferedCameraGeometryGlobe(t) {\n          var i = this.screenBounds[0],\n            o = 1 === this.screenBounds.length ? this.screenBounds[0].add(new e.pointGeometry(1, 1)) : this.screenBounds[1],\n            r = e.polygonizeBounds(i, o, t),\n            n = this.cameraPoint.clone();\n          switch (3 * ((n.y > i.y) + (n.y > o.y)) + ((n.x > i.x) + (n.x > o.x))) {\n            case 0:\n              r[0] = n, r[4] = n.clone();\n              break;\n            case 1:\n              r.splice(1, 0, n);\n              break;\n            case 2:\n              r[1] = n;\n              break;\n            case 3:\n              r.splice(4, 0, n);\n              break;\n            case 5:\n              r.splice(2, 0, n);\n              break;\n            case 6:\n              r[3] = n;\n              break;\n            case 7:\n              r.splice(3, 0, n);\n              break;\n            case 8:\n              r[2] = n;\n          }\n          return r;\n        }\n      }, {\n        key: \"containsTile\",\n        value: function containsTile(t, i, o) {\n          var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n          var n = t.queryPadding / i._pixelsPerMercatorPixel + 1,\n            s = o ? this._bufferedCameraMercator(n, i) : this._bufferedScreenMercator(n, i);\n          var a = t.tileID.wrap + (s.unwrapped ? r : 0);\n          var l = s.polygon.map(function (i) {\n            return e.getTilePoint(t.tileTransform, i, a);\n          });\n          if (!e.polygonIntersectsBox(l, 0, 0, e.EXTENT, e.EXTENT)) return;\n          a = t.tileID.wrap + (this.screenGeometryMercator.unwrapped ? r : 0);\n          var c = this.screenGeometryMercator.polygon.map(function (i) {\n              return e.getTileVec3(t.tileTransform, i, a);\n            }),\n            h = c.map(function (t) {\n              return new e.pointGeometry(t[0], t[1]);\n            }),\n            u = i.getFreeCameraOptions().position || new e.MercatorCoordinate(0, 0, 0),\n            _ = e.getTileVec3(t.tileTransform, u, a),\n            d = c.map(function (t) {\n              var i = e.sub(t, t, _);\n              return e.normalize(i, i), new e.Ray(_, i);\n            }),\n            p = P(t, 1, i.zoom) * i._pixelsPerMercatorPixel;\n          return {\n            queryGeometry: this,\n            tilespaceGeometry: h,\n            tilespaceRays: d,\n            bufferedTilespaceGeometry: l,\n            bufferedTilespaceBounds: (m = e.getBounds(l), m.min.x = e.clamp(m.min.x, 0, e.EXTENT), m.min.y = e.clamp(m.min.y, 0, e.EXTENT), m.max.x = e.clamp(m.max.x, 0, e.EXTENT), m.max.y = e.clamp(m.max.y, 0, e.EXTENT), m),\n            tile: t,\n            tileID: t.tileID,\n            pixelToTileUnitsFactor: p\n          };\n          var m;\n        }\n      }, {\n        key: \"_bufferedScreenMercator\",\n        value: function _bufferedScreenMercator(e, t) {\n          var i = k(e);\n          if (this._screenRaycastCache[i]) return this._screenRaycastCache[i];\n          {\n            var _o82;\n            return _o82 = \"globe\" === t.projection.name ? this._projectAndResample(this.bufferedScreenGeometry(e), t) : {\n              polygon: this.bufferedScreenGeometry(e).map(function (e) {\n                return t.pointCoordinate3D(e);\n              }),\n              unwrapped: !0\n            }, this._screenRaycastCache[i] = _o82, _o82;\n          }\n        }\n      }, {\n        key: \"_bufferedCameraMercator\",\n        value: function _bufferedCameraMercator(e, t) {\n          var i = k(e);\n          if (this._cameraRaycastCache[i]) return this._cameraRaycastCache[i];\n          {\n            var _o83;\n            return _o83 = \"globe\" === t.projection.name ? this._projectAndResample(this.bufferedCameraGeometryGlobe(e), t) : {\n              polygon: this.bufferedCameraGeometry(e).map(function (e) {\n                return t.pointCoordinate3D(e);\n              }),\n              unwrapped: !0\n            }, this._cameraRaycastCache[i] = _o83, _o83;\n          }\n        }\n      }, {\n        key: \"_projectAndResample\",\n        value: function _projectAndResample(t, i) {\n          var o = function (t, i) {\n            var o = e.multiply([], i.pixelMatrix, i.globeMatrix),\n              r = [0, -e.GLOBE_RADIUS, 0, 1],\n              n = [0, e.GLOBE_RADIUS, 0, 1],\n              s = [0, 0, 0, 1];\n            e.transformMat4$1(r, r, o), e.transformMat4$1(n, n, o), e.transformMat4$1(s, s, o);\n            var a = new e.pointGeometry(r[0] / r[3], r[1] / r[3]),\n              l = new e.pointGeometry(n[0] / n[3], n[1] / n[3]),\n              c = e.polygonContainsPoint(t, a) && r[3] < s[3],\n              h = e.polygonContainsPoint(t, l) && n[3] < s[3];\n            if (!c && !h) return null;\n            var u = function (e, t, i) {\n              for (var _o84 = 1; _o84 < e.length; _o84++) {\n                var _r224 = B(t.pointCoordinate3D(e[_o84 - 1]).x),\n                  _n160 = B(t.pointCoordinate3D(e[_o84]).x);\n                if (i < 0) {\n                  if (_r224 < _n160) return {\n                    idx: _o84,\n                    t: -_r224 / (_n160 - 1 - _r224)\n                  };\n                } else if (_n160 < _r224) return {\n                  idx: _o84,\n                  t: (1 - _r224) / (_n160 + 1 - _r224)\n                };\n              }\n              return null;\n            }(t, i, c ? -1 : 1);\n            if (!u) return null;\n            var _ = u.idx,\n              d = u.t;\n            var p = _ > 1 ? O(t.slice(0, _), i) : [],\n              m = _ < t.length ? O(t.slice(_), i) : [];\n            p = p.map(function (t) {\n              return new e.pointGeometry(B(t.x), t.y);\n            }), m = m.map(function (t) {\n              return new e.pointGeometry(B(t.x), t.y);\n            });\n            var f = _toConsumableArray(p);\n            0 === f.length && f.push(m[m.length - 1]);\n            var g = e.number(f[f.length - 1].y, (0 === m.length ? p[0] : m[0]).y, d);\n            var v;\n            return v = c ? [new e.pointGeometry(0, g), new e.pointGeometry(0, 0), new e.pointGeometry(1, 0), new e.pointGeometry(1, g)] : [new e.pointGeometry(1, g), new e.pointGeometry(1, 1), new e.pointGeometry(0, 1), new e.pointGeometry(0, g)], f.push.apply(f, _toConsumableArray(v)), 0 === m.length ? f.push(p[0]) : f.push.apply(f, _toConsumableArray(m)), {\n              polygon: f.map(function (t) {\n                return new e.MercatorCoordinate(t.x, t.y);\n              }),\n              unwrapped: !1\n            };\n          }(t, i);\n          if (o) return o;\n          var r = function (t, i) {\n            var o = !1,\n              r = -1 / 0,\n              n = 0;\n            for (var _e279 = 0; _e279 < t.length - 1; _e279++) t[_e279].x > r && (r = t[_e279].x, n = _e279);\n            for (var _e280 = 0; _e280 < t.length - 1; _e280++) {\n              var _i172 = (n + _e280) % (t.length - 1),\n                _r225 = t[_i172],\n                _s123 = t[_i172 + 1];\n              Math.abs(_r225.x - _s123.x) > .5 && (_r225.x < _s123.x ? (_r225.x += 1, 0 === _i172 && (t[t.length - 1].x += 1)) : (_s123.x += 1, _i172 + 1 === t.length - 1 && (t[0].x += 1)), o = !0);\n            }\n            var s = e.mercatorXfromLng(i.center.lng);\n            return o && s < Math.abs(s - 1) && t.forEach(function (e) {\n              e.x -= 1;\n            }), {\n              polygon: t,\n              unwrapped: o\n            };\n          }(O(t, i).map(function (t) {\n            return new e.pointGeometry(B(t.x), t.y);\n          }), i);\n          return {\n            polygon: r.polygon.map(function (t) {\n              return new e.MercatorCoordinate(t.x, t.y);\n            }),\n            unwrapped: r.unwrapped\n          };\n        }\n      }], [{\n        key: \"createFromScreenPoints\",\n        value: function createFromScreenPoints(t, i) {\n          var o, r;\n          if (t instanceof e.pointGeometry || \"number\" == typeof t[0]) {\n            var _n161 = e.pointGeometry.convert(t);\n            o = [_n161], r = i.isPointAboveHorizon(_n161);\n          } else {\n            var _n162 = e.pointGeometry.convert(t[0]),\n              _s124 = e.pointGeometry.convert(t[1]);\n            o = [_n162, _s124], r = e.polygonizeBounds(_n162, _s124).every(function (e) {\n              return i.isPointAboveHorizon(e);\n            });\n          }\n          return new R(o, i.getCameraPoint(), r, i);\n        }\n      }]);\n      return R;\n    }();\n    function O(t, i) {\n      return e.resample(t, function (e) {\n        var t = i.pointCoordinate3D(e);\n        e.x = t.x, e.y = t.y;\n      }, 1 / 256);\n    }\n    function B(e) {\n      return e < 0 ? 1 + e % 1 : e % 1;\n    }\n    function k(e) {\n      return 100 * e | 0;\n    }\n    function F(t, i, o, r, n) {\n      var s = function s(o, r) {\n        if (o) return n(o);\n        if (r) {\n          t.url && r.tiles && t.tiles && delete t.tiles;\n          var _o85 = e.pick(e.extend(r, t), [\"tiles\", \"minzoom\", \"maxzoom\", \"attribution\", \"mapbox_logo\", \"bounds\", \"scheme\", \"tileSize\", \"encoding\"]);\n          r.vector_layers && (_o85.vectorLayers = r.vector_layers, _o85.vectorLayerIds = _o85.vectorLayers.map(function (e) {\n            return e.id;\n          })), _o85.tiles = i.canonicalizeTileset(_o85, t.url), n(null, _o85);\n        }\n      };\n      return t.url ? e.getJSON(i.transformRequest(i.normalizeSourceURL(t.url, null, o, r), e.ResourceType.Source), s) : e.exported.frame(function () {\n        return s(null, t);\n      });\n    }\n    var U = /*#__PURE__*/function () {\n      function U(t, i, o) {\n        _classCallCheck(this, U);\n        this.bounds = e.LngLatBounds.convert(this.validateBounds(t)), this.minzoom = i || 0, this.maxzoom = o || 24;\n      }\n      _createClass(U, [{\n        key: \"validateBounds\",\n        value: function validateBounds(e) {\n          return Array.isArray(e) && 4 === e.length ? [Math.max(-180, e[0]), Math.max(-90, e[1]), Math.min(180, e[2]), Math.min(90, e[3])] : [-180, -90, 180, 90];\n        }\n      }, {\n        key: \"contains\",\n        value: function contains(t) {\n          var i = Math.pow(2, t.z),\n            o = Math.floor(e.mercatorXfromLng(this.bounds.getWest()) * i),\n            r = Math.floor(e.mercatorYfromLat(this.bounds.getNorth()) * i),\n            n = Math.ceil(e.mercatorXfromLng(this.bounds.getEast()) * i),\n            s = Math.ceil(e.mercatorYfromLat(this.bounds.getSouth()) * i);\n          return t.x >= o && t.x < n && t.y >= r && t.y < s;\n        }\n      }]);\n      return U;\n    }();\n    var N = /*#__PURE__*/function () {\n      function N(e, t, i) {\n        _classCallCheck(this, N);\n        this.context = e;\n        var o = e.gl;\n        this.buffer = o.createBuffer(), this.dynamicDraw = Boolean(i), this.context.unbindVAO(), e.bindElementBuffer.set(this.buffer), o.bufferData(o.ELEMENT_ARRAY_BUFFER, t.arrayBuffer, this.dynamicDraw ? o.DYNAMIC_DRAW : o.STATIC_DRAW), this.dynamicDraw || t.destroy();\n      }\n      _createClass(N, [{\n        key: \"bind\",\n        value: function bind() {\n          this.context.bindElementBuffer.set(this.buffer);\n        }\n      }, {\n        key: \"updateData\",\n        value: function updateData(e) {\n          var t = this.context.gl;\n          this.context.unbindVAO(), this.bind(), t.bufferSubData(t.ELEMENT_ARRAY_BUFFER, 0, e.arrayBuffer);\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);\n        }\n      }]);\n      return N;\n    }();\n    var G = {\n      Int8: \"BYTE\",\n      Uint8: \"UNSIGNED_BYTE\",\n      Int16: \"SHORT\",\n      Uint16: \"UNSIGNED_SHORT\",\n      Int32: \"INT\",\n      Uint32: \"UNSIGNED_INT\",\n      Float32: \"FLOAT\"\n    };\n    var j = /*#__PURE__*/function () {\n      function j(e, t, i, o) {\n        _classCallCheck(this, j);\n        this.length = t.length, this.attributes = i, this.itemSize = t.bytesPerElement, this.dynamicDraw = o, this.context = e;\n        var r = e.gl;\n        this.buffer = r.createBuffer(), e.bindVertexBuffer.set(this.buffer), r.bufferData(r.ARRAY_BUFFER, t.arrayBuffer, this.dynamicDraw ? r.DYNAMIC_DRAW : r.STATIC_DRAW), this.dynamicDraw || t.destroy();\n      }\n      _createClass(j, [{\n        key: \"bind\",\n        value: function bind() {\n          this.context.bindVertexBuffer.set(this.buffer);\n        }\n      }, {\n        key: \"updateData\",\n        value: function updateData(e) {\n          var t = this.context.gl;\n          this.bind(), t.bufferSubData(t.ARRAY_BUFFER, 0, e.arrayBuffer);\n        }\n      }, {\n        key: \"enableAttributes\",\n        value: function enableAttributes(e, t) {\n          for (var _i173 = 0; _i173 < this.attributes.length; _i173++) {\n            var _o86 = t.attributes[this.attributes[_i173].name];\n            void 0 !== _o86 && e.enableVertexAttribArray(_o86);\n          }\n        }\n      }, {\n        key: \"setVertexAttribPointers\",\n        value: function setVertexAttribPointers(e, t, i) {\n          for (var _o87 = 0; _o87 < this.attributes.length; _o87++) {\n            var _r226 = this.attributes[_o87],\n              _n163 = t.attributes[_r226.name];\n            void 0 !== _n163 && e.vertexAttribPointer(_n163, _r226.components, e[G[_r226.type]], !1, this.itemSize, _r226.offset + this.itemSize * (i || 0));\n          }\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.buffer && (this.context.gl.deleteBuffer(this.buffer), delete this.buffer);\n        }\n      }]);\n      return j;\n    }();\n    var Z = /*#__PURE__*/function () {\n      function Z(e) {\n        _classCallCheck(this, Z);\n        this.gl = e.gl, this.default = this.getDefault(), this.current = this.default, this.dirty = !1;\n      }\n      _createClass(Z, [{\n        key: \"get\",\n        value: function get() {\n          return this.current;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {}\n      }, {\n        key: \"getDefault\",\n        value: function getDefault() {\n          return this.default;\n        }\n      }, {\n        key: \"setDefault\",\n        value: function setDefault() {\n          this.set(this.default);\n        }\n      }]);\n      return Z;\n    }();\n    var V = /*#__PURE__*/function (_Z) {\n      _inherits(V, _Z);\n      function V() {\n        _classCallCheck(this, V);\n        return _possibleConstructorReturn(this, _getPrototypeOf(V).apply(this, arguments));\n      }\n      _createClass(V, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return e.Color.transparent;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e.r !== t.r || e.g !== t.g || e.b !== t.b || e.a !== t.a || this.dirty) && (this.gl.clearColor(e.r, e.g, e.b, e.a), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return V;\n    }(Z);\n    var W = /*#__PURE__*/function (_Z2) {\n      _inherits(W, _Z2);\n      function W() {\n        _classCallCheck(this, W);\n        return _possibleConstructorReturn(this, _getPrototypeOf(W).apply(this, arguments));\n      }\n      _createClass(W, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return 1;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.clearDepth(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return W;\n    }(Z);\n    var X = /*#__PURE__*/function (_Z3) {\n      _inherits(X, _Z3);\n      function X() {\n        _classCallCheck(this, X);\n        return _possibleConstructorReturn(this, _getPrototypeOf(X).apply(this, arguments));\n      }\n      _createClass(X, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return 0;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.clearStencil(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return X;\n    }(Z);\n    var q = /*#__PURE__*/function (_Z4) {\n      _inherits(q, _Z4);\n      function q() {\n        _classCallCheck(this, q);\n        return _possibleConstructorReturn(this, _getPrototypeOf(q).apply(this, arguments));\n      }\n      _createClass(q, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return [!0, !0, !0, !0];\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e[0] !== t[0] || e[1] !== t[1] || e[2] !== t[2] || e[3] !== t[3] || this.dirty) && (this.gl.colorMask(e[0], e[1], e[2], e[3]), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return q;\n    }(Z);\n    var $ = /*#__PURE__*/function (_Z5) {\n      _inherits($, _Z5);\n      function $() {\n        _classCallCheck(this, $);\n        return _possibleConstructorReturn(this, _getPrototypeOf($).apply(this, arguments));\n      }\n      _createClass($, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return !0;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.depthMask(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return $;\n    }(Z);\n    var H = /*#__PURE__*/function (_Z6) {\n      _inherits(H, _Z6);\n      function H() {\n        _classCallCheck(this, H);\n        return _possibleConstructorReturn(this, _getPrototypeOf(H).apply(this, arguments));\n      }\n      _createClass(H, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return 255;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.stencilMask(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return H;\n    }(Z);\n    var Y = /*#__PURE__*/function (_Z7) {\n      _inherits(Y, _Z7);\n      function Y() {\n        _classCallCheck(this, Y);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Y).apply(this, arguments));\n      }\n      _createClass(Y, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return {\n            func: this.gl.ALWAYS,\n            ref: 0,\n            mask: 255\n          };\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e.func !== t.func || e.ref !== t.ref || e.mask !== t.mask || this.dirty) && (this.gl.stencilFunc(e.func, e.ref, e.mask), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return Y;\n    }(Z);\n    var K = /*#__PURE__*/function (_Z8) {\n      _inherits(K, _Z8);\n      function K() {\n        _classCallCheck(this, K);\n        return _possibleConstructorReturn(this, _getPrototypeOf(K).apply(this, arguments));\n      }\n      _createClass(K, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          var e = this.gl;\n          return [e.KEEP, e.KEEP, e.KEEP];\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e[0] !== t[0] || e[1] !== t[1] || e[2] !== t[2] || this.dirty) && (this.gl.stencilOp(e[0], e[1], e[2]), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return K;\n    }(Z);\n    var J = /*#__PURE__*/function (_Z9) {\n      _inherits(J, _Z9);\n      function J() {\n        _classCallCheck(this, J);\n        return _possibleConstructorReturn(this, _getPrototypeOf(J).apply(this, arguments));\n      }\n      _createClass(J, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return !1;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          e ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return J;\n    }(Z);\n    var Q = /*#__PURE__*/function (_Z10) {\n      _inherits(Q, _Z10);\n      function Q() {\n        _classCallCheck(this, Q);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Q).apply(this, arguments));\n      }\n      _createClass(Q, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return [0, 1];\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e[0] !== t[0] || e[1] !== t[1] || this.dirty) && (this.gl.depthRange(e[0], e[1]), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return Q;\n    }(Z);\n    var ee = /*#__PURE__*/function (_Z11) {\n      _inherits(ee, _Z11);\n      function ee() {\n        _classCallCheck(this, ee);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ee).apply(this, arguments));\n      }\n      _createClass(ee, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return !1;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          e ? t.enable(t.DEPTH_TEST) : t.disable(t.DEPTH_TEST), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return ee;\n    }(Z);\n    var te = /*#__PURE__*/function (_Z12) {\n      _inherits(te, _Z12);\n      function te() {\n        _classCallCheck(this, te);\n        return _possibleConstructorReturn(this, _getPrototypeOf(te).apply(this, arguments));\n      }\n      _createClass(te, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return this.gl.LESS;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.depthFunc(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return te;\n    }(Z);\n    var ie = /*#__PURE__*/function (_Z13) {\n      _inherits(ie, _Z13);\n      function ie() {\n        _classCallCheck(this, ie);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ie).apply(this, arguments));\n      }\n      _createClass(ie, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return !1;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          e ? t.enable(t.BLEND) : t.disable(t.BLEND), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return ie;\n    }(Z);\n    var oe = /*#__PURE__*/function (_Z14) {\n      _inherits(oe, _Z14);\n      function oe() {\n        _classCallCheck(this, oe);\n        return _possibleConstructorReturn(this, _getPrototypeOf(oe).apply(this, arguments));\n      }\n      _createClass(oe, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          var e = this.gl;\n          return [e.ONE, e.ZERO];\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e[0] !== t[0] || e[1] !== t[1] || this.dirty) && (this.gl.blendFunc(e[0], e[1]), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return oe;\n    }(Z);\n    var re = /*#__PURE__*/function (_Z15) {\n      _inherits(re, _Z15);\n      function re() {\n        _classCallCheck(this, re);\n        return _possibleConstructorReturn(this, _getPrototypeOf(re).apply(this, arguments));\n      }\n      _createClass(re, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return e.Color.transparent;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e.r !== t.r || e.g !== t.g || e.b !== t.b || e.a !== t.a || this.dirty) && (this.gl.blendColor(e.r, e.g, e.b, e.a), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return re;\n    }(Z);\n    var ne = /*#__PURE__*/function (_Z16) {\n      _inherits(ne, _Z16);\n      function ne() {\n        _classCallCheck(this, ne);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ne).apply(this, arguments));\n      }\n      _createClass(ne, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return this.gl.FUNC_ADD;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.blendEquation(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return ne;\n    }(Z);\n    var se = /*#__PURE__*/function (_Z17) {\n      _inherits(se, _Z17);\n      function se() {\n        _classCallCheck(this, se);\n        return _possibleConstructorReturn(this, _getPrototypeOf(se).apply(this, arguments));\n      }\n      _createClass(se, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return !1;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          e ? t.enable(t.CULL_FACE) : t.disable(t.CULL_FACE), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return se;\n    }(Z);\n    var ae = /*#__PURE__*/function (_Z18) {\n      _inherits(ae, _Z18);\n      function ae() {\n        _classCallCheck(this, ae);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ae).apply(this, arguments));\n      }\n      _createClass(ae, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return this.gl.BACK;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.cullFace(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return ae;\n    }(Z);\n    var le = /*#__PURE__*/function (_Z19) {\n      _inherits(le, _Z19);\n      function le() {\n        _classCallCheck(this, le);\n        return _possibleConstructorReturn(this, _getPrototypeOf(le).apply(this, arguments));\n      }\n      _createClass(le, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return this.gl.CCW;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.frontFace(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return le;\n    }(Z);\n    var ce = /*#__PURE__*/function (_Z20) {\n      _inherits(ce, _Z20);\n      function ce() {\n        _classCallCheck(this, ce);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ce).apply(this, arguments));\n      }\n      _createClass(ce, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.useProgram(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return ce;\n    }(Z);\n    var he = /*#__PURE__*/function (_Z21) {\n      _inherits(he, _Z21);\n      function he() {\n        _classCallCheck(this, he);\n        return _possibleConstructorReturn(this, _getPrototypeOf(he).apply(this, arguments));\n      }\n      _createClass(he, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return this.gl.TEXTURE0;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          (e !== this.current || this.dirty) && (this.gl.activeTexture(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return he;\n    }(Z);\n    var ue = /*#__PURE__*/function (_Z22) {\n      _inherits(ue, _Z22);\n      function ue() {\n        _classCallCheck(this, ue);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ue).apply(this, arguments));\n      }\n      _createClass(ue, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          var e = this.gl;\n          return [0, 0, e.drawingBufferWidth, e.drawingBufferHeight];\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.current;\n          (e[0] !== t[0] || e[1] !== t[1] || e[2] !== t[2] || e[3] !== t[3] || this.dirty) && (this.gl.viewport(e[0], e[1], e[2], e[3]), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return ue;\n    }(Z);\n    var _e = /*#__PURE__*/function (_Z23) {\n      _inherits(_e, _Z23);\n      function _e() {\n        _classCallCheck(this, _e);\n        return _possibleConstructorReturn(this, _getPrototypeOf(_e).apply(this, arguments));\n      }\n      _createClass(_e, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          t.bindFramebuffer(t.FRAMEBUFFER, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return _e;\n    }(Z);\n    var de = /*#__PURE__*/function (_Z24) {\n      _inherits(de, _Z24);\n      function de() {\n        _classCallCheck(this, de);\n        return _possibleConstructorReturn(this, _getPrototypeOf(de).apply(this, arguments));\n      }\n      _createClass(de, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          t.bindRenderbuffer(t.RENDERBUFFER, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return de;\n    }(Z);\n    var pe = /*#__PURE__*/function (_Z25) {\n      _inherits(pe, _Z25);\n      function pe() {\n        _classCallCheck(this, pe);\n        return _possibleConstructorReturn(this, _getPrototypeOf(pe).apply(this, arguments));\n      }\n      _createClass(pe, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          t.bindTexture(t.TEXTURE_2D, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return pe;\n    }(Z);\n    var me = /*#__PURE__*/function (_Z26) {\n      _inherits(me, _Z26);\n      function me() {\n        _classCallCheck(this, me);\n        return _possibleConstructorReturn(this, _getPrototypeOf(me).apply(this, arguments));\n      }\n      _createClass(me, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          t.bindBuffer(t.ARRAY_BUFFER, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return me;\n    }(Z);\n    var fe = /*#__PURE__*/function (_Z27) {\n      _inherits(fe, _Z27);\n      function fe() {\n        _classCallCheck(this, fe);\n        return _possibleConstructorReturn(this, _getPrototypeOf(fe).apply(this, arguments));\n      }\n      _createClass(fe, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          var t = this.gl;\n          t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return fe;\n    }(Z);\n    var ge = /*#__PURE__*/function (_Z28) {\n      _inherits(ge, _Z28);\n      function ge(e) {\n        var _this73;\n        _classCallCheck(this, ge);\n        _this73 = _possibleConstructorReturn(this, _getPrototypeOf(ge).call(this, e)), _this73.vao = e.extVertexArrayObject;\n        return _this73;\n      }\n      _createClass(ge, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          this.vao && (e !== this.current || this.dirty) && (this.vao.bindVertexArrayOES(e), this.current = e, this.dirty = !1);\n        }\n      }]);\n      return ge;\n    }(Z);\n    var ve = /*#__PURE__*/function (_Z29) {\n      _inherits(ve, _Z29);\n      function ve() {\n        _classCallCheck(this, ve);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ve).apply(this, arguments));\n      }\n      _createClass(ve, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return 4;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          t.pixelStorei(t.UNPACK_ALIGNMENT, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return ve;\n    }(Z);\n    var xe = /*#__PURE__*/function (_Z30) {\n      _inherits(xe, _Z30);\n      function xe() {\n        _classCallCheck(this, xe);\n        return _possibleConstructorReturn(this, _getPrototypeOf(xe).apply(this, arguments));\n      }\n      _createClass(xe, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return !1;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return xe;\n    }(Z);\n    var ye = /*#__PURE__*/function (_Z31) {\n      _inherits(ye, _Z31);\n      function ye() {\n        _classCallCheck(this, ye);\n        return _possibleConstructorReturn(this, _getPrototypeOf(ye).apply(this, arguments));\n      }\n      _createClass(ye, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return !1;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          var t = this.gl;\n          t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return ye;\n    }(Z);\n    var be = /*#__PURE__*/function (_Z32) {\n      _inherits(be, _Z32);\n      function be(e, t) {\n        var _this74;\n        _classCallCheck(this, be);\n        _this74 = _possibleConstructorReturn(this, _getPrototypeOf(be).call(this, e)), _this74.context = e, _this74.parent = t;\n        return _this74;\n      }\n      _createClass(be, [{\n        key: \"getDefault\",\n        value: function getDefault() {\n          return null;\n        }\n      }]);\n      return be;\n    }(Z);\n    var we = /*#__PURE__*/function (_be) {\n      _inherits(we, _be);\n      function we() {\n        _classCallCheck(this, we);\n        return _possibleConstructorReturn(this, _getPrototypeOf(we).apply(this, arguments));\n      }\n      _createClass(we, [{\n        key: \"setDirty\",\n        value: function setDirty() {\n          this.dirty = !0;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          this.context.bindFramebuffer.set(this.parent);\n          var t = this.gl;\n          t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, e, 0), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return we;\n    }(be);\n    var Te = /*#__PURE__*/function (_be2) {\n      _inherits(Te, _be2);\n      function Te() {\n        _classCallCheck(this, Te);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Te).apply(this, arguments));\n      }\n      _createClass(Te, [{\n        key: \"attachment\",\n        value: function attachment() {\n          return this.gl.DEPTH_ATTACHMENT;\n        }\n      }, {\n        key: \"set\",\n        value: function set(e) {\n          if (e === this.current && !this.dirty) return;\n          this.context.bindFramebuffer.set(this.parent);\n          var t = this.gl;\n          t.framebufferRenderbuffer(t.FRAMEBUFFER, this.attachment(), t.RENDERBUFFER, e), this.current = e, this.dirty = !1;\n        }\n      }]);\n      return Te;\n    }(be);\n    var Ee = /*#__PURE__*/function (_Te) {\n      _inherits(Ee, _Te);\n      function Ee() {\n        _classCallCheck(this, Ee);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Ee).apply(this, arguments));\n      }\n      _createClass(Ee, [{\n        key: \"attachment\",\n        value: function attachment() {\n          return this.gl.DEPTH_STENCIL_ATTACHMENT;\n        }\n      }]);\n      return Ee;\n    }(Te);\n    var Ce = /*#__PURE__*/function () {\n      function Ce(e, t, i, o) {\n        _classCallCheck(this, Ce);\n        this.context = e, this.width = t, this.height = i;\n        var r = this.framebuffer = e.gl.createFramebuffer();\n        this.colorAttachment = new we(e, r), o && (this.depthAttachment = new Te(e, r));\n      }\n      _createClass(Ce, [{\n        key: \"destroy\",\n        value: function destroy() {\n          var e = this.context.gl,\n            t = this.colorAttachment.get();\n          if (t && e.deleteTexture(t), this.depthAttachment) {\n            var _t321 = this.depthAttachment.get();\n            _t321 && e.deleteRenderbuffer(_t321);\n          }\n          e.deleteFramebuffer(this.framebuffer);\n        }\n      }]);\n      return Ce;\n    }();\n    var Me = /*#__PURE__*/function () {\n      function Me(e) {\n        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n        _classCallCheck(this, Me);\n        if (this.gl = e, this.isWebGL2 = t, this.extVertexArrayObject = this.gl.getExtension(\"OES_vertex_array_object\"), t) {\n          var _t322 = e;\n          this.extVertexArrayObject = {\n            createVertexArrayOES: _t322.createVertexArray.bind(e),\n            deleteVertexArrayOES: _t322.deleteVertexArray.bind(e),\n            bindVertexArrayOES: _t322.bindVertexArray.bind(e)\n          };\n        }\n        this.clearColor = new V(this), this.clearDepth = new W(this), this.clearStencil = new X(this), this.colorMask = new q(this), this.depthMask = new $(this), this.stencilMask = new H(this), this.stencilFunc = new Y(this), this.stencilOp = new K(this), this.stencilTest = new J(this), this.depthRange = new Q(this), this.depthTest = new ee(this), this.depthFunc = new te(this), this.blend = new ie(this), this.blendFunc = new oe(this), this.blendColor = new re(this), this.blendEquation = new ne(this), this.cullFace = new se(this), this.cullFaceSide = new ae(this), this.frontFace = new le(this), this.program = new ce(this), this.activeTexture = new he(this), this.viewport = new ue(this), this.bindFramebuffer = new _e(this), this.bindRenderbuffer = new de(this), this.bindTexture = new pe(this), this.bindVertexBuffer = new me(this), this.bindElementBuffer = new fe(this), this.bindVertexArrayOES = this.extVertexArrayObject && new ge(this), this.pixelStoreUnpack = new ve(this), this.pixelStoreUnpackPremultiplyAlpha = new xe(this), this.pixelStoreUnpackFlipY = new ye(this), this.extTextureFilterAnisotropic = e.getExtension(\"EXT_texture_filter_anisotropic\") || e.getExtension(\"MOZ_EXT_texture_filter_anisotropic\") || e.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\"), this.extTextureFilterAnisotropic && (this.extTextureFilterAnisotropicMax = e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)), this.extTextureFilterAnisotropicForceOff = !1, this.extStandardDerivativesForceOff = !1, this.extDebugRendererInfo = e.getExtension(\"WEBGL_debug_renderer_info\"), this.extDebugRendererInfo && (this.renderer = e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL), this.vendor = e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)), t || (this.extTextureHalfFloat = e.getExtension(\"OES_texture_half_float\")), (t || this.extTextureHalfFloat && e.getExtension(\"OES_texture_half_float_linear\")) && (this.extRenderToTextureHalfFloat = e.getExtension(\"EXT_color_buffer_half_float\")), this.extStandardDerivatives = t || e.getExtension(\"OES_standard_derivatives\"), this.extTimerQuery = e.getExtension(\"EXT_disjoint_timer_query\"), this.maxTextureSize = e.getParameter(e.MAX_TEXTURE_SIZE);\n      }\n      _createClass(Me, [{\n        key: \"setDefault\",\n        value: function setDefault() {\n          this.unbindVAO(), this.clearColor.setDefault(), this.clearDepth.setDefault(), this.clearStencil.setDefault(), this.colorMask.setDefault(), this.depthMask.setDefault(), this.stencilMask.setDefault(), this.stencilFunc.setDefault(), this.stencilOp.setDefault(), this.stencilTest.setDefault(), this.depthRange.setDefault(), this.depthTest.setDefault(), this.depthFunc.setDefault(), this.blend.setDefault(), this.blendFunc.setDefault(), this.blendColor.setDefault(), this.blendEquation.setDefault(), this.cullFace.setDefault(), this.cullFaceSide.setDefault(), this.frontFace.setDefault(), this.program.setDefault(), this.activeTexture.setDefault(), this.bindFramebuffer.setDefault(), this.pixelStoreUnpack.setDefault(), this.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.pixelStoreUnpackFlipY.setDefault();\n        }\n      }, {\n        key: \"setDirty\",\n        value: function setDirty() {\n          this.clearColor.dirty = !0, this.clearDepth.dirty = !0, this.clearStencil.dirty = !0, this.colorMask.dirty = !0, this.depthMask.dirty = !0, this.stencilMask.dirty = !0, this.stencilFunc.dirty = !0, this.stencilOp.dirty = !0, this.stencilTest.dirty = !0, this.depthRange.dirty = !0, this.depthTest.dirty = !0, this.depthFunc.dirty = !0, this.blend.dirty = !0, this.blendFunc.dirty = !0, this.blendColor.dirty = !0, this.blendEquation.dirty = !0, this.cullFace.dirty = !0, this.cullFaceSide.dirty = !0, this.frontFace.dirty = !0, this.program.dirty = !0, this.activeTexture.dirty = !0, this.viewport.dirty = !0, this.bindFramebuffer.dirty = !0, this.bindRenderbuffer.dirty = !0, this.bindTexture.dirty = !0, this.bindVertexBuffer.dirty = !0, this.bindElementBuffer.dirty = !0, this.extVertexArrayObject && (this.bindVertexArrayOES.dirty = !0), this.pixelStoreUnpack.dirty = !0, this.pixelStoreUnpackPremultiplyAlpha.dirty = !0, this.pixelStoreUnpackFlipY.dirty = !0;\n        }\n      }, {\n        key: \"createIndexBuffer\",\n        value: function createIndexBuffer(e, t) {\n          return new N(this, e, t);\n        }\n      }, {\n        key: \"createVertexBuffer\",\n        value: function createVertexBuffer(e, t, i) {\n          return new j(this, e, t, i);\n        }\n      }, {\n        key: \"createRenderbuffer\",\n        value: function createRenderbuffer(e, t, i) {\n          var o = this.gl,\n            r = o.createRenderbuffer();\n          return this.bindRenderbuffer.set(r), o.renderbufferStorage(o.RENDERBUFFER, e, t, i), this.bindRenderbuffer.set(null), r;\n        }\n      }, {\n        key: \"createFramebuffer\",\n        value: function createFramebuffer(e, t, i) {\n          return new Ce(this, e, t, i);\n        }\n      }, {\n        key: \"clear\",\n        value: function clear(_ref134) {\n          var e = _ref134.color,\n            t = _ref134.depth,\n            i = _ref134.stencil;\n          var o = this.gl;\n          var r = 0;\n          e && (r |= o.COLOR_BUFFER_BIT, this.clearColor.set(e), this.colorMask.set([!0, !0, !0, !0])), void 0 !== t && (r |= o.DEPTH_BUFFER_BIT, this.depthRange.set([0, 1]), this.clearDepth.set(t), this.depthMask.set(!0)), void 0 !== i && (r |= o.STENCIL_BUFFER_BIT, this.clearStencil.set(i), this.stencilMask.set(255)), o.clear(r);\n        }\n      }, {\n        key: \"setCullFace\",\n        value: function setCullFace(e) {\n          !1 === e.enable ? this.cullFace.set(!1) : (this.cullFace.set(!0), this.cullFaceSide.set(e.mode), this.frontFace.set(e.frontFace));\n        }\n      }, {\n        key: \"setDepthMode\",\n        value: function setDepthMode(e) {\n          e.func !== this.gl.ALWAYS || e.mask ? (this.depthTest.set(!0), this.depthFunc.set(e.func), this.depthMask.set(e.mask), this.depthRange.set(e.range)) : this.depthTest.set(!1);\n        }\n      }, {\n        key: \"setStencilMode\",\n        value: function setStencilMode(e) {\n          e.test.func !== this.gl.ALWAYS || e.mask ? (this.stencilTest.set(!0), this.stencilMask.set(e.mask), this.stencilOp.set([e.fail, e.depthFail, e.pass]), this.stencilFunc.set({\n            func: e.test.func,\n            ref: e.ref,\n            mask: e.test.mask\n          })) : this.stencilTest.set(!1);\n        }\n      }, {\n        key: \"setColorMode\",\n        value: function setColorMode(i) {\n          t(i.blendFunction, e.ColorMode.Replace) ? this.blend.set(!1) : (this.blend.set(!0), this.blendFunc.set(i.blendFunction), this.blendColor.set(i.blendColor)), this.colorMask.set(i.mask);\n        }\n      }, {\n        key: \"unbindVAO\",\n        value: function unbindVAO() {\n          this.extVertexArrayObject && this.bindVertexArrayOES.set(null);\n        }\n      }]);\n      return Me;\n    }();\n    var Ie = /*#__PURE__*/function (_e$Evented5) {\n      _inherits(Ie, _e$Evented5);\n      function Ie(t, i, o, r) {\n        var _this75;\n        _classCallCheck(this, Ie);\n        if (_this75 = _possibleConstructorReturn(this, _getPrototypeOf(Ie).call(this)), _this75.id = t, _this75.dispatcher = o, _this75.type = \"vector\", _this75.minzoom = 0, _this75.maxzoom = 22, _this75.scheme = \"xyz\", _this75.tileSize = 512, _this75.reparseOverscaled = !0, _this75.isTileClipped = !0, _this75._loaded = !1, e.extend(_assertThisInitialized(_assertThisInitialized(_this75)), e.pick(i, [\"url\", \"scheme\", \"tileSize\", \"promoteId\"])), _this75._options = e.extend({\n          type: \"vector\"\n        }, i), _this75._collectResourceTiming = i.collectResourceTiming, 512 !== _this75.tileSize) throw new Error(\"vector tile sources must have a tileSize of 512\");\n        _this75.setEventedParent(r), _this75._tileWorkers = {}, _this75._deduped = new e.DedupedRequest();\n        return _possibleConstructorReturn(_this75);\n      }\n      _createClass(Ie, [{\n        key: \"load\",\n        value: function load(t) {\n          var _this76 = this;\n          this._loaded = !1, this.fire(new e.Event(\"dataloading\", {\n            dataType: \"source\"\n          }));\n          var i = Array.isArray(this.map._language) ? this.map._language.join() : this.map._language,\n            o = this.map._worldview;\n          this._tileJSONRequest = F(this._options, this.map._requestManager, i, o, function (r, n) {\n            _this76._tileJSONRequest = null, _this76._loaded = !0, r ? (i && console.warn(\"Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: \".concat(i)), o && 2 !== o.length && console.warn(\"Requested worldview strings must be a valid ISO alpha-2 code. Found: \".concat(o)), _this76.fire(new e.ErrorEvent(r))) : n && (e.extend(_this76, n), n.bounds && (_this76.tileBounds = new U(n.bounds, _this76.minzoom, _this76.maxzoom)), e.postTurnstileEvent(n.tiles, _this76.map._requestManager._customAccessToken), _this76.fire(new e.Event(\"data\", {\n              dataType: \"source\",\n              sourceDataType: \"metadata\"\n            })), _this76.fire(new e.Event(\"data\", {\n              dataType: \"source\",\n              sourceDataType: \"content\"\n            }))), t && t(r);\n          });\n        }\n      }, {\n        key: \"loaded\",\n        value: function loaded() {\n          return this._loaded;\n        }\n      }, {\n        key: \"hasTile\",\n        value: function hasTile(e) {\n          return !this.tileBounds || this.tileBounds.contains(e.canonical);\n        }\n      }, {\n        key: \"onAdd\",\n        value: function onAdd(e) {\n          this.map = e, this.load();\n        }\n      }, {\n        key: \"reload\",\n        value: function reload() {\n          var _this77 = this;\n          this.cancelTileJSONRequest(), this.load(function () {\n            return _this77.map.style._clearSource(_this77.id);\n          });\n        }\n      }, {\n        key: \"setTiles\",\n        value: function setTiles(e) {\n          return this._options.tiles = e, this.reload(), this;\n        }\n      }, {\n        key: \"setUrl\",\n        value: function setUrl(e) {\n          return this.url = e, this._options.url = e, this.reload(), this;\n        }\n      }, {\n        key: \"onRemove\",\n        value: function onRemove() {\n          this.cancelTileJSONRequest();\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return e.extend({}, this._options);\n        }\n      }, {\n        key: \"loadTile\",\n        value: function loadTile(t, i) {\n          var _this78 = this;\n          var o = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme)),\n            r = {\n              request: this.map._requestManager.transformRequest(o, e.ResourceType.Tile),\n              data: void 0,\n              uid: t.uid,\n              tileID: t.tileID,\n              tileZoom: t.tileZoom,\n              zoom: t.tileID.overscaledZ,\n              tileSize: this.tileSize * t.tileID.overscaleFactor(),\n              type: this.type,\n              source: this.id,\n              pixelRatio: e.exported.devicePixelRatio,\n              showCollisionBoxes: this.map.showCollisionBoxes,\n              promoteId: this.promoteId,\n              isSymbolTile: t.isSymbolTile\n            };\n          if (r.request.collectResourceTiming = this._collectResourceTiming, t.actor && \"expired\" !== t.state) \"loading\" === t.state ? t.reloadCallback = i : t.request = t.actor.send(\"reloadTile\", r, n.bind(this));else if (t.actor = this._tileWorkers[o] = this._tileWorkers[o] || this.dispatcher.getActor(), this.dispatcher.ready) t.request = t.actor.send(\"loadTile\", r, n.bind(this), void 0, !0);else {\n            var _i174 = e.loadVectorTile.call({\n              deduped: this._deduped\n            }, r, function (e, i) {\n              e || !i ? n.call(_this78, e) : (r.data = {\n                cacheControl: i.cacheControl,\n                expires: i.expires,\n                rawData: i.rawData.slice(0)\n              }, t.actor && t.actor.send(\"loadTile\", r, n.bind(_this78), void 0, !0));\n            }, !0);\n            t.request = {\n              cancel: _i174\n            };\n          }\n          function n(o, r) {\n            return delete t.request, t.aborted ? i(null) : o && 404 !== o.status ? i(o) : (r && r.resourceTiming && (t.resourceTiming = r.resourceTiming), this.map._refreshExpiredTiles && r && t.setExpiryData(r), t.loadVectorData(r, this.map.painter), e.cacheEntryPossiblyAdded(this.dispatcher), i(null), void (t.reloadCallback && (this.loadTile(t, t.reloadCallback), t.reloadCallback = null)));\n          }\n        }\n      }, {\n        key: \"abortTile\",\n        value: function abortTile(e) {\n          e.request && (e.request.cancel(), delete e.request), e.actor && e.actor.send(\"abortTile\", {\n            uid: e.uid,\n            type: this.type,\n            source: this.id\n          });\n        }\n      }, {\n        key: \"unloadTile\",\n        value: function unloadTile(e) {\n          e.unloadVectorData(), e.actor && e.actor.send(\"removeTile\", {\n            uid: e.uid,\n            type: this.type,\n            source: this.id\n          });\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return !1;\n        }\n      }, {\n        key: \"afterUpdate\",\n        value: function afterUpdate() {\n          this._tileWorkers = {};\n        }\n      }, {\n        key: \"cancelTileJSONRequest\",\n        value: function cancelTileJSONRequest() {\n          this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);\n        }\n      }]);\n      return Ie;\n    }(e.Evented);\n    var Se = /*#__PURE__*/function (_e$Evented6) {\n      _inherits(Se, _e$Evented6);\n      function Se(t, i, o, r) {\n        var _this79;\n        _classCallCheck(this, Se);\n        _this79 = _possibleConstructorReturn(this, _getPrototypeOf(Se).call(this)), _this79.id = t, _this79.dispatcher = o, _this79.setEventedParent(r), _this79.type = \"raster\", _this79.minzoom = 0, _this79.maxzoom = 22, _this79.roundZoom = !0, _this79.scheme = \"xyz\", _this79.tileSize = 512, _this79._loaded = !1, _this79._options = e.extend({\n          type: \"raster\"\n        }, i), e.extend(_assertThisInitialized(_assertThisInitialized(_this79)), e.pick(i, [\"url\", \"scheme\", \"tileSize\"]));\n        return _this79;\n      }\n      _createClass(Se, [{\n        key: \"load\",\n        value: function load(t) {\n          var _this80 = this;\n          this._loaded = !1, this.fire(new e.Event(\"dataloading\", {\n            dataType: \"source\"\n          })), this._tileJSONRequest = F(this._options, this.map._requestManager, null, null, function (i, o) {\n            _this80._tileJSONRequest = null, _this80._loaded = !0, i ? _this80.fire(new e.ErrorEvent(i)) : o && (e.extend(_this80, o), o.bounds && (_this80.tileBounds = new U(o.bounds, _this80.minzoom, _this80.maxzoom)), e.postTurnstileEvent(o.tiles), _this80.fire(new e.Event(\"data\", {\n              dataType: \"source\",\n              sourceDataType: \"metadata\"\n            })), _this80.fire(new e.Event(\"data\", {\n              dataType: \"source\",\n              sourceDataType: \"content\"\n            }))), t && t(i);\n          });\n        }\n      }, {\n        key: \"loaded\",\n        value: function loaded() {\n          return this._loaded;\n        }\n      }, {\n        key: \"onAdd\",\n        value: function onAdd(e) {\n          this.map = e, this.load();\n        }\n      }, {\n        key: \"reload\",\n        value: function reload() {\n          var _this81 = this;\n          this.cancelTileJSONRequest(), this.load(function () {\n            return _this81.map.style._clearSource(_this81.id);\n          });\n        }\n      }, {\n        key: \"setTiles\",\n        value: function setTiles(e) {\n          return this._options.tiles = e, this.reload(), this;\n        }\n      }, {\n        key: \"setUrl\",\n        value: function setUrl(e) {\n          return this.url = e, this._options.url = e, this.reload(), this;\n        }\n      }, {\n        key: \"onRemove\",\n        value: function onRemove() {\n          this.cancelTileJSONRequest();\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return e.extend({}, this._options);\n        }\n      }, {\n        key: \"hasTile\",\n        value: function hasTile(e) {\n          return !this.tileBounds || this.tileBounds.contains(e.canonical);\n        }\n      }, {\n        key: \"loadTile\",\n        value: function loadTile(t, i) {\n          var _this82 = this;\n          var o = e.exported.devicePixelRatio >= 2,\n            r = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme), o, this.tileSize);\n          t.request = e.getImage(this.map._requestManager.transformRequest(r, e.ResourceType.Tile), function (o, r, n, s) {\n            return delete t.request, t.aborted ? (t.state = \"unloaded\", i(null)) : o ? (t.state = \"errored\", i(o)) : r ? (_this82.map._refreshExpiredTiles && t.setExpiryData({\n              cacheControl: n,\n              expires: s\n            }), t.setTexture(r, _this82.map.painter), t.state = \"loaded\", e.cacheEntryPossiblyAdded(_this82.dispatcher), void i(null)) : i(null);\n          });\n        }\n      }, {\n        key: \"abortTile\",\n        value: function abortTile(e, t) {\n          e.request && (e.request.cancel(), delete e.request), t();\n        }\n      }, {\n        key: \"unloadTile\",\n        value: function unloadTile(e, t) {\n          e.texture && this.map.painter.saveTileTexture(e.texture), t();\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return !1;\n        }\n      }, {\n        key: \"cancelTileJSONRequest\",\n        value: function cancelTileJSONRequest() {\n          this._tileJSONRequest && (this._tileJSONRequest.cancel(), this._tileJSONRequest = null);\n        }\n      }], [{\n        key: \"loadTileData\",\n        value: function loadTileData(e, t, i) {\n          e.setTexture(t, i);\n        }\n      }, {\n        key: \"unloadTileData\",\n        value: function unloadTileData(e, t) {\n          e.texture && t.saveTileTexture(e.texture);\n        }\n      }]);\n      return Se;\n    }(e.Evented);\n    var De;\n    function Le(t, i, o, r, n, s, a, l) {\n      var c = [t, o, n, i, r, s, 1, 1, 1],\n        h = [a, l, 1],\n        u = e.adjoint([], c),\n        _e$transformMat = e.transformMat3(h, h, e.transpose(u, u)),\n        _e$transformMat2 = _slicedToArray(_e$transformMat, 3),\n        _ = _e$transformMat2[0],\n        d = _e$transformMat2[1],\n        p = _e$transformMat2[2];\n      return e.multiply$1(c, [_, 0, 0, 0, d, 0, 0, 0, p], c);\n    }\n    var Ae = /*#__PURE__*/function (_e$Evented7) {\n      _inherits(Ae, _e$Evented7);\n      function Ae(e, t, i, o) {\n        var _this83;\n        _classCallCheck(this, Ae);\n        _this83 = _possibleConstructorReturn(this, _getPrototypeOf(Ae).call(this)), _this83.id = e, _this83.dispatcher = i, _this83.coordinates = t.coordinates, _this83.type = \"image\", _this83.minzoom = 0, _this83.maxzoom = 22, _this83.tileSize = 512, _this83.tiles = {}, _this83._loaded = !1, _this83.setEventedParent(o), _this83.options = t, _this83._dirty = !1;\n        return _this83;\n      }\n      _createClass(Ae, [{\n        key: \"load\",\n        value: function load(t, i) {\n          var _this84 = this;\n          this._loaded = i || !1, this.fire(new e.Event(\"dataloading\", {\n            dataType: \"source\"\n          })), this.url = this.options.url, this._imageRequest = e.getImage(this.map._requestManager.transformRequest(this.url, e.ResourceType.Image), function (i, o) {\n            if (_this84._imageRequest = null, _this84._loaded = !0, i) _this84.fire(new e.ErrorEvent(i));else if (o) {\n              var _i175 = e.window.HTMLImageElement;\n              _this84.image = o instanceof _i175 ? e.exported.getImageData(o) : o, _this84._dirty = !0, _this84.width = _this84.image.width, _this84.height = _this84.image.height, t && (_this84.coordinates = t), _this84._finishLoading();\n            }\n          });\n        }\n      }, {\n        key: \"loaded\",\n        value: function loaded() {\n          return this._loaded;\n        }\n      }, {\n        key: \"updateImage\",\n        value: function updateImage(e) {\n          return this.image && e.url ? (this._imageRequest && e.url !== this.options.url && (this._imageRequest.cancel(), this._imageRequest = null), this.options.url = e.url, this.load(e.coordinates, this._loaded), this) : this;\n        }\n      }, {\n        key: \"_finishLoading\",\n        value: function _finishLoading() {\n          this.map && (this.setCoordinates(this.coordinates), this.fire(new e.Event(\"data\", {\n            dataType: \"source\",\n            sourceDataType: \"metadata\"\n          })));\n        }\n      }, {\n        key: \"onAdd\",\n        value: function onAdd(e) {\n          this.map = e, this.load();\n        }\n      }, {\n        key: \"onRemove\",\n        value: function onRemove() {\n          this._imageRequest && (this._imageRequest.cancel(), this._imageRequest = null), this.texture && this.texture.destroy();\n        }\n      }, {\n        key: \"setCoordinates\",\n        value: function setCoordinates(t) {\n          this.coordinates = t, this._boundsArray = void 0;\n          var i = t.map(e.MercatorCoordinate.fromLngLat);\n          return this.tileID = function (t) {\n            var i = 1 / 0,\n              o = 1 / 0,\n              r = -1 / 0,\n              n = -1 / 0;\n            var _iterator192 = _createForOfIteratorHelper(t),\n              _step192;\n            try {\n              for (_iterator192.s(); !(_step192 = _iterator192.n()).done;) {\n                var _e281 = _step192.value;\n                i = Math.min(i, _e281.x), o = Math.min(o, _e281.y), r = Math.max(r, _e281.x), n = Math.max(n, _e281.y);\n              }\n            } catch (err) {\n              _iterator192.e(err);\n            } finally {\n              _iterator192.f();\n            }\n            var s = Math.max(r - i, n - o),\n              a = Math.max(0, Math.floor(-Math.log(s) / Math.LN2)),\n              l = Math.pow(2, a);\n            return new e.CanonicalTileID(a, Math.floor((i + r) / 2 * l), Math.floor((o + n) / 2 * l));\n          }(i), this.minzoom = this.maxzoom = this.tileID.z, this.fire(new e.Event(\"data\", {\n            dataType: \"source\",\n            sourceDataType: \"content\"\n          })), this;\n        }\n      }, {\n        key: \"_clear\",\n        value: function _clear() {\n          this._boundsArray = void 0;\n        }\n      }, {\n        key: \"_prepareData\",\n        value: function _prepareData(t) {\n          for (var _e282 in this.tiles) {\n            var _t323 = this.tiles[_e282];\n            \"loaded\" !== _t323.state && (_t323.state = \"loaded\", _t323.texture = this.texture);\n          }\n          if (this._boundsArray) return;\n          var i = e.tileTransform(this.tileID, this.map.transform.projection),\n            _this$coordinates$map = this.coordinates.map(function (t) {\n              var o = i.projection.project(t[0], t[1]);\n              return e.getTilePoint(i, o)._round();\n            }),\n            _this$coordinates$map2 = _slicedToArray(_this$coordinates$map, 4),\n            o = _this$coordinates$map2[0],\n            r = _this$coordinates$map2[1],\n            n = _this$coordinates$map2[2],\n            s = _this$coordinates$map2[3];\n          this.perspectiveTransform = function (t, i, o, r, n, s, a, l, c, h) {\n            var u = Le(0, 0, t, 0, 0, i, t, i),\n              _ = Le(o, r, n, s, a, l, c, h);\n            return e.multiply$1(_, e.adjoint(u, u), _), [_[6] / _[8] * t / e.EXTENT, _[7] / _[8] * i / e.EXTENT];\n          }(this.width, this.height, o.x, o.y, r.x, r.y, s.x, s.y, n.x, n.y);\n          var a = this._boundsArray = new e.StructArrayLayout4i8();\n          a.emplaceBack(o.x, o.y, 0, 0), a.emplaceBack(r.x, r.y, e.EXTENT, 0), a.emplaceBack(s.x, s.y, 0, e.EXTENT), a.emplaceBack(n.x, n.y, e.EXTENT, e.EXTENT), this.boundsBuffer && this.boundsBuffer.destroy(), this.boundsBuffer = t.createVertexBuffer(a, e.boundsAttributes.members), this.boundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);\n        }\n      }, {\n        key: \"prepare\",\n        value: function prepare() {\n          if (0 === Object.keys(this.tiles).length || !this.image) return;\n          var t = this.map.painter.context,\n            i = t.gl;\n          this._dirty && (this.texture ? this.texture.update(this.image) : (this.texture = new e.Texture(t, this.image, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE)), this._dirty = !1), this._prepareData(t);\n        }\n      }, {\n        key: \"loadTile\",\n        value: function loadTile(e, t) {\n          this.tileID && this.tileID.equals(e.tileID.canonical) ? (this.tiles[String(e.tileID.wrap)] = e, e.buckets = {}, t(null)) : (e.state = \"errored\", t(null));\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          return {\n            type: \"image\",\n            url: this.options.url,\n            coordinates: this.coordinates\n          };\n        }\n      }, {\n        key: \"hasTransition\",\n        value: function hasTransition() {\n          return !1;\n        }\n      }]);\n      return Ae;\n    }(e.Evented);\n    var ze = {\n        vector: Ie,\n        raster: Se,\n        \"raster-dem\": /*#__PURE__*/function (_Se) {\n          _inherits(rasterDem, _Se);\n          function rasterDem(t, i, o, r) {\n            var _this85;\n            _classCallCheck(this, rasterDem);\n            _this85 = _possibleConstructorReturn(this, _getPrototypeOf(rasterDem).call(this, t, i, o, r)), _this85.type = \"raster-dem\", _this85.maxzoom = 22, _this85._options = e.extend({\n              type: \"raster-dem\"\n            }, i), _this85.encoding = i.encoding || \"mapbox\";\n            return _this85;\n          }\n          _createClass(rasterDem, [{\n            key: \"loadTile\",\n            value: function loadTile(t, i) {\n              var o = this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles, this.scheme), !1, this.tileSize);\n              function r(e, o) {\n                e && (t.state = \"errored\", i(e)), o && (t.dem = o, t.dem.onDeserialize(), t.needsHillshadePrepare = !0, t.needsDEMTextureUpload = !0, t.state = \"loaded\", i(null));\n              }\n              t.request = e.getImage(this.map._requestManager.transformRequest(o, e.ResourceType.Tile), function (o, n, s, a) {\n                if (delete t.request, t.aborted) t.state = \"unloaded\", i(null);else if (o) t.state = \"errored\", i(o);else if (n) {\n                  this.map._refreshExpiredTiles && t.setExpiryData({\n                    cacheControl: s,\n                    expires: a\n                  });\n                  var _i176 = e.window.ImageBitmap && n instanceof e.window.ImageBitmap && (null == De && (De = e.window.OffscreenCanvas && new e.window.OffscreenCanvas(1, 1).getContext(\"2d\") && \"function\" == typeof e.window.createImageBitmap), De),\n                    _o88 = 1 - (n.width - e.prevPowerOfTwo(n.width)) / 2;\n                  _o88 < 1 || t.neighboringTiles || (t.neighboringTiles = this._getNeighboringTiles(t.tileID));\n                  var _l62 = _i176 ? n : e.exported.getImageData(n, _o88),\n                    _c43 = {\n                      uid: t.uid,\n                      coord: t.tileID,\n                      source: this.id,\n                      rawImageData: _l62,\n                      encoding: this.encoding,\n                      padding: _o88\n                    };\n                  t.actor && \"expired\" !== t.state || (t.actor = this.dispatcher.getActor(), t.actor.send(\"loadDEMTile\", _c43, r.bind(this), void 0, !0));\n                }\n              }.bind(this));\n            }\n          }, {\n            key: \"_getNeighboringTiles\",\n            value: function _getNeighboringTiles(t) {\n              var i = t.canonical,\n                o = Math.pow(2, i.z),\n                r = (i.x - 1 + o) % o,\n                n = 0 === i.x ? t.wrap - 1 : t.wrap,\n                s = (i.x + 1 + o) % o,\n                a = i.x + 1 === o ? t.wrap + 1 : t.wrap,\n                l = {};\n              return l[new e.OverscaledTileID(t.overscaledZ, n, i.z, r, i.y).key] = {\n                backfilled: !1\n              }, l[new e.OverscaledTileID(t.overscaledZ, a, i.z, s, i.y).key] = {\n                backfilled: !1\n              }, i.y > 0 && (l[new e.OverscaledTileID(t.overscaledZ, n, i.z, r, i.y - 1).key] = {\n                backfilled: !1\n              }, l[new e.OverscaledTileID(t.overscaledZ, t.wrap, i.z, i.x, i.y - 1).key] = {\n                backfilled: !1\n              }, l[new e.OverscaledTileID(t.overscaledZ, a, i.z, s, i.y - 1).key] = {\n                backfilled: !1\n              }), i.y + 1 < o && (l[new e.OverscaledTileID(t.overscaledZ, n, i.z, r, i.y + 1).key] = {\n                backfilled: !1\n              }, l[new e.OverscaledTileID(t.overscaledZ, t.wrap, i.z, i.x, i.y + 1).key] = {\n                backfilled: !1\n              }, l[new e.OverscaledTileID(t.overscaledZ, a, i.z, s, i.y + 1).key] = {\n                backfilled: !1\n              }), l;\n            }\n          }, {\n            key: \"unloadTile\",\n            value: function unloadTile(e) {\n              e.demTexture && this.map.painter.saveTileTexture(e.demTexture), e.fbo && (e.fbo.destroy(), delete e.fbo), e.dem && delete e.dem, delete e.neighboringTiles, e.state = \"unloaded\";\n            }\n          }]);\n          return rasterDem;\n        }(Se),\n        geojson: /*#__PURE__*/function (_e$Evented8) {\n          _inherits(geojson, _e$Evented8);\n          function geojson(t, i, o, r) {\n            var _this86;\n            _classCallCheck(this, geojson);\n            _this86 = _possibleConstructorReturn(this, _getPrototypeOf(geojson).call(this)), _this86.id = t, _this86.type = \"geojson\", _this86.minzoom = 0, _this86.maxzoom = 18, _this86.tileSize = 512, _this86.isTileClipped = !0, _this86.reparseOverscaled = !0, _this86._loaded = !1, _this86.actor = o.getActor(), _this86.setEventedParent(r), _this86._data = i.data, _this86._options = e.extend({}, i), _this86._collectResourceTiming = i.collectResourceTiming, void 0 !== i.maxzoom && (_this86.maxzoom = i.maxzoom), i.type && (_this86.type = i.type), i.attribution && (_this86.attribution = i.attribution), _this86.promoteId = i.promoteId;\n            var n = e.EXTENT / _this86.tileSize;\n            _this86.workerOptions = e.extend({\n              source: _this86.id,\n              cluster: i.cluster || !1,\n              geojsonVtOptions: {\n                buffer: (void 0 !== i.buffer ? i.buffer : 128) * n,\n                tolerance: (void 0 !== i.tolerance ? i.tolerance : .375) * n,\n                extent: e.EXTENT,\n                maxZoom: _this86.maxzoom,\n                lineMetrics: i.lineMetrics || !1,\n                generateId: i.generateId || !1\n              },\n              superclusterOptions: {\n                maxZoom: void 0 !== i.clusterMaxZoom ? i.clusterMaxZoom : _this86.maxzoom - 1,\n                minPoints: Math.max(2, i.clusterMinPoints || 2),\n                extent: e.EXTENT,\n                radius: (void 0 !== i.clusterRadius ? i.clusterRadius : 50) * n,\n                log: !1,\n                generateId: i.generateId || !1\n              },\n              clusterProperties: i.clusterProperties,\n              filter: i.filter\n            }, i.workerOptions);\n            return _this86;\n          }\n          _createClass(geojson, [{\n            key: \"onAdd\",\n            value: function onAdd(e) {\n              this.map = e, this.setData(this._data);\n            }\n          }, {\n            key: \"setData\",\n            value: function setData(e) {\n              return this._data = e, this._updateWorkerData(), this;\n            }\n          }, {\n            key: \"getClusterExpansionZoom\",\n            value: function getClusterExpansionZoom(e, t) {\n              return this.actor.send(\"geojson.getClusterExpansionZoom\", {\n                clusterId: e,\n                source: this.id\n              }, t), this;\n            }\n          }, {\n            key: \"getClusterChildren\",\n            value: function getClusterChildren(e, t) {\n              return this.actor.send(\"geojson.getClusterChildren\", {\n                clusterId: e,\n                source: this.id\n              }, t), this;\n            }\n          }, {\n            key: \"getClusterLeaves\",\n            value: function getClusterLeaves(e, t, i, o) {\n              return this.actor.send(\"geojson.getClusterLeaves\", {\n                source: this.id,\n                clusterId: e,\n                limit: t,\n                offset: i\n              }, o), this;\n            }\n          }, {\n            key: \"_updateWorkerData\",\n            value: function _updateWorkerData() {\n              var _this87 = this;\n              if (this._pendingLoad) return void (this._coalesce = !0);\n              this.fire(new e.Event(\"dataloading\", {\n                dataType: \"source\"\n              })), this._loaded = !1;\n              var t = e.extend({}, this.workerOptions),\n                i = this._data;\n              \"string\" == typeof i ? (t.request = this.map._requestManager.transformRequest(e.exported.resolveURL(i), e.ResourceType.Source), t.request.collectResourceTiming = this._collectResourceTiming) : t.data = JSON.stringify(i), this._pendingLoad = this.actor.send(\"\".concat(this.type, \".loadData\"), t, function (t, i) {\n                if (_this87._loaded = !0, _this87._pendingLoad = null, t) _this87.fire(new e.ErrorEvent(t));else {\n                  var _t324 = {\n                    dataType: \"source\",\n                    sourceDataType: _this87._metadataFired ? \"content\" : \"metadata\"\n                  };\n                  _this87._collectResourceTiming && i && i.resourceTiming && i.resourceTiming[_this87.id] && (_t324.resourceTiming = i.resourceTiming[_this87.id]), _this87.fire(new e.Event(\"data\", _t324)), _this87._metadataFired = !0;\n                }\n                _this87._coalesce && (_this87._updateWorkerData(), _this87._coalesce = !1);\n              });\n            }\n          }, {\n            key: \"loaded\",\n            value: function loaded() {\n              return this._loaded;\n            }\n          }, {\n            key: \"loadTile\",\n            value: function loadTile(t, i) {\n              var _this88 = this;\n              var o = t.actor ? \"reloadTile\" : \"loadTile\";\n              t.actor = this.actor, t.request = this.actor.send(o, {\n                type: this.type,\n                uid: t.uid,\n                tileID: t.tileID,\n                tileZoom: t.tileZoom,\n                zoom: t.tileID.overscaledZ,\n                maxZoom: this.maxzoom,\n                tileSize: this.tileSize,\n                source: this.id,\n                pixelRatio: e.exported.devicePixelRatio,\n                showCollisionBoxes: this.map.showCollisionBoxes,\n                promoteId: this.promoteId\n              }, function (e, r) {\n                return delete t.request, t.unloadVectorData(), t.aborted ? i(null) : e ? i(e) : (t.loadVectorData(r, _this88.map.painter, \"reloadTile\" === o), i(null));\n              }, void 0, \"loadTile\" === o);\n            }\n          }, {\n            key: \"abortTile\",\n            value: function abortTile(e) {\n              e.request && (e.request.cancel(), delete e.request), e.aborted = !0;\n            }\n          }, {\n            key: \"unloadTile\",\n            value: function unloadTile(e) {\n              e.unloadVectorData(), this.actor.send(\"removeTile\", {\n                uid: e.uid,\n                type: this.type,\n                source: this.id\n              });\n            }\n          }, {\n            key: \"onRemove\",\n            value: function onRemove() {\n              this._pendingLoad && this._pendingLoad.cancel();\n            }\n          }, {\n            key: \"serialize\",\n            value: function serialize() {\n              return e.extend({}, this._options, {\n                type: this.type,\n                data: this._data\n              });\n            }\n          }, {\n            key: \"hasTransition\",\n            value: function hasTransition() {\n              return !1;\n            }\n          }]);\n          return geojson;\n        }(e.Evented),\n        video: /*#__PURE__*/function (_Ae) {\n          _inherits(video, _Ae);\n          function video(e, t, i, o) {\n            var _this89;\n            _classCallCheck(this, video);\n            _this89 = _possibleConstructorReturn(this, _getPrototypeOf(video).call(this, e, t, i, o)), _this89.roundZoom = !0, _this89.type = \"video\", _this89.options = t;\n            return _this89;\n          }\n          _createClass(video, [{\n            key: \"load\",\n            value: function load() {\n              var _this90 = this;\n              this._loaded = !1;\n              var t = this.options;\n              this.urls = [];\n              var _iterator193 = _createForOfIteratorHelper(t.urls),\n                _step193;\n              try {\n                for (_iterator193.s(); !(_step193 = _iterator193.n()).done;) {\n                  var _i177 = _step193.value;\n                  this.urls.push(this.map._requestManager.transformRequest(_i177, e.ResourceType.Source).url);\n                }\n              } catch (err) {\n                _iterator193.e(err);\n              } finally {\n                _iterator193.f();\n              }\n              e.getVideo(this.urls, function (t, i) {\n                _this90._loaded = !0, t ? _this90.fire(new e.ErrorEvent(t)) : i && (_this90.video = i, _this90.video.loop = !0, _this90.video.setAttribute(\"playsinline\", \"\"), _this90.video.addEventListener(\"playing\", function () {\n                  _this90.map.triggerRepaint();\n                }), _this90.map && _this90.video.play(), _this90._finishLoading());\n              });\n            }\n          }, {\n            key: \"pause\",\n            value: function pause() {\n              this.video && this.video.pause();\n            }\n          }, {\n            key: \"play\",\n            value: function play() {\n              this.video && this.video.play();\n            }\n          }, {\n            key: \"seek\",\n            value: function seek(t) {\n              if (this.video) {\n                var _i178 = this.video.seekable;\n                t < _i178.start(0) || t > _i178.end(0) ? this.fire(new e.ErrorEvent(new e.ValidationError(\"sources.\".concat(this.id), null, \"Playback for this video can be set only between the \".concat(_i178.start(0), \" and \").concat(_i178.end(0), \"-second mark.\")))) : this.video.currentTime = t;\n              }\n            }\n          }, {\n            key: \"getVideo\",\n            value: function getVideo() {\n              return this.video;\n            }\n          }, {\n            key: \"onAdd\",\n            value: function onAdd(e) {\n              this.map || (this.map = e, this.load(), this.video && (this.video.play(), this.setCoordinates(this.coordinates)));\n            }\n          }, {\n            key: \"prepare\",\n            value: function prepare() {\n              if (0 === Object.keys(this.tiles).length || this.video.readyState < 2) return;\n              var t = this.map.painter.context,\n                i = t.gl;\n              this.texture ? this.video.paused || (this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE), i.texSubImage2D(i.TEXTURE_2D, 0, 0, 0, i.RGBA, i.UNSIGNED_BYTE, this.video)) : (this.texture = new e.Texture(t, this.video, i.RGBA), this.texture.bind(i.LINEAR, i.CLAMP_TO_EDGE), this.width = this.video.videoWidth, this.height = this.video.videoHeight), this._prepareData(t);\n            }\n          }, {\n            key: \"serialize\",\n            value: function serialize() {\n              return {\n                type: \"video\",\n                urls: this.urls,\n                coordinates: this.coordinates\n              };\n            }\n          }, {\n            key: \"hasTransition\",\n            value: function hasTransition() {\n              return this.video && !this.video.paused;\n            }\n          }]);\n          return video;\n        }(Ae),\n        image: Ae,\n        canvas: /*#__PURE__*/function (_Ae2) {\n          _inherits(canvas, _Ae2);\n          function canvas(t, i, o, r) {\n            var _this91;\n            _classCallCheck(this, canvas);\n            _this91 = _possibleConstructorReturn(this, _getPrototypeOf(canvas).call(this, t, i, o, r)), i.coordinates ? Array.isArray(i.coordinates) && 4 === i.coordinates.length && !i.coordinates.some(function (e) {\n              return !Array.isArray(e) || 2 !== e.length || e.some(function (e) {\n                return \"number\" != typeof e;\n              });\n            }) || _this91.fire(new e.ErrorEvent(new e.ValidationError(\"sources.\".concat(t), null, '\"coordinates\" property must be an array of 4 longitude/latitude array pairs'))) : _this91.fire(new e.ErrorEvent(new e.ValidationError(\"sources.\".concat(t), null, 'missing required property \"coordinates\"'))), i.animate && \"boolean\" != typeof i.animate && _this91.fire(new e.ErrorEvent(new e.ValidationError(\"sources.\".concat(t), null, 'optional \"animate\" property must be a boolean value'))), i.canvas ? \"string\" == typeof i.canvas || i.canvas instanceof e.window.HTMLCanvasElement || _this91.fire(new e.ErrorEvent(new e.ValidationError(\"sources.\".concat(t), null, '\"canvas\" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))) : _this91.fire(new e.ErrorEvent(new e.ValidationError(\"sources.\".concat(t), null, 'missing required property \"canvas\"'))), _this91.options = i, _this91.animate = void 0 === i.animate || i.animate;\n            return _this91;\n          }\n          _createClass(canvas, [{\n            key: \"load\",\n            value: function load() {\n              this._loaded = !0, this.canvas || (this.canvas = this.options.canvas instanceof e.window.HTMLCanvasElement ? this.options.canvas : e.window.document.getElementById(this.options.canvas)), this.width = this.canvas.width, this.height = this.canvas.height, this._hasInvalidDimensions() ? this.fire(new e.ErrorEvent(new Error(\"Canvas dimensions cannot be less than or equal to zero.\"))) : (this.play = function () {\n                this._playing = !0, this.map.triggerRepaint();\n              }, this.pause = function () {\n                this._playing && (this.prepare(), this._playing = !1);\n              }, this._finishLoading());\n            }\n          }, {\n            key: \"getCanvas\",\n            value: function getCanvas() {\n              return this.canvas;\n            }\n          }, {\n            key: \"onAdd\",\n            value: function onAdd(e) {\n              this.map = e, this.load(), this.canvas && this.animate && this.play();\n            }\n          }, {\n            key: \"onRemove\",\n            value: function onRemove() {\n              this.pause();\n            }\n          }, {\n            key: \"prepare\",\n            value: function prepare() {\n              var t = !1;\n              if (this.canvas.width !== this.width && (this.width = this.canvas.width, t = !0), this.canvas.height !== this.height && (this.height = this.canvas.height, t = !0), this._hasInvalidDimensions()) return;\n              if (0 === Object.keys(this.tiles).length) return;\n              var i = this.map.painter.context;\n              this.texture ? (t || this._playing) && this.texture.update(this.canvas, {\n                premultiply: !0\n              }) : this.texture = new e.Texture(i, this.canvas, i.gl.RGBA, {\n                premultiply: !0\n              }), this._prepareData(i);\n            }\n          }, {\n            key: \"serialize\",\n            value: function serialize() {\n              return {\n                type: \"canvas\",\n                coordinates: this.coordinates\n              };\n            }\n          }, {\n            key: \"hasTransition\",\n            value: function hasTransition() {\n              return this._playing;\n            }\n          }, {\n            key: \"_hasInvalidDimensions\",\n            value: function _hasInvalidDimensions() {\n              for (var _i179 = 0, _arr = [this.canvas.width, this.canvas.height]; _i179 < _arr.length; _i179++) {\n                var _e283 = _arr[_i179];\n                if (isNaN(_e283) || _e283 <= 0) return !0;\n              }\n              return !1;\n            }\n          }]);\n          return canvas;\n        }(Ae),\n        custom: /*#__PURE__*/function (_e$Evented9) {\n          _inherits(custom, _e$Evented9);\n          function custom(t, i, o, r) {\n            var _this92;\n            _classCallCheck(this, custom);\n            _this92 = _possibleConstructorReturn(this, _getPrototypeOf(custom).call(this)), _this92.id = t, _this92.type = \"custom\", _this92._dataType = \"raster\", _this92._dispatcher = o, _this92._implementation = i, _this92.setEventedParent(r), _this92.scheme = \"xyz\", _this92.minzoom = 0, _this92.maxzoom = 22, _this92.tileSize = 512, _this92._loaded = !1, _this92.roundZoom = !0, _this92._implementation || _this92.fire(new e.ErrorEvent(new Error(\"Missing implementation for \".concat(_this92.id, \" custom source\")))), _this92._implementation.loadTile || _this92.fire(new e.ErrorEvent(new Error(\"Missing loadTile implementation for \".concat(_this92.id, \" custom source\")))), _this92._implementation.bounds && (_this92.tileBounds = new U(_this92._implementation.bounds, _this92.minzoom, _this92.maxzoom)), i.update = _this92._update.bind(_assertThisInitialized(_assertThisInitialized(_this92))), i.clearTiles = _this92._clearTiles.bind(_assertThisInitialized(_assertThisInitialized(_this92))), i.coveringTiles = _this92._coveringTiles.bind(_assertThisInitialized(_assertThisInitialized(_this92))), e.extend(_assertThisInitialized(_assertThisInitialized(_this92)), e.pick(i, [\"dataType\", \"scheme\", \"minzoom\", \"maxzoom\", \"tileSize\", \"attribution\", \"minTileCacheSize\", \"maxTileCacheSize\"]));\n            return _this92;\n          }\n          _createClass(custom, [{\n            key: \"serialize\",\n            value: function serialize() {\n              return e.pick(this, [\"type\", \"scheme\", \"minzoom\", \"maxzoom\", \"tileSize\", \"attribution\"]);\n            }\n          }, {\n            key: \"load\",\n            value: function load() {\n              this._loaded = !0, this.fire(new e.Event(\"data\", {\n                dataType: \"source\",\n                sourceDataType: \"metadata\"\n              })), this.fire(new e.Event(\"data\", {\n                dataType: \"source\",\n                sourceDataType: \"content\"\n              }));\n            }\n          }, {\n            key: \"loaded\",\n            value: function loaded() {\n              return this._loaded;\n            }\n          }, {\n            key: \"onAdd\",\n            value: function onAdd(t) {\n              this._map = t, this._loaded = !1, this.fire(new e.Event(\"dataloading\", {\n                dataType: \"source\"\n              })), this._implementation.onAdd && this._implementation.onAdd(t), this.load();\n            }\n          }, {\n            key: \"onRemove\",\n            value: function onRemove(e) {\n              this._implementation.onRemove && this._implementation.onRemove(e);\n            }\n          }, {\n            key: \"hasTile\",\n            value: function hasTile(e) {\n              if (this._implementation.hasTile) {\n                var _e$canonical = e.canonical,\n                  _t325 = _e$canonical.x,\n                  _i180 = _e$canonical.y,\n                  _o89 = _e$canonical.z;\n                return this._implementation.hasTile({\n                  x: _t325,\n                  y: _i180,\n                  z: _o89\n                });\n              }\n              return !this.tileBounds || this.tileBounds.contains(e.canonical);\n            }\n          }, {\n            key: \"loadTile\",\n            value: function loadTile(t, i) {\n              var _t$tileID$canonical = t.tileID.canonical,\n                o = _t$tileID$canonical.x,\n                r = _t$tileID$canonical.y,\n                n = _t$tileID$canonical.z,\n                s = new e.window.AbortController();\n              t.request = Promise.resolve(this._implementation.loadTile({\n                x: o,\n                y: r,\n                z: n\n              }, {\n                signal: s.signal\n              })).then(function (o) {\n                return delete t.request, t.aborted ? (t.state = \"unloaded\", i(null)) : void 0 === o ? (t.state = \"errored\", i(null)) : null === o ? (this.loadTileData(t, {\n                  width: this.tileSize,\n                  height: this.tileSize,\n                  data: null\n                }), t.state = \"loaded\", i(null)) : function (t) {\n                  return t instanceof e.window.ImageData || t instanceof e.window.HTMLCanvasElement || t instanceof e.window.ImageBitmap || t instanceof e.window.HTMLImageElement;\n                }(o) ? (this.loadTileData(t, o), t.state = \"loaded\", void i(null)) : (t.state = \"errored\", i(new Error(\"Can't infer data type for \".concat(this.id, \", only raster data supported at the moment\"))));\n              }.bind(this)).catch(function (e) {\n                20 !== e.code && (t.state = \"errored\", i(e));\n              }), t.request.cancel = function () {\n                return s.abort();\n              };\n            }\n          }, {\n            key: \"loadTileData\",\n            value: function loadTileData(e, t) {\n              Se.loadTileData(e, t, this._map.painter);\n            }\n          }, {\n            key: \"unloadTileData\",\n            value: function unloadTileData(e) {\n              Se.unloadTileData(e, this._map.painter);\n            }\n          }, {\n            key: \"unloadTile\",\n            value: function unloadTile(e, t) {\n              if (this.unloadTileData(e), this._implementation.unloadTile) {\n                var _e$tileID$canonical = e.tileID.canonical,\n                  _t326 = _e$tileID$canonical.x,\n                  _i181 = _e$tileID$canonical.y,\n                  _o90 = _e$tileID$canonical.z;\n                this._implementation.unloadTile({\n                  x: _t326,\n                  y: _i181,\n                  z: _o90\n                });\n              }\n              t();\n            }\n          }, {\n            key: \"abortTile\",\n            value: function abortTile(e, t) {\n              e.request && e.request.cancel && (e.request.cancel(), delete e.request), t();\n            }\n          }, {\n            key: \"hasTransition\",\n            value: function hasTransition() {\n              return !1;\n            }\n          }, {\n            key: \"_coveringTiles\",\n            value: function _coveringTiles() {\n              return this._map.transform.coveringTiles({\n                tileSize: this.tileSize,\n                minzoom: this.minzoom,\n                maxzoom: this.maxzoom,\n                roundZoom: this.roundZoom\n              }).map(function (e) {\n                return {\n                  x: e.canonical.x,\n                  y: e.canonical.y,\n                  z: e.canonical.z\n                };\n              });\n            }\n          }, {\n            key: \"_clearTiles\",\n            value: function _clearTiles() {\n              this._map.style._clearSource(this.id);\n            }\n          }, {\n            key: \"_update\",\n            value: function _update() {\n              this.fire(new e.Event(\"data\", {\n                dataType: \"source\",\n                sourceDataType: \"content\"\n              }));\n            }\n          }]);\n          return custom;\n        }(e.Evented)\n      },\n      Pe = function Pe(t, i, o, r) {\n        var n = new ze[i.type](t, i, o, r);\n        if (n.id !== t) throw new Error(\"Expected Source id to be \".concat(t, \" instead of \").concat(n.id));\n        return e.bindAll([\"load\", \"abort\", \"unload\", \"serialize\", \"prepare\"], n), n;\n      };\n    function Re(t, i) {\n      var o = e.identity([]);\n      return e.scale(o, o, [.5 * t.width, .5 * -t.height, 1]), e.translate(o, o, [1, -1, 0]), e.multiply(o, o, t.calculateProjMatrix(i.toUnwrapped())), Float32Array.from(o);\n    }\n    function Oe(e, t, i, o, r, n, s) {\n      var a = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : !1;\n      var l = e.tilesIn(o, s, a);\n      l.sort(ke);\n      var c = [];\n      var _iterator194 = _createForOfIteratorHelper(l),\n        _step194;\n      try {\n        for (_iterator194.s(); !(_step194 = _iterator194.n()).done;) {\n          var _o93 = _step194.value;\n          c.push({\n            wrappedTileID: _o93.tile.tileID.wrapped().key,\n            queryResults: _o93.tile.queryRenderedFeatures(t, i, e._state, _o93, r, n, Re(e.transform, _o93.tile.tileID), a)\n          });\n        }\n      } catch (err) {\n        _iterator194.e(err);\n      } finally {\n        _iterator194.f();\n      }\n      var h = function (e) {\n        var t = {},\n          i = {};\n        var _iterator195 = _createForOfIteratorHelper(e),\n          _step195;\n        try {\n          for (_iterator195.s(); !(_step195 = _iterator195.n()).done;) {\n            var _o91 = _step195.value;\n            var _e284 = _o91.queryResults,\n              _r227 = _o91.wrappedTileID,\n              _n164 = i[_r227] = i[_r227] || {};\n            for (var _i182 in _e284) {\n              var _o92 = _e284[_i182],\n                _r228 = _n164[_i182] = _n164[_i182] || {},\n                _s125 = t[_i182] = t[_i182] || [];\n              var _iterator196 = _createForOfIteratorHelper(_o92),\n                _step196;\n              try {\n                for (_iterator196.s(); !(_step196 = _iterator196.n()).done;) {\n                  var _e285 = _step196.value;\n                  _r228[_e285.featureIndex] || (_r228[_e285.featureIndex] = !0, _s125.push(_e285));\n                }\n              } catch (err) {\n                _iterator196.e(err);\n              } finally {\n                _iterator196.f();\n              }\n            }\n          }\n        } catch (err) {\n          _iterator195.e(err);\n        } finally {\n          _iterator195.f();\n        }\n        return t;\n      }(c);\n      for (var _t327 in h) h[_t327].forEach(function (t) {\n        var i = t.feature,\n          o = i.layer;\n        o && \"background\" !== o.type && \"sky\" !== o.type && (i.source = o.source, o[\"source-layer\"] && (i.sourceLayer = o[\"source-layer\"]), i.state = void 0 !== i.id ? e.getFeatureState(o[\"source-layer\"], i.id) : {});\n      });\n      return h;\n    }\n    function Be(e, t) {\n      var i = e.getRenderableIds().map(function (t) {\n          return e.getTileByID(t);\n        }),\n        o = [],\n        r = {};\n      for (var _e286 = 0; _e286 < i.length; _e286++) {\n        var _n165 = i[_e286],\n          _s126 = _n165.tileID.canonical.key;\n        r[_s126] || (r[_s126] = !0, _n165.querySourceFeatures(o, t));\n      }\n      return o;\n    }\n    function ke(e, t) {\n      var i = e.tileID,\n        o = t.tileID;\n      return i.overscaledZ - o.overscaledZ || i.canonical.y - o.canonical.y || i.wrap - o.wrap || i.canonical.x - o.canonical.x;\n    }\n    function Fe() {\n      return null != fn.workerClass ? new fn.workerClass() : new e.window.Worker(fn.workerUrl);\n    }\n    var Ue = \"mapboxgl_preloaded_worker_pool\";\n    var Ne = /*#__PURE__*/function () {\n      function Ne() {\n        _classCallCheck(this, Ne);\n        this.active = {};\n      }\n      _createClass(Ne, [{\n        key: \"acquire\",\n        value: function acquire(e) {\n          if (!this.workers) for (this.workers = []; this.workers.length < Ne.workerCount;) this.workers.push(new Fe());\n          return this.active[e] = !0, this.workers.slice();\n        }\n      }, {\n        key: \"release\",\n        value: function release(e) {\n          delete this.active[e], 0 === this.numActive() && (this.workers.forEach(function (e) {\n            e.terminate();\n          }), this.workers = null);\n        }\n      }, {\n        key: \"isPreloaded\",\n        value: function isPreloaded() {\n          return !!this.active[Ue];\n        }\n      }, {\n        key: \"numActive\",\n        value: function numActive() {\n          return Object.keys(this.active).length;\n        }\n      }]);\n      return Ne;\n    }();\n    var Ge;\n    function je() {\n      return Ge || (Ge = new Ne()), Ge;\n    }\n    function Ze(t, i) {\n      var o = {};\n      for (var _e287 in t) \"ref\" !== _e287 && (o[_e287] = t[_e287]);\n      return e.refProperties.forEach(function (e) {\n        e in i && (o[e] = i[e]);\n      }), o;\n    }\n    function Ve(e) {\n      e = e.slice();\n      var t = Object.create(null);\n      for (var _i183 = 0; _i183 < e.length; _i183++) t[e[_i183].id] = e[_i183];\n      for (var _i184 = 0; _i184 < e.length; _i184++) \"ref\" in e[_i184] && (e[_i184] = Ze(e[_i184], t[e[_i184].ref]));\n      return e;\n    }\n    Ne.workerCount = 2;\n    var We = {\n      setStyle: \"setStyle\",\n      addLayer: \"addLayer\",\n      removeLayer: \"removeLayer\",\n      setPaintProperty: \"setPaintProperty\",\n      setLayoutProperty: \"setLayoutProperty\",\n      setFilter: \"setFilter\",\n      addSource: \"addSource\",\n      removeSource: \"removeSource\",\n      setGeoJSONSourceData: \"setGeoJSONSourceData\",\n      setLayerZoomRange: \"setLayerZoomRange\",\n      setLayerProperty: \"setLayerProperty\",\n      setCenter: \"setCenter\",\n      setZoom: \"setZoom\",\n      setBearing: \"setBearing\",\n      setPitch: \"setPitch\",\n      setSprite: \"setSprite\",\n      setGlyphs: \"setGlyphs\",\n      setTransition: \"setTransition\",\n      setLight: \"setLight\",\n      setTerrain: \"setTerrain\",\n      setFog: \"setFog\",\n      setProjection: \"setProjection\"\n    };\n    function Xe(e, t, i) {\n      i.push({\n        command: We.addSource,\n        args: [e, t[e]]\n      });\n    }\n    function qe(e, t, i) {\n      t.push({\n        command: We.removeSource,\n        args: [e]\n      }), i[e] = !0;\n    }\n    function $e(e, t, i, o) {\n      qe(e, i, o), Xe(e, t, i);\n    }\n    function He(e, i, o) {\n      var r;\n      for (r in e[o]) if (e[o].hasOwnProperty(r) && \"data\" !== r && !t(e[o][r], i[o][r])) return !1;\n      for (r in i[o]) if (i[o].hasOwnProperty(r) && \"data\" !== r && !t(e[o][r], i[o][r])) return !1;\n      return !0;\n    }\n    function Ye(e, i, o, r, n, s) {\n      var a;\n      for (a in i = i || {}, e = e || {}) e.hasOwnProperty(a) && (t(e[a], i[a]) || o.push({\n        command: s,\n        args: [r, a, i[a], n]\n      }));\n      for (a in i) i.hasOwnProperty(a) && !e.hasOwnProperty(a) && (t(e[a], i[a]) || o.push({\n        command: s,\n        args: [r, a, i[a], n]\n      }));\n    }\n    function Ke(e) {\n      return e.id;\n    }\n    function Je(e, t) {\n      return e[t.id] = t, e;\n    }\n    var Qe = /*#__PURE__*/function () {\n      function Qe(e, t) {\n        _classCallCheck(this, Qe);\n        this.reset(e, t);\n      }\n      _createClass(Qe, [{\n        key: \"reset\",\n        value: function reset(e, t) {\n          this.points = e || [], this._distances = [0];\n          for (var _e288 = 1; _e288 < this.points.length; _e288++) this._distances[_e288] = this._distances[_e288 - 1] + this.points[_e288].dist(this.points[_e288 - 1]);\n          this.length = this._distances[this._distances.length - 1], this.padding = Math.min(t || 0, .5 * this.length), this.paddedLength = this.length - 2 * this.padding;\n        }\n      }, {\n        key: \"lerp\",\n        value: function lerp(t) {\n          if (1 === this.points.length) return this.points[0];\n          t = e.clamp(t, 0, 1);\n          var i = 1,\n            o = this._distances[i];\n          var r = t * this.paddedLength + this.padding;\n          for (; o < r && i < this._distances.length;) o = this._distances[++i];\n          var n = i - 1,\n            s = this._distances[n],\n            a = o - s,\n            l = a > 0 ? (r - s) / a : 0;\n          return this.points[n].mult(1 - l).add(this.points[i].mult(l));\n        }\n      }]);\n      return Qe;\n    }();\n    var et = /*#__PURE__*/function () {\n      function et(e, t, i) {\n        _classCallCheck(this, et);\n        var o = this.boxCells = [],\n          r = this.circleCells = [];\n        this.xCellCount = Math.ceil(e / i), this.yCellCount = Math.ceil(t / i);\n        for (var _e289 = 0; _e289 < this.xCellCount * this.yCellCount; _e289++) o.push([]), r.push([]);\n        this.circleKeys = [], this.boxKeys = [], this.bboxes = [], this.circles = [], this.width = e, this.height = t, this.xScale = this.xCellCount / e, this.yScale = this.yCellCount / t, this.boxUid = 0, this.circleUid = 0;\n      }\n      _createClass(et, [{\n        key: \"keysLength\",\n        value: function keysLength() {\n          return this.boxKeys.length + this.circleKeys.length;\n        }\n      }, {\n        key: \"insert\",\n        value: function insert(e, t, i, o, r) {\n          this._forEachCell(t, i, o, r, this._insertBoxCell, this.boxUid++), this.boxKeys.push(e), this.bboxes.push(t), this.bboxes.push(i), this.bboxes.push(o), this.bboxes.push(r);\n        }\n      }, {\n        key: \"insertCircle\",\n        value: function insertCircle(e, t, i, o) {\n          this._forEachCell(t - o, i - o, t + o, i + o, this._insertCircleCell, this.circleUid++), this.circleKeys.push(e), this.circles.push(t), this.circles.push(i), this.circles.push(o);\n        }\n      }, {\n        key: \"_insertBoxCell\",\n        value: function _insertBoxCell(e, t, i, o, r, n) {\n          this.boxCells[r].push(n);\n        }\n      }, {\n        key: \"_insertCircleCell\",\n        value: function _insertCircleCell(e, t, i, o, r, n) {\n          this.circleCells[r].push(n);\n        }\n      }, {\n        key: \"_query\",\n        value: function _query(e, t, i, o, r, n) {\n          if (i < 0 || e > this.width || o < 0 || t > this.height) return !r && [];\n          var s = [];\n          if (e <= 0 && t <= 0 && this.width <= i && this.height <= o) {\n            if (r) return !0;\n            for (var _e290 = 0; _e290 < this.boxKeys.length; _e290++) s.push({\n              key: this.boxKeys[_e290],\n              x1: this.bboxes[4 * _e290],\n              y1: this.bboxes[4 * _e290 + 1],\n              x2: this.bboxes[4 * _e290 + 2],\n              y2: this.bboxes[4 * _e290 + 3]\n            });\n            for (var _e291 = 0; _e291 < this.circleKeys.length; _e291++) {\n              var _t328 = this.circles[3 * _e291],\n                _i185 = this.circles[3 * _e291 + 1],\n                _o94 = this.circles[3 * _e291 + 2];\n              s.push({\n                key: this.circleKeys[_e291],\n                x1: _t328 - _o94,\n                y1: _i185 - _o94,\n                x2: _t328 + _o94,\n                y2: _i185 + _o94\n              });\n            }\n            return n ? s.filter(n) : s;\n          }\n          return this._forEachCell(e, t, i, o, this._queryCell, s, {\n            hitTest: r,\n            seenUids: {\n              box: {},\n              circle: {}\n            }\n          }, n), r ? s.length > 0 : s;\n        }\n      }, {\n        key: \"_queryCircle\",\n        value: function _queryCircle(e, t, i, o, r) {\n          var n = e - i,\n            s = e + i,\n            a = t - i,\n            l = t + i;\n          if (s < 0 || n > this.width || l < 0 || a > this.height) return !o && [];\n          var c = [];\n          return this._forEachCell(n, a, s, l, this._queryCellCircle, c, {\n            hitTest: o,\n            circle: {\n              x: e,\n              y: t,\n              radius: i\n            },\n            seenUids: {\n              box: {},\n              circle: {}\n            }\n          }, r), o ? c.length > 0 : c;\n        }\n      }, {\n        key: \"query\",\n        value: function query(e, t, i, o, r) {\n          return this._query(e, t, i, o, !1, r);\n        }\n      }, {\n        key: \"hitTest\",\n        value: function hitTest(e, t, i, o, r) {\n          return this._query(e, t, i, o, !0, r);\n        }\n      }, {\n        key: \"hitTestCircle\",\n        value: function hitTestCircle(e, t, i, o) {\n          return this._queryCircle(e, t, i, !0, o);\n        }\n      }, {\n        key: \"_queryCell\",\n        value: function _queryCell(e, t, i, o, r, n, s, a) {\n          var l = s.seenUids,\n            c = this.boxCells[r];\n          if (null !== c) {\n            var _r229 = this.bboxes;\n            var _iterator197 = _createForOfIteratorHelper(c),\n              _step197;\n            try {\n              for (_iterator197.s(); !(_step197 = _iterator197.n()).done;) {\n                var _h36 = _step197.value;\n                if (!l.box[_h36]) {\n                  l.box[_h36] = !0;\n                  var _c44 = 4 * _h36;\n                  if (e <= _r229[_c44 + 2] && t <= _r229[_c44 + 3] && i >= _r229[_c44 + 0] && o >= _r229[_c44 + 1] && (!a || a(this.boxKeys[_h36]))) {\n                    if (s.hitTest) return n.push(!0), !0;\n                    n.push({\n                      key: this.boxKeys[_h36],\n                      x1: _r229[_c44],\n                      y1: _r229[_c44 + 1],\n                      x2: _r229[_c44 + 2],\n                      y2: _r229[_c44 + 3]\n                    });\n                  }\n                }\n              }\n            } catch (err) {\n              _iterator197.e(err);\n            } finally {\n              _iterator197.f();\n            }\n          }\n          var h = this.circleCells[r];\n          if (null !== h) {\n            var _r230 = this.circles;\n            var _iterator198 = _createForOfIteratorHelper(h),\n              _step198;\n            try {\n              for (_iterator198.s(); !(_step198 = _iterator198.n()).done;) {\n                var _c45 = _step198.value;\n                if (!l.circle[_c45]) {\n                  l.circle[_c45] = !0;\n                  var _h37 = 3 * _c45;\n                  if (this._circleAndRectCollide(_r230[_h37], _r230[_h37 + 1], _r230[_h37 + 2], e, t, i, o) && (!a || a(this.circleKeys[_c45]))) {\n                    if (s.hitTest) return n.push(!0), !0;\n                    {\n                      var _e292 = _r230[_h37],\n                        _t329 = _r230[_h37 + 1],\n                        _i186 = _r230[_h37 + 2];\n                      n.push({\n                        key: this.circleKeys[_c45],\n                        x1: _e292 - _i186,\n                        y1: _t329 - _i186,\n                        x2: _e292 + _i186,\n                        y2: _t329 + _i186\n                      });\n                    }\n                  }\n                }\n              }\n            } catch (err) {\n              _iterator198.e(err);\n            } finally {\n              _iterator198.f();\n            }\n          }\n        }\n      }, {\n        key: \"_queryCellCircle\",\n        value: function _queryCellCircle(e, t, i, o, r, n, s, a) {\n          var l = s.circle,\n            c = s.seenUids,\n            h = this.boxCells[r];\n          if (null !== h) {\n            var _e293 = this.bboxes;\n            var _iterator199 = _createForOfIteratorHelper(h),\n              _step199;\n            try {\n              for (_iterator199.s(); !(_step199 = _iterator199.n()).done;) {\n                var _t330 = _step199.value;\n                if (!c.box[_t330]) {\n                  c.box[_t330] = !0;\n                  var _i187 = 4 * _t330;\n                  if (this._circleAndRectCollide(l.x, l.y, l.radius, _e293[_i187 + 0], _e293[_i187 + 1], _e293[_i187 + 2], _e293[_i187 + 3]) && (!a || a(this.boxKeys[_t330]))) return n.push(!0), !0;\n                }\n              }\n            } catch (err) {\n              _iterator199.e(err);\n            } finally {\n              _iterator199.f();\n            }\n          }\n          var u = this.circleCells[r];\n          if (null !== u) {\n            var _e294 = this.circles;\n            var _iterator200 = _createForOfIteratorHelper(u),\n              _step200;\n            try {\n              for (_iterator200.s(); !(_step200 = _iterator200.n()).done;) {\n                var _t331 = _step200.value;\n                if (!c.circle[_t331]) {\n                  c.circle[_t331] = !0;\n                  var _i188 = 3 * _t331;\n                  if (this._circlesCollide(_e294[_i188], _e294[_i188 + 1], _e294[_i188 + 2], l.x, l.y, l.radius) && (!a || a(this.circleKeys[_t331]))) return n.push(!0), !0;\n                }\n              }\n            } catch (err) {\n              _iterator200.e(err);\n            } finally {\n              _iterator200.f();\n            }\n          }\n        }\n      }, {\n        key: \"_forEachCell\",\n        value: function _forEachCell(e, t, i, o, r, n, s, a) {\n          var l = this._convertToXCellCoord(e),\n            c = this._convertToYCellCoord(t),\n            h = this._convertToXCellCoord(i),\n            u = this._convertToYCellCoord(o);\n          for (var _12 = l; _12 <= h; _12++) for (var _l63 = c; _l63 <= u; _l63++) if (r.call(this, e, t, i, o, this.xCellCount * _l63 + _12, n, s, a)) return;\n        }\n      }, {\n        key: \"_convertToXCellCoord\",\n        value: function _convertToXCellCoord(e) {\n          return Math.max(0, Math.min(this.xCellCount - 1, Math.floor(e * this.xScale)));\n        }\n      }, {\n        key: \"_convertToYCellCoord\",\n        value: function _convertToYCellCoord(e) {\n          return Math.max(0, Math.min(this.yCellCount - 1, Math.floor(e * this.yScale)));\n        }\n      }, {\n        key: \"_circlesCollide\",\n        value: function _circlesCollide(e, t, i, o, r, n) {\n          var s = o - e,\n            a = r - t,\n            l = i + n;\n          return l * l > s * s + a * a;\n        }\n      }, {\n        key: \"_circleAndRectCollide\",\n        value: function _circleAndRectCollide(e, t, i, o, r, n, s) {\n          var a = (n - o) / 2,\n            l = Math.abs(e - (o + a));\n          if (l > a + i) return !1;\n          var c = (s - r) / 2,\n            h = Math.abs(t - (r + c));\n          if (h > c + i) return !1;\n          if (l <= a || h <= c) return !0;\n          var u = l - a,\n            _ = h - c;\n          return u * u + _ * _ <= i * i;\n        }\n      }]);\n      return et;\n    }();\n    var tt = Math.tan(85 * Math.PI / 180);\n    function it(t, i, o, r, n, s, a) {\n      var l = e.create();\n      if (o) {\n        if (\"globe\" === s.name) {\n          var _t332 = e.calculateGlobeLabelMatrix(n, i);\n          e.multiply(l, l, _t332);\n        } else {\n          var _t333 = v([], a);\n          l[0] = _t333[0], l[1] = _t333[1], l[4] = _t333[2], l[5] = _t333[3], r || e.rotateZ(l, l, n.angle);\n        }\n      } else e.multiply(l, n.labelPlaneMatrix, t);\n      return l;\n    }\n    function ot(e, t, i, o, r, n, s) {\n      var a = it(e, t, i, o, r, n, s);\n      return \"globe\" === n.name && i || (a[2] = a[6] = a[10] = a[14] = 0), a;\n    }\n    function rt(t, i, o, r, n, s, a) {\n      if (o) {\n        if (\"globe\" === s.name) {\n          var _l64 = it(t, i, o, r, n, s, a);\n          return e.invert(_l64, _l64), e.multiply(_l64, t, _l64), _l64;\n        }\n        {\n          var _i189 = e.clone(t),\n            _o95 = e.identity([]);\n          return _o95[0] = a[0], _o95[1] = a[1], _o95[4] = a[2], _o95[5] = a[3], e.multiply(_i189, _i189, _o95), r || e.rotateZ(_i189, _i189, -n.angle), _i189;\n        }\n      }\n      return n.glCoordMatrix;\n    }\n    function nt(t, i, o, r) {\n      var n = [t, i, o, 1];\n      o ? e.transformMat4$1(n, n, r) : ft(n, n, r);\n      var s = n[3];\n      return n[0] /= s, n[1] /= s, n[2] /= s, n;\n    }\n    function st(e, t) {\n      return Math.min(.5 + e / t * .5, 1.5);\n    }\n    function at(e, t) {\n      var i = e[0] / e[3],\n        o = e[1] / e[3];\n      return i >= -t[0] && i <= t[0] && o >= -t[1] && o <= t[1];\n    }\n    function lt(t, i, o, r, n, s, a, l, c, h) {\n      var u = o.transform,\n        _ = r ? t.textSizeData : t.iconSizeData,\n        d = e.evaluateSizeForZoom(_, o.transform.zoom),\n        p = \"globe\" === u.projection.name,\n        m = [256 / o.width * 2 + 1, 256 / o.height * 2 + 1],\n        f = r ? t.text.dynamicLayoutVertexArray : t.icon.dynamicLayoutVertexArray;\n      f.clear();\n      var g = null;\n      p && (g = r ? t.text.globeExtVertexArray : t.icon.globeExtVertexArray);\n      var v = t.lineVertexArray,\n        x = r ? t.text.placedSymbolArray : t.icon.placedSymbolArray,\n        y = o.transform.width / o.transform.height;\n      var b,\n        w = !1;\n      for (var _r231 = 0; _r231 < x.length; _r231++) {\n        var _p33 = x.get(_r231),\n          _T4 = _p33.numGlyphs,\n          _E2 = _p33.writingMode;\n        if (_E2 !== e.WritingMode.vertical || w || b === e.WritingMode.horizontal || (w = !0), b = _E2, (_p33.hidden || _E2 === e.WritingMode.vertical) && !w) {\n          mt(_T4, f);\n          continue;\n        }\n        w = !1;\n        var _C = new e.pointGeometry(_p33.tileAnchorX, _p33.tileAnchorY);\n        var _u$projection$project = u.projection.projectTilePoint(_C.x, _C.y, h.canonical),\n          _M5 = _u$projection$project.x,\n          _I6 = _u$projection$project.y,\n          _S11 = _u$projection$project.z;\n        if (c) {\n          var _c46 = c(_C),\n            _c47 = _slicedToArray(_c46, 3),\n            _e295 = _c47[0],\n            _t334 = _c47[1],\n            _i190 = _c47[2];\n          _M5 += _e295, _I6 += _t334, _S11 += _i190;\n        }\n        var _D = [_M5, _I6, _S11, 1];\n        if (e.transformMat4$1(_D, _D, i), !at(_D, m)) {\n          mt(_T4, f);\n          continue;\n        }\n        var _L = st(o.transform.cameraToCenterDistance, _D[3]),\n          _A10 = e.evaluateSizeForFeature(_, d, _p33),\n          _z2 = a ? _A10 / _L : _A10 * _L,\n          _P = nt(_M5, _I6, _S11, n);\n        if (_P[3] <= 0) {\n          mt(_T4, f);\n          continue;\n        }\n        var _R = {};\n        var _O = a ? null : c,\n          _B2 = ut(_p33, _z2, !1, l, i, n, s, t.glyphOffsetArray, v, f, g, _P, _C, _R, y, _O, u.projection, h, a);\n        w = _B2.useVertical, _O && _B2.needsFlipping && (_R = {}), (_B2.notEnoughRoom || w || _B2.needsFlipping && ut(_p33, _z2, !0, l, i, n, s, t.glyphOffsetArray, v, f, g, _P, _C, _R, y, _O, u.projection, h, a).notEnoughRoom) && mt(_T4, f);\n      }\n      r ? (t.text.dynamicLayoutVertexBuffer.updateData(f), g && t.text.globeExtVertexBuffer.updateData(g)) : (t.icon.dynamicLayoutVertexBuffer.updateData(f), g && t.icon.globeExtVertexBuffer.updateData(g));\n    }\n    function ct(e, t, i, o, r, n, s, a, l, c, h, u, _, d, p, m) {\n      var f = a.lineStartIndex,\n        g = a.glyphStartIndex,\n        v = a.segment,\n        x = g + a.numGlyphs,\n        y = f + a.lineLength,\n        b = t.getoffsetX(g),\n        w = t.getoffsetX(x - 1),\n        T = pt(e * b, i, o, r, n, s, v, f, y, l, c, h, u, _, !0, d, p, m);\n      if (!T) return null;\n      var E = pt(e * w, i, o, r, n, s, v, f, y, l, c, h, u, _, !0, d, p, m);\n      return E ? {\n        first: T,\n        last: E\n      } : null;\n    }\n    function ht(t, i, o, r) {\n      return t === e.WritingMode.horizontal && Math.abs(r) > Math.abs(o) ? {\n        useVertical: !0\n      } : t === e.WritingMode.vertical ? r > 0 ? {\n        needsFlipping: !0\n      } : null : 0 !== i && function (e, t) {\n        return 0 === e || Math.abs(t / e) > tt;\n      }(o, r) ? 1 === i ? {\n        needsFlipping: !0\n      } : null : o < 0 ? {\n        needsFlipping: !0\n      } : null;\n    }\n    function ut(t, i, o, r, n, s, a, l, c, h, u, _, d, p, m, f, g, v, x) {\n      var y = i / 24,\n        b = t.lineOffsetX * y,\n        w = t.lineOffsetY * y,\n        T = t.lineStartIndex,\n        E = t.glyphStartIndex,\n        C = t.numGlyphs,\n        M = t.segment,\n        I = t.writingMode,\n        S = t.flipState,\n        D = T + t.lineLength,\n        L = function L(t) {\n          if (u) {\n            var _t$up = _slicedToArray(t.up, 3),\n              _i191 = _t$up[0],\n              _o96 = _t$up[1],\n              _r232 = _t$up[2],\n              _n166 = h.length;\n            e.updateGlobeVertexNormal(u, _n166 + 0, _i191, _o96, _r232), e.updateGlobeVertexNormal(u, _n166 + 1, _i191, _o96, _r232), e.updateGlobeVertexNormal(u, _n166 + 2, _i191, _o96, _r232), e.updateGlobeVertexNormal(u, _n166 + 3, _i191, _o96, _r232);\n          }\n          var _t$point3 = _slicedToArray(t.point, 3),\n            i = _t$point3[0],\n            o = _t$point3[1],\n            r = _t$point3[2];\n          e.addDynamicAttributes(h, i, o, r, t.angle);\n        };\n      if (C > 1) {\n        var _e296 = ct(y, l, b, w, o, _, d, t, c, s, p, f, !1, g, v, x);\n        if (!_e296) return {\n          notEnoughRoom: !0\n        };\n        if (r && !o) {\n          var _nt, _nt2, _nt3, _nt4;\n          var _e296$first$point = _slicedToArray(_e296.first.point, 3),\n            _i192 = _e296$first$point[0],\n            _o97 = _e296$first$point[1],\n            _r233 = _e296$first$point[2],\n            _e296$last$point = _slicedToArray(_e296.last.point, 3),\n            _n167 = _e296$last$point[0],\n            _s127 = _e296$last$point[1],\n            _l65 = _e296$last$point[2];\n          (_nt = nt(_i192, _o97, _r233, a), _nt2 = _slicedToArray(_nt, 2), _i192 = _nt2[0], _o97 = _nt2[1], _nt), (_nt3 = nt(_n167, _s127, _l65, a), _nt4 = _slicedToArray(_nt3, 2), _n167 = _nt4[0], _s127 = _nt4[1], _nt3);\n          var _c48 = ht(I, S, (_n167 - _i192) * m, _s127 - _o97);\n          if (t.flipState = _c48 && _c48.needsFlipping ? 1 : 2, _c48) return _c48;\n        }\n        L(_e296.first);\n        for (var _e297 = E + 1; _e297 < E + C - 1; _e297++) {\n          var _t335 = pt(y * l.getoffsetX(_e297), b, w, o, _, d, M, T, D, c, s, p, f, !1, !1, g, v, x);\n          if (!_t335) return h.length -= 4 * (_e297 - E), {\n            notEnoughRoom: !0\n          };\n          L(_t335);\n        }\n        L(_e296.last);\n      } else {\n        if (r && !o) {\n          var _i193 = nt(d.x, d.y, 0, n),\n            _o98 = T + M + 1,\n            _r234 = new e.pointGeometry(c.getx(_o98), c.gety(_o98)),\n            _s128 = nt(_r234.x, _r234.y, 0, n),\n            _a110 = _s128[3] > 0 ? _s128 : dt(d, _r234, _i193, 1, n, void 0, g, v.canonical),\n            _l66 = ht(I, S, (_a110[0] - _i193[0]) * m, _a110[1] - _i193[1]);\n          if (t.flipState = _l66 && _l66.needsFlipping ? 1 : 2, _l66) return _l66;\n        }\n        var _i194 = pt(y * l.getoffsetX(E), b, w, o, _, d, M, T, D, c, s, p, f, !1, !1, g, v, x);\n        if (!_i194) return {\n          notEnoughRoom: !0\n        };\n        L(_i194);\n      }\n      return {};\n    }\n    function _t(e, t, i, o, r) {\n      var _o$projectTilePoint = o.projectTilePoint(e.x, e.y, t),\n        n = _o$projectTilePoint.x,\n        s = _o$projectTilePoint.y,\n        a = _o$projectTilePoint.z;\n      if (!r) return nt(n, s, a, i);\n      var _r235 = r(e),\n        _r236 = _slicedToArray(_r235, 3),\n        l = _r236[0],\n        c = _r236[1],\n        h = _r236[2];\n      return nt(n + l, s + c, a + h, i);\n    }\n    function dt(t, i, o, r, n, s, a, l) {\n      var c = _t(t.sub(i)._unit()._add(t), l, n, a, s);\n      return e.sub(c, o, c), e.normalize(c, c), e.scaleAndAdd(c, o, c, r);\n    }\n    function pt(t, i, o, r, n, s, a, l, c, h, u, _, d, p, m, f, g, v) {\n      var x = r ? t - i : t + i;\n      var y = x > 0 ? 1 : -1,\n        b = 0;\n      r && (y *= -1, b = Math.PI), y < 0 && (b += Math.PI);\n      var w = l + a + (y > 0 ? 0 : 1) | 0,\n        T = n,\n        E = n,\n        C = 0,\n        M = 0;\n      var I = Math.abs(x),\n        S = [],\n        D = [];\n      var L = s,\n        A = L;\n      var z = function z() {\n        return dt(A, L, E, I - C + 1, u, d, f, g.canonical);\n      };\n      for (; C + M <= I;) {\n        if (w += y, w < l || w >= c) return null;\n        if (E = T, A = L, S.push(E), p && D.push(A), L = new e.pointGeometry(h.getx(w), h.gety(w)), T = _[w], !T) {\n          var _e298 = _t(L, g.canonical, u, f, d);\n          T = _e298[3] > 0 ? _[w] = _e298 : z();\n        }\n        C += M, M = e.distance(E, T);\n      }\n      m && d && (_[w] && (T = z(), M = e.distance(E, T)), _[w] = T);\n      var P = (I - C) / M,\n        R = L.sub(A)._mult(P)._add(A),\n        O = e.sub([], T, E),\n        B = e.scaleAndAdd([], E, O, P);\n      var k = [0, 0, 1],\n        F = O[0],\n        U = O[1];\n      if (v && (k = f.upVector(g.canonical, R.x, R.y), 0 !== k[0] || 0 !== k[1] || 1 !== k[2])) {\n        var _t336 = [k[2], 0, -k[0]],\n          _i195 = e.cross([], k, _t336);\n        e.normalize(_t336, _t336), e.normalize(_i195, _i195), F = e.dot(O, _t336), U = e.dot(O, _i195);\n      }\n      if (o) {\n        var _t337 = e.cross([], k, O);\n        e.normalize(_t337, _t337), e.scaleAndAdd(B, B, _t337, o * y);\n      }\n      var N = b + Math.atan2(U, F);\n      return S.push(B), p && D.push(R), {\n        point: B,\n        angle: N,\n        path: S,\n        tilePath: D,\n        up: k\n      };\n    }\n    function mt(e, t) {\n      var i = t.length,\n        o = i + 4 * e;\n      t.resize(o), t.float32.fill(-1 / 0, 4 * i, 4 * o);\n    }\n    function ft(e, t, i) {\n      var o = t[0],\n        r = t[1];\n      return e[0] = i[0] * o + i[4] * r + i[12], e[1] = i[1] * o + i[5] * r + i[13], e[3] = i[3] * o + i[7] * r + i[15], e;\n    }\n    var gt = 100;\n    var vt = /*#__PURE__*/function () {\n      function vt(e, t) {\n        var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new et(e.width + 200, e.height + 200, 25);\n        var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new et(e.width + 200, e.height + 200, 25);\n        _classCallCheck(this, vt);\n        this.transform = e, this.grid = i, this.ignoredGrid = o, this.pitchfactor = Math.cos(e._pitch) * e.cameraToCenterDistance, this.screenRightBoundary = e.width + gt, this.screenBottomBoundary = e.height + gt, this.gridRightBoundary = e.width + 200, this.gridBottomBoundary = e.height + 200, this.fogState = t;\n      }\n      _createClass(vt, [{\n        key: \"placeCollisionBox\",\n        value: function placeCollisionBox(e, t, i, o, r, n, s, a) {\n          var l = i.projectedAnchorX,\n            c = i.projectedAnchorY,\n            h = i.projectedAnchorZ;\n          var u = i.elevation,\n            _ = i.tileID,\n            d = e.getProjection();\n          if (u && _) {\n            var _d$upVector = d.upVector(_.canonical, i.tileAnchorX, i.tileAnchorY),\n              _d$upVector2 = _slicedToArray(_d$upVector, 3),\n              _e299 = _d$upVector2[0],\n              _t338 = _d$upVector2[1],\n              _o99 = _d$upVector2[2],\n              _r237 = d.upVectorScale(_.canonical, this.transform.center.lat, this.transform.worldSize).metersToTile;\n            l += _e299 * u * _r237, c += _t338 * u * _r237, h += _o99 * u * _r237;\n          }\n          var p = this.projectAndGetPerspectiveRatio(s, l, c, h, i.tileID, \"globe\" === d.name || !!u || this.transform.pitch > 0, d),\n            m = n * p.perspectiveRatio,\n            f = (i.x1 * t + o.x - i.padding) * m + p.point.x,\n            g = (i.y1 * t + o.y - i.padding) * m + p.point.y,\n            v = (i.x2 * t + o.x + i.padding) * m + p.point.x,\n            x = (i.y2 * t + o.y + i.padding) * m + p.point.y,\n            y = p.perspectiveRatio <= .55 || p.occluded;\n          return !this.isInsideGrid(f, g, v, x) || !r && this.grid.hitTest(f, g, v, x, a) || y ? {\n            box: [],\n            offscreen: !1,\n            occluded: p.occluded\n          } : {\n            box: [f, g, v, x],\n            offscreen: this.isOffscreen(f, g, v, x),\n            occluded: !1\n          };\n        }\n      }, {\n        key: \"placeCollisionCircles\",\n        value: function placeCollisionCircles(t, i, o, r, n, s, a, l, c, h, u, _, d, p, m) {\n          var f = [],\n            g = this.transform.elevation,\n            v = t.getProjection(),\n            x = g ? g.getAtTileOffsetFunc(m, this.transform.center.lat, this.transform.worldSize, v) : null,\n            y = new e.pointGeometry(o.tileAnchorX, o.tileAnchorY);\n          var _v$projectTilePoint = v.projectTilePoint(y.x, y.y, m.canonical),\n            b = _v$projectTilePoint.x,\n            w = _v$projectTilePoint.y,\n            T = _v$projectTilePoint.z;\n          if (x) {\n            var _x13 = x(y),\n              _x14 = _slicedToArray(_x13, 3),\n              _e300 = _x14[0],\n              _t339 = _x14[1],\n              _i196 = _x14[2];\n            b += _e300, w += _t339, T += _i196;\n          }\n          var E = \"globe\" === v.name,\n            C = this.projectAndGetPerspectiveRatio(a, b, w, T, m, E || !!g || this.transform.pitch > 0, v),\n            M = C.perspectiveRatio,\n            I = (u ? s / M : s * M) / e.ONE_EM,\n            S = nt(b, w, T, l),\n            D = C.signedDistanceFromCamera > 0 ? ct(I, n, o.lineOffsetX * I, o.lineOffsetY * I, !1, S, y, o, r, l, {}, g && !u ? x : null, u && !!g, v, m, u) : null;\n          var L = !1,\n            A = !1,\n            z = !0;\n          if (D && !C.occluded) {\n            var _t340 = .5 * d * M + p,\n              _o100 = new e.pointGeometry(-100, -100),\n              _r238 = new e.pointGeometry(this.screenRightBoundary, this.screenBottomBoundary),\n              _n168 = new Qe(),\n              _s129 = D.first,\n              _a111 = D.last,\n              _l67 = _s129.path.length;\n            var _u55 = [];\n            for (var _e301 = _l67 - 1; _e301 >= 1; _e301--) _u55.push(_s129.path[_e301]);\n            for (var _e302 = 1; _e302 < _a111.path.length; _e302++) _u55.push(_a111.path[_e302]);\n            var _m11 = 2.5 * _t340;\n            c && (_u55 = _u55.map(function (_ref135, o) {\n              var _ref136 = _slicedToArray(_ref135, 3),\n                e = _ref136[0],\n                t = _ref136[1],\n                i = _ref136[2];\n              return x && !E && (i = x(o < _l67 - 1 ? _s129.tilePath[_l67 - 1 - o] : _a111.tilePath[o - _l67 + 2])[2]), nt(e, t, i, c);\n            }), _u55.some(function (e) {\n              return e[3] <= 0;\n            }) && (_u55 = []));\n            var _g16 = [];\n            if (_u55.length > 0) {\n              var _t341 = 1 / 0,\n                _i197 = -1 / 0,\n                _n169 = 1 / 0,\n                _s130 = -1 / 0;\n              var _iterator201 = _createForOfIteratorHelper(_u55),\n                _step201;\n              try {\n                for (_iterator201.s(); !(_step201 = _iterator201.n()).done;) {\n                  var _e303 = _step201.value;\n                  _t341 = Math.min(_t341, _e303[0]), _n169 = Math.min(_n169, _e303[1]), _i197 = Math.max(_i197, _e303[0]), _s130 = Math.max(_s130, _e303[1]);\n                }\n              } catch (err) {\n                _iterator201.e(err);\n              } finally {\n                _iterator201.f();\n              }\n              _i197 >= _o100.x && _t341 <= _r238.x && _s130 >= _o100.y && _n169 <= _r238.y && (_g16 = [_u55.map(function (t) {\n                return new e.pointGeometry(t[0], t[1]);\n              })], (_t341 < _o100.x || _i197 > _r238.x || _n169 < _o100.y || _s130 > _r238.y) && (_g16 = e.clipLine(_g16, _o100.x, _o100.y, _r238.x, _r238.y)));\n            }\n            var _iterator202 = _createForOfIteratorHelper(_g16),\n              _step202;\n            try {\n              for (_iterator202.s(); !(_step202 = _iterator202.n()).done;) {\n                var _e304 = _step202.value;\n                _n168.reset(_e304, .25 * _t340);\n                var _o101 = 0;\n                _o101 = _n168.length <= .5 * _t340 ? 1 : Math.ceil(_n168.paddedLength / _m11) + 1;\n                for (var _e305 = 0; _e305 < _o101; _e305++) {\n                  var _r239 = _e305 / Math.max(_o101 - 1, 1),\n                    _s131 = _n168.lerp(_r239),\n                    _a112 = _s131.x + gt,\n                    _l68 = _s131.y + gt;\n                  f.push(_a112, _l68, _t340, 0);\n                  var _c49 = _a112 - _t340,\n                    _u56 = _l68 - _t340,\n                    _d19 = _a112 + _t340,\n                    _p34 = _l68 + _t340;\n                  if (z = z && this.isOffscreen(_c49, _u56, _d19, _p34), A = A || this.isInsideGrid(_c49, _u56, _d19, _p34), !i && this.grid.hitTestCircle(_a112, _l68, _t340, _) && (L = !0, !h)) return {\n                    circles: [],\n                    offscreen: !1,\n                    collisionDetected: L,\n                    occluded: !1\n                  };\n                }\n              }\n            } catch (err) {\n              _iterator202.e(err);\n            } finally {\n              _iterator202.f();\n            }\n          }\n          return {\n            circles: !h && L || !A ? [] : f,\n            offscreen: z,\n            collisionDetected: L,\n            occluded: C.occluded\n          };\n        }\n      }, {\n        key: \"queryRenderedSymbols\",\n        value: function queryRenderedSymbols(t) {\n          if (0 === t.length || 0 === this.grid.keysLength() && 0 === this.ignoredGrid.keysLength()) return {};\n          var i = [];\n          var o = 1 / 0,\n            r = 1 / 0,\n            n = -1 / 0,\n            s = -1 / 0;\n          var _iterator203 = _createForOfIteratorHelper(t),\n            _step203;\n          try {\n            for (_iterator203.s(); !(_step203 = _iterator203.n()).done;) {\n              var _a113 = _step203.value;\n              var _t342 = new e.pointGeometry(_a113.x + gt, _a113.y + gt);\n              o = Math.min(o, _t342.x), r = Math.min(r, _t342.y), n = Math.max(n, _t342.x), s = Math.max(s, _t342.y), i.push(_t342);\n            }\n          } catch (err) {\n            _iterator203.e(err);\n          } finally {\n            _iterator203.f();\n          }\n          var a = this.grid.query(o, r, n, s).concat(this.ignoredGrid.query(o, r, n, s)),\n            l = {},\n            c = {};\n          var _iterator204 = _createForOfIteratorHelper(a),\n            _step204;\n          try {\n            for (_iterator204.s(); !(_step204 = _iterator204.n()).done;) {\n              var _t343 = _step204.value;\n              var _o102 = _t343.key;\n              if (void 0 === l[_o102.bucketInstanceId] && (l[_o102.bucketInstanceId] = {}), l[_o102.bucketInstanceId][_o102.featureIndex]) continue;\n              var _r240 = [new e.pointGeometry(_t343.x1, _t343.y1), new e.pointGeometry(_t343.x2, _t343.y1), new e.pointGeometry(_t343.x2, _t343.y2), new e.pointGeometry(_t343.x1, _t343.y2)];\n              e.polygonIntersectsPolygon(i, _r240) && (l[_o102.bucketInstanceId][_o102.featureIndex] = !0, void 0 === c[_o102.bucketInstanceId] && (c[_o102.bucketInstanceId] = []), c[_o102.bucketInstanceId].push(_o102.featureIndex));\n            }\n          } catch (err) {\n            _iterator204.e(err);\n          } finally {\n            _iterator204.f();\n          }\n          return c;\n        }\n      }, {\n        key: \"insertCollisionBox\",\n        value: function insertCollisionBox(e, t, i, o, r) {\n          (t ? this.ignoredGrid : this.grid).insert({\n            bucketInstanceId: i,\n            featureIndex: o,\n            collisionGroupID: r\n          }, e[0], e[1], e[2], e[3]);\n        }\n      }, {\n        key: \"insertCollisionCircles\",\n        value: function insertCollisionCircles(e, t, i, o, r) {\n          var n = t ? this.ignoredGrid : this.grid,\n            s = {\n              bucketInstanceId: i,\n              featureIndex: o,\n              collisionGroupID: r\n            };\n          for (var _t344 = 0; _t344 < e.length; _t344 += 4) n.insertCircle(s, e[_t344], e[_t344 + 1], e[_t344 + 2]);\n        }\n      }, {\n        key: \"projectAndGetPerspectiveRatio\",\n        value: function projectAndGetPerspectiveRatio(t, i, o, r, n, s, a) {\n          var l = [i, o, r, 1];\n          var c = !1;\n          if (r || this.transform.pitch > 0) {\n            e.transformMat4$1(l, l, t);\n            var _s132 = \"globe\" === a.name;\n            if (this.fogState && n && !_s132) {\n              var _t345 = function (t, i, o, r, n, s) {\n                var a = s.calculateFogTileMatrix(n),\n                  l = [i, o, r];\n                return e.transformMat4(l, l, a), I(t, l, s.pitch, s._fov);\n              }(this.fogState, i, o, r, n.toUnwrapped(), this.transform);\n              c = _t345 > .9;\n            }\n          } else ft(l, l, t);\n          var h = l[3];\n          return {\n            point: new e.pointGeometry((l[0] / h + 1) / 2 * this.transform.width + gt, (-l[1] / h + 1) / 2 * this.transform.height + gt),\n            perspectiveRatio: Math.min(.5 + this.transform.getCameraToCenterDistance(a) / h * .5, 1.5),\n            signedDistanceFromCamera: h,\n            occluded: s && l[2] > h || c\n          };\n        }\n      }, {\n        key: \"isOffscreen\",\n        value: function isOffscreen(e, t, i, o) {\n          return i < gt || e >= this.screenRightBoundary || o < gt || t > this.screenBottomBoundary;\n        }\n      }, {\n        key: \"isInsideGrid\",\n        value: function isInsideGrid(e, t, i, o) {\n          return i >= 0 && e < this.gridRightBoundary && o >= 0 && t < this.gridBottomBoundary;\n        }\n      }, {\n        key: \"getViewportMatrix\",\n        value: function getViewportMatrix() {\n          var t = e.identity([]);\n          return e.translate(t, t, [-100, -100, 0]), t;\n        }\n      }]);\n      return vt;\n    }();\n    function xt(t, i, o) {\n      var r = i.createTileMatrix(t, t.worldSize, o.toUnwrapped());\n      return e.multiply(new Float32Array(16), t.projMatrix, r);\n    }\n    function yt(e, t, i) {\n      if (t.projection.name === i.projection.name) return e.projMatrix;\n      var o = i.clone();\n      return o.setProjection(t.projection), xt(o, t.getProjection(), e);\n    }\n    function bt(e, t, i) {\n      return t.name === i.projection.name ? e.projMatrix : xt(i, t, e);\n    }\n    var wt = /*#__PURE__*/function () {\n      function wt(e, t, i, o) {\n        _classCallCheck(this, wt);\n        this.opacity = e ? Math.max(0, Math.min(1, e.opacity + (e.placed ? t : -t))) : o && i ? 1 : 0, this.placed = i;\n      }\n      _createClass(wt, [{\n        key: \"isHidden\",\n        value: function isHidden() {\n          return 0 === this.opacity && !this.placed;\n        }\n      }]);\n      return wt;\n    }();\n    var Tt = /*#__PURE__*/function () {\n      function Tt(e, t, i, o, r) {\n        var n = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !1;\n        _classCallCheck(this, Tt);\n        this.text = new wt(e ? e.text : null, t, i, r), this.icon = new wt(e ? e.icon : null, t, o, r), this.clipped = n;\n      }\n      _createClass(Tt, [{\n        key: \"isHidden\",\n        value: function isHidden() {\n          return this.text.isHidden() && this.icon.isHidden();\n        }\n      }]);\n      return Tt;\n    }();\n    var Et = function Et(e, t, i) {\n      var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;\n      _classCallCheck(this, Et);\n      this.text = e, this.icon = t, this.skipFade = i, this.clipped = o;\n    };\n    var Ct = function Ct() {\n      _classCallCheck(this, Ct);\n      this.invProjMatrix = e.create(), this.viewportMatrix = e.create(), this.circles = [];\n    };\n    var Mt = function Mt(e, t, i, o, r) {\n      _classCallCheck(this, Mt);\n      this.bucketInstanceId = e, this.featureIndex = t, this.sourceLayerIndex = i, this.bucketIndex = o, this.tileID = r;\n    };\n    var It = /*#__PURE__*/function () {\n      function It(e) {\n        _classCallCheck(this, It);\n        this.crossSourceCollisions = e, this.maxGroupID = 0, this.collisionGroups = {};\n      }\n      _createClass(It, [{\n        key: \"get\",\n        value: function get(e) {\n          if (this.crossSourceCollisions) return {\n            ID: 0,\n            predicate: null\n          };\n          if (!this.collisionGroups[e]) {\n            var _t346 = ++this.maxGroupID;\n            this.collisionGroups[e] = {\n              ID: _t346,\n              predicate: function predicate(e) {\n                return e.collisionGroupID === _t346;\n              }\n            };\n          }\n          return this.collisionGroups[e];\n        }\n      }]);\n      return It;\n    }();\n    function St(t, i, o, r, n) {\n      var _e$getAnchorAlignment = e.getAnchorAlignment(t),\n        s = _e$getAnchorAlignment.horizontalAlign,\n        a = _e$getAnchorAlignment.verticalAlign,\n        l = -(s - .5) * i,\n        c = -(a - .5) * o,\n        h = e.evaluateVariableOffset(t, r);\n      return new e.pointGeometry(l + h[0] * n, c + h[1] * n);\n    }\n    function Dt(t, i, o, r, n) {\n      var s = new e.pointGeometry(t, i);\n      return o && s._rotate(r ? n : -n), s;\n    }\n    var Lt = /*#__PURE__*/function () {\n      function Lt(e, t, i, o, r) {\n        _classCallCheck(this, Lt);\n        this.transform = e.clone(), this.projection = e.projection.name, this.collisionIndex = new vt(this.transform, r), this.placements = {}, this.opacities = {}, this.variableOffsets = {}, this.stale = !1, this.commitTime = 0, this.fadeDuration = t, this.retainedQueryData = {}, this.collisionGroups = new It(i), this.collisionCircleArrays = {}, this.prevPlacement = o, o && (o.prevPlacement = void 0), this.placedOrientations = {};\n      }\n      _createClass(Lt, [{\n        key: \"getBucketParts\",\n        value: function getBucketParts(t, i, o, r) {\n          var n = o.getBucket(i),\n            s = o.latestFeatureIndex;\n          if (!n || !s || i.id !== n.layerIds[0]) return;\n          var a = n.layers[0].layout,\n            l = o.collisionBoxArray,\n            c = Math.pow(2, this.transform.zoom - o.tileID.overscaledZ),\n            h = o.tileSize / e.EXTENT,\n            u = o.tileID.toUnwrapped();\n          this.transform.setProjection(n.projection);\n          var _ = (d = o.tileID, p = n.getProjection(), m = this.transform, p.name === this.projection ? m.calculateProjMatrix(d.toUnwrapped()) : xt(m, p, d));\n          var d, p, m;\n          var f = \"map\" === a.get(\"text-pitch-alignment\"),\n            g = \"map\" === a.get(\"text-rotation-alignment\");\n          i.compileFilter();\n          var v = i.dynamicFilter(),\n            x = i.dynamicFilterNeedsFeature(),\n            y = this.transform.calculatePixelsToTileUnitsMatrix(o),\n            b = ot(_, o.tileID.canonical, f, g, this.transform, n.getProjection(), y);\n          var w = null;\n          if (f) {\n            var _t347 = rt(_, o.tileID.canonical, f, g, this.transform, n.getProjection(), y);\n            w = e.multiply([], this.transform.labelPlaneMatrix, _t347);\n          }\n          var T = null;\n          v && o.latestFeatureIndex && (T = {\n            unwrappedTileID: u,\n            dynamicFilter: v,\n            dynamicFilterNeedsFeature: x,\n            featureIndex: o.latestFeatureIndex\n          }), this.retainedQueryData[n.bucketInstanceId] = new Mt(n.bucketInstanceId, s, n.sourceLayerIndex, n.index, o.tileID);\n          var E = {\n            bucket: n,\n            layout: a,\n            posMatrix: _,\n            textLabelPlaneMatrix: b,\n            labelToScreenMatrix: w,\n            clippingData: T,\n            scale: c,\n            textPixelRatio: h,\n            holdingForFade: o.holdingForFade(),\n            collisionBoxArray: l,\n            partiallyEvaluatedTextSize: e.evaluateSizeForZoom(n.textSizeData, this.transform.zoom),\n            partiallyEvaluatedIconSize: e.evaluateSizeForZoom(n.iconSizeData, this.transform.zoom),\n            collisionGroup: this.collisionGroups.get(n.sourceID)\n          };\n          if (r) {\n            var _iterator205 = _createForOfIteratorHelper(n.sortKeyRanges),\n              _step205;\n            try {\n              for (_iterator205.s(); !(_step205 = _iterator205.n()).done;) {\n                var _e306 = _step205.value;\n                var _i198 = _e306.sortKey,\n                  _o103 = _e306.symbolInstanceStart,\n                  _r241 = _e306.symbolInstanceEnd;\n                t.push({\n                  sortKey: _i198,\n                  symbolInstanceStart: _o103,\n                  symbolInstanceEnd: _r241,\n                  parameters: E\n                });\n              }\n            } catch (err) {\n              _iterator205.e(err);\n            } finally {\n              _iterator205.f();\n            }\n          } else t.push({\n            symbolInstanceStart: 0,\n            symbolInstanceEnd: n.symbolInstances.length,\n            parameters: E\n          });\n        }\n      }, {\n        key: \"attemptAnchorPlacement\",\n        value: function attemptAnchorPlacement(e, t, i, o, r, n, s, a, l, c, h, u, _, d, p, m, f, g) {\n          var v = u.textOffset0,\n            x = u.textOffset1,\n            y = u.crossTileID,\n            b = [v, x],\n            w = St(e, i, o, b, r),\n            T = this.collisionIndex.placeCollisionBox(d, r, t, Dt(w.x, w.y, n, s, this.transform.angle), h, a, l, c.predicate);\n          if (m) {\n            var _e307 = d.getSymbolInstanceIconSize(g, this.transform.zoom, u.placedIconSymbolIndex);\n            if (0 === this.collisionIndex.placeCollisionBox(d, _e307, m, Dt(w.x, w.y, n, s, this.transform.angle), h, a, l, c.predicate).box.length) return;\n          }\n          if (T.box.length > 0) {\n            var _t348;\n            return this.prevPlacement && this.prevPlacement.variableOffsets[y] && this.prevPlacement.placements[y] && this.prevPlacement.placements[y].text && (_t348 = this.prevPlacement.variableOffsets[y].anchor), this.variableOffsets[y] = {\n              textOffset: b,\n              width: i,\n              height: o,\n              anchor: e,\n              textScale: r,\n              prevAnchor: _t348\n            }, this.markUsedJustification(d, e, u, p), d.allowVerticalPlacement && (this.markUsedOrientation(d, p, u), this.placedOrientations[y] = p), {\n              shift: w,\n              placedGlyphBoxes: T\n            };\n          }\n        }\n      }, {\n        key: \"placeLayerBucketPart\",\n        value: function placeLayerBucketPart(t, i, o, r) {\n          var _this93 = this;\n          var _t$parameters = t.parameters,\n            n = _t$parameters.bucket,\n            s = _t$parameters.layout,\n            a = _t$parameters.posMatrix,\n            l = _t$parameters.textLabelPlaneMatrix,\n            c = _t$parameters.labelToScreenMatrix,\n            h = _t$parameters.clippingData,\n            u = _t$parameters.textPixelRatio,\n            _ = _t$parameters.holdingForFade,\n            d = _t$parameters.collisionBoxArray,\n            p = _t$parameters.partiallyEvaluatedTextSize,\n            m = _t$parameters.partiallyEvaluatedIconSize,\n            f = _t$parameters.collisionGroup,\n            g = s.get(\"text-optional\"),\n            v = s.get(\"icon-optional\"),\n            x = s.get(\"text-allow-overlap\"),\n            y = s.get(\"icon-allow-overlap\"),\n            b = \"map\" === s.get(\"text-rotation-alignment\"),\n            w = \"map\" === s.get(\"text-pitch-alignment\"),\n            T = \"none\" !== s.get(\"icon-text-fit\"),\n            E = \"viewport-y\" === s.get(\"symbol-z-order\");\n          this.transform.setProjection(n.projection);\n          var C = x && (y || !n.hasIconData() || v),\n            M = y && (x || !n.hasTextData() || g);\n          !n.collisionArrays && d && n.deserializeCollisionBoxes(d), o && r && n.updateCollisionDebugBuffers(this.transform.zoom, d);\n          var I = function I(t, r, d) {\n            var E = t.crossTileID,\n              I = t.numVerticalGlyphVertices;\n            if (h) {\n              var _o104 = {\n                zoom: _this93.transform.zoom,\n                pitch: _this93.transform.pitch\n              };\n              var _r242 = null;\n              if (h.dynamicFilterNeedsFeature) {\n                var _e308 = _this93.retainedQueryData[n.bucketInstanceId];\n                _r242 = h.featureIndex.loadFeature({\n                  featureIndex: t.featureIndex,\n                  bucketIndex: _e308.bucketIndex,\n                  sourceLayerIndex: _e308.sourceLayerIndex,\n                  layoutVertexArrayOffset: 0\n                });\n              }\n              if (!(0, h.dynamicFilter)(_o104, _r242, _this93.retainedQueryData[n.bucketInstanceId].tileID.canonical, new e.pointGeometry(t.tileAnchorX, t.tileAnchorY), _this93.transform.calculateDistanceTileData(h.unwrappedTileID))) return _this93.placements[E] = new Et(!1, !1, !1, !0), void (i[E] = !0);\n            }\n            if (i[E]) return;\n            if (_) return void (_this93.placements[E] = new Et(!1, !1, !1));\n            var S = !1,\n              D = !1,\n              L = !0,\n              A = !1,\n              z = !1,\n              P = null,\n              R = {\n                box: null,\n                offscreen: null,\n                occluded: null\n              },\n              O = {\n                box: null,\n                offscreen: null,\n                occluded: null\n              },\n              B = null,\n              k = null,\n              F = null,\n              U = 0,\n              N = 0,\n              G = 0;\n            d.textFeatureIndex ? U = d.textFeatureIndex : t.useRuntimeCollisionCircles && (U = t.featureIndex), d.verticalTextFeatureIndex && (N = d.verticalTextFeatureIndex);\n            var j = function j(e) {\n                e.tileID = _this93.retainedQueryData[n.bucketInstanceId].tileID;\n                var t = _this93.transform.elevation;\n                (t || e.elevation) && (e.elevation = t ? t.getAtTileOffset(e.tileID, e.tileAnchorX, e.tileAnchorY) : 0);\n              },\n              Z = d.textBox;\n            if (Z) {\n              j(Z);\n              var _i199 = function _i199(i) {\n                  var o = e.WritingMode.horizontal;\n                  if (n.allowVerticalPlacement && !i && _this93.prevPlacement) {\n                    var _e309 = _this93.prevPlacement.placedOrientations[E];\n                    _e309 && (_this93.placedOrientations[E] = _e309, o = _e309, _this93.markUsedOrientation(n, o, t));\n                  }\n                  return o;\n                },\n                _o105 = function _o105(t, i) {\n                  if (n.allowVerticalPlacement && I > 0 && d.verticalTextBox) {\n                    var _iterator206 = _createForOfIteratorHelper(n.writingModes),\n                      _step206;\n                    try {\n                      for (_iterator206.s(); !(_step206 = _iterator206.n()).done;) {\n                        var _o106 = _step206.value;\n                        if (_o106 === e.WritingMode.vertical ? (R = i(), O = R) : R = t(), R && R.box && R.box.length) break;\n                      }\n                    } catch (err) {\n                      _iterator206.e(err);\n                    } finally {\n                      _iterator206.f();\n                    }\n                  } else R = t();\n                };\n              if (s.get(\"text-variable-anchor\")) {\n                var _l69 = s.get(\"text-variable-anchor\");\n                if (_this93.prevPlacement && _this93.prevPlacement.variableOffsets[E]) {\n                  var _e310 = _this93.prevPlacement.variableOffsets[E];\n                  _l69.indexOf(_e310.anchor) > 0 && (_l69 = _l69.filter(function (t) {\n                    return t !== _e310.anchor;\n                  }), _l69.unshift(_e310.anchor));\n                }\n                var _c50 = function _c50(e, i, o) {\n                  var s = n.getSymbolInstanceTextSize(p, t, _this93.transform.zoom, r),\n                    c = (e.x2 - e.x1) * s + 2 * e.padding,\n                    h = (e.y2 - e.y1) * s + 2 * e.padding,\n                    _ = T && !y ? i : null;\n                  _ && j(_);\n                  var d = {\n                    box: [],\n                    offscreen: !1,\n                    occluded: !1\n                  };\n                  var g = x ? 2 * _l69.length : _l69.length;\n                  for (var _i200 = 0; _i200 < g; ++_i200) {\n                    var _g17 = _this93.attemptAnchorPlacement(_l69[_i200 % _l69.length], e, c, h, s, b, w, u, a, f, _i200 >= _l69.length, t, r, n, o, _, p, m);\n                    if (_g17 && (d = _g17.placedGlyphBoxes, d && d.box && d.box.length)) {\n                      S = !0, P = _g17.shift;\n                      break;\n                    }\n                  }\n                  return d;\n                };\n                _o105(function () {\n                  return _c50(Z, d.iconBox, e.WritingMode.horizontal);\n                }, function () {\n                  var t = d.verticalTextBox;\n                  return t && j(t), n.allowVerticalPlacement && !(R && R.box && R.box.length) && I > 0 && t ? _c50(t, d.verticalIconBox, e.WritingMode.vertical) : {\n                    box: null,\n                    offscreen: null,\n                    occluded: null\n                  };\n                }), R && (S = R.box, L = R.offscreen, A = R.occluded);\n                var _h38 = _i199(R && R.box);\n                if (!S && _this93.prevPlacement) {\n                  var _e311 = _this93.prevPlacement.variableOffsets[E];\n                  _e311 && (_this93.variableOffsets[E] = _e311, _this93.markUsedJustification(n, _e311.anchor, t, _h38));\n                }\n              } else {\n                var _s133 = function _s133(i, o) {\n                  var s = n.getSymbolInstanceTextSize(p, t, _this93.transform.zoom, r),\n                    l = _this93.collisionIndex.placeCollisionBox(n, s, i, new e.pointGeometry(0, 0), x, u, a, f.predicate);\n                  return l && l.box && l.box.length && (_this93.markUsedOrientation(n, o, t), _this93.placedOrientations[E] = o), l;\n                };\n                _o105(function () {\n                  return _s133(Z, e.WritingMode.horizontal);\n                }, function () {\n                  var t = d.verticalTextBox;\n                  return n.allowVerticalPlacement && I > 0 && t ? (j(t), _s133(t, e.WritingMode.vertical)) : {\n                    box: null,\n                    offscreen: null,\n                    occluded: null\n                  };\n                }), _i199(R && R.box && R.box.length);\n              }\n            }\n            if (B = R, S = B && B.box && B.box.length > 0, L = B && B.offscreen, A = B && B.occluded, t.useRuntimeCollisionCircles) {\n              var _i201 = n.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex >= 0 ? t.centerJustifiedTextSymbolIndex : t.verticalPlacedTextSymbolIndex),\n                _r243 = e.evaluateSizeForFeature(n.textSizeData, p, _i201),\n                _h39 = s.get(\"text-padding\");\n              k = _this93.collisionIndex.placeCollisionCircles(n, x, _i201, n.lineVertexArray, n.glyphOffsetArray, _r243, a, l, c, o, w, f.predicate, t.collisionCircleDiameter * _r243 / e.ONE_EM, _h39, _this93.retainedQueryData[n.bucketInstanceId].tileID), S = x || k.circles.length > 0 && !k.collisionDetected, L = L && k.offscreen, A = k.occluded;\n            }\n            if (d.iconFeatureIndex && (G = d.iconFeatureIndex), d.iconBox) {\n              var _i202 = function _i202(i) {\n                j(i);\n                var o = T && P ? Dt(P.x, P.y, b, w, _this93.transform.angle) : new e.pointGeometry(0, 0),\n                  r = n.getSymbolInstanceIconSize(m, _this93.transform.zoom, t.placedIconSymbolIndex);\n                return _this93.collisionIndex.placeCollisionBox(n, r, i, o, y, u, a, f.predicate);\n              };\n              O && O.box && O.box.length && d.verticalIconBox ? (F = _i202(d.verticalIconBox), D = F.box.length > 0) : (F = _i202(d.iconBox), D = F.box.length > 0), L = L && F.offscreen, z = F.occluded;\n            }\n            var V = g || 0 === t.numHorizontalGlyphVertices && 0 === I,\n              W = v || 0 === t.numIconVertices;\n            if (V || W ? W ? V || (D = D && S) : S = D && S : D = S = D && S, S && B && B.box && _this93.collisionIndex.insertCollisionBox(B.box, s.get(\"text-ignore-placement\"), n.bucketInstanceId, O && O.box && N ? N : U, f.ID), D && F && _this93.collisionIndex.insertCollisionBox(F.box, s.get(\"icon-ignore-placement\"), n.bucketInstanceId, G, f.ID), k && (S && _this93.collisionIndex.insertCollisionCircles(k.circles, s.get(\"text-ignore-placement\"), n.bucketInstanceId, U, f.ID), o)) {\n              var _e312 = n.bucketInstanceId;\n              var _t349 = _this93.collisionCircleArrays[_e312];\n              void 0 === _t349 && (_t349 = _this93.collisionCircleArrays[_e312] = new Ct());\n              for (var _e313 = 0; _e313 < k.circles.length; _e313 += 4) _t349.circles.push(k.circles[_e313 + 0]), _t349.circles.push(k.circles[_e313 + 1]), _t349.circles.push(k.circles[_e313 + 2]), _t349.circles.push(k.collisionDetected ? 1 : 0);\n            }\n            var X = \"globe\" !== n.projection.name;\n            C = C && (X || !A), M = M && (X || !z), _this93.placements[E] = new Et(S || C, D || M, L || n.justReloaded), i[E] = !0;\n          };\n          if (E) {\n            var _e314 = n.getSortedSymbolIndexes(this.transform.angle);\n            for (var _t350 = _e314.length - 1; _t350 >= 0; --_t350) {\n              var _i203 = _e314[_t350];\n              I(n.symbolInstances.get(_i203), _i203, n.collisionArrays[_i203]);\n            }\n          } else for (var _e315 = t.symbolInstanceStart; _e315 < t.symbolInstanceEnd; _e315++) I(n.symbolInstances.get(_e315), _e315, n.collisionArrays[_e315]);\n          if (o && n.bucketInstanceId in this.collisionCircleArrays) {\n            var _t351 = this.collisionCircleArrays[n.bucketInstanceId];\n            e.invert(_t351.invProjMatrix, a), _t351.viewportMatrix = this.collisionIndex.getViewportMatrix();\n          }\n          n.justReloaded = !1;\n        }\n      }, {\n        key: \"markUsedJustification\",\n        value: function markUsedJustification(t, i, o, r) {\n          var n = o.leftJustifiedTextSymbolIndex,\n            s = o.centerJustifiedTextSymbolIndex,\n            a = o.rightJustifiedTextSymbolIndex,\n            l = o.verticalPlacedTextSymbolIndex,\n            c = o.crossTileID,\n            h = e.getAnchorJustification(i),\n            u = r === e.WritingMode.vertical ? l : \"left\" === h ? n : \"center\" === h ? s : \"right\" === h ? a : -1;\n          n >= 0 && (t.text.placedSymbolArray.get(n).crossTileID = u >= 0 && n !== u ? 0 : c), s >= 0 && (t.text.placedSymbolArray.get(s).crossTileID = u >= 0 && s !== u ? 0 : c), a >= 0 && (t.text.placedSymbolArray.get(a).crossTileID = u >= 0 && a !== u ? 0 : c), l >= 0 && (t.text.placedSymbolArray.get(l).crossTileID = u >= 0 && l !== u ? 0 : c);\n        }\n      }, {\n        key: \"markUsedOrientation\",\n        value: function markUsedOrientation(t, i, o) {\n          var r = i === e.WritingMode.horizontal || i === e.WritingMode.horizontalOnly ? i : 0,\n            n = i === e.WritingMode.vertical ? i : 0,\n            s = o.leftJustifiedTextSymbolIndex,\n            a = o.centerJustifiedTextSymbolIndex,\n            l = o.rightJustifiedTextSymbolIndex,\n            c = o.verticalPlacedTextSymbolIndex,\n            h = t.text.placedSymbolArray;\n          s >= 0 && (h.get(s).placedOrientation = r), a >= 0 && (h.get(a).placedOrientation = r), l >= 0 && (h.get(l).placedOrientation = r), c >= 0 && (h.get(c).placedOrientation = n);\n        }\n      }, {\n        key: \"commit\",\n        value: function commit(e) {\n          this.commitTime = e, this.zoomAtLastRecencyCheck = this.transform.zoom;\n          var t = this.prevPlacement;\n          var i = !1;\n          this.prevZoomAdjustment = t ? t.zoomAdjustment(this.transform.zoom) : 0;\n          var o = t ? t.symbolFadeChange(e) : 1,\n            r = t ? t.opacities : {},\n            n = t ? t.variableOffsets : {},\n            s = t ? t.placedOrientations : {};\n          for (var _e316 in this.placements) {\n            var _t352 = this.placements[_e316],\n              _n170 = r[_e316];\n            _n170 ? (this.opacities[_e316] = new Tt(_n170, o, _t352.text, _t352.icon, null, _t352.clipped), i = i || _t352.text !== _n170.text.placed || _t352.icon !== _n170.icon.placed) : (this.opacities[_e316] = new Tt(null, o, _t352.text, _t352.icon, _t352.skipFade, _t352.clipped), i = i || _t352.text || _t352.icon);\n          }\n          for (var _e317 in r) {\n            var _t353 = r[_e317];\n            if (!this.opacities[_e317]) {\n              var _r244 = new Tt(_t353, o, !1, !1);\n              _r244.isHidden() || (this.opacities[_e317] = _r244, i = i || _t353.text.placed || _t353.icon.placed);\n            }\n          }\n          for (var _e318 in n) this.variableOffsets[_e318] || !this.opacities[_e318] || this.opacities[_e318].isHidden() || (this.variableOffsets[_e318] = n[_e318]);\n          for (var _e319 in s) this.placedOrientations[_e319] || !this.opacities[_e319] || this.opacities[_e319].isHidden() || (this.placedOrientations[_e319] = s[_e319]);\n          i ? this.lastPlacementChangeTime = e : \"number\" != typeof this.lastPlacementChangeTime && (this.lastPlacementChangeTime = t ? t.lastPlacementChangeTime : e);\n        }\n      }, {\n        key: \"updateLayerOpacities\",\n        value: function updateLayerOpacities(e, t) {\n          var i = {};\n          var _iterator207 = _createForOfIteratorHelper(t),\n            _step207;\n          try {\n            for (_iterator207.s(); !(_step207 = _iterator207.n()).done;) {\n              var _o107 = _step207.value;\n              var _t354 = _o107.getBucket(e);\n              _t354 && _o107.latestFeatureIndex && e.id === _t354.layerIds[0] && this.updateBucketOpacities(_t354, i, _o107.collisionBoxArray);\n            }\n          } catch (err) {\n            _iterator207.e(err);\n          } finally {\n            _iterator207.f();\n          }\n        }\n      }, {\n        key: \"updateBucketOpacities\",\n        value: function updateBucketOpacities(t, i, o) {\n          t.hasTextData() && t.text.opacityVertexArray.clear(), t.hasIconData() && t.icon.opacityVertexArray.clear(), t.hasIconCollisionBoxData() && t.iconCollisionBox.collisionVertexArray.clear(), t.hasTextCollisionBoxData() && t.textCollisionBox.collisionVertexArray.clear();\n          var r = t.layers[0].layout,\n            n = !!t.layers[0].dynamicFilter(),\n            s = new Tt(null, 0, !1, !1, !0),\n            a = r.get(\"text-allow-overlap\"),\n            l = r.get(\"icon-allow-overlap\"),\n            c = r.get(\"text-variable-anchor\"),\n            h = \"map\" === r.get(\"text-rotation-alignment\"),\n            u = \"map\" === r.get(\"text-pitch-alignment\"),\n            _ = \"none\" !== r.get(\"icon-text-fit\"),\n            d = new Tt(null, 0, a && (l || !t.hasIconData() || r.get(\"icon-optional\")), l && (a || !t.hasTextData() || r.get(\"text-optional\")), !0);\n          !t.collisionArrays && o && (t.hasIconCollisionBoxData() || t.hasTextCollisionBoxData()) && t.deserializeCollisionBoxes(o);\n          var p = function p(e, t, i) {\n            for (var _o108 = 0; _o108 < t / 4; _o108++) e.opacityVertexArray.emplaceBack(i);\n          };\n          var m = 0;\n          for (var _o109 = 0; _o109 < t.symbolInstances.length; _o109++) {\n            var _r245 = t.symbolInstances.get(_o109),\n              _a114 = _r245.numHorizontalGlyphVertices,\n              _l70 = _r245.numVerticalGlyphVertices,\n              _f24 = _r245.crossTileID,\n              _g18 = _r245.numIconVertices;\n            var _v12 = this.opacities[_f24];\n            i[_f24] ? _v12 = s : _v12 || (_v12 = d, this.opacities[_f24] = _v12), i[_f24] = !0;\n            var _x15 = _a114 > 0 || _l70 > 0,\n              _y12 = _g18 > 0,\n              _b10 = this.placedOrientations[_f24],\n              _w10 = _b10 === e.WritingMode.vertical,\n              _T5 = _b10 === e.WritingMode.horizontal || _b10 === e.WritingMode.horizontalOnly;\n            if (!_x15 && !_y12 || _v12.isHidden() || m++, _x15) {\n              var _e320 = Ut(_v12.text);\n              p(t.text, _a114, _w10 ? Nt : _e320), p(t.text, _l70, _T5 ? Nt : _e320);\n              var _i204 = _v12.text.isHidden(),\n                _o110 = _r245.leftJustifiedTextSymbolIndex,\n                _n171 = _r245.centerJustifiedTextSymbolIndex,\n                _s134 = _r245.rightJustifiedTextSymbolIndex,\n                _c51 = _r245.verticalPlacedTextSymbolIndex,\n                _h40 = t.text.placedSymbolArray,\n                _u57 = _i204 || _w10 ? 1 : 0;\n              _o110 >= 0 && (_h40.get(_o110).hidden = _u57), _n171 >= 0 && (_h40.get(_n171).hidden = _u57), _s134 >= 0 && (_h40.get(_s134).hidden = _u57), _c51 >= 0 && (_h40.get(_c51).hidden = _i204 || _T5 ? 1 : 0);\n              var _13 = this.variableOffsets[_f24];\n              _13 && this.markUsedJustification(t, _13.anchor, _r245, _b10);\n              var _d20 = this.placedOrientations[_f24];\n              _d20 && (this.markUsedJustification(t, \"left\", _r245, _d20), this.markUsedOrientation(t, _d20, _r245));\n            }\n            if (_y12) {\n              var _e321 = Ut(_v12.icon),\n                _i205 = _r245.placedIconSymbolIndex,\n                _o111 = _r245.verticalPlacedIconSymbolIndex,\n                _n172 = t.icon.placedSymbolArray,\n                _s135 = _v12.icon.isHidden() ? 1 : 0;\n              _i205 >= 0 && (p(t.icon, _g18, _w10 ? Nt : _e321), _n172.get(_i205).hidden = _s135), _o111 >= 0 && (p(t.icon, _r245.numVerticalIconVertices, _T5 ? Nt : _e321), _n172.get(_o111).hidden = _s135);\n            }\n            if (t.hasIconCollisionBoxData() || t.hasTextCollisionBoxData()) {\n              var _i206 = t.collisionArrays[_o109];\n              if (_i206) {\n                var _o112 = new e.pointGeometry(0, 0),\n                  _r246 = !0;\n                if (_i206.textBox || _i206.verticalTextBox) {\n                  if (c) {\n                    var _e322 = this.variableOffsets[_f24];\n                    _e322 ? (_o112 = St(_e322.anchor, _e322.width, _e322.height, _e322.textOffset, _e322.textScale), h && _o112._rotate(u ? this.transform.angle : -this.transform.angle)) : _r246 = !1;\n                  }\n                  n && (_r246 = !_v12.clipped), _i206.textBox && At(t.textCollisionBox.collisionVertexArray, _v12.text.placed, !_r246 || _w10, _o112.x, _o112.y), _i206.verticalTextBox && At(t.textCollisionBox.collisionVertexArray, _v12.text.placed, !_r246 || _T5, _o112.x, _o112.y);\n                }\n                var _s136 = _r246 && Boolean(!_T5 && _i206.verticalIconBox);\n                _i206.iconBox && At(t.iconCollisionBox.collisionVertexArray, _v12.icon.placed, _s136, _ ? _o112.x : 0, _ ? _o112.y : 0), _i206.verticalIconBox && At(t.iconCollisionBox.collisionVertexArray, _v12.icon.placed, !_s136, _ ? _o112.x : 0, _ ? _o112.y : 0);\n              }\n            }\n          }\n          if (t.fullyClipped = 0 === m, t.sortFeatures(this.transform.angle), this.retainedQueryData[t.bucketInstanceId] && (this.retainedQueryData[t.bucketInstanceId].featureSortOrder = t.featureSortOrder), t.hasTextData() && t.text.opacityVertexBuffer && t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray), t.hasIconData() && t.icon.opacityVertexBuffer && t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray), t.hasIconCollisionBoxData() && t.iconCollisionBox.collisionVertexBuffer && t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray), t.hasTextCollisionBoxData() && t.textCollisionBox.collisionVertexBuffer && t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray), t.bucketInstanceId in this.collisionCircleArrays) {\n            var _e323 = this.collisionCircleArrays[t.bucketInstanceId];\n            t.placementInvProjMatrix = _e323.invProjMatrix, t.placementViewportMatrix = _e323.viewportMatrix, t.collisionCircleArray = _e323.circles, delete this.collisionCircleArrays[t.bucketInstanceId];\n          }\n        }\n      }, {\n        key: \"symbolFadeChange\",\n        value: function symbolFadeChange(e) {\n          return 0 === this.fadeDuration ? 1 : (e - this.commitTime) / this.fadeDuration + this.prevZoomAdjustment;\n        }\n      }, {\n        key: \"zoomAdjustment\",\n        value: function zoomAdjustment(e) {\n          return Math.max(0, (this.transform.zoom - e) / 1.5);\n        }\n      }, {\n        key: \"hasTransitions\",\n        value: function hasTransitions(e) {\n          return this.stale || e - this.lastPlacementChangeTime < this.fadeDuration;\n        }\n      }, {\n        key: \"stillRecent\",\n        value: function stillRecent(e, t) {\n          var i = this.zoomAtLastRecencyCheck === t ? 1 - this.zoomAdjustment(t) : 1;\n          return this.zoomAtLastRecencyCheck = t, this.commitTime + this.fadeDuration * i > e;\n        }\n      }, {\n        key: \"setStale\",\n        value: function setStale() {\n          this.stale = !0;\n        }\n      }]);\n      return Lt;\n    }();\n    function At(e, t, i, o, r) {\n      e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, r || 0), e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, r || 0), e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, r || 0), e.emplaceBack(t ? 1 : 0, i ? 1 : 0, o || 0, r || 0);\n    }\n    var zt = Math.pow(2, 25),\n      Pt = Math.pow(2, 24),\n      Rt = Math.pow(2, 17),\n      Ot = Math.pow(2, 16),\n      Bt = Math.pow(2, 9),\n      kt = Math.pow(2, 8),\n      Ft = Math.pow(2, 1);\n    function Ut(e) {\n      if (0 === e.opacity && !e.placed) return 0;\n      if (1 === e.opacity && e.placed) return 4294967295;\n      var t = e.placed ? 1 : 0,\n        i = Math.floor(127 * e.opacity);\n      return i * zt + t * Pt + i * Rt + t * Ot + i * Bt + t * kt + i * Ft + t;\n    }\n    var Nt = 0;\n    var Gt = /*#__PURE__*/function () {\n      function Gt(e) {\n        _classCallCheck(this, Gt);\n        this._sortAcrossTiles = \"viewport-y\" !== e.layout.get(\"symbol-z-order\") && void 0 !== e.layout.get(\"symbol-sort-key\").constantOr(1), this._currentTileIndex = 0, this._currentPartIndex = 0, this._seenCrossTileIDs = {}, this._bucketParts = [];\n      }\n      _createClass(Gt, [{\n        key: \"continuePlacement\",\n        value: function continuePlacement(e, t, i, o, r) {\n          var n = this._bucketParts;\n          for (; this._currentTileIndex < e.length;) if (t.getBucketParts(n, o, e[this._currentTileIndex], this._sortAcrossTiles), this._currentTileIndex++, r()) return !0;\n          for (this._sortAcrossTiles && (this._sortAcrossTiles = !1, n.sort(function (e, t) {\n            return e.sortKey - t.sortKey;\n          })); this._currentPartIndex < n.length;) {\n            var _e324 = n[this._currentPartIndex];\n            if (t.placeLayerBucketPart(_e324, this._seenCrossTileIDs, i, 0 === _e324.symbolInstanceStart), this._currentPartIndex++, r()) return !0;\n          }\n          return !1;\n        }\n      }]);\n      return Gt;\n    }();\n    var jt = /*#__PURE__*/function () {\n      function jt(e, t, i, o, r, n, s, a) {\n        _classCallCheck(this, jt);\n        this.placement = new Lt(e, r, n, s, a), this._currentPlacementIndex = t.length - 1, this._forceFullPlacement = i, this._showCollisionBoxes = o, this._done = !1;\n      }\n      _createClass(jt, [{\n        key: \"isDone\",\n        value: function isDone() {\n          return this._done;\n        }\n      }, {\n        key: \"continuePlacement\",\n        value: function continuePlacement(t, i, o) {\n          var _this94 = this;\n          var r = e.exported.now(),\n            n = function n() {\n              var t = e.exported.now() - r;\n              return !_this94._forceFullPlacement && t > 2;\n            };\n          for (; this._currentPlacementIndex >= 0;) {\n            var _e325 = i[t[this._currentPlacementIndex]],\n              _r247 = this.placement.collisionIndex.transform.zoom;\n            if (\"symbol\" === _e325.type && (!_e325.minzoom || _e325.minzoom <= _r247) && (!_e325.maxzoom || _e325.maxzoom > _r247)) {\n              if (this._inProgressLayer || (this._inProgressLayer = new Gt(_e325)), this._inProgressLayer.continuePlacement(o[_e325.source], this.placement, this._showCollisionBoxes, _e325, n)) return;\n              delete this._inProgressLayer;\n            }\n            this._currentPlacementIndex--;\n          }\n          this._done = !0;\n        }\n      }, {\n        key: \"commit\",\n        value: function commit(e) {\n          return this.placement.commit(e), this.placement;\n        }\n      }]);\n      return jt;\n    }();\n    var Zt = 512 / e.EXTENT / 2;\n    var Vt = /*#__PURE__*/function () {\n      function Vt(e, t, i) {\n        _classCallCheck(this, Vt);\n        this.tileID = e, this.indexedSymbolInstances = {}, this.bucketInstanceId = i;\n        for (var _i207 = 0; _i207 < t.length; _i207++) {\n          var _o113 = t.get(_i207),\n            _r248 = _o113.key;\n          this.indexedSymbolInstances[_r248] || (this.indexedSymbolInstances[_r248] = []), this.indexedSymbolInstances[_r248].push({\n            crossTileID: _o113.crossTileID,\n            coord: this.getScaledCoordinates(_o113, e)\n          });\n        }\n      }\n      _createClass(Vt, [{\n        key: \"getScaledCoordinates\",\n        value: function getScaledCoordinates(t, i) {\n          var o = Zt / Math.pow(2, i.canonical.z - this.tileID.canonical.z);\n          return {\n            x: Math.floor((i.canonical.x * e.EXTENT + t.tileAnchorX) * o),\n            y: Math.floor((i.canonical.y * e.EXTENT + t.tileAnchorY) * o)\n          };\n        }\n      }, {\n        key: \"findMatches\",\n        value: function findMatches(e, t, i) {\n          var o = this.tileID.canonical.z < t.canonical.z ? 1 : Math.pow(2, this.tileID.canonical.z - t.canonical.z);\n          for (var _r249 = 0; _r249 < e.length; _r249++) {\n            var _n173 = e.get(_r249);\n            if (_n173.crossTileID) continue;\n            var _s137 = this.indexedSymbolInstances[_n173.key];\n            if (!_s137) continue;\n            var _a115 = this.getScaledCoordinates(_n173, t);\n            var _iterator208 = _createForOfIteratorHelper(_s137),\n              _step208;\n            try {\n              for (_iterator208.s(); !(_step208 = _iterator208.n()).done;) {\n                var _e326 = _step208.value;\n                if (Math.abs(_e326.coord.x - _a115.x) <= o && Math.abs(_e326.coord.y - _a115.y) <= o && !i[_e326.crossTileID]) {\n                  i[_e326.crossTileID] = !0, _n173.crossTileID = _e326.crossTileID;\n                  break;\n                }\n              }\n            } catch (err) {\n              _iterator208.e(err);\n            } finally {\n              _iterator208.f();\n            }\n          }\n        }\n      }]);\n      return Vt;\n    }();\n    var Wt = /*#__PURE__*/function () {\n      function Wt() {\n        _classCallCheck(this, Wt);\n        this.maxCrossTileID = 0;\n      }\n      _createClass(Wt, [{\n        key: \"generate\",\n        value: function generate() {\n          return ++this.maxCrossTileID;\n        }\n      }]);\n      return Wt;\n    }();\n    var Xt = /*#__PURE__*/function () {\n      function Xt() {\n        _classCallCheck(this, Xt);\n        this.indexes = {}, this.usedCrossTileIDs = {}, this.lng = 0;\n      }\n      _createClass(Xt, [{\n        key: \"handleWrapJump\",\n        value: function handleWrapJump(e) {\n          var t = Math.round((e - this.lng) / 360);\n          if (0 !== t) for (var _e327 in this.indexes) {\n            var _i208 = this.indexes[_e327],\n              _o114 = {};\n            for (var _e328 in _i208) {\n              var _r250 = _i208[_e328];\n              _r250.tileID = _r250.tileID.unwrapTo(_r250.tileID.wrap + t), _o114[_r250.tileID.key] = _r250;\n            }\n            this.indexes[_e327] = _o114;\n          }\n          this.lng = e;\n        }\n      }, {\n        key: \"addBucket\",\n        value: function addBucket(e, t, i) {\n          if (this.indexes[e.overscaledZ] && this.indexes[e.overscaledZ][e.key]) {\n            if (this.indexes[e.overscaledZ][e.key].bucketInstanceId === t.bucketInstanceId) return !1;\n            this.removeBucketCrossTileIDs(e.overscaledZ, this.indexes[e.overscaledZ][e.key]);\n          }\n          for (var _e329 = 0; _e329 < t.symbolInstances.length; _e329++) t.symbolInstances.get(_e329).crossTileID = 0;\n          this.usedCrossTileIDs[e.overscaledZ] || (this.usedCrossTileIDs[e.overscaledZ] = {});\n          var o = this.usedCrossTileIDs[e.overscaledZ];\n          for (var _i209 in this.indexes) {\n            var _r251 = this.indexes[_i209];\n            if (Number(_i209) > e.overscaledZ) for (var _i210 in _r251) {\n              var _n174 = _r251[_i210];\n              _n174.tileID.isChildOf(e) && _n174.findMatches(t.symbolInstances, e, o);\n            } else {\n              var _n175 = _r251[e.scaledTo(Number(_i209)).key];\n              _n175 && _n175.findMatches(t.symbolInstances, e, o);\n            }\n          }\n          for (var _e330 = 0; _e330 < t.symbolInstances.length; _e330++) {\n            var _r252 = t.symbolInstances.get(_e330);\n            _r252.crossTileID || (_r252.crossTileID = i.generate(), o[_r252.crossTileID] = !0);\n          }\n          return void 0 === this.indexes[e.overscaledZ] && (this.indexes[e.overscaledZ] = {}), this.indexes[e.overscaledZ][e.key] = new Vt(e, t.symbolInstances, t.bucketInstanceId), !0;\n        }\n      }, {\n        key: \"removeBucketCrossTileIDs\",\n        value: function removeBucketCrossTileIDs(e, t) {\n          for (var _i211 in t.indexedSymbolInstances) {\n            var _iterator209 = _createForOfIteratorHelper(t.indexedSymbolInstances[_i211]),\n              _step209;\n            try {\n              for (_iterator209.s(); !(_step209 = _iterator209.n()).done;) {\n                var _o115 = _step209.value;\n                delete this.usedCrossTileIDs[e][_o115.crossTileID];\n              }\n            } catch (err) {\n              _iterator209.e(err);\n            } finally {\n              _iterator209.f();\n            }\n          }\n        }\n      }, {\n        key: \"removeStaleBuckets\",\n        value: function removeStaleBuckets(e) {\n          var t = !1;\n          for (var _i212 in this.indexes) {\n            var _o116 = this.indexes[_i212];\n            for (var _r253 in _o116) e[_o116[_r253].bucketInstanceId] || (this.removeBucketCrossTileIDs(_i212, _o116[_r253]), delete _o116[_r253], t = !0);\n          }\n          return t;\n        }\n      }]);\n      return Xt;\n    }();\n    var qt = /*#__PURE__*/function () {\n      function qt() {\n        _classCallCheck(this, qt);\n        this.layerIndexes = {}, this.crossTileIDs = new Wt(), this.maxBucketInstanceId = 0, this.bucketsInCurrentPlacement = {};\n      }\n      _createClass(qt, [{\n        key: \"addLayer\",\n        value: function addLayer(e, t, i, o) {\n          var r = this.layerIndexes[e.id];\n          void 0 === r && (r = this.layerIndexes[e.id] = new Xt());\n          var n = !1;\n          var s = {};\n          \"globe\" !== o.name && r.handleWrapJump(i);\n          var _iterator210 = _createForOfIteratorHelper(t),\n            _step210;\n          try {\n            for (_iterator210.s(); !(_step210 = _iterator210.n()).done;) {\n              var _i213 = _step210.value;\n              var _t355 = _i213.getBucket(e);\n              _t355 && e.id === _t355.layerIds[0] && (_t355.bucketInstanceId || (_t355.bucketInstanceId = ++this.maxBucketInstanceId), r.addBucket(_i213.tileID, _t355, this.crossTileIDs) && (n = !0), s[_t355.bucketInstanceId] = !0);\n            }\n          } catch (err) {\n            _iterator210.e(err);\n          } finally {\n            _iterator210.f();\n          }\n          return r.removeStaleBuckets(s) && (n = !0), n;\n        }\n      }, {\n        key: \"pruneUnusedLayers\",\n        value: function pruneUnusedLayers(e) {\n          var t = {};\n          e.forEach(function (e) {\n            t[e] = !0;\n          });\n          for (var _e331 in this.layerIndexes) t[_e331] || delete this.layerIndexes[_e331];\n        }\n      }]);\n      return qt;\n    }();\n    var $t = function $t(t, i) {\n        return e.emitValidationErrors(t, i && i.filter(function (e) {\n          return \"source.canvas\" !== e.identifier;\n        }));\n      },\n      Ht = e.pick(We, [\"addLayer\", \"removeLayer\", \"setPaintProperty\", \"setLayoutProperty\", \"setFilter\", \"addSource\", \"removeSource\", \"setLayerZoomRange\", \"setLight\", \"setTransition\", \"setGeoJSONSourceData\", \"setTerrain\", \"setFog\", \"setProjection\"]),\n      Yt = e.pick(We, [\"setCenter\", \"setZoom\", \"setBearing\", \"setPitch\"]),\n      Kt = {\n        version: 8,\n        layers: [],\n        sources: {}\n      },\n      Jt = {\n        fill: !0,\n        line: !0,\n        background: !0,\n        hillshade: !0,\n        raster: !0\n      };\n    var Qt = /*#__PURE__*/function (_e$Evented10) {\n      _inherits(Qt, _e$Evented10);\n      function Qt(t) {\n        var _this95;\n        var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        _classCallCheck(this, Qt);\n        _this95 = _possibleConstructorReturn(this, _getPrototypeOf(Qt).call(this)), _this95.map = t, _this95.dispatcher = new z(je(), _assertThisInitialized(_assertThisInitialized(_this95))), _this95.imageManager = new y(), _this95.imageManager.setEventedParent(_assertThisInitialized(_assertThisInitialized(_this95))), _this95.glyphManager = new e.GlyphManager(t._requestManager, i.localFontFamily ? e.LocalGlyphMode.all : i.localIdeographFontFamily ? e.LocalGlyphMode.ideographs : e.LocalGlyphMode.none, i.localFontFamily || i.localIdeographFontFamily), _this95.crossTileSymbolIndex = new qt(), _this95._layers = {}, _this95._num3DLayers = 0, _this95._numSymbolLayers = 0, _this95._numCircleLayers = 0, _this95._serializedLayers = {}, _this95._sourceCaches = {}, _this95._otherSourceCaches = {}, _this95._symbolSourceCaches = {}, _this95._loaded = !1, _this95._availableImages = [], _this95._order = [], _this95._drapedFirstOrder = [], _this95._markersNeedUpdate = !1, _this95._resetUpdates(), _this95.dispatcher.broadcast(\"setReferrer\", e.getReferrer());\n        var o = _assertThisInitialized(_assertThisInitialized(_this95));\n        _this95._rtlTextPluginCallback = Qt.registerForPluginStateChange(function (t) {\n          o.dispatcher.broadcast(\"syncRTLPluginState\", {\n            pluginStatus: t.pluginStatus,\n            pluginURL: t.pluginURL\n          }, function (t, i) {\n            if (e.triggerPluginCompletionEvent(t), i && i.every(function (e) {\n              return e;\n            })) for (var _e332 in o._sourceCaches) {\n              var _t356 = o._sourceCaches[_e332],\n                _i214 = _t356.getSource().type;\n              \"vector\" !== _i214 && \"geojson\" !== _i214 || _t356.reload();\n            }\n          });\n        }), _this95.on(\"data\", function (e) {\n          if (\"source\" !== e.dataType || \"metadata\" !== e.sourceDataType) return;\n          var t = _this95.getSource(e.sourceId);\n          if (t && t.vectorLayerIds) for (var _e333 in _this95._layers) {\n            var _i215 = _this95._layers[_e333];\n            _i215.source === t.id && _this95._validateLayer(_i215);\n          }\n        });\n        return _this95;\n      }\n      _createClass(Qt, [{\n        key: \"loadURL\",\n        value: function loadURL(t) {\n          var _this96 = this;\n          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n          this.fire(new e.Event(\"dataloading\", {\n            dataType: \"style\"\n          }));\n          var o = \"boolean\" == typeof i.validate ? i.validate : !e.isMapboxURL(t);\n          t = this.map._requestManager.normalizeStyleURL(t, i.accessToken);\n          var r = this.map._requestManager.transformRequest(t, e.ResourceType.Style);\n          this._request = e.getJSON(r, function (t, i) {\n            _this96._request = null, t ? _this96.fire(new e.ErrorEvent(t)) : i && _this96._load(i, o);\n          });\n        }\n      }, {\n        key: \"loadJSON\",\n        value: function loadJSON(t) {\n          var _this97 = this;\n          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n          this.fire(new e.Event(\"dataloading\", {\n            dataType: \"style\"\n          })), this._request = e.exported.frame(function () {\n            _this97._request = null, _this97._load(t, !1 !== i.validate);\n          });\n        }\n      }, {\n        key: \"loadEmpty\",\n        value: function loadEmpty() {\n          this.fire(new e.Event(\"dataloading\", {\n            dataType: \"style\"\n          })), this._load(Kt, !1);\n        }\n      }, {\n        key: \"_updateLayerCount\",\n        value: function _updateLayerCount(e, t) {\n          var i = t ? 1 : -1;\n          e.is3D() && (this._num3DLayers += i), \"circle\" === e.type && (this._numCircleLayers += i), \"symbol\" === e.type && (this._numSymbolLayers += i);\n        }\n      }, {\n        key: \"_load\",\n        value: function _load(t, i) {\n          if (i && $t(this, e.validateStyle(t))) return;\n          this._loaded = !0, this.stylesheet = e.clone$1(t), this._updateMapProjection();\n          for (var _e334 in t.sources) this.addSource(_e334, t.sources[_e334], {\n            validate: !1\n          });\n          this._changed = !1, t.sprite ? this._loadSprite(t.sprite) : (this.imageManager.setLoaded(!0), this.dispatcher.broadcast(\"spriteLoaded\", !0)), this.glyphManager.setURL(t.glyphs);\n          var o = Ve(this.stylesheet.layers);\n          this._order = o.map(function (e) {\n            return e.id;\n          }), this._layers = {}, this._serializedLayers = {};\n          var _iterator211 = _createForOfIteratorHelper(o),\n            _step211;\n          try {\n            for (_iterator211.s(); !(_step211 = _iterator211.n()).done;) {\n              var _t357 = _step211.value;\n              var _i216 = e.createStyleLayer(_t357);\n              _i216.setEventedParent(this, {\n                layer: {\n                  id: _i216.id\n                }\n              }), this._layers[_i216.id] = _i216, this._serializedLayers[_i216.id] = _i216.serialize(), this._updateLayerCount(_i216, !0);\n            }\n          } catch (err) {\n            _iterator211.e(err);\n          } finally {\n            _iterator211.f();\n          }\n          this.dispatcher.broadcast(\"setLayers\", this._serializeLayers(this._order)), this.light = new T(this.stylesheet.light), this.stylesheet.terrain && !this.terrainSetForDrapingOnly() && this._createTerrain(this.stylesheet.terrain, 1), this.stylesheet.fog && this._createFog(this.stylesheet.fog), this._updateDrapeFirstLayers(), this.fire(new e.Event(\"data\", {\n            dataType: \"style\"\n          })), this.fire(new e.Event(\"style.load\"));\n        }\n      }, {\n        key: \"terrainSetForDrapingOnly\",\n        value: function terrainSetForDrapingOnly() {\n          return !!this.terrain && 0 === this.terrain.drapeRenderMode;\n        }\n      }, {\n        key: \"setProjection\",\n        value: function setProjection(e) {\n          e ? this.stylesheet.projection = e : delete this.stylesheet.projection, this._updateMapProjection();\n        }\n      }, {\n        key: \"applyProjectionUpdate\",\n        value: function applyProjectionUpdate() {\n          this._loaded && (this.dispatcher.broadcast(\"setProjection\", this.map.transform.projectionOptions), this.map.transform.projection.requiresDraping ? this.getTerrain() || this.stylesheet.terrain || this.setTerrainForDraping() : this.terrainSetForDrapingOnly() && this.setTerrain(null));\n        }\n      }, {\n        key: \"_updateMapProjection\",\n        value: function _updateMapProjection() {\n          this.map._useExplicitProjection ? this.applyProjectionUpdate() : this.map._prioritizeAndUpdateProjection(null, this.stylesheet.projection);\n        }\n      }, {\n        key: \"_loadSprite\",\n        value: function _loadSprite(t) {\n          var _this98 = this;\n          this._spriteRequest = function (t, i, o) {\n            var r, n, s;\n            var a = e.exported.devicePixelRatio > 1 ? \"@2x\" : \"\";\n            var l = e.getJSON(i.transformRequest(i.normalizeSpriteURL(t, a, \".json\"), e.ResourceType.SpriteJSON), function (e, t) {\n                l = null, s || (s = e, r = t, h());\n              }),\n              c = e.getImage(i.transformRequest(i.normalizeSpriteURL(t, a, \".png\"), e.ResourceType.SpriteImage), function (e, t) {\n                c = null, s || (s = e, n = t, h());\n              });\n            function h() {\n              if (s) o(s);else if (r && n) {\n                var _t358 = e.exported.getImageData(n),\n                  _i217 = {};\n                for (var _o117 in r) {\n                  var _r$_o = r[_o117],\n                    _n176 = _r$_o.width,\n                    _s138 = _r$_o.height,\n                    _a116 = _r$_o.x,\n                    _l71 = _r$_o.y,\n                    _c52 = _r$_o.sdf,\n                    _h41 = _r$_o.pixelRatio,\n                    _u58 = _r$_o.stretchX,\n                    _14 = _r$_o.stretchY,\n                    _d21 = _r$_o.content,\n                    _p35 = new e.RGBAImage({\n                      width: _n176,\n                      height: _s138\n                    });\n                  e.RGBAImage.copy(_t358, _p35, {\n                    x: _a116,\n                    y: _l71\n                  }, {\n                    x: 0,\n                    y: 0\n                  }, {\n                    width: _n176,\n                    height: _s138\n                  }), _i217[_o117] = {\n                    data: _p35,\n                    pixelRatio: _h41,\n                    sdf: _c52,\n                    stretchX: _u58,\n                    stretchY: _14,\n                    content: _d21\n                  };\n                }\n                o(null, _i217);\n              }\n            }\n            return {\n              cancel: function cancel() {\n                l && (l.cancel(), l = null), c && (c.cancel(), c = null);\n              }\n            };\n          }(t, this.map._requestManager, function (t, i) {\n            if (_this98._spriteRequest = null, t) _this98.fire(new e.ErrorEvent(t));else if (i) for (var _e335 in i) _this98.imageManager.addImage(_e335, i[_e335]);\n            _this98.imageManager.setLoaded(!0), _this98._availableImages = _this98.imageManager.listImages(), _this98.dispatcher.broadcast(\"setImages\", _this98._availableImages), _this98.dispatcher.broadcast(\"spriteLoaded\", !0), _this98.fire(new e.Event(\"data\", {\n              dataType: \"style\"\n            }));\n          });\n        }\n      }, {\n        key: \"_validateLayer\",\n        value: function _validateLayer(t) {\n          var i = this.getSource(t.source);\n          if (!i) return;\n          var o = t.sourceLayer;\n          o && (\"geojson\" === i.type || i.vectorLayerIds && -1 === i.vectorLayerIds.indexOf(o)) && this.fire(new e.ErrorEvent(new Error(\"Source layer \\\"\".concat(o, \"\\\" does not exist on source \\\"\").concat(i.id, \"\\\" as specified by style layer \\\"\").concat(t.id, \"\\\"\"))));\n        }\n      }, {\n        key: \"loaded\",\n        value: function loaded() {\n          if (!this._loaded) return !1;\n          if (Object.keys(this._updatedSources).length) return !1;\n          for (var _e336 in this._sourceCaches) if (!this._sourceCaches[_e336].loaded()) return !1;\n          return !!this.imageManager.isLoaded();\n        }\n      }, {\n        key: \"_serializeLayers\",\n        value: function _serializeLayers(e) {\n          var t = [];\n          var _iterator212 = _createForOfIteratorHelper(e),\n            _step212;\n          try {\n            for (_iterator212.s(); !(_step212 = _iterator212.n()).done;) {\n              var _i218 = _step212.value;\n              var _e337 = this._layers[_i218];\n              \"custom\" !== _e337.type && t.push(_e337.serialize());\n            }\n          } catch (err) {\n            _iterator212.e(err);\n          } finally {\n            _iterator212.f();\n          }\n          return t;\n        }\n      }, {\n        key: \"hasTransitions\",\n        value: function hasTransitions() {\n          if (this.light && this.light.hasTransition()) return !0;\n          if (this.fog && this.fog.hasTransition()) return !0;\n          for (var _e338 in this._sourceCaches) if (this._sourceCaches[_e338].hasTransition()) return !0;\n          for (var _e339 in this._layers) if (this._layers[_e339].hasTransition()) return !0;\n          return !1;\n        }\n      }, {\n        key: \"isLayerDraped\",\n        value: function isLayerDraped(e) {\n          return !!this.terrain && (\"function\" == typeof e.isLayerDraped ? e.isLayerDraped() : Jt[e.type]);\n        }\n      }, {\n        key: \"_checkLoaded\",\n        value: function _checkLoaded() {\n          if (!this._loaded) throw new Error(\"Style is not done loading\");\n        }\n      }, {\n        key: \"update\",\n        value: function update(t) {\n          if (!this._loaded) return;\n          var i = this._changed;\n          if (this._changed) {\n            var _e340 = Object.keys(this._updatedLayers),\n              _i219 = Object.keys(this._removedLayers);\n            (_e340.length || _i219.length) && this._updateWorkerLayers(_e340, _i219);\n            for (var _e341 in this._updatedSources) {\n              var _t359 = this._updatedSources[_e341];\n              \"reload\" === _t359 ? this._reloadSource(_e341) : \"clear\" === _t359 && this._clearSource(_e341);\n            }\n            this._updateTilesForChangedImages();\n            for (var _e342 in this._updatedPaintProps) this._layers[_e342].updateTransitions(t);\n            this.light.updateTransitions(t), this.fog && this.fog.updateTransitions(t), this._resetUpdates();\n          }\n          var o = {};\n          for (var _e343 in this._sourceCaches) {\n            var _t360 = this._sourceCaches[_e343];\n            o[_e343] = _t360.used, _t360.used = !1;\n          }\n          var _iterator213 = _createForOfIteratorHelper(this._order),\n            _step213;\n          try {\n            for (_iterator213.s(); !(_step213 = _iterator213.n()).done;) {\n              var _e344 = _step213.value;\n              var _i221 = this._layers[_e344];\n              if (_i221.recalculate(t, this._availableImages), !_i221.isHidden(t.zoom)) {\n                var _e345 = this._getLayerSourceCache(_i221);\n                _e345 && (_e345.used = !0);\n              }\n              var _o118 = this.map.painter;\n              if (_o118) {\n                var _e346 = _i221.getProgramIds();\n                if (!_e346) continue;\n                var _r254 = _i221.getProgramConfiguration(t.zoom);\n                var _iterator214 = _createForOfIteratorHelper(_e346),\n                  _step214;\n                try {\n                  for (_iterator214.s(); !(_step214 = _iterator214.n()).done;) {\n                    var _t362 = _step214.value;\n                    _o118.useProgram(_t362, _r254);\n                  }\n                } catch (err) {\n                  _iterator214.e(err);\n                } finally {\n                  _iterator214.f();\n                }\n              }\n            }\n          } catch (err) {\n            _iterator213.e(err);\n          } finally {\n            _iterator213.f();\n          }\n          for (var _t361 in o) {\n            var _i220 = this._sourceCaches[_t361];\n            o[_t361] !== _i220.used && _i220.getSource().fire(new e.Event(\"data\", {\n              sourceDataType: \"visibility\",\n              dataType: \"source\",\n              sourceId: _i220.getSource().id\n            }));\n          }\n          this.light.recalculate(t), this.terrain && this.terrain.recalculate(t), this.fog && this.fog.recalculate(t), this.z = t.zoom, this._markersNeedUpdate && (this._updateMarkersOpacity(), this._markersNeedUpdate = !1), i && this.fire(new e.Event(\"data\", {\n            dataType: \"style\"\n          }));\n        }\n      }, {\n        key: \"_updateTilesForChangedImages\",\n        value: function _updateTilesForChangedImages() {\n          var e = Object.keys(this._changedImages);\n          if (e.length) {\n            for (var _t363 in this._sourceCaches) this._sourceCaches[_t363].reloadTilesForDependencies([\"icons\", \"patterns\"], e);\n            this._changedImages = {};\n          }\n        }\n      }, {\n        key: \"_updateWorkerLayers\",\n        value: function _updateWorkerLayers(e, t) {\n          this.dispatcher.broadcast(\"updateLayers\", {\n            layers: this._serializeLayers(e),\n            removedIds: t\n          });\n        }\n      }, {\n        key: \"_resetUpdates\",\n        value: function _resetUpdates() {\n          this._changed = !1, this._updatedLayers = {}, this._removedLayers = {}, this._updatedSources = {}, this._updatedPaintProps = {}, this._changedImages = {};\n        }\n      }, {\n        key: \"setState\",\n        value: function setState(i) {\n          var _this99 = this;\n          if (this._checkLoaded(), $t(this, e.validateStyle(i))) return !1;\n          (i = e.clone$1(i)).layers = Ve(i.layers);\n          var o = function (e, i) {\n            if (!e) return [{\n              command: We.setStyle,\n              args: [i]\n            }];\n            var o = [];\n            try {\n              if (!t(e.version, i.version)) return [{\n                command: We.setStyle,\n                args: [i]\n              }];\n              t(e.center, i.center) || o.push({\n                command: We.setCenter,\n                args: [i.center]\n              }), t(e.zoom, i.zoom) || o.push({\n                command: We.setZoom,\n                args: [i.zoom]\n              }), t(e.bearing, i.bearing) || o.push({\n                command: We.setBearing,\n                args: [i.bearing]\n              }), t(e.pitch, i.pitch) || o.push({\n                command: We.setPitch,\n                args: [i.pitch]\n              }), t(e.sprite, i.sprite) || o.push({\n                command: We.setSprite,\n                args: [i.sprite]\n              }), t(e.glyphs, i.glyphs) || o.push({\n                command: We.setGlyphs,\n                args: [i.glyphs]\n              }), t(e.transition, i.transition) || o.push({\n                command: We.setTransition,\n                args: [i.transition]\n              }), t(e.light, i.light) || o.push({\n                command: We.setLight,\n                args: [i.light]\n              }), t(e.fog, i.fog) || o.push({\n                command: We.setFog,\n                args: [i.fog]\n              }), t(e.projection, i.projection) || o.push({\n                command: We.setProjection,\n                args: [i.projection]\n              });\n              var _r255 = {},\n                _n177 = [];\n              !function (e, i, o, r) {\n                var n;\n                for (n in i = i || {}, e = e || {}) e.hasOwnProperty(n) && (i.hasOwnProperty(n) || qe(n, o, r));\n                for (n in i) {\n                  if (!i.hasOwnProperty(n)) continue;\n                  var _s139 = i[n];\n                  e.hasOwnProperty(n) ? t(e[n], _s139) || (\"geojson\" === e[n].type && \"geojson\" === _s139.type && He(e, i, n) ? o.push({\n                    command: We.setGeoJSONSourceData,\n                    args: [n, _s139.data]\n                  }) : $e(n, i, o, r)) : Xe(n, i, o);\n                }\n              }(e.sources, i.sources, _n177, _r255);\n              var _s140 = [];\n              e.layers && e.layers.forEach(function (e) {\n                e.source && _r255[e.source] ? o.push({\n                  command: We.removeLayer,\n                  args: [e.id]\n                }) : _s140.push(e);\n              });\n              var _a117 = e.terrain;\n              _a117 && _r255[_a117.source] && (o.push({\n                command: We.setTerrain,\n                args: [void 0]\n              }), _a117 = void 0), o = o.concat(_n177), t(_a117, i.terrain) || o.push({\n                command: We.setTerrain,\n                args: [i.terrain]\n              }), function (e, i, o) {\n                i = i || [];\n                var r = (e = e || []).map(Ke),\n                  n = i.map(Ke),\n                  s = e.reduce(Je, {}),\n                  a = i.reduce(Je, {}),\n                  l = r.slice(),\n                  c = Object.create(null);\n                var h, u, _, d, p, m, f;\n                for (h = 0, u = 0; h < r.length; h++) _ = r[h], a.hasOwnProperty(_) ? u++ : (o.push({\n                  command: We.removeLayer,\n                  args: [_]\n                }), l.splice(l.indexOf(_, u), 1));\n                for (h = 0, u = 0; h < n.length; h++) _ = n[n.length - 1 - h], l[l.length - 1 - h] !== _ && (s.hasOwnProperty(_) ? (o.push({\n                  command: We.removeLayer,\n                  args: [_]\n                }), l.splice(l.lastIndexOf(_, l.length - u), 1)) : u++, m = l[l.length - h], o.push({\n                  command: We.addLayer,\n                  args: [a[_], m]\n                }), l.splice(l.length - h, 0, _), c[_] = !0);\n                for (h = 0; h < n.length; h++) if (_ = n[h], d = s[_], p = a[_], !c[_] && !t(d, p)) if (t(d.source, p.source) && t(d[\"source-layer\"], p[\"source-layer\"]) && t(d.type, p.type)) {\n                  for (f in Ye(d.layout, p.layout, o, _, null, We.setLayoutProperty), Ye(d.paint, p.paint, o, _, null, We.setPaintProperty), t(d.filter, p.filter) || o.push({\n                    command: We.setFilter,\n                    args: [_, p.filter]\n                  }), t(d.minzoom, p.minzoom) && t(d.maxzoom, p.maxzoom) || o.push({\n                    command: We.setLayerZoomRange,\n                    args: [_, p.minzoom, p.maxzoom]\n                  }), d) d.hasOwnProperty(f) && \"layout\" !== f && \"paint\" !== f && \"filter\" !== f && \"metadata\" !== f && \"minzoom\" !== f && \"maxzoom\" !== f && (0 === f.indexOf(\"paint.\") ? Ye(d[f], p[f], o, _, f.slice(6), We.setPaintProperty) : t(d[f], p[f]) || o.push({\n                    command: We.setLayerProperty,\n                    args: [_, f, p[f]]\n                  }));\n                  for (f in p) p.hasOwnProperty(f) && !d.hasOwnProperty(f) && \"layout\" !== f && \"paint\" !== f && \"filter\" !== f && \"metadata\" !== f && \"minzoom\" !== f && \"maxzoom\" !== f && (0 === f.indexOf(\"paint.\") ? Ye(d[f], p[f], o, _, f.slice(6), We.setPaintProperty) : t(d[f], p[f]) || o.push({\n                    command: We.setLayerProperty,\n                    args: [_, f, p[f]]\n                  }));\n                } else o.push({\n                  command: We.removeLayer,\n                  args: [_]\n                }), m = l[l.lastIndexOf(_) + 1], o.push({\n                  command: We.addLayer,\n                  args: [p, m]\n                });\n              }(_s140, i.layers, o);\n            } catch (e) {\n              console.warn(\"Unable to compute style diff:\", e), o = [{\n                command: We.setStyle,\n                args: [i]\n              }];\n            }\n            return o;\n          }(this.serialize(), i).filter(function (e) {\n            return !(e.command in Yt);\n          });\n          if (0 === o.length) return !1;\n          var r = o.filter(function (e) {\n            return !(e.command in Ht);\n          });\n          if (r.length > 0) throw new Error(\"Unimplemented: \".concat(r.map(function (e) {\n            return e.command;\n          }).join(\", \"), \".\"));\n          return o.forEach(function (e) {\n            \"setTransition\" !== e.command && \"setProjection\" !== e.command && _this99[e.command].apply(_this99, e.args);\n          }), this.stylesheet = i, this._updateMapProjection(), !0;\n        }\n      }, {\n        key: \"addImage\",\n        value: function addImage(t, i) {\n          return this.getImage(t) ? this.fire(new e.ErrorEvent(new Error(\"An image with this name already exists.\"))) : (this.imageManager.addImage(t, i), this._afterImageUpdated(t), this);\n        }\n      }, {\n        key: \"updateImage\",\n        value: function updateImage(e, t) {\n          this.imageManager.updateImage(e, t);\n        }\n      }, {\n        key: \"getImage\",\n        value: function getImage(e) {\n          return this.imageManager.getImage(e);\n        }\n      }, {\n        key: \"removeImage\",\n        value: function removeImage(t) {\n          return this.getImage(t) ? (this.imageManager.removeImage(t), this._afterImageUpdated(t), this) : this.fire(new e.ErrorEvent(new Error(\"No image with this name exists.\")));\n        }\n      }, {\n        key: \"_afterImageUpdated\",\n        value: function _afterImageUpdated(t) {\n          this._availableImages = this.imageManager.listImages(), this._changedImages[t] = !0, this._changed = !0, this.dispatcher.broadcast(\"setImages\", this._availableImages), this.fire(new e.Event(\"data\", {\n            dataType: \"style\"\n          }));\n        }\n      }, {\n        key: \"listImages\",\n        value: function listImages() {\n          return this._checkLoaded(), this._availableImages.slice();\n        }\n      }, {\n        key: \"addSource\",\n        value: function addSource(t, i) {\n          var _this100 = this;\n          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          if (this._checkLoaded(), void 0 !== this.getSource(t)) throw new Error(\"There is already a source with this ID\");\n          if (!i.type) throw new Error(\"The type property must be defined, but only the following properties were given: \".concat(Object.keys(i).join(\", \"), \".\"));\n          if ([\"vector\", \"raster\", \"geojson\", \"video\", \"image\"].indexOf(i.type) >= 0 && this._validate(e.validateSource, \"sources.\".concat(t), i, null, o)) return;\n          this.map && this.map._collectResourceTiming && (i.collectResourceTiming = !0);\n          var r = Pe(t, i, this.dispatcher, this);\n          r.setEventedParent(this, function () {\n            return {\n              isSourceLoaded: _this100._isSourceCacheLoaded(t),\n              source: r.serialize(),\n              sourceId: t\n            };\n          });\n          var n = function n(i) {\n            var o = (i ? \"symbol:\" : \"other:\") + t,\n              n = _this100._sourceCaches[o] = new e.SourceCache(o, r, i);\n            (i ? _this100._symbolSourceCaches : _this100._otherSourceCaches)[t] = n, n.style = _this100, n.onAdd(_this100.map);\n          };\n          n(!1), \"vector\" !== i.type && \"geojson\" !== i.type || n(!0), r.onAdd && r.onAdd(this.map), this._changed = !0;\n        }\n      }, {\n        key: \"removeSource\",\n        value: function removeSource(t) {\n          this._checkLoaded();\n          var i = this.getSource(t);\n          if (!i) throw new Error(\"There is no source with this ID\");\n          for (var _i222 in this._layers) if (this._layers[_i222].source === t) return this.fire(new e.ErrorEvent(new Error(\"Source \\\"\".concat(t, \"\\\" cannot be removed while layer \\\"\").concat(_i222, \"\\\" is using it.\"))));\n          if (this.terrain && this.terrain.get().source === t) return this.fire(new e.ErrorEvent(new Error(\"Source \\\"\".concat(t, \"\\\" cannot be removed while terrain is using it.\"))));\n          var o = this._getSourceCaches(t);\n          var _iterator215 = _createForOfIteratorHelper(o),\n            _step215;\n          try {\n            for (_iterator215.s(); !(_step215 = _iterator215.n()).done;) {\n              var _t364 = _step215.value;\n              delete this._sourceCaches[_t364.id], delete this._updatedSources[_t364.id], _t364.fire(new e.Event(\"data\", {\n                sourceDataType: \"metadata\",\n                dataType: \"source\",\n                sourceId: _t364.getSource().id\n              })), _t364.setEventedParent(null), _t364.clearTiles();\n            }\n          } catch (err) {\n            _iterator215.e(err);\n          } finally {\n            _iterator215.f();\n          }\n          return delete this._otherSourceCaches[t], delete this._symbolSourceCaches[t], i.setEventedParent(null), i.onRemove && i.onRemove(this.map), this._changed = !0, this;\n        }\n      }, {\n        key: \"setGeoJSONSourceData\",\n        value: function setGeoJSONSourceData(e, t) {\n          this._checkLoaded(), this.getSource(e).setData(t), this._changed = !0;\n        }\n      }, {\n        key: \"getSource\",\n        value: function getSource(e) {\n          var t = this._getSourceCache(e);\n          return t && t.getSource();\n        }\n      }, {\n        key: \"_getSources\",\n        value: function _getSources() {\n          var e = [];\n          for (var _t365 in this._otherSourceCaches) {\n            var _i223 = this._getSourceCache(_t365);\n            _i223 && e.push(_i223.getSource());\n          }\n          return e;\n        }\n      }, {\n        key: \"addLayer\",\n        value: function addLayer(t, i) {\n          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          this._checkLoaded();\n          var r = t.id;\n          if (this.getLayer(r)) return void this.fire(new e.ErrorEvent(new Error(\"Layer with id \\\"\".concat(r, \"\\\" already exists on this map\"))));\n          var n;\n          if (\"custom\" === t.type) {\n            if ($t(this, e.validateCustomStyleLayer(t))) return;\n            n = e.createStyleLayer(t);\n          } else {\n            if (\"object\" == typeof t.source && (this.addSource(r, t.source), t = e.clone$1(t), t = e.extend(t, {\n              source: r\n            })), this._validate(e.validateLayer, \"layers.\".concat(r), t, {\n              arrayIndex: -1\n            }, o)) return;\n            n = e.createStyleLayer(t), this._validateLayer(n), n.setEventedParent(this, {\n              layer: {\n                id: r\n              }\n            }), this._serializedLayers[n.id] = n.serialize(), this._updateLayerCount(n, !0);\n          }\n          var s = i ? this._order.indexOf(i) : this._order.length;\n          if (i && -1 === s) return void this.fire(new e.ErrorEvent(new Error(\"Layer with id \\\"\".concat(i, \"\\\" does not exist on this map.\"))));\n          this._order.splice(s, 0, r), this._layerOrderChanged = !0, this._layers[r] = n;\n          var a = this._getLayerSourceCache(n);\n          if (this._removedLayers[r] && n.source && a && \"custom\" !== n.type) {\n            var _e347 = this._removedLayers[r];\n            delete this._removedLayers[r], _e347.type !== n.type ? this._updatedSources[n.source] = \"clear\" : (this._updatedSources[n.source] = \"reload\", a.pause());\n          }\n          this._updateLayer(n), n.onAdd && n.onAdd(this.map), this._updateDrapeFirstLayers();\n        }\n      }, {\n        key: \"moveLayer\",\n        value: function moveLayer(t, i) {\n          if (this._checkLoaded(), this._changed = !0, !this._layers[t]) return void this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(t, \"' does not exist in the map's style and cannot be moved.\"))));\n          if (t === i) return;\n          var o = this._order.indexOf(t);\n          this._order.splice(o, 1);\n          var r = i ? this._order.indexOf(i) : this._order.length;\n          i && -1 === r ? this.fire(new e.ErrorEvent(new Error(\"Layer with id \\\"\".concat(i, \"\\\" does not exist on this map.\")))) : (this._order.splice(r, 0, t), this._layerOrderChanged = !0, this._updateDrapeFirstLayers());\n        }\n      }, {\n        key: \"removeLayer\",\n        value: function removeLayer(t) {\n          this._checkLoaded();\n          var i = this._layers[t];\n          if (!i) return void this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(t, \"' does not exist in the map's style and cannot be removed.\"))));\n          i.setEventedParent(null), this._updateLayerCount(i, !1);\n          var o = this._order.indexOf(t);\n          this._order.splice(o, 1), this._layerOrderChanged = !0, this._changed = !0, this._removedLayers[t] = i, delete this._layers[t], delete this._serializedLayers[t], delete this._updatedLayers[t], delete this._updatedPaintProps[t], i.onRemove && i.onRemove(this.map), this._updateDrapeFirstLayers();\n        }\n      }, {\n        key: \"getLayer\",\n        value: function getLayer(e) {\n          return this._layers[e];\n        }\n      }, {\n        key: \"hasLayer\",\n        value: function hasLayer(e) {\n          return e in this._layers;\n        }\n      }, {\n        key: \"hasLayerType\",\n        value: function hasLayerType(e) {\n          for (var _t366 in this._layers) if (this._layers[_t366].type === e) return !0;\n          return !1;\n        }\n      }, {\n        key: \"setLayerZoomRange\",\n        value: function setLayerZoomRange(t, i, o) {\n          this._checkLoaded();\n          var r = this.getLayer(t);\n          r ? r.minzoom === i && r.maxzoom === o || (null != i && (r.minzoom = i), null != o && (r.maxzoom = o), this._updateLayer(r)) : this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(t, \"' does not exist in the map's style and cannot have zoom extent.\"))));\n        }\n      }, {\n        key: \"setFilter\",\n        value: function setFilter(i, o) {\n          var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          this._checkLoaded();\n          var n = this.getLayer(i);\n          if (n) {\n            if (!t(n.filter, o)) return null == o ? (n.filter = void 0, void this._updateLayer(n)) : void (this._validate(e.validateFilter, \"layers.\".concat(n.id, \".filter\"), o, {\n              layerType: n.type\n            }, r) || (n.filter = e.clone$1(o), this._updateLayer(n)));\n          } else this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(i, \"' does not exist in the map's style and cannot be filtered.\"))));\n        }\n      }, {\n        key: \"getFilter\",\n        value: function getFilter(t) {\n          var i = this.getLayer(t);\n          return i && e.clone$1(i.filter);\n        }\n      }, {\n        key: \"setLayoutProperty\",\n        value: function setLayoutProperty(i, o, r) {\n          var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n          this._checkLoaded();\n          var s = this.getLayer(i);\n          s ? t(s.getLayoutProperty(o), r) || (s.setLayoutProperty(o, r, n), this._updateLayer(s)) : this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(i, \"' does not exist in the map's style and cannot be styled.\"))));\n        }\n      }, {\n        key: \"getLayoutProperty\",\n        value: function getLayoutProperty(t, i) {\n          var o = this.getLayer(t);\n          if (o) return o.getLayoutProperty(i);\n          this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(t, \"' does not exist in the map's style.\"))));\n        }\n      }, {\n        key: \"setPaintProperty\",\n        value: function setPaintProperty(i, o, r) {\n          var n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n          this._checkLoaded();\n          var s = this.getLayer(i);\n          s ? t(s.getPaintProperty(o), r) || (s.setPaintProperty(o, r, n) && this._updateLayer(s), this._changed = !0, this._updatedPaintProps[i] = !0) : this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(i, \"' does not exist in the map's style and cannot be styled.\"))));\n        }\n      }, {\n        key: \"getPaintProperty\",\n        value: function getPaintProperty(e, t) {\n          var i = this.getLayer(e);\n          return i && i.getPaintProperty(t);\n        }\n      }, {\n        key: \"setFeatureState\",\n        value: function setFeatureState(t, i) {\n          this._checkLoaded();\n          var o = t.source,\n            r = t.sourceLayer,\n            n = this.getSource(o);\n          if (!n) return void this.fire(new e.ErrorEvent(new Error(\"The source '\".concat(o, \"' does not exist in the map's style.\"))));\n          var s = n.type;\n          if (\"geojson\" === s && r) return void this.fire(new e.ErrorEvent(new Error(\"GeoJSON sources cannot have a sourceLayer parameter.\")));\n          if (\"vector\" === s && !r) return void this.fire(new e.ErrorEvent(new Error(\"The sourceLayer parameter must be provided for vector source types.\")));\n          void 0 === t.id && this.fire(new e.ErrorEvent(new Error(\"The feature id parameter must be provided.\")));\n          var a = this._getSourceCaches(o);\n          var _iterator216 = _createForOfIteratorHelper(a),\n            _step216;\n          try {\n            for (_iterator216.s(); !(_step216 = _iterator216.n()).done;) {\n              var _e348 = _step216.value;\n              _e348.setFeatureState(r, t.id, i);\n            }\n          } catch (err) {\n            _iterator216.e(err);\n          } finally {\n            _iterator216.f();\n          }\n        }\n      }, {\n        key: \"removeFeatureState\",\n        value: function removeFeatureState(t, i) {\n          this._checkLoaded();\n          var o = t.source,\n            r = this.getSource(o);\n          if (!r) return void this.fire(new e.ErrorEvent(new Error(\"The source '\".concat(o, \"' does not exist in the map's style.\"))));\n          var n = r.type,\n            s = \"vector\" === n ? t.sourceLayer : void 0;\n          if (\"vector\" === n && !s) return void this.fire(new e.ErrorEvent(new Error(\"The sourceLayer parameter must be provided for vector source types.\")));\n          if (i && \"string\" != typeof t.id && \"number\" != typeof t.id) return void this.fire(new e.ErrorEvent(new Error(\"A feature id is required to remove its specific state property.\")));\n          var a = this._getSourceCaches(o);\n          var _iterator217 = _createForOfIteratorHelper(a),\n            _step217;\n          try {\n            for (_iterator217.s(); !(_step217 = _iterator217.n()).done;) {\n              var _e349 = _step217.value;\n              _e349.removeFeatureState(s, t.id, i);\n            }\n          } catch (err) {\n            _iterator217.e(err);\n          } finally {\n            _iterator217.f();\n          }\n        }\n      }, {\n        key: \"getFeatureState\",\n        value: function getFeatureState(t) {\n          this._checkLoaded();\n          var i = t.source,\n            o = t.sourceLayer,\n            r = this.getSource(i);\n          if (r) {\n            if (\"vector\" !== r.type || o) return void 0 === t.id && this.fire(new e.ErrorEvent(new Error(\"The feature id parameter must be provided.\"))), this._getSourceCaches(i)[0].getFeatureState(o, t.id);\n            this.fire(new e.ErrorEvent(new Error(\"The sourceLayer parameter must be provided for vector source types.\")));\n          } else this.fire(new e.ErrorEvent(new Error(\"The source '\".concat(i, \"' does not exist in the map's style.\"))));\n        }\n      }, {\n        key: \"getTransition\",\n        value: function getTransition() {\n          return e.extend({\n            duration: 300,\n            delay: 0\n          }, this.stylesheet && this.stylesheet.transition);\n        }\n      }, {\n        key: \"serialize\",\n        value: function serialize() {\n          var t = {};\n          for (var _e350 in this._sourceCaches) {\n            var _i224 = this._sourceCaches[_e350].getSource();\n            t[_i224.id] || (t[_i224.id] = _i224.serialize());\n          }\n          return e.filterObject({\n            version: this.stylesheet.version,\n            name: this.stylesheet.name,\n            metadata: this.stylesheet.metadata,\n            light: this.stylesheet.light,\n            terrain: this.getTerrain() || void 0,\n            fog: this.stylesheet.fog,\n            center: this.stylesheet.center,\n            zoom: this.stylesheet.zoom,\n            bearing: this.stylesheet.bearing,\n            pitch: this.stylesheet.pitch,\n            sprite: this.stylesheet.sprite,\n            glyphs: this.stylesheet.glyphs,\n            transition: this.stylesheet.transition,\n            projection: this.stylesheet.projection,\n            sources: t,\n            layers: this._serializeLayers(this._order)\n          }, function (e) {\n            return void 0 !== e;\n          });\n        }\n      }, {\n        key: \"_updateLayer\",\n        value: function _updateLayer(e) {\n          this._updatedLayers[e.id] = !0;\n          var t = this._getLayerSourceCache(e);\n          e.source && !this._updatedSources[e.source] && t && \"raster\" !== t.getSource().type && (this._updatedSources[e.source] = \"reload\", t.pause()), this._changed = !0, e.invalidateCompiledFilter();\n        }\n      }, {\n        key: \"_flattenAndSortRenderedFeatures\",\n        value: function _flattenAndSortRenderedFeatures(e) {\n          var _this101 = this;\n          var t = function t(e) {\n              return \"fill-extrusion\" === _this101._layers[e].type;\n            },\n            i = {},\n            o = [];\n          for (var _r256 = this._order.length - 1; _r256 >= 0; _r256--) {\n            var _n178 = this._order[_r256];\n            if (t(_n178)) {\n              i[_n178] = _r256;\n              var _iterator218 = _createForOfIteratorHelper(e),\n                _step218;\n              try {\n                for (_iterator218.s(); !(_step218 = _iterator218.n()).done;) {\n                  var _t367 = _step218.value;\n                  var _e351 = _t367[_n178];\n                  if (_e351) {\n                    var _iterator219 = _createForOfIteratorHelper(_e351),\n                      _step219;\n                    try {\n                      for (_iterator219.s(); !(_step219 = _iterator219.n()).done;) {\n                        var _t368 = _step219.value;\n                        o.push(_t368);\n                      }\n                    } catch (err) {\n                      _iterator219.e(err);\n                    } finally {\n                      _iterator219.f();\n                    }\n                  }\n                }\n              } catch (err) {\n                _iterator218.e(err);\n              } finally {\n                _iterator218.f();\n              }\n            }\n          }\n          o.sort(function (e, t) {\n            return t.intersectionZ - e.intersectionZ;\n          });\n          var r = [];\n          for (var _n179 = this._order.length - 1; _n179 >= 0; _n179--) {\n            var _s141 = this._order[_n179];\n            if (t(_s141)) for (var _e352 = o.length - 1; _e352 >= 0; _e352--) {\n              var _t369 = o[_e352].feature;\n              if (i[_t369.layer.id] < _n179) break;\n              r.push(_t369), o.pop();\n            } else {\n              var _iterator220 = _createForOfIteratorHelper(e),\n                _step220;\n              try {\n                for (_iterator220.s(); !(_step220 = _iterator220.n()).done;) {\n                  var _t370 = _step220.value;\n                  var _e353 = _t370[_s141];\n                  if (_e353) {\n                    var _iterator221 = _createForOfIteratorHelper(_e353),\n                      _step221;\n                    try {\n                      for (_iterator221.s(); !(_step221 = _iterator221.n()).done;) {\n                        var _t371 = _step221.value;\n                        r.push(_t371.feature);\n                      }\n                    } catch (err) {\n                      _iterator221.e(err);\n                    } finally {\n                      _iterator221.f();\n                    }\n                  }\n                }\n              } catch (err) {\n                _iterator220.e(err);\n              } finally {\n                _iterator220.f();\n              }\n            }\n          }\n          return r;\n        }\n      }, {\n        key: \"queryRenderedFeatures\",\n        value: function queryRenderedFeatures(t, i, o) {\n          var _this102 = this;\n          i && i.filter && this._validate(e.validateFilter, \"queryRenderedFeatures.filter\", i.filter, null, i);\n          var r = {};\n          if (i && i.layers) {\n            if (!Array.isArray(i.layers)) return this.fire(new e.ErrorEvent(new Error(\"parameters.layers must be an Array.\"))), [];\n            var _iterator222 = _createForOfIteratorHelper(i.layers),\n              _step222;\n            try {\n              for (_iterator222.s(); !(_step222 = _iterator222.n()).done;) {\n                var _t372 = _step222.value;\n                var _i225 = this._layers[_t372];\n                if (!_i225) return this.fire(new e.ErrorEvent(new Error(\"The layer '\".concat(_t372, \"' does not exist in the map's style and cannot be queried for features.\")))), [];\n                r[_i225.source] = !0;\n              }\n            } catch (err) {\n              _iterator222.e(err);\n            } finally {\n              _iterator222.f();\n            }\n          }\n          var n = [];\n          i.availableImages = this._availableImages;\n          var s = i && i.layers ? i.layers.some(function (e) {\n              var t = _this102.getLayer(e);\n              return t && t.is3D();\n            }) : this.has3DLayers(),\n            a = R.createFromScreenPoints(t, o);\n          for (var _e354 in this._sourceCaches) {\n            var _t373 = this._sourceCaches[_e354].getSource().id;\n            i.layers && !r[_t373] || n.push(Oe(this._sourceCaches[_e354], this._layers, this._serializedLayers, a, i, o, s, !!this.map._showQueryGeometry));\n          }\n          return this.placement && n.push(function (e, t, i, o, r, n, s) {\n            var a = {},\n              l = n.queryRenderedSymbols(o),\n              c = [];\n            var _iterator223 = _createForOfIteratorHelper(Object.keys(l).map(Number)),\n              _step223;\n            try {\n              for (_iterator223.s(); !(_step223 = _iterator223.n()).done;) {\n                var _e357 = _step223.value;\n                c.push(s[_e357]);\n              }\n            } catch (err) {\n              _iterator223.e(err);\n            } finally {\n              _iterator223.f();\n            }\n            c.sort(ke);\n            var _loop9 = function _loop9() {\n              var i = _c53[_i226];\n              var o = i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId], t, i.bucketIndex, i.sourceLayerIndex, r.filter, r.layers, r.availableImages, e);\n              for (var _e355 in o) {\n                var _t374 = a[_e355] = a[_e355] || [],\n                  _r257 = o[_e355];\n                _r257.sort(function (e, t) {\n                  var o = i.featureSortOrder;\n                  if (o) {\n                    var _i227 = o.indexOf(e.featureIndex);\n                    return o.indexOf(t.featureIndex) - _i227;\n                  }\n                  return t.featureIndex - e.featureIndex;\n                });\n                var _iterator224 = _createForOfIteratorHelper(_r257),\n                  _step224;\n                try {\n                  for (_iterator224.s(); !(_step224 = _iterator224.n()).done;) {\n                    var _e356 = _step224.value;\n                    _t374.push(_e356);\n                  }\n                } catch (err) {\n                  _iterator224.e(err);\n                } finally {\n                  _iterator224.f();\n                }\n              }\n            };\n            for (var _i226 = 0, _c53 = c; _i226 < _c53.length; _i226++) {\n              _loop9();\n            }\n            var _loop10 = function _loop10(_t375) {\n              a[_t375].forEach(function (o) {\n                var r = o.feature,\n                  n = i(e[_t375]);\n                if (!n) return;\n                var s = n.getFeatureState(r.layer[\"source-layer\"], r.id);\n                r.source = r.layer.source, r.layer[\"source-layer\"] && (r.sourceLayer = r.layer[\"source-layer\"]), r.state = s;\n              });\n            };\n            for (var _t375 in a) {\n              _loop10(_t375);\n            }\n            return a;\n          }(this._layers, this._serializedLayers, this._getLayerSourceCache.bind(this), a.screenGeometry, i, this.placement.collisionIndex, this.placement.retainedQueryData)), this._flattenAndSortRenderedFeatures(n);\n        }\n      }, {\n        key: \"querySourceFeatures\",\n        value: function querySourceFeatures(t, i) {\n          i && i.filter && this._validate(e.validateFilter, \"querySourceFeatures.filter\", i.filter, null, i);\n          var o = this._getSourceCaches(t);\n          var r = [];\n          var _iterator225 = _createForOfIteratorHelper(o),\n            _step225;\n          try {\n            for (_iterator225.s(); !(_step225 = _iterator225.n()).done;) {\n              var _e358 = _step225.value;\n              r = r.concat(Be(_e358, i));\n            }\n          } catch (err) {\n            _iterator225.e(err);\n          } finally {\n            _iterator225.f();\n          }\n          return r;\n        }\n      }, {\n        key: \"addSourceType\",\n        value: function addSourceType(e, t, i) {\n          return Qt.getSourceType(e) ? i(new Error(\"A source type called \\\"\".concat(e, \"\\\" already exists.\"))) : (Qt.setSourceType(e, t), t.workerSourceURL ? void this.dispatcher.broadcast(\"loadWorkerSource\", {\n            name: e,\n            url: t.workerSourceURL\n          }, i) : i(null, null));\n        }\n      }, {\n        key: \"getLight\",\n        value: function getLight() {\n          return this.light.getLight();\n        }\n      }, {\n        key: \"setLight\",\n        value: function setLight(e) {\n          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n          this._checkLoaded();\n          var o = this.light.getLight();\n          var r = !1;\n          for (var _i228 in e) if (!t(e[_i228], o[_i228])) {\n            r = !0;\n            break;\n          }\n          if (!r) return;\n          var n = this._setTransitionParameters({\n            duration: 300,\n            delay: 0\n          });\n          this.light.setLight(e, i), this.light.updateTransitions(n);\n        }\n      }, {\n        key: \"getTerrain\",\n        value: function getTerrain() {\n          return this.terrain && 1 === this.terrain.drapeRenderMode ? this.terrain.get() : null;\n        }\n      }, {\n        key: \"setTerrainForDraping\",\n        value: function setTerrainForDraping() {\n          this.setTerrain({\n            source: \"\",\n            exaggeration: 0\n          }, 0);\n        }\n      }, {\n        key: \"setTerrain\",\n        value: function setTerrain(i) {\n          var o = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n          if (this._checkLoaded(), !i) return delete this.terrain, delete this.stylesheet.terrain, this.dispatcher.broadcast(\"enableTerrain\", !1), this._force3DLayerUpdate(), void (this._markersNeedUpdate = !0);\n          var r = i;\n          if (1 === o) {\n            if (\"object\" == typeof r.source) {\n              var _t376 = \"terrain-dem-src\";\n              this.addSource(_t376, r.source), r = e.clone$1(r), r = e.extend(r, {\n                source: _t376\n              });\n            }\n            if (this._validate(e.validateTerrain, \"terrain\", r)) return;\n          }\n          if (!this.terrain || this.terrain && o !== this.terrain.drapeRenderMode) {\n            if (!r) return;\n            this._createTerrain(r, o);\n          } else {\n            var _i229 = this.terrain,\n              _o119 = _i229.get();\n            for (var _i230 = 0, _Object$keys13 = Object.keys(e.spec.terrain); _i230 < _Object$keys13.length; _i230++) {\n              var _t377 = _Object$keys13[_i230];\n              !r.hasOwnProperty(_t377) && e.spec.terrain[_t377].default && (r[_t377] = e.spec.terrain[_t377].default);\n            }\n            for (var _e359 in r) if (!t(r[_e359], _o119[_e359])) {\n              _i229.set(r), this.stylesheet.terrain = r;\n              var _e360 = this._setTransitionParameters({\n                duration: 0\n              });\n              _i229.updateTransitions(_e360);\n              break;\n            }\n          }\n          this._updateDrapeFirstLayers(), this._markersNeedUpdate = !0;\n        }\n      }, {\n        key: \"_createFog\",\n        value: function _createFog(e) {\n          var t = this.fog = new A(e, this.map.transform);\n          this.stylesheet.fog = e;\n          var i = this._setTransitionParameters({\n            duration: 0\n          });\n          t.updateTransitions(i);\n        }\n      }, {\n        key: \"_updateMarkersOpacity\",\n        value: function _updateMarkersOpacity() {\n          var _this103 = this;\n          0 !== this.map._markers.length && this.map._requestDomTask(function () {\n            var _iterator226 = _createForOfIteratorHelper(_this103.map._markers),\n              _step226;\n            try {\n              for (_iterator226.s(); !(_step226 = _iterator226.n()).done;) {\n                var _e361 = _step226.value;\n                _e361._evaluateOpacity();\n              }\n            } catch (err) {\n              _iterator226.e(err);\n            } finally {\n              _iterator226.f();\n            }\n          });\n        }\n      }, {\n        key: \"getFog\",\n        value: function getFog() {\n          return this.fog ? this.fog.get() : null;\n        }\n      }, {\n        key: \"setFog\",\n        value: function setFog(e) {\n          if (this._checkLoaded(), !e) return delete this.fog, delete this.stylesheet.fog, void (this._markersNeedUpdate = !0);\n          if (this.fog) {\n            var _i231 = this.fog,\n              _o120 = _i231.get();\n            0 === Object.keys(e).length && _i231.set(e);\n            for (var _r258 in e) if (!t(e[_r258], _o120[_r258])) {\n              _i231.set(e), this.stylesheet.fog = e;\n              var _t378 = this._setTransitionParameters({\n                duration: 0\n              });\n              _i231.updateTransitions(_t378);\n              break;\n            }\n          } else this._createFog(e);\n          this._markersNeedUpdate = !0;\n        }\n      }, {\n        key: \"_setTransitionParameters\",\n        value: function _setTransitionParameters(t) {\n          return {\n            now: e.exported.now(),\n            transition: e.extend(t, this.stylesheet.transition)\n          };\n        }\n      }, {\n        key: \"_updateDrapeFirstLayers\",\n        value: function _updateDrapeFirstLayers() {\n          var _this104 = this,\n            _this$_drapedFirstOrd,\n            _this$_drapedFirstOrd2;\n          if (!this.map._optimizeForTerrain || !this.terrain) return;\n          var e = this._order.filter(function (e) {\n              return _this104.isLayerDraped(_this104._layers[e]);\n            }),\n            t = this._order.filter(function (e) {\n              return !_this104.isLayerDraped(_this104._layers[e]);\n            });\n          this._drapedFirstOrder = [], (_this$_drapedFirstOrd = this._drapedFirstOrder).push.apply(_this$_drapedFirstOrd, _toConsumableArray(e)), (_this$_drapedFirstOrd2 = this._drapedFirstOrder).push.apply(_this$_drapedFirstOrd2, _toConsumableArray(t));\n        }\n      }, {\n        key: \"_createTerrain\",\n        value: function _createTerrain(e, t) {\n          var i = this.terrain = new M(e, t);\n          this.stylesheet.terrain = e, this.dispatcher.broadcast(\"enableTerrain\", !this.terrainSetForDrapingOnly()), this._force3DLayerUpdate();\n          var o = this._setTransitionParameters({\n            duration: 0\n          });\n          i.updateTransitions(o);\n        }\n      }, {\n        key: \"_force3DLayerUpdate\",\n        value: function _force3DLayerUpdate() {\n          for (var _e362 in this._layers) {\n            var _t379 = this._layers[_e362];\n            \"fill-extrusion\" === _t379.type && this._updateLayer(_t379);\n          }\n        }\n      }, {\n        key: \"_forceSymbolLayerUpdate\",\n        value: function _forceSymbolLayerUpdate() {\n          for (var _e363 in this._layers) {\n            var _t380 = this._layers[_e363];\n            \"symbol\" === _t380.type && this._updateLayer(_t380);\n          }\n        }\n      }, {\n        key: \"_validate\",\n        value: function _validate(t, i, o, r) {\n          var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n          return (!n || !1 !== n.validate) && $t(this, t.call(e.validateStyle, e.extend({\n            key: i,\n            style: this.serialize(),\n            value: o,\n            styleSpec: e.spec\n          }, r)));\n        }\n      }, {\n        key: \"_remove\",\n        value: function _remove() {\n          this._request && (this._request.cancel(), this._request = null), this._spriteRequest && (this._spriteRequest.cancel(), this._spriteRequest = null), e.evented.off(\"pluginStateChange\", this._rtlTextPluginCallback);\n          for (var _e364 in this._layers) this._layers[_e364].setEventedParent(null);\n          for (var _e365 in this._sourceCaches) this._sourceCaches[_e365].clearTiles(), this._sourceCaches[_e365].setEventedParent(null);\n          this.imageManager.setEventedParent(null), this.setEventedParent(null), this.dispatcher.remove();\n        }\n      }, {\n        key: \"_clearSource\",\n        value: function _clearSource(e) {\n          var t = this._getSourceCaches(e);\n          var _iterator227 = _createForOfIteratorHelper(t),\n            _step227;\n          try {\n            for (_iterator227.s(); !(_step227 = _iterator227.n()).done;) {\n              var _e366 = _step227.value;\n              _e366.clearTiles();\n            }\n          } catch (err) {\n            _iterator227.e(err);\n          } finally {\n            _iterator227.f();\n          }\n        }\n      }, {\n        key: \"_reloadSource\",\n        value: function _reloadSource(e) {\n          var t = this._getSourceCaches(e);\n          var _iterator228 = _createForOfIteratorHelper(t),\n            _step228;\n          try {\n            for (_iterator228.s(); !(_step228 = _iterator228.n()).done;) {\n              var _e367 = _step228.value;\n              _e367.resume(), _e367.reload();\n            }\n          } catch (err) {\n            _iterator228.e(err);\n          } finally {\n            _iterator228.f();\n          }\n        }\n      }, {\n        key: \"_reloadSources\",\n        value: function _reloadSources() {\n          var _iterator229 = _createForOfIteratorHelper(this._getSources()),\n            _step229;\n          try {\n            for (_iterator229.s(); !(_step229 = _iterator229.n()).done;) {\n              var _e368 = _step229.value;\n              _e368.reload && _e368.reload();\n            }\n          } catch (err) {\n            _iterator229.e(err);\n          } finally {\n            _iterator229.f();\n          }\n        }\n      }, {\n        key: \"_updateSources\",\n        value: function _updateSources(e) {\n          for (var _t381 in this._sourceCaches) this._sourceCaches[_t381].update(e);\n        }\n      }, {\n        key: \"_generateCollisionBoxes\",\n        value: function _generateCollisionBoxes() {\n          for (var _e369 in this._sourceCaches) {\n            var _t382 = this._sourceCaches[_e369];\n            _t382.resume(), _t382.reload();\n          }\n        }\n      }, {\n        key: \"_updatePlacement\",\n        value: function _updatePlacement(t, i, o, r) {\n          var _this105 = this;\n          var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;\n          var s = !1,\n            a = !1;\n          var l = {};\n          var _iterator230 = _createForOfIteratorHelper(this._order),\n            _step230;\n          try {\n            var _loop11 = function _loop11() {\n              var e = _step230.value;\n              var i = _this105._layers[e];\n              if (\"symbol\" !== i.type) return \"continue\";\n              if (!l[i.source]) {\n                var _e371 = _this105._getLayerSourceCache(i);\n                if (!_e371) return \"continue\";\n                l[i.source] = _e371.getRenderableIds(!0).map(function (t) {\n                  return _e371.getTileByID(t);\n                }).sort(function (e, t) {\n                  return t.tileID.overscaledZ - e.tileID.overscaledZ || (e.tileID.isLessThan(t.tileID) ? -1 : 1);\n                });\n              }\n              var o = _this105.crossTileSymbolIndex.addLayer(i, l[i.source], t.center.lng, t.projection);\n              s = s || o;\n            };\n            for (_iterator230.s(); !(_step230 = _iterator230.n()).done;) {\n              var _ret4 = _loop11();\n              if (_ret4 === \"continue\") continue;\n            }\n          } catch (err) {\n            _iterator230.e(err);\n          } finally {\n            _iterator230.f();\n          }\n          if (this.crossTileSymbolIndex.pruneUnusedLayers(this._order), n = n || this._layerOrderChanged || 0 === o, this._layerOrderChanged && this.fire(new e.Event(\"neworder\")), (n || !this.pauseablePlacement || this.pauseablePlacement.isDone() && !this.placement.stillRecent(e.exported.now(), t.zoom)) && (this.pauseablePlacement = new jt(t, this._order, n, i, o, r, this.placement, this.fog && t.projection.supportsFog ? this.fog.state : null), this._layerOrderChanged = !1), this.pauseablePlacement.isDone() ? this.placement.setStale() : (this.pauseablePlacement.continuePlacement(this._order, this._layers, l), this.pauseablePlacement.isDone() && (this.placement = this.pauseablePlacement.commit(e.exported.now()), a = !0), s && this.pauseablePlacement.placement.setStale()), a || s) {\n            var _iterator231 = _createForOfIteratorHelper(this._order),\n              _step231;\n            try {\n              for (_iterator231.s(); !(_step231 = _iterator231.n()).done;) {\n                var _e370 = _step231.value;\n                var _t383 = this._layers[_e370];\n                \"symbol\" === _t383.type && this.placement.updateLayerOpacities(_t383, l[_t383.source]);\n              }\n            } catch (err) {\n              _iterator231.e(err);\n            } finally {\n              _iterator231.f();\n            }\n          }\n          return !this.pauseablePlacement.isDone() || this.placement.hasTransitions(e.exported.now());\n        }\n      }, {\n        key: \"_releaseSymbolFadeTiles\",\n        value: function _releaseSymbolFadeTiles() {\n          for (var _e372 in this._sourceCaches) this._sourceCaches[_e372].releaseSymbolFadeTiles();\n        }\n      }, {\n        key: \"getImages\",\n        value: function getImages(e, t, i) {\n          this.imageManager.getImages(t.icons, i), this._updateTilesForChangedImages();\n          var o = function o(e) {\n            e && e.setDependencies(t.tileID.key, t.type, t.icons);\n          };\n          o(this._otherSourceCaches[t.source]), o(this._symbolSourceCaches[t.source]);\n        }\n      }, {\n        key: \"getGlyphs\",\n        value: function getGlyphs(e, t, i) {\n          this.glyphManager.getGlyphs(t.stacks, i);\n        }\n      }, {\n        key: \"getResource\",\n        value: function getResource(t, i, o) {\n          return e.makeRequest(i, o);\n        }\n      }, {\n        key: \"_getSourceCache\",\n        value: function _getSourceCache(e) {\n          return this._otherSourceCaches[e];\n        }\n      }, {\n        key: \"_getLayerSourceCache\",\n        value: function _getLayerSourceCache(e) {\n          return \"symbol\" === e.type ? this._symbolSourceCaches[e.source] : this._otherSourceCaches[e.source];\n        }\n      }, {\n        key: \"_getSourceCaches\",\n        value: function _getSourceCaches(e) {\n          var t = [];\n          return this._otherSourceCaches[e] && t.push(this._otherSourceCaches[e]), this._symbolSourceCaches[e] && t.push(this._symbolSourceCaches[e]), t;\n        }\n      }, {\n        key: \"_isSourceCacheLoaded\",\n        value: function _isSourceCacheLoaded(t) {\n          var i = this._getSourceCaches(t);\n          return 0 === i.length ? (this.fire(new e.ErrorEvent(new Error(\"There is no source with ID '\".concat(t, \"'\")))), !1) : i.every(function (e) {\n            return e.loaded();\n          });\n        }\n      }, {\n        key: \"has3DLayers\",\n        value: function has3DLayers() {\n          return this._num3DLayers > 0;\n        }\n      }, {\n        key: \"hasSymbolLayers\",\n        value: function hasSymbolLayers() {\n          return this._numSymbolLayers > 0;\n        }\n      }, {\n        key: \"hasCircleLayers\",\n        value: function hasCircleLayers() {\n          return this._numCircleLayers > 0;\n        }\n      }, {\n        key: \"_clearWorkerCaches\",\n        value: function _clearWorkerCaches() {\n          this.dispatcher.broadcast(\"clearCaches\");\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this._clearWorkerCaches(), this.terrainSetForDrapingOnly() && (delete this.terrain, delete this.stylesheet.terrain);\n        }\n      }, {\n        key: \"order\",\n        get: function get() {\n          return this.map._optimizeForTerrain && this.terrain ? this._drapedFirstOrder : this._order;\n        }\n      }]);\n      return Qt;\n    }(e.Evented);\n    Qt.getSourceType = function (e) {\n      return ze[e];\n    }, Qt.setSourceType = function (e, t) {\n      ze[e] = t;\n    }, Qt.registerForPluginStateChange = e.registerForPluginStateChange;\n    var ei = \"\\n#define EPSILON 0.0000001\\n#define PI 3.141592653589793\\n#define EXTENT 8192.0\\n#define HALF_PI PI/2.0\\n#define QUARTER_PI PI/4.0\\n#define RAD_TO_DEG 180.0/PI\\n#define DEG_TO_RAD PI/180.0\\n#define GLOBE_RADIUS EXTENT/PI/2.0\",\n      ti = \"attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}\",\n      ii = \"\\n#define ELEVATION_SCALE 7.0\\n#define ELEVATION_OFFSET 450.0\\n#ifdef PROJECTION_GLOBE_VIEW\\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\\n#else\\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\\n#endif\\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\\n#ifdef TERRAIN\\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\\n#else\\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\\n#endif\\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\\n#else\\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\\n#ifdef TERRAIN_DEM_NEAREST_FILTER\\nreturn u_exaggeration*tl;\\n#endif\\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\\n#endif\\n}float prevElevation(vec2 apos) {\\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\\n#else\\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\\n#endif\\n}\\n#ifdef TERRAIN_VERTEX_MORPHING\\nfloat elevation(vec2 apos) {\\n#ifdef ZERO_EXAGGERATION\\nreturn 0.0;\\n#endif\\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\\n#else\\nfloat elevation(vec2 apos) {\\n#ifdef ZERO_EXAGGERATION\\nreturn 0.0;\\n#endif\\nreturn currentElevation(apos);}\\n#endif\\nhighp float unpack_depth(highp vec4 rgba_depth)\\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\\n#else\\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\\n#endif\\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\\n#else\\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\\n#endif\",\n      oi = \"#ifdef FOG\\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\\n#endif\",\n      ri = \"#ifdef FOG\\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\\n#endif\";\n    var ni = {},\n      si = {};\n    var ai = [];\n    _i(ei, ai), _i(ii, ai), _i(oi, ai), _i(ri, ai), ni = di(\"\", ii), si = di(ri, oi);\n    var li = di(\"\\n#if __VERSION__ >=300\\n#define varying in\\n#define gl_FragColor glFragColor\\n#define texture2D texture\\n#define textureCube texture\\nout vec4 glFragColor;\\n#endif\\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\", \"\\n#if __VERSION__ >=300\\n#define attribute in\\n#define varying out\\n#define texture2D texture\\n#endif\\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\\n#ifndef PROJECTED_POS_ON_VIEWPORT\\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\\n#else\\nreturn vec3(0.0);\\n#endif\\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\\n#endif\\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.\"),\n      ci = ei,\n      hi = \"\\n#ifdef GL_ES\\nprecision mediump float;\\n#else\\n\\n#if !defined(lowp)\\n#define lowp\\n#endif\\n\\n#if !defined(mediump)\\n#define mediump\\n#endif\\n\\n#if !defined(highp)\\n#define highp\\n#endif\\n\\n#endif\";\n    var ui = {\n      background: di(\"uniform vec4 u_color;uniform float u_opacity;\\n#ifdef LIGHTING_3D_MODE\\nvarying vec4 v_color;\\n#endif\\nvoid main() {vec4 out_color;\\n#ifdef LIGHTING_3D_MODE\\nout_color=v_color;\\n#else\\nout_color=u_color;\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=out_color*u_opacity;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"attribute vec2 a_pos;uniform mat4 u_matrix;\\n#ifdef LIGHTING_3D_MODE\\nuniform vec4 u_color;varying vec4 v_color;\\n#endif\\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\\n#ifdef LIGHTING_3D_MODE\\nv_color=apply_lighting(u_color);\\n#endif\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      backgroundPattern: di(\"uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=out_color*u_opacity;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      circle: di(\"varying vec3 v_data;varying float v_visibility;\\n#pragma mapbox: define highp vec4 color\\n#pragma mapbox: define mediump float radius\\n#pragma mapbox: define lowp float blur\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define highp vec4 stroke_color\\n#pragma mapbox: define mediump float stroke_width\\n#pragma mapbox: define lowp float stroke_opacity\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 color\\n#pragma mapbox: initialize mediump float radius\\n#pragma mapbox: initialize lowp float blur\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize highp vec4 stroke_color\\n#pragma mapbox: initialize mediump float stroke_width\\n#pragma mapbox: initialize lowp float stroke_opacity\\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\\n#endif\\ngl_FragColor=out_color*(v_visibility*opacity_t);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"#define NUM_VISIBILITY_RINGS 2\\n#define INV_SQRT2 0.70710678\\n#define ELEVATION_BIAS 0.0001\\n#define NUM_SAMPLES_PER_RING 16\\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\\n#endif\\nvarying vec3 v_data;varying float v_visibility;\\n#pragma mapbox: define highp vec4 color\\n#pragma mapbox: define mediump float radius\\n#pragma mapbox: define lowp float blur\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define highp vec4 stroke_color\\n#pragma mapbox: define mediump float stroke_width\\n#pragma mapbox: define lowp float stroke_opacity\\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\\n#if defined(TERRAIN)\\nreturn elevation(pos)+ELEVATION_BIAS;\\n#else\\nreturn 0.0;\\n#endif\\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\\n#ifdef PITCH_WITH_MAP\\n#ifdef PROJECTION_GLOBE_VIEW\\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\\n#else\\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\\n#endif\\n#else\\nreturn projected_center+vec4(sample_offset,0,0);\\n#endif\\n}float get_sample_step() {\\n#ifdef PITCH_WITH_MAP\\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\\n#else\\nreturn PI/float(NUM_SAMPLES_PER_RING);\\n#endif\\n}void main(void) {\\n#pragma mapbox: initialize highp vec4 color\\n#pragma mapbox: initialize mediump float radius\\n#pragma mapbox: initialize lowp float blur\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize highp vec4 stroke_color\\n#pragma mapbox: initialize mediump float stroke_width\\n#pragma mapbox: initialize lowp float stroke_opacity\\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\\n#else \\nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\\n#endif\\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\\n#ifdef PITCH_WITH_MAP\\n#ifdef SCALE_WITH_MAP\\nview_scale=1.0;\\n#else\\nview_scale=projected_center.w/u_camera_to_center_distance;\\n#endif\\n#else\\n#ifdef SCALE_WITH_MAP\\nview_scale=u_camera_to_center_distance;\\n#else\\nview_scale=projected_center.w;\\n#endif\\n#endif\\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\\n#ifdef TERRAIN\\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\\n#ifdef PITCH_WITH_MAP\\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\\n#else\\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\\n#endif\\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\\n#else\\nvisibility=1.0;\\n#endif\\n#ifdef PROJECTION_GLOBE_VIEW\\nvisibility=1.0;\\n#endif\\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\\n#ifdef FOG\\nv_fog_pos=fog_position(world_center.xyz);\\n#endif\\n}\"),\n      clippingMask: di(\"void main() {gl_FragColor=vec4(1.0);}\", \"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}\"),\n      heatmap: di(\"uniform highp float u_intensity;varying vec2 v_extrude;\\n#pragma mapbox: define highp float weight\\n#define GAUSS_COEF 0.3989422804014327\\nvoid main() {\\n#pragma mapbox: initialize highp float weight\\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\\n#ifdef FOG\\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\\n#endif\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\\n#endif\\nvarying vec2 v_extrude;\\n#pragma mapbox: define highp float weight\\n#pragma mapbox: define mediump float radius\\nconst highp float ZERO=1.0/255.0/16.0;\\n#define GAUSS_COEF 0.3989422804014327\\nvoid main(void) {\\n#pragma mapbox: initialize highp float weight\\n#pragma mapbox: initialize mediump float radius\\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\\n#else\\npos=vec3(tilePos+extrude,elevation(tilePos));\\n#endif\\ngl_Position=u_matrix*vec4(pos,1);\\n#ifdef FOG\\nv_fog_pos=fog_position(pos);\\n#endif\\n}\"),\n      heatmapTexture: di(\"uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(0.0);\\n#endif\\n}\", \"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}\"),\n      collisionBox: di(\"varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}\", \"attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}\"),\n      collisionCircle: di(\"varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}\", \"attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}\"),\n      debug: di(\"uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}\", \"attribute vec2 a_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_pos_3;\\n#endif\\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\\n#ifdef PROJECTION_GLOBE_VIEW\\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\\n#else\\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\\n#endif\\n}\"),\n      fill: di(\"#pragma mapbox: define highp vec4 color\\n#pragma mapbox: define lowp float opacity\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 color\\n#pragma mapbox: initialize lowp float opacity\\nvec4 out_color=color;\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=out_color*opacity;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"attribute vec2 a_pos;uniform mat4 u_matrix;\\n#pragma mapbox: define highp vec4 color\\n#pragma mapbox: define lowp float opacity\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 color\\n#pragma mapbox: initialize lowp float opacity\\ngl_Position=u_matrix*vec4(a_pos,0,1);\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      fillOutline: di(\"varying vec2 v_pos;\\n#pragma mapbox: define highp vec4 outline_color\\n#pragma mapbox: define lowp float opacity\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 outline_color\\n#pragma mapbox: initialize lowp float opacity\\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=out_color*(alpha*opacity);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\\n#pragma mapbox: define highp vec4 outline_color\\n#pragma mapbox: define lowp float opacity\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 outline_color\\n#pragma mapbox: initialize lowp float opacity\\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      fillOutlinePattern: di(\"uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp vec4 pattern\\nvoid main() {\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize mediump vec4 pattern\\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=out_color*(alpha*opacity);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp vec4 pattern\\n#pragma mapbox: define lowp float pixel_ratio\\nvoid main() {\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize mediump vec4 pattern\\n#pragma mapbox: initialize lowp float pixel_ratio\\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      fillPattern: di(\"uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp vec4 pattern\\nvoid main() {\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize mediump vec4 pattern\\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=out_color*opacity;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp vec4 pattern\\n#pragma mapbox: define lowp float pixel_ratio\\nvoid main() {\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize mediump vec4 pattern\\n#pragma mapbox: initialize lowp float pixel_ratio\\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      fillExtrusion: di(\"varying vec4 v_color;\\n#ifdef RENDER_SHADOWS\\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\\n#endif\\n#ifdef FAUX_AO\\nuniform lowp vec2 u_ao;varying vec3 v_ao;\\n#endif\\n#ifdef ZERO_ROOF_RADIUS\\nvarying vec4 v_roof_color;\\n#endif\\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\\nvarying highp vec3 v_normal;\\n#endif\\nvoid main() {\\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\\nvec3 normal=v_normal;\\n#endif\\nfloat z;vec4 color;\\n#ifdef ZERO_ROOF_RADIUS\\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\\n#else\\ncolor=v_color;\\n#endif\\n#ifdef FAUX_AO\\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\\n#ifdef ZERO_ROOF_RADIUS\\nconcave*=(1.0-z);\\n#endif\\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\\n#endif\\n#ifdef RENDER_SHADOWS\\n#ifdef ZERO_ROOF_RADIUS\\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\\n#endif\\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\\n#endif\\n#ifdef FOG\\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\\n#endif\\ngl_FragColor=color;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\\n#endif\\nvarying vec4 v_color;\\n#ifdef RENDER_SHADOWS\\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\\n#endif\\n#ifdef ZERO_ROOF_RADIUS\\nvarying vec4 v_roof_color;\\n#endif\\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\\nvarying highp vec3 v_normal;\\n#endif\\n#ifdef FAUX_AO\\nuniform lowp vec2 u_ao;varying vec3 v_ao;\\n#endif\\n#pragma mapbox: define highp float base\\n#pragma mapbox: define highp float height\\n#pragma mapbox: define highp vec4 color\\nvoid main() {\\n#pragma mapbox: initialize highp float base\\n#pragma mapbox: initialize highp float height\\n#pragma mapbox: initialize highp vec4 color\\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\\nv_normal=normal;\\n#endif\\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\\n#if defined(HAS_CENTROID) || defined(TERRAIN)\\ncentroid_pos=a_centroid_pos;\\n#endif\\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\\n#ifdef TERRAIN\\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\\n#else\\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\\n#endif\\n#ifdef PROJECTION_GLOBE_VIEW\\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\\n#endif\\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\\n#ifdef RENDER_SHADOWS\\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\\n#endif\\nfloat NdotL=0.0;float colorvalue=0.0;\\n#ifdef LIGHTING_3D_MODE\\nNdotL=calculate_NdotL(normal);\\n#else\\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\\n#endif\\nif (normal.y !=0.0) {float r=0.84;\\n#ifndef LIGHTING_3D_MODE\\nr=mix(0.7,0.98,1.0-u_lightintensity);\\n#endif\\nNdotL*=(\\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\\n#ifdef FAUX_AO\\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\\n#ifdef TERRAIN\\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\\n#endif\\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\\n#ifdef PROJECTION_GLOBE_VIEW\\ntop_height+=u_height_lift;\\n#endif\\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\\n#endif\\n#ifdef LIGHTING_3D_MODE\\nv_color=apply_lighting(color,NdotL);\\n#else\\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\\n#endif\\nv_color*=u_opacity;\\n#ifdef ZERO_ROOF_RADIUS\\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\\n#ifdef LIGHTING_3D_MODE\\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\\n#else\\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\\n#endif\\nv_roof_color*=u_opacity;\\n#endif\\n#ifdef FOG\\nv_fog_pos=fog_position(pos);\\n#endif\\n}\"),\n      fillExtrusionPattern: di(\"uniform vec2 u_texsize;uniform sampler2D u_image;\\n#ifdef FAUX_AO\\nuniform lowp vec2 u_ao;varying vec3 v_ao;\\n#endif\\n#ifdef LIGHTING_3D_MODE\\nvarying float v_NdotL;\\n#endif\\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\\n#pragma mapbox: define lowp float base\\n#pragma mapbox: define lowp float height\\n#pragma mapbox: define lowp vec4 pattern\\n#pragma mapbox: define lowp float pixel_ratio\\nvoid main() {\\n#pragma mapbox: initialize lowp float base\\n#pragma mapbox: initialize lowp float height\\n#pragma mapbox: initialize mediump vec4 pattern\\n#pragma mapbox: initialize lowp float pixel_ratio\\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\\n#else\\nout_color=out_color*v_lighting;\\n#endif\\n#ifdef FAUX_AO\\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=out_color;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\\n#endif\\nvarying vec2 v_pos;varying vec4 v_lighting;\\n#ifdef FAUX_AO\\nuniform lowp vec2 u_ao;varying vec3 v_ao;\\n#endif\\n#ifdef LIGHTING_3D_MODE\\nvarying float v_NdotL;\\n#endif\\n#pragma mapbox: define lowp float base\\n#pragma mapbox: define lowp float height\\n#pragma mapbox: define lowp vec4 pattern\\n#pragma mapbox: define lowp float pixel_ratio\\nvoid main() {\\n#pragma mapbox: initialize lowp float base\\n#pragma mapbox: initialize lowp float height\\n#pragma mapbox: initialize mediump vec4 pattern\\n#pragma mapbox: initialize lowp float pixel_ratio\\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\\n#if defined(HAS_CENTROID) || defined(TERRAIN)\\ncentroid_pos=a_centroid_pos;\\n#endif\\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\\n#ifdef TERRAIN\\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\\n#else\\np=vec3(pos_nx.xy,z);\\n#endif\\n#ifdef PROJECTION_GLOBE_VIEW\\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\\n#endif\\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\\n? pos_nx.xy\\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\\n#ifdef LIGHTING_3D_MODE\\nNdotL=calculate_NdotL(normal);\\n#else\\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\\n#endif\\nif (normal.y !=0.0) {float r=0.84;\\n#ifndef LIGHTING_3D_MODE\\nr=mix(0.7,0.98,1.0-u_lightintensity);\\n#endif\\nNdotL*=(\\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\\n#ifdef FAUX_AO\\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\\n#ifdef TERRAIN\\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\\n#endif\\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\\n#ifdef PROJECTION_GLOBE_VIEW\\ntop_height+=u_height_lift;\\n#endif\\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\\n#endif\\n#ifdef LIGHTING_3D_MODE\\nv_NdotL=NdotL;\\n#else\\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\\n#endif \\n#ifdef FOG\\nv_fog_pos=fog_position(p);\\n#endif\\n}\"),\n      hillshadePrepare: di(\"#ifdef GL_ES\\nprecision highp float;\\n#endif\\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\\nreturn texture2D(u_image,coord).a/4.0;\\n#else\\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\\n#endif\\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}\"),\n      hillshade: di(\"uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\\n#ifdef LIGHTING_3D_MODE\\ngl_FragColor=apply_lighting(gl_FragColor);\\n#endif\\n#ifdef FOG\\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\\n#endif\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      line: di(\"uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\\n#ifdef RENDER_LINE_DASH\\nuniform sampler2D u_dash_image;varying vec2 v_tex;\\n#endif\\n#ifdef RENDER_LINE_GRADIENT\\nuniform sampler2D u_gradient_image;\\n#endif\\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\\n#pragma mapbox: define highp vec4 color\\n#pragma mapbox: define lowp float floorwidth\\n#pragma mapbox: define lowp vec4 dash\\n#pragma mapbox: define lowp float blur\\n#pragma mapbox: define lowp float opacity\\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\\n#pragma mapbox: initialize highp vec4 color\\n#pragma mapbox: initialize lowp float floorwidth\\n#pragma mapbox: initialize lowp vec4 dash\\n#pragma mapbox: initialize lowp float blur\\n#pragma mapbox: initialize lowp float opacity\\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\\n#ifdef RENDER_LINE_DASH\\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\\n#endif\\nhighp vec4 out_color;\\n#ifdef RENDER_LINE_GRADIENT\\nout_color=texture2D(u_gradient_image,v_uv.xy);\\n#else\\nout_color=color;\\n#endif\\nfloat trimmed=1.0;\\n#ifdef RENDER_LINE_TRIM_OFFSET\\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\\n#endif\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\\n#endif\\n#ifdef RENDER_LINE_ALPHA_DISCARD\\nif (alpha < u_alpha_discard_threshold) {discard;}\\n#endif\\n#ifdef RENDER_LINE_BORDER\\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\\n#ifdef RENDER_LINE_BORDER_AUTO\\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\\n#else\\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\\n#endif\\n}\\n#endif\\ngl_FragColor=out_color*(alpha*opacity);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"\\n#define EXTRUDE_SCALE 0.015873016\\nattribute vec2 a_pos_normal;attribute vec4 a_data;\\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\\nattribute highp vec4 a_packed;\\n#endif\\n#ifdef RENDER_LINE_DASH\\nattribute float a_linesofar;\\n#endif\\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\\n#ifdef RENDER_LINE_DASH\\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\\n#endif\\n#ifdef RENDER_LINE_GRADIENT\\nuniform float u_image_height;\\n#endif\\n#pragma mapbox: define highp vec4 color\\n#pragma mapbox: define lowp float floorwidth\\n#pragma mapbox: define lowp vec4 dash\\n#pragma mapbox: define lowp float blur\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define mediump float gapwidth\\n#pragma mapbox: define lowp float offset\\n#pragma mapbox: define mediump float width\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 color\\n#pragma mapbox: initialize lowp float floorwidth\\n#pragma mapbox: initialize lowp vec4 dash\\n#pragma mapbox: initialize lowp float blur\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize mediump float gapwidth\\n#pragma mapbox: initialize lowp float offset\\n#pragma mapbox: initialize mediump float width\\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\\n#ifndef RENDER_TO_TEXTURE\\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\\n#else\\nv_gamma_scale=1.0;\\n#endif\\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\\n#ifdef RENDER_LINE_GRADIENT\\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\\n#else\\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\\n#endif\\n#endif\\n#ifdef RENDER_LINE_DASH\\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\\n#endif\\nv_width2=vec2(outset,inset);\\n#ifdef FOG\\nv_fog_pos=fog_position(pos);\\n#endif\\n}\"),\n      linePattern: di(\"uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\\n#pragma mapbox: define lowp vec4 pattern\\n#pragma mapbox: define lowp float pixel_ratio\\n#pragma mapbox: define lowp float blur\\n#pragma mapbox: define lowp float opacity\\nvoid main() {\\n#pragma mapbox: initialize mediump vec4 pattern\\n#pragma mapbox: initialize lowp float pixel_ratio\\n#pragma mapbox: initialize lowp float blur\\n#pragma mapbox: initialize lowp float opacity\\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\\n#ifdef LIGHTING_3D_MODE\\ncolor=apply_lighting(color);\\n#endif\\n#ifdef FOG\\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\\n#endif\\ngl_FragColor=color*(alpha*opacity);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"\\n#define scale 0.015873016\\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\\n#pragma mapbox: define lowp float blur\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp float offset\\n#pragma mapbox: define mediump float gapwidth\\n#pragma mapbox: define mediump float width\\n#pragma mapbox: define lowp float floorwidth\\n#pragma mapbox: define lowp vec4 pattern\\n#pragma mapbox: define lowp float pixel_ratio\\nvoid main() {\\n#pragma mapbox: initialize lowp float blur\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize lowp float offset\\n#pragma mapbox: initialize mediump float gapwidth\\n#pragma mapbox: initialize mediump float width\\n#pragma mapbox: initialize lowp float floorwidth\\n#pragma mapbox: initialize mediump vec4 pattern\\n#pragma mapbox: initialize lowp float pixel_ratio\\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\\n#ifndef RENDER_TO_TEXTURE\\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\\n#else\\nv_gamma_scale=1.0;\\n#endif\\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\\n#ifdef FOG\\nv_fog_pos=fog_position(pos);\\n#endif\\n}\"),\n      raster: di(\"uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\\n#ifdef LIGHTING_3D_MODE\\nout_color=apply_lighting(out_color);\\n#endif\\n#ifdef FOG\\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\\n#endif\\ngl_FragColor=vec4(out_color*color.a,color.a);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\\n#ifdef FOG\\nv_fog_pos=fog_position(a_pos);\\n#endif\\n}\"),\n      symbolIcon: di(\"uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\\n#pragma mapbox: define lowp float opacity\\nvoid main() {\\n#pragma mapbox: initialize lowp float opacity\\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\\n#endif\\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\\n#ifdef PROJECTION_GLOBE_VIEW\\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\\n#endif\\nvarying vec2 v_tex;varying float v_fade_opacity;\\n#pragma mapbox: define lowp float opacity\\nvoid main() {\\n#pragma mapbox: initialize lowp float opacity\\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\\n#else\\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\\n#endif\\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\\ncamera_to_anchor_distance/u_camera_to_center_distance :\\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\\n#else\\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\\n#endif\\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\\n#else\\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\\n#endif\\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\\n#ifdef TERRAIN\\n#ifdef PITCH_WITH_MAP_TERRAIN\\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\\n#endif\\n#endif\\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\\n#else\\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\\n#endif\\nfloat projection_transition_fade=1.0;\\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\\n#endif\\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}\"),\n      symbolSDF: di(\"#define SDF_PX 8.0\\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\\n#pragma mapbox: define highp vec4 fill_color\\n#pragma mapbox: define highp vec4 halo_color\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp float halo_width\\n#pragma mapbox: define lowp float halo_blur\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 fill_color\\n#pragma mapbox: initialize highp vec4 halo_color\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize lowp float halo_width\\n#pragma mapbox: initialize lowp float halo_blur\\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\\n#endif\\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\\n#ifdef PROJECTION_GLOBE_VIEW\\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\\n#endif\\nvarying vec2 v_data0;varying vec3 v_data1;\\n#pragma mapbox: define highp vec4 fill_color\\n#pragma mapbox: define highp vec4 halo_color\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp float halo_width\\n#pragma mapbox: define lowp float halo_blur\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 fill_color\\n#pragma mapbox: initialize highp vec4 halo_color\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize lowp float halo_width\\n#pragma mapbox: initialize lowp float halo_blur\\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\\n#else\\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\\n#endif\\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\\ncamera_to_anchor_distance/u_camera_to_center_distance :\\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\\n#else\\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\\n#endif\\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\\n#else\\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\\n#endif\\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\\n#ifdef TERRAIN\\n#ifdef PITCH_WITH_MAP_TERRAIN\\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\\n#endif\\n#endif\\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\\n#else\\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\\n#endif\\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\\n#endif\\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}\"),\n      symbolTextAndIcon: di(\"#define SDF_PX 8.0\\n#define SDF 1.0\\n#define ICON 0.0\\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\\n#pragma mapbox: define highp vec4 fill_color\\n#pragma mapbox: define highp vec4 halo_color\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp float halo_width\\n#pragma mapbox: define lowp float halo_blur\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 fill_color\\n#pragma mapbox: initialize highp vec4 halo_color\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize lowp float halo_width\\n#pragma mapbox: initialize lowp float halo_blur\\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\\n#ifdef PROJECTION_GLOBE_VIEW\\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\\n#endif\\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\\n#ifdef PROJECTION_GLOBE_VIEW\\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\\n#endif\\nvarying vec4 v_data0;varying vec4 v_data1;\\n#pragma mapbox: define highp vec4 fill_color\\n#pragma mapbox: define highp vec4 halo_color\\n#pragma mapbox: define lowp float opacity\\n#pragma mapbox: define lowp float halo_width\\n#pragma mapbox: define lowp float halo_blur\\nvoid main() {\\n#pragma mapbox: initialize highp vec4 fill_color\\n#pragma mapbox: initialize highp vec4 halo_color\\n#pragma mapbox: initialize lowp float opacity\\n#pragma mapbox: initialize lowp float halo_width\\n#pragma mapbox: initialize lowp float halo_blur\\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\\n#else\\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\\n#endif\\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\\ncamera_to_anchor_distance/u_camera_to_center_distance :\\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\\n#else\\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\\n#endif\\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\\n#ifdef TERRAIN\\n#ifdef PITCH_WITH_MAP_TERRAIN\\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\\n#endif\\n#endif\\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\\n#ifdef PROJECTION_GLOBE_VIEW\\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\\n#else\\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\\n#endif\\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\\n#endif\\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}\"),\n      terrainRaster: di(\"uniform sampler2D u_image0;varying vec2 v_pos0;\\n#ifdef FOG\\nvarying float v_fog_opacity;\\n#endif\\n#ifdef RENDER_SHADOWS\\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\\n#endif\\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\\n#ifdef RENDER_SHADOWS\\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\\n#endif\\n#ifdef FOG\\n#ifdef ZERO_EXAGGERATION\\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\\n#else\\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\\n#endif\\n#endif\\ngl_FragColor=color;\\n#ifdef TERRAIN_WIREFRAME\\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\\n#endif\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\\n#ifdef FOG\\nvarying float v_fog_opacity;\\n#endif\\n#ifdef RENDER_SHADOWS\\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\\n#endif\\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\\n#ifdef TERRAIN_WIREFRAME\\nelevation+=wireframeOffset;\\n#endif\\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\\n#ifdef FOG\\n#ifdef ZERO_EXAGGERATION\\nv_fog_pos=fog_position(decodedPos);\\n#else\\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\\n#endif\\n#endif\\n#ifdef RENDER_SHADOWS\\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\\n#endif\\n}\"),\n      terrainDepth: di(\"#ifdef GL_ES\\nprecision highp float;\\n#endif\\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}\", \"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}\"),\n      skybox: di(\"\\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\\n#ifdef FOG\\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\\n#endif\\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", ti),\n      skyboxGradient: di(\"varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\\n#ifdef FOG\\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\\n#endif\\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", ti),\n      skyboxCapture: di(\"\\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\\n#ifdef GL_ES\\nprecision highp float;\\n#endif\\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\\n#define MIE_G                   0.76\\n#define DENSITY_HEIGHT_SCALE_R  8000.0\\n#define DENSITY_HEIGHT_SCALE_M  1200.0\\n#define PLANET_RADIUS           6360e3\\n#define ATMOSPHERE_RADIUS       6420e3\\n#define SAMPLE_STEPS            10\\n#define DENSITY_STEPS           4\\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}\", \"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}\"),\n      globeRaster: di(\"uniform sampler2D u_image0;varying vec2 v_pos0;\\n#ifndef FOG\\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\\n#endif\\nvoid main() {vec4 color;\\n#ifdef CUSTOM_ANTIALIASING\\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\\n#else\\ncolor=texture2D(u_image0,v_pos0);\\n#endif\\n#ifdef FOG\\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\\n#endif\\ngl_FragColor=color;\\n#ifdef TERRAIN_WIREFRAME\\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\\n#endif\\n#ifdef OVERDRAW_INSPECTOR\\ngl_FragColor=vec4(1.0);\\n#endif\\n}\", \"uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\\n#ifdef GLOBE_POLES\\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\\n#else\\nattribute vec2 a_pos;\\n#endif\\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\\n#ifdef GLOBE_POLES\\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\\n#else\\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\\n#endif\\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\\n#ifdef GLOBE_POLES\\nvec3 up_vector=globe_derived_up_vector;\\n#else\\nvec3 up_vector=elevationVector(tile_pos);\\n#endif\\nfloat height=elevation(tile_pos);\\n#ifdef TERRAIN_WIREFRAME\\nheight+=wireframeOffset;\\n#endif\\nglobe_pos+=up_vector*height;\\n#ifndef GLOBE_POLES\\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\\n#endif\\n#ifdef GLOBE_POLES\\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\\n#else\\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\\n#endif\\ngl_Position=u_proj_matrix*interpolated_pos;\\n#ifdef FOG\\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\\n#endif\\n}\"),\n      globeAtmosphere: di(\"uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\\n#ifdef PROJECTION_GLOBE_VIEW\\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\\n#endif\\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\\n#ifdef PROJECTION_GLOBE_VIEW\\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\\n#else\\nhorizon_angle=horizon_angle_mercator;\\n#endif\\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}\", \"attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}\")\n    };\n    function _i(e, t) {\n      var i = e.replace(/\\s*\\/\\/[^\\n]*\\n/g, \"\\n\").split(\"\\n\");\n      var _iterator232 = _createForOfIteratorHelper(i),\n        _step232;\n      try {\n        for (_iterator232.s(); !(_step232 = _iterator232.n()).done;) {\n          var _e373 = _step232.value;\n          if (_e373 = _e373.trim(), \"#\" === _e373[0] && _e373.includes(\"if\") && !_e373.includes(\"endif\")) {\n            _e373 = _e373.replace(\"#\", \"\").replace(/ifdef|ifndef|elif|if/g, \"\").replace(/!|defined|\\(|\\)|\\|\\||&&/g, \"\").replace(/\\s+/g, \" \").trim();\n            var _i232 = _e373.split(\" \");\n            var _iterator233 = _createForOfIteratorHelper(_i232),\n              _step233;\n            try {\n              for (_iterator233.s(); !(_step233 = _iterator233.n()).done;) {\n                var _e374 = _step233.value;\n                t.includes(_e374) || t.push(_e374);\n              }\n            } catch (err) {\n              _iterator233.e(err);\n            } finally {\n              _iterator233.f();\n            }\n          }\n        }\n      } catch (err) {\n        _iterator232.e(err);\n      } finally {\n        _iterator232.f();\n      }\n    }\n    function di(e, t) {\n      var i = /#pragma mapbox: ([\\w]+) ([\\w]+) ([\\w]+) ([\\w]+)/g,\n        o = t.match(/attribute (highp |mediump |lowp )?([\\w]+) ([\\w]+)/g),\n        r = {},\n        n = [].concat(ai);\n      return _i(e, n), _i(t, n), {\n        fragmentSource: e = e.replace(i, function (e, t, i, o, n) {\n          return r[n] = !0, \"define\" === t ? \"\\n#ifndef HAS_UNIFORM_u_\".concat(n, \"\\nvarying \").concat(i, \" \").concat(o, \" \").concat(n, \";\\n#else\\nuniform \").concat(i, \" \").concat(o, \" u_\").concat(n, \";\\n#endif\\n\") : \"\\n#ifdef HAS_UNIFORM_u_\".concat(n, \"\\n    \").concat(i, \" \").concat(o, \" \").concat(n, \" = u_\").concat(n, \";\\n#endif\\n\");\n        }),\n        vertexSource: t = t.replace(i, function (e, t, i, o, n) {\n          var s = \"float\" === o ? \"vec2\" : \"vec4\",\n            a = n.match(/color/) ? \"color\" : s;\n          return r[n] ? \"define\" === t ? \"\\n#ifndef HAS_UNIFORM_u_\".concat(n, \"\\nuniform lowp float u_\").concat(n, \"_t;\\nattribute \").concat(i, \" \").concat(s, \" a_\").concat(n, \";\\nvarying \").concat(i, \" \").concat(o, \" \").concat(n, \";\\n#else\\nuniform \").concat(i, \" \").concat(o, \" u_\").concat(n, \";\\n#endif\\n\") : \"vec4\" === a ? \"\\n#ifndef HAS_UNIFORM_u_\".concat(n, \"\\n    \").concat(n, \" = a_\").concat(n, \";\\n#else\\n    \").concat(i, \" \").concat(o, \" \").concat(n, \" = u_\").concat(n, \";\\n#endif\\n\") : \"\\n#ifndef HAS_UNIFORM_u_\".concat(n, \"\\n    \").concat(n, \" = unpack_mix_\").concat(a, \"(a_\").concat(n, \", u_\").concat(n, \"_t);\\n#else\\n    \").concat(i, \" \").concat(o, \" \").concat(n, \" = u_\").concat(n, \";\\n#endif\\n\") : \"define\" === t ? \"\\n#ifndef HAS_UNIFORM_u_\".concat(n, \"\\nuniform lowp float u_\").concat(n, \"_t;\\nattribute \").concat(i, \" \").concat(s, \" a_\").concat(n, \";\\n#else\\nuniform \").concat(i, \" \").concat(o, \" u_\").concat(n, \";\\n#endif\\n\") : \"vec4\" === a ? \"\\n#ifndef HAS_UNIFORM_u_\".concat(n, \"\\n    \").concat(i, \" \").concat(o, \" \").concat(n, \" = a_\").concat(n, \";\\n#else\\n    \").concat(i, \" \").concat(o, \" \").concat(n, \" = u_\").concat(n, \";\\n#endif\\n\") : \"\\n#ifndef HAS_UNIFORM_u_\".concat(n, \"\\n    \").concat(i, \" \").concat(o, \" \").concat(n, \" = unpack_mix_\").concat(a, \"(a_\").concat(n, \", u_\").concat(n, \"_t);\\n#else\\n    \").concat(i, \" \").concat(o, \" \").concat(n, \" = u_\").concat(n, \";\\n#endif\\n\");\n        }),\n        staticAttributes: o,\n        usedDefines: n\n      };\n    }\n    var pi = /*#__PURE__*/function () {\n      function pi() {\n        _classCallCheck(this, pi);\n        this.boundProgram = null, this.boundLayoutVertexBuffer = null, this.boundPaintVertexBuffers = [], this.boundIndexBuffer = null, this.boundVertexOffset = null, this.boundDynamicVertexBuffers = [], this.vao = null;\n      }\n      _createClass(pi, [{\n        key: \"bind\",\n        value: function bind(e, t, i, o, r, n, s) {\n          this.context = e;\n          var a = this.boundPaintVertexBuffers.length !== o.length;\n          for (var _e375 = 0; !a && _e375 < o.length; _e375++) this.boundPaintVertexBuffers[_e375] !== o[_e375] && (a = !0);\n          var l = this.boundDynamicVertexBuffers.length !== s.length;\n          for (var _e376 = 0; !l && _e376 < s.length; _e376++) this.boundDynamicVertexBuffers[_e376] !== s[_e376] && (l = !0);\n          if (!e.extVertexArrayObject || !this.vao || this.boundProgram !== t || this.boundLayoutVertexBuffer !== i || a || l || this.boundIndexBuffer !== r || this.boundVertexOffset !== n) this.freshBind(t, i, o, r, n, s);else {\n            e.bindVertexArrayOES.set(this.vao);\n            var _iterator234 = _createForOfIteratorHelper(s),\n              _step234;\n            try {\n              for (_iterator234.s(); !(_step234 = _iterator234.n()).done;) {\n                var _e377 = _step234.value;\n                _e377 && _e377.bind();\n              }\n            } catch (err) {\n              _iterator234.e(err);\n            } finally {\n              _iterator234.f();\n            }\n            r && r.dynamicDraw && r.bind();\n          }\n        }\n      }, {\n        key: \"freshBind\",\n        value: function freshBind(e, t, i, o, r, n) {\n          var s;\n          var a = e.numAttributes,\n            l = this.context,\n            c = l.gl;\n          if (l.extVertexArrayObject) this.vao && this.destroy(), this.vao = l.extVertexArrayObject.createVertexArrayOES(), l.bindVertexArrayOES.set(this.vao), s = 0, this.boundProgram = e, this.boundLayoutVertexBuffer = t, this.boundPaintVertexBuffers = i, this.boundIndexBuffer = o, this.boundVertexOffset = r, this.boundDynamicVertexBuffers = n;else {\n            s = l.currentNumAttributes || 0;\n            for (var _e378 = a; _e378 < s; _e378++) c.disableVertexAttribArray(_e378);\n          }\n          t.enableAttributes(c, e), t.bind(), t.setVertexAttribPointers(c, e, r);\n          var _iterator235 = _createForOfIteratorHelper(i),\n            _step235;\n          try {\n            for (_iterator235.s(); !(_step235 = _iterator235.n()).done;) {\n              var _t384 = _step235.value;\n              _t384.enableAttributes(c, e), _t384.bind(), _t384.setVertexAttribPointers(c, e, r);\n            }\n          } catch (err) {\n            _iterator235.e(err);\n          } finally {\n            _iterator235.f();\n          }\n          var _iterator236 = _createForOfIteratorHelper(n),\n            _step236;\n          try {\n            for (_iterator236.s(); !(_step236 = _iterator236.n()).done;) {\n              var _t385 = _step236.value;\n              _t385 && (_t385.enableAttributes(c, e), _t385.bind(), _t385.setVertexAttribPointers(c, e, r));\n            }\n          } catch (err) {\n            _iterator236.e(err);\n          } finally {\n            _iterator236.f();\n          }\n          o && o.bind(), l.currentNumAttributes = a;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this.vao && (this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao), this.vao = null);\n        }\n      }]);\n      return pi;\n    }();\n    function mi(t, i) {\n      var o = Math.pow(2, i.canonical.z),\n        r = i.canonical.y;\n      return [new e.MercatorCoordinate(0, r / o).toLngLat().lat, new e.MercatorCoordinate(0, (r + 1) / o).toLngLat().lat];\n    }\n    function fi(t, i, o, r, n, s, a) {\n      var l = t.context,\n        c = l.gl,\n        h = o.fbo;\n      if (!h) return;\n      t.prepareDrawTile();\n      var u = t.useProgram(\"hillshade\");\n      l.activeTexture.set(c.TEXTURE0), c.bindTexture(c.TEXTURE_2D, h.colorAttachment.get());\n      var _ = function (e, t, i, o) {\n        var r = i.paint.get(\"hillshade-shadow-color\"),\n          n = i.paint.get(\"hillshade-highlight-color\"),\n          s = i.paint.get(\"hillshade-accent-color\");\n        var a = i.paint.get(\"hillshade-illumination-direction\") * (Math.PI / 180);\n        \"viewport\" === i.paint.get(\"hillshade-illumination-anchor\") && (a -= e.transform.angle);\n        var l = !e.options.moving;\n        return {\n          u_matrix: o || e.transform.calculateProjMatrix(t.tileID.toUnwrapped(), l),\n          u_image: 0,\n          u_latrange: mi(0, t.tileID),\n          u_light: [i.paint.get(\"hillshade-exaggeration\"), a],\n          u_shadow: r,\n          u_highlight: n,\n          u_accent: s\n        };\n      }(t, o, r, t.terrain ? i.projMatrix : null);\n      t.prepareDrawProgram(l, u, i.toUnwrapped());\n      var _t$getTileBoundsBuffe = t.getTileBoundsBuffers(o),\n        d = _t$getTileBoundsBuffe.tileBoundsBuffer,\n        p = _t$getTileBoundsBuffe.tileBoundsIndexBuffer,\n        m = _t$getTileBoundsBuffe.tileBoundsSegments;\n      u.draw(l, c.TRIANGLES, n, s, a, e.CullFaceMode.disabled, _, r.id, d, p, m);\n    }\n    function gi(t, i, o) {\n      if (!i.needsDEMTextureUpload) return;\n      var r = t.context,\n        n = r.gl;\n      r.pixelStoreUnpackPremultiplyAlpha.set(!1), i.demTexture = i.demTexture || t.getTileTexture(o.stride);\n      var s = o.getPixels();\n      i.demTexture ? i.demTexture.update(s, {\n        premultiply: !1\n      }) : i.demTexture = new e.Texture(r, s, n.RGBA, {\n        premultiply: !1\n      }), i.needsDEMTextureUpload = !1;\n    }\n    function vi(t, i, o, r, n, s) {\n      var a = t.context,\n        l = a.gl;\n      if (!i.dem) return;\n      var c = i.dem;\n      if (a.activeTexture.set(l.TEXTURE1), gi(t, i, c), !i.demTexture) return;\n      i.demTexture.bind(l.NEAREST, l.CLAMP_TO_EDGE);\n      var h = c.dim;\n      a.activeTexture.set(l.TEXTURE0);\n      var u = i.fbo;\n      if (!u) {\n        var _t386 = new e.Texture(a, {\n          width: h,\n          height: h,\n          data: null\n        }, l.RGBA);\n        _t386.bind(l.LINEAR, l.CLAMP_TO_EDGE), u = i.fbo = a.createFramebuffer(h, h, !0), u.colorAttachment.set(_t386.texture);\n      }\n      a.bindFramebuffer.set(u.framebuffer), a.viewport.set([0, 0, h, h]);\n      var _t$getMercatorTileBou = t.getMercatorTileBoundsBuffers(),\n        _ = _t$getMercatorTileBou.tileBoundsBuffer,\n        d = _t$getMercatorTileBou.tileBoundsIndexBuffer,\n        p = _t$getMercatorTileBou.tileBoundsSegments;\n      t.useProgram(\"hillshadePrepare\").draw(a, l.TRIANGLES, r, n, s, e.CullFaceMode.disabled, function (t, i) {\n        var o = i.stride,\n          r = e.create();\n        return e.ortho(r, 0, e.EXTENT, -e.EXTENT, 0, 0, 1), e.translate(r, r, [0, -e.EXTENT, 0]), {\n          u_matrix: r,\n          u_image: 1,\n          u_dimension: [o, o],\n          u_zoom: t.overscaledZ,\n          u_unpack: i.unpackVector\n        };\n      }(i.tileID, c), o.id, _, d, p), i.needsHillshadePrepare = !1;\n    }\n    var xi = function xi(t) {\n        return {\n          u_matrix: new e.UniformMatrix4f(t),\n          u_image0: new e.Uniform1i(t),\n          u_skirt_height: new e.Uniform1f(t)\n        };\n      },\n      yi = function yi(e, t) {\n        return {\n          u_matrix: e,\n          u_image0: 0,\n          u_skirt_height: t\n        };\n      },\n      bi = function bi(e, t, i, o, r, n, s, a, l, c, h, u, _, d, p) {\n        return {\n          u_proj_matrix: Float32Array.from(e),\n          u_globe_matrix: t,\n          u_normalize_matrix: Float32Array.from(o),\n          u_merc_matrix: i,\n          u_zoom_transition: r,\n          u_merc_center: n,\n          u_image0: 0,\n          u_frustum_tl: s,\n          u_frustum_tr: a,\n          u_frustum_br: l,\n          u_frustum_bl: c,\n          u_globe_pos: h,\n          u_globe_radius: u,\n          u_viewport: _,\n          u_grid_matrix: p ? Float32Array.from(p) : new Float32Array(9),\n          u_skirt_height: d\n        };\n      };\n    function wi(e, t) {\n      return null != e && null != t && !(!e.hasData() || !t.hasData()) && null != e.demTexture && null != t.demTexture && e.tileID.key !== t.tileID.key;\n    }\n    var Ti = new ( /*#__PURE__*/function () {\n        function _class19() {\n          _classCallCheck(this, _class19);\n          this.operations = {};\n        }\n        _createClass(_class19, [{\n          key: \"newMorphing\",\n          value: function newMorphing(e, t, i, o, r) {\n            if (e in this.operations) {\n              var _t387 = this.operations[e];\n              _t387.to.tileID.key !== i.tileID.key && (_t387.queued = i);\n            } else this.operations[e] = {\n              startTime: o,\n              phase: 0,\n              duration: r,\n              from: t,\n              to: i,\n              queued: null\n            };\n          }\n        }, {\n          key: \"getMorphValuesForProxy\",\n          value: function getMorphValuesForProxy(e) {\n            if (!(e in this.operations)) return null;\n            var t = this.operations[e];\n            return {\n              from: t.from,\n              to: t.to,\n              phase: t.phase\n            };\n          }\n        }, {\n          key: \"update\",\n          value: function update(e) {\n            for (var _t388 in this.operations) {\n              var _i233 = this.operations[_t388];\n              for (_i233.phase = (e - _i233.startTime) / _i233.duration; _i233.phase >= 1 || !this._validOp(_i233);) if (!this._nextOp(_i233, e)) {\n                delete this.operations[_t388];\n                break;\n              }\n            }\n          }\n        }, {\n          key: \"_nextOp\",\n          value: function _nextOp(e, t) {\n            return !!e.queued && (e.from = e.to, e.to = e.queued, e.queued = null, e.phase = 0, e.startTime = t, !0);\n          }\n        }, {\n          key: \"_validOp\",\n          value: function _validOp(e) {\n            return e.from.hasData() && e.to.hasData();\n          }\n        }]);\n        return _class19;\n      }())(),\n      Ei = {\n        0: null,\n        1: \"TERRAIN_VERTEX_MORPHING\",\n        2: \"TERRAIN_WIREFRAME\"\n      };\n    function Ci(e) {\n      return 6 * Math.pow(1.5, 22 - e);\n    }\n    function Mi(e, t) {\n      var i = 1 << e.z;\n      return !t && (0 === e.x || e.x === i - 1) || 0 === e.y || e.y === i - 1;\n    }\n    var Ii = function Ii(e) {\n      return {\n        u_matrix: e\n      };\n    };\n    function Si(t, i, o, r, n) {\n      if (n > 0) {\n        var _s142 = e.exported.now(),\n          _a118 = (_s142 - t.timeAdded) / n,\n          _l72 = i ? (_s142 - i.timeAdded) / n : -1,\n          _c54 = o.getSource(),\n          _h42 = r.coveringZoomLevel({\n            tileSize: _c54.tileSize,\n            roundZoom: _c54.roundZoom\n          }),\n          _u59 = !i || Math.abs(i.tileID.overscaledZ - _h42) > Math.abs(t.tileID.overscaledZ - _h42),\n          _15 = _u59 && t.refreshedUponExpiration ? 1 : e.clamp(_u59 ? _a118 : 1 - _l72, 0, 1);\n        return t.refreshedUponExpiration && _a118 >= 1 && (t.refreshedUponExpiration = !1), i ? {\n          opacity: 1,\n          mix: 1 - _15\n        } : {\n          opacity: _15,\n          mix: 0\n        };\n      }\n      return {\n        opacity: 1,\n        mix: 0\n      };\n    }\n    var Di = /*#__PURE__*/function (_e$SourceCache) {\n      _inherits(Di, _e$SourceCache);\n      function Di(e) {\n        var _this106;\n        _classCallCheck(this, Di);\n        var t = {\n            type: \"raster-dem\",\n            maxzoom: e.transform.maxZoom\n          },\n          i = new z(je(), null),\n          o = Pe(\"mock-dem\", t, i, e.style);\n        _this106 = _possibleConstructorReturn(this, _getPrototypeOf(Di).call(this, \"mock-dem\", o, !1)), o.setEventedParent(_assertThisInitialized(_assertThisInitialized(_this106))), _this106._sourceLoaded = !0;\n        return _this106;\n      }\n      _createClass(Di, [{\n        key: \"_loadTile\",\n        value: function _loadTile(e, t) {\n          e.state = \"loaded\", t(null);\n        }\n      }]);\n      return Di;\n    }(e.SourceCache);\n    var Li = /*#__PURE__*/function (_e$SourceCache2) {\n      _inherits(Li, _e$SourceCache2);\n      function Li(e) {\n        var _this107;\n        _classCallCheck(this, Li);\n        var t = Pe(\"proxy\", {\n          type: \"geojson\",\n          maxzoom: e.transform.maxZoom\n        }, new z(je(), null), e.style);\n        _this107 = _possibleConstructorReturn(this, _getPrototypeOf(Li).call(this, \"proxy\", t, !1)), t.setEventedParent(_assertThisInitialized(_assertThisInitialized(_this107))), _this107.map = _this107.getSource().map = e, _this107.used = _this107._sourceLoaded = !0, _this107.renderCache = [], _this107.renderCachePool = [], _this107.proxyCachedFBO = {};\n        return _this107;\n      }\n      _createClass(Li, [{\n        key: \"update\",\n        value: function update(t, i, o) {\n          var _this108 = this;\n          if (t.freezeTileCoverage) return;\n          this.transform = t;\n          var r = t.coveringTiles({\n            tileSize: this._source.tileSize,\n            minzoom: this._source.minzoom,\n            maxzoom: this._source.maxzoom,\n            roundZoom: this._source.roundZoom,\n            reparseOverscaled: this._source.reparseOverscaled\n          }).reduce(function (i, o) {\n            if (i[o.key] = \"\", !_this108._tiles[o.key]) {\n              var _i234 = new e.Tile(o, _this108._source.tileSize * o.overscaleFactor(), t.tileZoom);\n              _i234.state = \"loaded\", _this108._tiles[o.key] = _i234;\n            }\n            return i;\n          }, {});\n          for (var _e379 in this._tiles) _e379 in r || (this.freeFBO(_e379), this._tiles[_e379].unloadVectorData(), delete this._tiles[_e379]);\n        }\n      }, {\n        key: \"freeFBO\",\n        value: function freeFBO(e) {\n          var t = this.proxyCachedFBO[e];\n          if (void 0 !== t) {\n            var _this$renderCachePool;\n            var _i235 = Object.values(t);\n            (_this$renderCachePool = this.renderCachePool).push.apply(_this$renderCachePool, _i235), delete this.proxyCachedFBO[e];\n          }\n        }\n      }, {\n        key: \"deallocRenderCache\",\n        value: function deallocRenderCache() {\n          this.renderCache.forEach(function (e) {\n            return e.fb.destroy();\n          }), this.renderCache = [], this.renderCachePool = [], this.proxyCachedFBO = {};\n        }\n      }]);\n      return Li;\n    }(e.SourceCache);\n    var Ai = /*#__PURE__*/function (_e$OverscaledTileID) {\n      _inherits(Ai, _e$OverscaledTileID);\n      function Ai(e, t, i) {\n        var _this109;\n        _classCallCheck(this, Ai);\n        _this109 = _possibleConstructorReturn(this, _getPrototypeOf(Ai).call(this, e.overscaledZ, e.wrap, e.canonical.z, e.canonical.x, e.canonical.y)), _this109.proxyTileKey = t, _this109.projMatrix = i;\n        return _this109;\n      }\n      return Ai;\n    }(e.OverscaledTileID);\n    var zi = /*#__PURE__*/function (_e$Elevation) {\n      _inherits(zi, _e$Elevation);\n      function zi(t, i) {\n        var _this110;\n        _classCallCheck(this, zi);\n        _this110 = _possibleConstructorReturn(this, _getPrototypeOf(zi).call(this)), _this110.painter = t, _this110.terrainTileForTile = {}, _this110.prevTerrainTileForTile = {};\n        var _ref137 = function (t) {\n            var i = new e.StructArrayLayout2i4(),\n              o = new e.StructArrayLayout3ui6(),\n              r = 131;\n            i.reserve(17161), o.reserve(33800);\n            var n = e.EXTENT / 128,\n              s = e.EXTENT + n / 2,\n              a = s + n;\n            for (var _t389 = -n; _t389 < a; _t389 += n) for (var _o121 = -n; _o121 < a; _o121 += n) {\n              var _r259 = _o121 < 0 || _o121 > s || _t389 < 0 || _t389 > s ? 24575 : 0,\n                _n180 = e.clamp(Math.round(_o121), 0, e.EXTENT),\n                _a119 = e.clamp(Math.round(_t389), 0, e.EXTENT);\n              i.emplaceBack(_n180 + _r259, _a119);\n            }\n            var l = function l(e, t) {\n              var i = t * r + e;\n              o.emplaceBack(i + 1, i, i + r), o.emplaceBack(i + r, i + r + 1, i + 1);\n            };\n            for (var _e380 = 1; _e380 < 129; _e380++) for (var _t390 = 1; _t390 < 129; _t390++) l(_t390, _e380);\n            return [0, 129].forEach(function (e) {\n              for (var _t391 = 0; _t391 < 130; _t391++) l(_t391, e), l(e, _t391);\n            }), [i, o, 32768];\n          }(),\n          _ref138 = _slicedToArray(_ref137, 3),\n          o = _ref138[0],\n          r = _ref138[1],\n          n = _ref138[2],\n          s = t.context;\n        _this110.gridBuffer = s.createVertexBuffer(o, e.posAttributes.members), _this110.gridIndexBuffer = s.createIndexBuffer(r), _this110.gridSegments = e.SegmentVector.simpleSegment(0, 0, o.length, r.length), _this110.gridNoSkirtSegments = e.SegmentVector.simpleSegment(0, 0, o.length, n), _this110.proxyCoords = [], _this110.proxiedCoords = {}, _this110._visibleDemTiles = [], _this110._drapedRenderBatches = [], _this110._sourceTilesOverlap = {}, _this110.proxySourceCache = new Li(i.map), _this110.orthoMatrix = e.create(), e.ortho(_this110.orthoMatrix, \"globe\" === _this110.painter.transform.projection.name ? .015 : 0, e.EXTENT, 0, e.EXTENT, 0, 1);\n        var a = s.gl;\n        _this110._overlapStencilMode = new e.StencilMode({\n          func: a.GEQUAL,\n          mask: 255\n        }, 0, 255, a.KEEP, a.KEEP, a.REPLACE), _this110._previousZoom = t.transform.zoom, _this110.pool = [], _this110._findCoveringTileCache = {}, _this110._tilesDirty = {}, _this110.style = i, _this110._useVertexMorphing = !0, _this110._exaggeration = 1, _this110._mockSourceCache = new Di(i.map);\n        return _this110;\n      }\n      _createClass(zi, [{\n        key: \"update\",\n        value: function update(t, i, o) {\n          var _this111 = this;\n          if (t && t.terrain) {\n            this._style !== t && (this.style = t), this.enabled = !0;\n            var _r260 = t.terrain.properties;\n            this.sourceCache = 0 === t.terrain.drapeRenderMode ? this._mockSourceCache : t._getSourceCache(_r260.get(\"source\")), this._exaggeration = _r260.get(\"exaggeration\");\n            var _n181 = function _n181() {\n              _this111.sourceCache.used && e.warnOnce(\"Raster DEM source '\".concat(_this111.sourceCache.id, \"' is used both for terrain and as layer source.\\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.\"));\n              var t = _this111.getScaledDemTileSize();\n              _this111.sourceCache.update(i, t, !0), _this111.resetTileLookupCache(_this111.sourceCache.id);\n            };\n            this.sourceCache.usedForTerrain || (this.resetTileLookupCache(this.sourceCache.id), this.sourceCache.usedForTerrain = !0, _n181(), this._initializing = !0), _n181(), i.updateElevation(!0, o), this.resetTileLookupCache(this.proxySourceCache.id), this.proxySourceCache.update(i), this._emptyDEMTextureDirty = !0;\n          } else this._disable();\n        }\n      }, {\n        key: \"resetTileLookupCache\",\n        value: function resetTileLookupCache(e) {\n          this._findCoveringTileCache[e] = {};\n        }\n      }, {\n        key: \"getScaledDemTileSize\",\n        value: function getScaledDemTileSize() {\n          return this.sourceCache.getSource().tileSize / 128 * this.proxySourceCache.getSource().tileSize;\n        }\n      }, {\n        key: \"_checkRenderCacheEfficiency\",\n        value: function _checkRenderCacheEfficiency() {\n          var t = this.renderCacheEfficiency(this._style);\n          this._style.map._optimizeForTerrain || 100 !== t.efficiency && e.warnOnce(\"Terrain render cache efficiency is not optimal (\".concat(t.efficiency, \"%) and performance\\n                may be affected negatively, consider placing all background, fill and line layers before layer\\n                with id '\").concat(t.firstUndrapedLayer, \"' or create a map using optimizeForTerrain: true option.\"));\n        }\n      }, {\n        key: \"_onStyleDataEvent\",\n        value: function _onStyleDataEvent(e) {\n          e.coord && \"source\" === e.dataType ? this._clearRenderCacheForTile(e.sourceCacheId, e.coord) : \"style\" === e.dataType && (this._invalidateRenderCache = !0);\n        }\n      }, {\n        key: \"_disable\",\n        value: function _disable() {\n          if (this.enabled && (this.enabled = !1, this._sharedDepthStencil = void 0, this.proxySourceCache.deallocRenderCache(), this._style)) for (var _e381 in this._style._sourceCaches) this._style._sourceCaches[_e381].usedForTerrain = !1;\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this._disable(), this._emptyDEMTexture && this._emptyDEMTexture.destroy(), this._emptyDepthBufferTexture && this._emptyDepthBufferTexture.destroy(), this.pool.forEach(function (e) {\n            return e.fb.destroy();\n          }), this.pool = [], this._depthFBO && (this._depthFBO.destroy(), this._depthFBO = void 0, this._depthTexture = void 0);\n        }\n      }, {\n        key: \"_source\",\n        value: function _source() {\n          return this.enabled ? this.sourceCache : null;\n        }\n      }, {\n        key: \"isUsingMockSource\",\n        value: function isUsingMockSource() {\n          return this.sourceCache === this._mockSourceCache;\n        }\n      }, {\n        key: \"exaggeration\",\n        value: function exaggeration() {\n          return this._exaggeration;\n        }\n      }, {\n        key: \"updateTileBinding\",\n        value: function updateTileBinding(t) {\n          var _this112 = this;\n          if (!this.enabled) return;\n          this.prevTerrainTileForTile = this.terrainTileForTile;\n          var i = this.proxySourceCache,\n            o = this.painter.transform;\n          this._initializing && (this._initializing = 0 === o._centerAltitude && -1 === this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(o.center), -1), this._emptyDEMTextureDirty = !this._initializing);\n          var r = this.proxyCoords = i.getIds().map(function (e) {\n            var t = i.getTileByID(e).tileID;\n            return t.projMatrix = o.calculateProjMatrix(t.toUnwrapped()), t;\n          });\n          !function (t, i) {\n            var o = i.transform.pointCoordinate(i.transform.getCameraPoint()),\n              r = new e.pointGeometry(o.x, o.y);\n            t.sort(function (t, i) {\n              if (i.overscaledZ - t.overscaledZ) return i.overscaledZ - t.overscaledZ;\n              var o = new e.pointGeometry(t.canonical.x + (1 << t.canonical.z) * t.wrap, t.canonical.y),\n                n = new e.pointGeometry(i.canonical.x + (1 << i.canonical.z) * i.wrap, i.canonical.y),\n                s = r.mult(1 << t.canonical.z);\n              return s.x -= .5, s.y -= .5, s.distSqr(o) - s.distSqr(n);\n            });\n          }(r, this.painter), this._previousZoom = o.zoom;\n          var n = this.proxyToSource || {};\n          this.proxyToSource = {}, r.forEach(function (e) {\n            _this112.proxyToSource[e.key] = {};\n          }), this.terrainTileForTile = {};\n          var s = this._style._sourceCaches;\n          for (var _e382 in s) {\n            var _i236 = s[_e382];\n            if (!_i236.used) continue;\n            if (_i236 !== this.sourceCache && this.resetTileLookupCache(_i236.id), this._setupProxiedCoordsForOrtho(_i236, t[_e382], n), _i236.usedForTerrain) continue;\n            var _o122 = t[_e382];\n            _i236.getSource().reparseOverscaled && this._assignTerrainTiles(_o122);\n          }\n          this.proxiedCoords[i.id] = r.map(function (e) {\n            return new Ai(e, e.key, _this112.orthoMatrix);\n          }), this._assignTerrainTiles(r), this._prepareDEMTextures(), this._setupDrapedRenderBatches(), this._initFBOPool(), this._setupRenderCache(n), this.renderingToTexture = !1, this._updateTimestamp = e.exported.now();\n          var a = {};\n          this._visibleDemTiles = [];\n          var _iterator237 = _createForOfIteratorHelper(this.proxyCoords),\n            _step237;\n          try {\n            for (_iterator237.s(); !(_step237 = _iterator237.n()).done;) {\n              var _e383 = _step237.value;\n              var _t392 = this.terrainTileForTile[_e383.key];\n              if (!_t392) continue;\n              var _i237 = _t392.tileID.key;\n              _i237 in a || (this._visibleDemTiles.push(_t392), a[_i237] = _i237);\n            }\n          } catch (err) {\n            _iterator237.e(err);\n          } finally {\n            _iterator237.f();\n          }\n        }\n      }, {\n        key: \"_assignTerrainTiles\",\n        value: function _assignTerrainTiles(e) {\n          var _this113 = this;\n          this._initializing || e.forEach(function (e) {\n            if (_this113.terrainTileForTile[e.key]) return;\n            var t = _this113._findTileCoveringTileID(e, _this113.sourceCache);\n            t && (_this113.terrainTileForTile[e.key] = t);\n          });\n        }\n      }, {\n        key: \"_prepareDEMTextures\",\n        value: function _prepareDEMTextures() {\n          var e = this.painter.context,\n            t = e.gl;\n          for (var _i238 in this.terrainTileForTile) {\n            var _o123 = this.terrainTileForTile[_i238],\n              _r261 = _o123.dem;\n            !_r261 || _o123.demTexture && !_o123.needsDEMTextureUpload || (e.activeTexture.set(t.TEXTURE1), gi(this.painter, _o123, _r261));\n          }\n        }\n      }, {\n        key: \"_prepareDemTileUniforms\",\n        value: function _prepareDemTileUniforms(e, t, i, o) {\n          if (!t || null == t.demTexture) return !1;\n          var r = e.tileID.canonical,\n            n = Math.pow(2, t.tileID.canonical.z - r.z),\n            s = o || \"\";\n          return i[\"u_dem_tl\".concat(s)] = [r.x * n % 1, r.y * n % 1], i[\"u_dem_scale\".concat(s)] = n, !0;\n        }\n      }, {\n        key: \"_getLoadedAreaMinimum\",\n        value: function _getLoadedAreaMinimum() {\n          var e = 0;\n          var t = this._visibleDemTiles.reduce(function (t, i) {\n            if (!i.dem) return t;\n            var o = i.dem.tree.minimums[0];\n            return o > 0 && e++, t + o;\n          }, 0);\n          return e ? t / e : 0;\n        }\n      }, {\n        key: \"_updateEmptyDEMTexture\",\n        value: function _updateEmptyDEMTexture() {\n          var t = this.painter.context,\n            i = t.gl;\n          t.activeTexture.set(i.TEXTURE2);\n          var o = this._getLoadedAreaMinimum(),\n            r = new e.RGBAImage({\n              width: 1,\n              height: 1\n            }, new Uint8Array(e.DEMData.pack(o, this.sourceCache.getSource().encoding)));\n          this._emptyDEMTextureDirty = !1;\n          var n = this._emptyDEMTexture;\n          return n ? n.update(r, {\n            premultiply: !1\n          }) : n = this._emptyDEMTexture = new e.Texture(t, r, i.RGBA, {\n            premultiply: !1\n          }), n;\n        }\n      }, {\n        key: \"setupElevationDraw\",\n        value: function setupElevationDraw(t, i, o) {\n          var r = this.painter.context,\n            n = r.gl,\n            s = (a = this.sourceCache.getSource().encoding, {\n              u_dem: 2,\n              u_dem_prev: 4,\n              u_dem_unpack: e.DEMData.getUnpackVector(a),\n              u_dem_tl: [0, 0],\n              u_dem_tl_prev: [0, 0],\n              u_dem_scale: 0,\n              u_dem_scale_prev: 0,\n              u_dem_size: 0,\n              u_dem_lerp: 1,\n              u_depth: 3,\n              u_depth_size_inv: [0, 0],\n              u_exaggeration: 0\n            });\n          var a;\n          s.u_dem_size = this.sourceCache.getSource().tileSize, s.u_exaggeration = this.exaggeration();\n          var l = null,\n            c = null,\n            h = 1;\n          if (o && o.morphing && this._useVertexMorphing) {\n            var _e384 = o.morphing.srcDemTile,\n              _i239 = o.morphing.dstDemTile;\n            h = o.morphing.phase, _e384 && _i239 && (this._prepareDemTileUniforms(t, _e384, s, \"_prev\") && (c = _e384), this._prepareDemTileUniforms(t, _i239, s) && (l = _i239));\n          }\n          if (c && l ? (r.activeTexture.set(n.TEXTURE2), l.demTexture.bind(n.NEAREST, n.CLAMP_TO_EDGE, n.NEAREST), r.activeTexture.set(n.TEXTURE4), c.demTexture.bind(n.NEAREST, n.CLAMP_TO_EDGE, n.NEAREST), s.u_dem_lerp = h) : (l = this.terrainTileForTile[t.tileID.key], r.activeTexture.set(n.TEXTURE2), (this._prepareDemTileUniforms(t, l, s) ? l.demTexture : this.emptyDEMTexture).bind(n.NEAREST, n.CLAMP_TO_EDGE)), r.activeTexture.set(n.TEXTURE3), o && o.useDepthForOcclusion ? (this._depthTexture && this._depthTexture.bind(n.NEAREST, n.CLAMP_TO_EDGE), this._depthFBO && (s.u_depth_size_inv = [1 / this._depthFBO.width, 1 / this._depthFBO.height])) : (this.emptyDepthBufferTexture.bind(n.NEAREST, n.CLAMP_TO_EDGE), s.u_depth_size_inv = [1, 1]), o && o.useMeterToDem && l) {\n            var _t393 = (1 << l.tileID.canonical.z) * e.mercatorZfromAltitude(1, this.painter.transform.center.lat) * this.sourceCache.getSource().tileSize;\n            s.u_meter_to_dem = _t393;\n          }\n          if (o && o.labelPlaneMatrixInv && (s.u_label_plane_matrix_inv = o.labelPlaneMatrixInv), i.setTerrainUniformValues(r, s), \"globe\" === this.painter.transform.projection.name) {\n            var _e385 = this.globeUniformValues(this.painter.transform, t.tileID.canonical, o && o.useDenormalizedUpVectorScale);\n            i.setGlobeUniformValues(r, _e385);\n          }\n        }\n      }, {\n        key: \"globeUniformValues\",\n        value: function globeUniformValues(t, i, o) {\n          var r = t.projection;\n          return {\n            u_tile_tl_up: r.upVector(i, 0, 0),\n            u_tile_tr_up: r.upVector(i, e.EXTENT, 0),\n            u_tile_br_up: r.upVector(i, e.EXTENT, e.EXTENT),\n            u_tile_bl_up: r.upVector(i, 0, e.EXTENT),\n            u_tile_up_scale: o ? e.globeMetersToEcef(1) : r.upVectorScale(i, t.center.lat, t.worldSize).metersToTile\n          };\n        }\n      }, {\n        key: \"renderToBackBuffer\",\n        value: function renderToBackBuffer(t) {\n          var i = this.painter,\n            o = this.painter.context;\n          0 !== t.length && (o.bindFramebuffer.set(null), o.viewport.set([0, 0, i.width, i.height]), i.gpuTimingDeferredRenderStart(), this.renderingToTexture = !1, function (t, i, o, r, n) {\n            if (\"globe\" === t.transform.projection.name) !function (t, i, o, r, n) {\n              var s = t.context,\n                a = s.gl;\n              var l, c;\n              var h = t.options.showTerrainWireframe ? 2 : 0,\n                u = t.transform,\n                _ = e.globeUseCustomAntiAliasing(t, s, u),\n                d = function d(e, i) {\n                  if (c === e) return;\n                  var o = [Ei[e], \"PROJECTION_GLOBE_VIEW\"];\n                  _ && o.push(\"CUSTOM_ANTIALIASING\"), i && o.push(Ei[h]), l = t.useProgram(\"globeRaster\", null, o), c = e;\n                },\n                p = t.colorModeForRenderPass(),\n                m = new e.DepthMode(a.LEQUAL, e.DepthMode.ReadWrite, t.depthRangeFor3D);\n              Ti.update(n);\n              var f = e.calculateGlobeMercatorMatrix(u),\n                g = [e.mercatorXfromLng(u.center.lng), e.mercatorYfromLat(u.center.lat)],\n                v = h ? [!1, !0] : [!1],\n                x = t.globeSharedBuffers,\n                y = [u.width * e.exported.devicePixelRatio, u.height * e.exported.devicePixelRatio],\n                b = Float32Array.from(u.globeMatrix),\n                w = {\n                  useDenormalizedUpVectorScale: !0\n                };\n              if (v.forEach(function (h) {\n                var u = t.transform,\n                  _ = Ci(u.zoom) * i.exaggeration();\n                c = -1;\n                var v = h ? a.LINES : a.TRIANGLES;\n                var _iterator238 = _createForOfIteratorHelper(r),\n                  _step238;\n                try {\n                  for (_iterator238.s(); !(_step238 = _iterator238.n()).done;) {\n                    var _c55 = _step238.value;\n                    var _r262 = o.getTile(_c55),\n                      _T6 = e.StencilMode.disabled,\n                      _E3 = i.prevTerrainTileForTile[_c55.key],\n                      _C2 = i.terrainTileForTile[_c55.key];\n                    wi(_E3, _C2) && Ti.newMorphing(_c55.key, _E3, _C2, n, 250), s.activeTexture.set(a.TEXTURE0), _r262.texture.bind(a.LINEAR, a.CLAMP_TO_EDGE);\n                    var _M6 = Ti.getMorphValuesForProxy(_c55.key),\n                      _I7 = _M6 ? 1 : 0;\n                    _M6 && e.extend$1(w, {\n                      morphing: {\n                        srcDemTile: _M6.from,\n                        dstDemTile: _M6.to,\n                        phase: e.easeCubicInOut(_M6.phase)\n                      }\n                    });\n                    var _S12 = e.tileCornersToBounds(_c55.canonical),\n                      _D2 = e.getLatitudinalLod(_S12.getCenter().lat),\n                      _L2 = e.getGridMatrix(_c55.canonical, _S12, _D2, u.worldSize / u._pixelsPerMercatorPixel),\n                      _A11 = e.globeNormalizeECEF(e.globeTileBounds(_c55.canonical)),\n                      _z3 = bi(u.projMatrix, b, f, _A11, e.globeToMercatorTransition(u.zoom), g, u.frustumCorners.TL, u.frustumCorners.TR, u.frustumCorners.BR, u.frustumCorners.BL, u.globeCenterInViewSpace, u.globeRadius, y, _, _L2);\n                    if (d(_I7, h), i.setupElevationDraw(_r262, l, w), t.prepareDrawProgram(s, l, _c55.toUnwrapped()), x) {\n                      var _ref139 = h ? x.getWirefameBuffers(t.context, _D2) : x.getGridBuffers(_D2, 0 !== _),\n                        _ref140 = _slicedToArray(_ref139, 3),\n                        _i240 = _ref140[0],\n                        _o124 = _ref140[1],\n                        _r263 = _ref140[2];\n                      l.draw(s, v, m, _T6, p, e.CullFaceMode.backCCW, _z3, \"globe_raster\", _i240, _o124, _r263);\n                    }\n                  }\n                } catch (err) {\n                  _iterator238.e(err);\n                } finally {\n                  _iterator238.f();\n                }\n              }), x) {\n                var _n182 = [\"GLOBE_POLES\", \"PROJECTION_GLOBE_VIEW\"];\n                _ && _n182.push(\"CUSTOM_ANTIALIASING\"), l = t.useProgram(\"globeRaster\", null, _n182);\n                var _iterator239 = _createForOfIteratorHelper(r),\n                  _step239;\n                try {\n                  var _loop12 = function _loop12() {\n                    var n = _step239.value;\n                    var _n$canonical = n.canonical,\n                      r = _n$canonical.x,\n                      c = _n$canonical.y,\n                      h = _n$canonical.z,\n                      _ = 0 === c,\n                      d = c === (1 << h) - 1,\n                      _x$getPoleBuffers = x.getPoleBuffers(h),\n                      _x$getPoleBuffers2 = _slicedToArray(_x$getPoleBuffers, 4),\n                      f = _x$getPoleBuffers2[0],\n                      v = _x$getPoleBuffers2[1],\n                      b = _x$getPoleBuffers2[2],\n                      T = _x$getPoleBuffers2[3];\n                    if (T && (_ || d)) {\n                      var _c56 = o.getTile(n);\n                      s.activeTexture.set(a.TEXTURE0), _c56.texture.bind(a.LINEAR, a.CLAMP_TO_EDGE);\n                      var _x16 = e.globePoleMatrixForTile(h, r, u);\n                      var _E4 = e.globeNormalizeECEF(e.globeTileBounds(n.canonical)),\n                        _C3 = function _C3(t, i) {\n                          return t.draw(s, a.TRIANGLES, m, e.StencilMode.disabled, p, e.CullFaceMode.disabled, bi(u.projMatrix, _x16, _x16, _E4, 0, g, u.frustumCorners.TL, u.frustumCorners.TR, u.frustumCorners.BR, u.frustumCorners.BL, u.globeCenterInViewSpace, u.globeRadius, y, 0), \"globe_pole_raster\", i, b, T);\n                        };\n                      i.setupElevationDraw(_c56, l, w), t.prepareDrawProgram(s, l, n.toUnwrapped()), _ && _C3(l, f), d && (_x16 = e.scale(e.create(), _x16, [1, -1, 1]), _C3(l, v));\n                    }\n                  };\n                  for (_iterator239.s(); !(_step239 = _iterator239.n()).done;) {\n                    _loop12();\n                  }\n                } catch (err) {\n                  _iterator239.e(err);\n                } finally {\n                  _iterator239.f();\n                }\n              }\n            }(t, i, o, r, n);else {\n              var _s143 = t.context,\n                _a120 = _s143.gl;\n              var _l73, _c57;\n              var _h43 = t.options.showTerrainWireframe ? 2 : 0,\n                _u60 = function _u60(e, i) {\n                  if (_c57 === e) return;\n                  var o = [Ei[e]];\n                  i && o.push(Ei[_h43]), _l73 = t.useProgram(\"terrainRaster\", null, o), _c57 = e;\n                },\n                _16 = t.colorModeForRenderPass(),\n                _d22 = new e.DepthMode(_a120.LEQUAL, e.DepthMode.ReadWrite, t.depthRangeFor3D);\n              Ti.update(n);\n              var _p36 = t.transform,\n                _m12 = Ci(_p36.zoom) * i.exaggeration();\n              (_h43 ? [!1, !0] : [!1]).forEach(function (h) {\n                _c57 = -1;\n                var f = h ? _a120.LINES : _a120.TRIANGLES,\n                  _ref141 = h ? i.getWirefameBuffer() : [i.gridIndexBuffer, i.gridSegments],\n                  _ref142 = _slicedToArray(_ref141, 2),\n                  g = _ref142[0],\n                  v = _ref142[1];\n                var _iterator240 = _createForOfIteratorHelper(r),\n                  _step240;\n                try {\n                  for (_iterator240.s(); !(_step240 = _iterator240.n()).done;) {\n                    var _c58 = _step240.value;\n                    var _r264 = o.getTile(_c58),\n                      _x17 = e.StencilMode.disabled,\n                      _y13 = i.prevTerrainTileForTile[_c58.key],\n                      _b11 = i.terrainTileForTile[_c58.key];\n                    wi(_y13, _b11) && Ti.newMorphing(_c58.key, _y13, _b11, n, 250), _s143.activeTexture.set(_a120.TEXTURE0), _r264.texture.bind(_a120.LINEAR, _a120.CLAMP_TO_EDGE, _a120.LINEAR_MIPMAP_NEAREST);\n                    var _w11 = Ti.getMorphValuesForProxy(_c58.key),\n                      _T7 = _w11 ? 1 : 0;\n                    var _E5 = void 0;\n                    _w11 && (_E5 = {\n                      morphing: {\n                        srcDemTile: _w11.from,\n                        dstDemTile: _w11.to,\n                        phase: e.easeCubicInOut(_w11.phase)\n                      }\n                    });\n                    var _C4 = yi(_c58.projMatrix, Mi(_c58.canonical, _p36.renderWorldCopies) ? _m12 / 10 : _m12);\n                    _u60(_T7, h), i.setupElevationDraw(_r264, _l73, _E5), t.prepareDrawProgram(_s143, _l73, _c58.toUnwrapped()), _l73.draw(_s143, f, _d22, _x17, _16, e.CullFaceMode.backCCW, _C4, \"terrain_raster\", i.gridBuffer, g, v);\n                  }\n                } catch (err) {\n                  _iterator240.e(err);\n                } finally {\n                  _iterator240.f();\n                }\n              });\n            }\n          }(i, this, this.proxySourceCache, t, this._updateTimestamp), this.renderingToTexture = !0, i.gpuTimingDeferredRenderEnd(), t.splice(0, t.length));\n        }\n      }, {\n        key: \"renderBatch\",\n        value: function renderBatch(t) {\n          if (0 === this._drapedRenderBatches.length) return t + 1;\n          this.renderingToTexture = !0;\n          var i = this.painter,\n            o = this.painter.context,\n            r = this.proxySourceCache,\n            n = this.proxiedCoords[r.id],\n            s = this._drapedRenderBatches.shift(),\n            a = [],\n            l = i.style.order;\n          var c = 0;\n          var _iterator241 = _createForOfIteratorHelper(n),\n            _step241;\n          try {\n            for (_iterator241.s(); !(_step241 = _iterator241.n()).done;) {\n              var _h44 = _step241.value;\n              var _n183 = r.getTileByID(_h44.proxyTileKey),\n                _u61 = r.proxyCachedFBO[_h44.key] ? r.proxyCachedFBO[_h44.key][t] : void 0,\n                _17 = void 0 !== _u61 ? r.renderCache[_u61] : this.pool[c++],\n                _d23 = void 0 !== _u61;\n              if (_n183.texture = _17.tex, _d23 && !_17.dirty) {\n                a.push(_n183.tileID);\n                continue;\n              }\n              var _p37 = void 0;\n              o.bindFramebuffer.set(_17.fb.framebuffer), this.renderedToTile = !1, _17.dirty && (o.clear({\n                color: e.Color.transparent,\n                stencil: 0\n              }), _17.dirty = !1);\n              for (var _e386 = s.start; _e386 <= s.end; ++_e386) {\n                var _t394 = i.style._layers[l[_e386]];\n                if (_t394.isHidden(i.transform.zoom)) continue;\n                var _r265 = i.style._getLayerSourceCache(_t394),\n                  _n184 = _r265 ? this.proxyToSource[_h44.key][_r265.id] : [_h44];\n                if (!_n184) continue;\n                var _s144 = _n184;\n                o.viewport.set([0, 0, _17.fb.width, _17.fb.height]), _p37 !== (_r265 ? _r265.id : null) && (this._setupStencil(_17, _n184, _t394, _r265), _p37 = _r265 ? _r265.id : null), i.renderLayer(i, _r265, _t394, _s144);\n              }\n              this.renderedToTile ? (_17.dirty = !0, a.push(_n183.tileID)) : _d23 || --c, 5 === c && (c = 0, this.renderToBackBuffer(a));\n            }\n          } catch (err) {\n            _iterator241.e(err);\n          } finally {\n            _iterator241.f();\n          }\n          return this.renderToBackBuffer(a), this.renderingToTexture = !1, o.bindFramebuffer.set(null), o.viewport.set([0, 0, i.width, i.height]), s.end + 1;\n        }\n      }, {\n        key: \"postRender\",\n        value: function postRender() {}\n      }, {\n        key: \"renderCacheEfficiency\",\n        value: function renderCacheEfficiency(e) {\n          var t = e.order.length;\n          if (0 === t) return {\n            efficiency: 100\n          };\n          var i,\n            o = 0,\n            r = 0,\n            n = !1;\n          for (var _s145 = 0; _s145 < t; ++_s145) {\n            var _t395 = e._layers[e.order[_s145]];\n            this._style.isLayerDraped(_t395) ? (n && ++o, ++r) : n || (n = !0, i = _t395.id);\n          }\n          return 0 === r ? {\n            efficiency: 100\n          } : {\n            efficiency: 100 * (1 - o / r),\n            firstUndrapedLayer: i\n          };\n        }\n      }, {\n        key: \"getMinElevationBelowMSL\",\n        value: function getMinElevationBelowMSL() {\n          var e = 0;\n          return this._visibleDemTiles.filter(function (e) {\n            return e.dem;\n          }).forEach(function (t) {\n            e = Math.min(e, t.dem.tree.minimums[0]);\n          }), 0 === e ? e : (e - 30) * this._exaggeration;\n        }\n      }, {\n        key: \"raycast\",\n        value: function raycast(e, t, i) {\n          if (!this._visibleDemTiles) return null;\n          var o = this._visibleDemTiles.filter(function (e) {\n            return e.dem;\n          }).map(function (o) {\n            var r = o.tileID,\n              n = 1 << r.overscaledZ,\n              _r$canonical = r.canonical,\n              s = _r$canonical.x,\n              a = _r$canonical.y,\n              l = s / n,\n              c = (s + 1) / n,\n              h = a / n,\n              u = (a + 1) / n;\n            return {\n              minx: l,\n              miny: h,\n              maxx: c,\n              maxy: u,\n              t: o.dem.tree.raycastRoot(l, h, c, u, e, t, i),\n              tile: o\n            };\n          });\n          o.sort(function (e, t) {\n            return (null !== e.t ? e.t : Number.MAX_VALUE) - (null !== t.t ? t.t : Number.MAX_VALUE);\n          });\n          var _iterator242 = _createForOfIteratorHelper(o),\n            _step242;\n          try {\n            for (_iterator242.s(); !(_step242 = _iterator242.n()).done;) {\n              var _r266 = _step242.value;\n              if (null == _r266.t) return null;\n              var _o125 = _r266.tile.dem.tree.raycast(_r266.minx, _r266.miny, _r266.maxx, _r266.maxy, e, t, i);\n              if (null != _o125) return _o125;\n            }\n          } catch (err) {\n            _iterator242.e(err);\n          } finally {\n            _iterator242.f();\n          }\n          return null;\n        }\n      }, {\n        key: \"_createFBO\",\n        value: function _createFBO() {\n          var t = this.painter.context,\n            i = t.gl,\n            o = this.drapeBufferSize;\n          t.activeTexture.set(i.TEXTURE0);\n          var r = new e.Texture(t, {\n            width: o[0],\n            height: o[1],\n            data: null\n          }, i.RGBA);\n          r.bind(i.LINEAR, i.CLAMP_TO_EDGE);\n          var n = t.createFramebuffer(o[0], o[1], !1);\n          return n.colorAttachment.set(r.texture), n.depthAttachment = new Ee(t, n.framebuffer), void 0 === this._sharedDepthStencil ? (this._sharedDepthStencil = t.createRenderbuffer(t.gl.DEPTH_STENCIL, o[0], o[1]), this._stencilRef = 0, n.depthAttachment.set(this._sharedDepthStencil), t.clear({\n            stencil: 0\n          })) : n.depthAttachment.set(this._sharedDepthStencil), t.extTextureFilterAnisotropic && !t.extTextureFilterAnisotropicForceOff && i.texParameterf(i.TEXTURE_2D, t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, t.extTextureFilterAnisotropicMax), {\n            fb: n,\n            tex: r,\n            dirty: !1\n          };\n        }\n      }, {\n        key: \"_initFBOPool\",\n        value: function _initFBOPool() {\n          for (; this.pool.length < Math.min(5, this.proxyCoords.length);) this.pool.push(this._createFBO());\n        }\n      }, {\n        key: \"_shouldDisableRenderCache\",\n        value: function _shouldDisableRenderCache() {\n          var _this114 = this;\n          if (this._style.light && this._style.light.hasTransition()) return !0;\n          for (var _e387 in this._style._sourceCaches) if (this._style._sourceCaches[_e387].hasTransition()) return !0;\n          return this._style.order.some(function (e) {\n            var t = _this114._style._layers[e],\n              i = t.isHidden(_this114.painter.transform.zoom);\n            return \"custom\" === t.type ? !i && t.shouldRedrape() : !i && t.hasTransition();\n          });\n        }\n      }, {\n        key: \"_clearLineLayersFromRenderCache\",\n        value: function _clearLineLayersFromRenderCache() {\n          var t = !1;\n          var _iterator243 = _createForOfIteratorHelper(this._style._getSources()),\n            _step243;\n          try {\n            for (_iterator243.s(); !(_step243 = _iterator243.n()).done;) {\n              var _e390 = _step243.value;\n              if (_e390 instanceof Ie) {\n                t = !0;\n                break;\n              }\n            }\n          } catch (err) {\n            _iterator243.e(err);\n          } finally {\n            _iterator243.f();\n          }\n          if (!t) return;\n          var i = {};\n          for (var _t396 = 0; _t396 < this._style.order.length; ++_t396) {\n            var _o126 = this._style._layers[this._style.order[_t396]],\n              _r267 = this._style._getLayerSourceCache(_o126);\n            if (_r267 && !i[_r267.id] && !_o126.isHidden(this.painter.transform.zoom) && \"line\" === _o126.type && _o126.widthExpression() instanceof e.ZoomDependentExpression) {\n              i[_r267.id] = !0;\n              var _iterator244 = _createForOfIteratorHelper(this.proxyCoords),\n                _step244;\n              try {\n                for (_iterator244.s(); !(_step244 = _iterator244.n()).done;) {\n                  var _e388 = _step244.value;\n                  var _t397 = this.proxyToSource[_e388.key][_r267.id];\n                  if (_t397) {\n                    var _iterator245 = _createForOfIteratorHelper(_t397),\n                      _step245;\n                    try {\n                      for (_iterator245.s(); !(_step245 = _iterator245.n()).done;) {\n                        var _e389 = _step245.value;\n                        this._clearRenderCacheForTile(_r267.id, _e389);\n                      }\n                    } catch (err) {\n                      _iterator245.e(err);\n                    } finally {\n                      _iterator245.f();\n                    }\n                  }\n                }\n              } catch (err) {\n                _iterator244.e(err);\n              } finally {\n                _iterator244.f();\n              }\n            }\n          }\n        }\n      }, {\n        key: \"_clearRasterLayersFromRenderCache\",\n        value: function _clearRasterLayersFromRenderCache() {\n          var e = !1;\n          for (var _t398 in this._style._sourceCaches) if (this._style._sourceCaches[_t398]._source instanceof Se) {\n            e = !0;\n            break;\n          }\n          if (!e) return;\n          var t = {};\n          for (var _e391 = 0; _e391 < this._style.order.length; ++_e391) {\n            var _i241 = this._style._layers[this._style.order[_e391]],\n              _o127 = this._style._getLayerSourceCache(_i241);\n            if (!_o127 || t[_o127.id]) continue;\n            if (_i241.isHidden(this.painter.transform.zoom) || \"raster\" !== _i241.type) continue;\n            var _r268 = _i241.paint.get(\"raster-fade-duration\");\n            var _iterator246 = _createForOfIteratorHelper(this.proxyCoords),\n              _step246;\n            try {\n              for (_iterator246.s(); !(_step246 = _iterator246.n()).done;) {\n                var _e392 = _step246.value;\n                var _t399 = this.proxyToSource[_e392.key][_o127.id];\n                if (_t399) {\n                  var _iterator247 = _createForOfIteratorHelper(_t399),\n                    _step247;\n                  try {\n                    for (_iterator247.s(); !(_step247 = _iterator247.n()).done;) {\n                      var _e393 = _step247.value;\n                      var _t400 = Si(_o127.getTile(_e393), _o127.findLoadedParent(_e393, 0), _o127, this.painter.transform, _r268);\n                      (1 !== _t400.opacity || 0 !== _t400.mix) && this._clearRenderCacheForTile(_o127.id, _e393);\n                    }\n                  } catch (err) {\n                    _iterator247.e(err);\n                  } finally {\n                    _iterator247.f();\n                  }\n                }\n              }\n            } catch (err) {\n              _iterator246.e(err);\n            } finally {\n              _iterator246.f();\n            }\n          }\n        }\n      }, {\n        key: \"_setupDrapedRenderBatches\",\n        value: function _setupDrapedRenderBatches() {\n          var e = this._style.order,\n            t = e.length;\n          if (0 === t) return;\n          var i = [];\n          var o,\n            r = 0,\n            n = this._style._layers[e[r]];\n          for (; !this._style.isLayerDraped(n) && n.isHidden(this.painter.transform.zoom) && ++r < t;) n = this._style._layers[e[r]];\n          for (; r < t; ++r) {\n            var _t401 = this._style._layers[e[r]];\n            _t401.isHidden(this.painter.transform.zoom) || (this._style.isLayerDraped(_t401) ? void 0 === o && (o = r) : void 0 !== o && (i.push({\n              start: o,\n              end: r - 1\n            }), o = void 0));\n          }\n          void 0 !== o && i.push({\n            start: o,\n            end: r - 1\n          }), this._drapedRenderBatches = i;\n        }\n      }, {\n        key: \"_setupRenderCache\",\n        value: function _setupRenderCache(e) {\n          var t = this.proxySourceCache;\n          if (this._shouldDisableRenderCache() || this._invalidateRenderCache) {\n            if (this._invalidateRenderCache = !1, t.renderCache.length > t.renderCachePool.length) {\n              var _e394 = Object.values(t.proxyCachedFBO);\n              t.proxyCachedFBO = {};\n              for (var _i242 = 0; _i242 < _e394.length; ++_i242) {\n                var _t$renderCachePool;\n                var _o128 = Object.values(_e394[_i242]);\n                (_t$renderCachePool = t.renderCachePool).push.apply(_t$renderCachePool, _o128);\n              }\n            }\n            return;\n          }\n          this._clearRasterLayersFromRenderCache();\n          var i = this.proxyCoords,\n            o = this._tilesDirty;\n          for (var _r269 = i.length - 1; _r269 >= 0; _r269--) {\n            var _n185 = i[_r269];\n            if (t.getTileByID(_n185.key), void 0 !== t.proxyCachedFBO[_n185.key]) {\n              var _i243 = e[_n185.key],\n                _r270 = this.proxyToSource[_n185.key];\n              var _s146 = 0;\n              var _loop13 = function _loop13(_e395) {\n                var t = _r270[_e395],\n                  n = _i243[_e395];\n                if (!n || n.length !== t.length || t.some(function (t, i) {\n                  return t !== n[i] || o[_e395] && o[_e395].hasOwnProperty(t.key);\n                })) {\n                  _s146 = -1;\n                  return \"break\";\n                }\n                ++_s146;\n              };\n              for (var _e395 in _r270) {\n                var _ret5 = _loop13(_e395);\n                if (_ret5 === \"break\") break;\n              }\n              for (var _e396 in t.proxyCachedFBO[_n185.key]) t.renderCache[t.proxyCachedFBO[_n185.key][_e396]].dirty = _s146 < 0 || _s146 !== Object.values(_i243).length;\n            }\n          }\n          var r = _toConsumableArray(this._drapedRenderBatches);\n          r.sort(function (e, t) {\n            return t.end - t.start - (e.end - e.start);\n          });\n          var _iterator248 = _createForOfIteratorHelper(r),\n            _step248;\n          try {\n            for (_iterator248.s(); !(_step248 = _iterator248.n()).done;) {\n              var _e397 = _step248.value;\n              var _iterator249 = _createForOfIteratorHelper(i),\n                _step249;\n              try {\n                for (_iterator249.s(); !(_step249 = _iterator249.n()).done;) {\n                  var _o129 = _step249.value;\n                  if (t.proxyCachedFBO[_o129.key]) continue;\n                  var _i244 = t.renderCachePool.pop();\n                  void 0 === _i244 && t.renderCache.length < 50 && (_i244 = t.renderCache.length, t.renderCache.push(this._createFBO())), void 0 !== _i244 && (t.proxyCachedFBO[_o129.key] = {}, t.proxyCachedFBO[_o129.key][_e397.start] = _i244, t.renderCache[_i244].dirty = !0);\n                }\n              } catch (err) {\n                _iterator249.e(err);\n              } finally {\n                _iterator249.f();\n              }\n            }\n          } catch (err) {\n            _iterator248.e(err);\n          } finally {\n            _iterator248.f();\n          }\n          this._tilesDirty = {};\n        }\n      }, {\n        key: \"_setupStencil\",\n        value: function _setupStencil(e, t, i, o) {\n          if (!o || !this._sourceTilesOverlap[o.id]) return void (this._overlapStencilType && (this._overlapStencilType = !1));\n          var r = this.painter.context,\n            n = r.gl;\n          if (t.length <= 1) return void (this._overlapStencilType = !1);\n          var s;\n          if (i.isTileClipped()) s = t.length, this._overlapStencilMode.test = {\n            func: n.EQUAL,\n            mask: 255\n          }, this._overlapStencilType = \"Clip\";else {\n            if (!(t[0].overscaledZ > t[t.length - 1].overscaledZ)) return void (this._overlapStencilType = !1);\n            s = 1, this._overlapStencilMode.test = {\n              func: n.GREATER,\n              mask: 255\n            }, this._overlapStencilType = \"Mask\";\n          }\n          this._stencilRef + s > 255 && (r.clear({\n            stencil: 0\n          }), this._stencilRef = 0), this._stencilRef += s, this._overlapStencilMode.ref = this._stencilRef, i.isTileClipped() && this._renderTileClippingMasks(t, this._overlapStencilMode.ref);\n        }\n      }, {\n        key: \"clipOrMaskOverlapStencilType\",\n        value: function clipOrMaskOverlapStencilType() {\n          return \"Clip\" === this._overlapStencilType || \"Mask\" === this._overlapStencilType;\n        }\n      }, {\n        key: \"stencilModeForRTTOverlap\",\n        value: function stencilModeForRTTOverlap(t) {\n          return this.renderingToTexture && this._overlapStencilType ? (\"Clip\" === this._overlapStencilType && (this._overlapStencilMode.ref = this.painter._tileClippingMaskIDs[t.key]), this._overlapStencilMode) : e.StencilMode.disabled;\n        }\n      }, {\n        key: \"_renderTileClippingMasks\",\n        value: function _renderTileClippingMasks(t, i) {\n          var o = this.painter,\n            r = this.painter.context,\n            n = r.gl;\n          o._tileClippingMaskIDs = {}, r.setColorMode(e.ColorMode.disabled), r.setDepthMode(e.DepthMode.disabled);\n          var s = o.useProgram(\"clippingMask\");\n          var _iterator250 = _createForOfIteratorHelper(t),\n            _step250;\n          try {\n            for (_iterator250.s(); !(_step250 = _iterator250.n()).done;) {\n              var _a121 = _step250.value;\n              var _t402 = o._tileClippingMaskIDs[_a121.key] = --i;\n              s.draw(r, n.TRIANGLES, e.DepthMode.disabled, new e.StencilMode({\n                func: n.ALWAYS,\n                mask: 0\n              }, _t402, 255, n.KEEP, n.KEEP, n.REPLACE), e.ColorMode.disabled, e.CullFaceMode.disabled, Ii(_a121.projMatrix), \"$clipping\", o.tileExtentBuffer, o.quadTriangleIndexBuffer, o.tileExtentSegments);\n            }\n          } catch (err) {\n            _iterator250.e(err);\n          } finally {\n            _iterator250.f();\n          }\n        }\n      }, {\n        key: \"pointCoordinate\",\n        value: function pointCoordinate(t) {\n          var i = this.painter.transform;\n          if (t.x < 0 || t.x > i.width || t.y < 0 || t.y > i.height) return null;\n          var o = [t.x, t.y, 1, 1];\n          e.transformMat4$1(o, o, i.pixelMatrixInverse), e.scale$1(o, o, 1 / o[3]), o[0] /= i.worldSize, o[1] /= i.worldSize;\n          var r = i._camera.position,\n            n = e.mercatorZfromAltitude(1, i.center.lat),\n            s = [r[0], r[1], r[2] / n, 0],\n            a = e.subtract([], o.slice(0, 3), s);\n          e.normalize(a, a);\n          var l = this.raycast(s, a, this._exaggeration);\n          return null !== l && l ? (e.scaleAndAdd(s, s, a, l), s[3] = s[2], s[2] *= n, s) : null;\n        }\n      }, {\n        key: \"drawDepth\",\n        value: function drawDepth() {\n          var t = this.painter,\n            i = t.context,\n            o = this.proxySourceCache,\n            r = Math.ceil(t.width),\n            n = Math.ceil(t.height);\n          if (!this._depthFBO || this._depthFBO.width === r && this._depthFBO.height === n || (this._depthFBO.destroy(), this._depthFBO = void 0, this._depthTexture = void 0), !this._depthFBO) {\n            var _t403 = i.gl,\n              _o130 = i.createFramebuffer(r, n, !0);\n            i.activeTexture.set(_t403.TEXTURE0);\n            var _s147 = new e.Texture(i, {\n              width: r,\n              height: n,\n              data: null\n            }, _t403.RGBA);\n            _s147.bind(_t403.NEAREST, _t403.CLAMP_TO_EDGE), _o130.colorAttachment.set(_s147.texture);\n            var _a122 = i.createRenderbuffer(i.gl.DEPTH_COMPONENT16, r, n);\n            _o130.depthAttachment.set(_a122), this._depthFBO = _o130, this._depthTexture = _s147;\n          }\n          i.bindFramebuffer.set(this._depthFBO.framebuffer), i.viewport.set([0, 0, r, n]), function (t, i, o, r) {\n            if (\"globe\" === t.transform.projection.name) return;\n            var n = t.context,\n              s = n.gl;\n            n.clear({\n              depth: 1\n            });\n            var a = t.useProgram(\"terrainDepth\"),\n              l = new e.DepthMode(s.LESS, e.DepthMode.ReadWrite, t.depthRangeFor3D);\n            var _iterator251 = _createForOfIteratorHelper(r),\n              _step251;\n            try {\n              for (_iterator251.s(); !(_step251 = _iterator251.n()).done;) {\n                var _t404 = _step251.value;\n                var _r271 = o.getTile(_t404),\n                  _c59 = yi(_t404.projMatrix, 0);\n                i.setupElevationDraw(_r271, a), a.draw(n, s.TRIANGLES, l, e.StencilMode.disabled, e.ColorMode.unblended, e.CullFaceMode.backCCW, _c59, \"terrain_depth\", i.gridBuffer, i.gridIndexBuffer, i.gridNoSkirtSegments);\n              }\n            } catch (err) {\n              _iterator251.e(err);\n            } finally {\n              _iterator251.f();\n            }\n          }(t, this, o, this.proxyCoords);\n        }\n      }, {\n        key: \"_setupProxiedCoordsForOrtho\",\n        value: function _setupProxiedCoordsForOrtho(e, t, i) {\n          if (e.getSource() instanceof Ae) return this._setupProxiedCoordsForImageSource(e, t, i);\n          this._findCoveringTileCache[e.id] = this._findCoveringTileCache[e.id] || {};\n          var o = this.proxiedCoords[e.id] = [],\n            r = this.proxyCoords;\n          for (var _t405 = 0; _t405 < r.length; _t405++) {\n            var _n186 = r[_t405],\n              _s148 = this._findTileCoveringTileID(_n186, e);\n            if (_s148) {\n              var _t406 = this._createProxiedId(_n186, _s148, i[_n186.key] && i[_n186.key][e.id]);\n              o.push(_t406), this.proxyToSource[_n186.key][e.id] = [_t406];\n            }\n          }\n          var n = !1;\n          for (var _r272 = 0; _r272 < t.length; _r272++) {\n            var _s149 = e.getTile(t[_r272]);\n            if (!_s149 || !_s149.hasData()) continue;\n            var _a123 = this._findTileCoveringTileID(_s149.tileID, this.proxySourceCache);\n            if (_a123 && _a123.tileID.canonical.z !== _s149.tileID.canonical.z) {\n              var _t407 = this.proxyToSource[_a123.tileID.key][e.id],\n                _r273 = this._createProxiedId(_a123.tileID, _s149, i[_a123.tileID.key] && i[_a123.tileID.key][e.id]);\n              _t407 ? _t407.splice(_t407.length - 1, 0, _r273) : this.proxyToSource[_a123.tileID.key][e.id] = [_r273], o.push(_r273), n = !0;\n            }\n          }\n          this._sourceTilesOverlap[e.id] = n;\n        }\n      }, {\n        key: \"_setupProxiedCoordsForImageSource\",\n        value: function _setupProxiedCoordsForImageSource(t, i, o) {\n          if (!t.getSource().loaded()) return;\n          var r = this.proxiedCoords[t.id] = [],\n            n = this.proxyCoords,\n            s = t.getSource(),\n            a = new e.pointGeometry(s.tileID.x, s.tileID.y)._div(1 << s.tileID.z),\n            l = s.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce(function (e, t) {\n              return e.min.x = Math.min(e.min.x, t.x - a.x), e.min.y = Math.min(e.min.y, t.y - a.y), e.max.x = Math.max(e.max.x, t.x - a.x), e.max.y = Math.max(e.max.y, t.y - a.y), e;\n            }, {\n              min: new e.pointGeometry(Number.MAX_VALUE, Number.MAX_VALUE),\n              max: new e.pointGeometry(-Number.MAX_VALUE, -Number.MAX_VALUE)\n            }),\n            c = function c(t, i) {\n              var o = t.wrap + t.canonical.x / (1 << t.canonical.z),\n                r = t.canonical.y / (1 << t.canonical.z),\n                n = e.EXTENT / (1 << t.canonical.z),\n                s = i.wrap + i.canonical.x / (1 << i.canonical.z),\n                a = i.canonical.y / (1 << i.canonical.z);\n              return o + n < s + l.min.x || o > s + l.max.x || r + n < a + l.min.y || r > a + l.max.y;\n            };\n          for (var _e398 = 0; _e398 < n.length; _e398++) {\n            var _s150 = n[_e398];\n            for (var _e399 = 0; _e399 < i.length; _e399++) {\n              var _n187 = t.getTile(i[_e399]);\n              if (!_n187 || !_n187.hasData()) continue;\n              if (c(_s150, _n187.tileID)) continue;\n              var _a124 = this._createProxiedId(_s150, _n187, o[_s150.key] && o[_s150.key][t.id]),\n                _l74 = this.proxyToSource[_s150.key][t.id];\n              _l74 ? _l74.push(_a124) : this.proxyToSource[_s150.key][t.id] = [_a124], r.push(_a124);\n            }\n          }\n        }\n      }, {\n        key: \"_createProxiedId\",\n        value: function _createProxiedId(t, i, o) {\n          var r = this.orthoMatrix;\n          if (o) {\n            var _e400 = o.find(function (e) {\n              return e.key === i.tileID.key;\n            });\n            if (_e400) return _e400;\n          }\n          if (i.tileID.key !== t.key) {\n            var _o131 = t.canonical.z - i.tileID.canonical.z;\n            var _n188, _s151, _a125;\n            r = e.create();\n            var _l75 = i.tileID.wrap - t.wrap << t.overscaledZ;\n            _o131 > 0 ? (_n188 = e.EXTENT >> _o131, _s151 = _n188 * ((i.tileID.canonical.x << _o131) - t.canonical.x + _l75), _a125 = _n188 * ((i.tileID.canonical.y << _o131) - t.canonical.y)) : (_n188 = e.EXTENT << -_o131, _s151 = e.EXTENT * (i.tileID.canonical.x - (t.canonical.x + _l75 << -_o131)), _a125 = e.EXTENT * (i.tileID.canonical.y - (t.canonical.y << -_o131))), e.ortho(r, 0, _n188, 0, _n188, 0, 1), e.translate(r, r, [_s151, _a125, 0]);\n          }\n          return new Ai(i.tileID, t.key, r);\n        }\n      }, {\n        key: \"_findTileCoveringTileID\",\n        value: function _findTileCoveringTileID(t, i) {\n          var o = i.getTile(t);\n          if (o && o.hasData()) return o;\n          var r = this._findCoveringTileCache[i.id],\n            n = r[t.key];\n          if (o = n ? i.getTileByID(n) : null, o && o.hasData() || null === n) return o;\n          var s = o ? o.tileID : t,\n            a = s.overscaledZ;\n          var l = i.getSource().minzoom,\n            c = [];\n          if (!n) {\n            var _r274 = i.getSource().maxzoom;\n            if (t.canonical.z >= _r274) {\n              var _o132 = t.canonical.z - _r274;\n              i.getSource().reparseOverscaled ? (a = Math.max(t.canonical.z + 2, i.transform.tileZoom), s = new e.OverscaledTileID(a, t.wrap, _r274, t.canonical.x >> _o132, t.canonical.y >> _o132)) : 0 !== _o132 && (a = _r274, s = new e.OverscaledTileID(a, t.wrap, _r274, t.canonical.x >> _o132, t.canonical.y >> _o132));\n            }\n            s.key !== t.key && (c.push(s.key), o = i.getTile(s));\n          }\n          var h = function h(e) {\n            c.forEach(function (t) {\n              r[t] = e;\n            }), c.length = 0;\n          };\n          for (a -= 1; a >= l && (!o || !o.hasData()); a--) {\n            o && h(o.tileID.key);\n            var _e401 = s.calculateScaledKey(a);\n            if (o = i.getTileByID(_e401), o && o.hasData()) break;\n            var _t408 = r[_e401];\n            if (null === _t408) break;\n            void 0 === _t408 ? c.push(_e401) : o = i.getTileByID(_t408);\n          }\n          return h(o ? o.tileID.key : null), o && o.hasData() ? o : null;\n        }\n      }, {\n        key: \"findDEMTileFor\",\n        value: function findDEMTileFor(e) {\n          return this.enabled ? this._findTileCoveringTileID(e, this.sourceCache) : null;\n        }\n      }, {\n        key: \"prepareDrawTile\",\n        value: function prepareDrawTile() {\n          this.renderedToTile = !0;\n        }\n      }, {\n        key: \"_clearRenderCacheForTile\",\n        value: function _clearRenderCacheForTile(e, t) {\n          var i = this._tilesDirty[e];\n          i || (i = this._tilesDirty[e] = {}), i[t.key] = !0;\n        }\n      }, {\n        key: \"getWirefameBuffer\",\n        value: function getWirefameBuffer() {\n          if (!this.wireframeSegments) {\n            var _t409 = function (t) {\n              var i = 0;\n              var o = new e.StructArrayLayout2ui4(),\n                r = 131;\n              for (var _e402 = 1; _e402 < 129; _e402++) {\n                for (var _t410 = 1; _t410 < 129; _t410++) i = _e402 * r + _t410, o.emplaceBack(i, i + 1), o.emplaceBack(i, i + r), o.emplaceBack(i + 1, i + r), 128 === _e402 && o.emplaceBack(i + r, i + r + 1);\n                o.emplaceBack(i + 1, i + 1 + r);\n              }\n              return o;\n            }();\n            this.wireframeIndexBuffer = this.painter.context.createIndexBuffer(_t409), this.wireframeSegments = e.SegmentVector.simpleSegment(0, 0, this.gridBuffer.length, _t409.length);\n          }\n          return [this.wireframeIndexBuffer, this.wireframeSegments];\n        }\n      }, {\n        key: \"style\",\n        set: function set(e) {\n          var _this115 = this;\n          e.on(\"data\", this._onStyleDataEvent.bind(this)), e.on(\"neworder\", this._checkRenderCacheEfficiency.bind(this)), this._style = e, this._checkRenderCacheEfficiency(), this._style.map.on(\"moveend\", function () {\n            _this115._clearLineLayersFromRenderCache();\n          });\n        }\n      }, {\n        key: \"visibleDemTiles\",\n        get: function get() {\n          return this._visibleDemTiles;\n        }\n      }, {\n        key: \"drapeBufferSize\",\n        get: function get() {\n          var e = 2 * this.proxySourceCache.getSource().tileSize;\n          return [e, e];\n        }\n      }, {\n        key: \"useVertexMorphing\",\n        set: function set(e) {\n          this._useVertexMorphing = e;\n        }\n      }, {\n        key: \"emptyDEMTexture\",\n        get: function get() {\n          return !this._emptyDEMTextureDirty && this._emptyDEMTexture ? this._emptyDEMTexture : this._updateEmptyDEMTexture();\n        }\n      }, {\n        key: \"emptyDepthBufferTexture\",\n        get: function get() {\n          var t = this.painter.context,\n            i = t.gl;\n          if (!this._emptyDepthBufferTexture) {\n            var _o133 = new e.RGBAImage({\n              width: 1,\n              height: 1\n            }, Uint8Array.of(255, 255, 255, 255));\n            this._emptyDepthBufferTexture = new e.Texture(t, _o133, i.RGBA, {\n              premultiply: !1\n            });\n          }\n          return this._emptyDepthBufferTexture;\n        }\n      }]);\n      return zi;\n    }(e.Elevation);\n    var Pi = /*#__PURE__*/function () {\n      _createClass(Pi, null, [{\n        key: \"cacheKey\",\n        value: function cacheKey(e, t, i, o) {\n          var r = \"\".concat(t).concat(o ? o.cacheKey : \"\");\n          var _iterator252 = _createForOfIteratorHelper(i),\n            _step252;\n          try {\n            for (_iterator252.s(); !(_step252 = _iterator252.n()).done;) {\n              var _t411 = _step252.value;\n              e.usedDefines.includes(_t411) && (r += \"/\".concat(_t411));\n            }\n          } catch (err) {\n            _iterator252.e(err);\n          } finally {\n            _iterator252.f();\n          }\n          return r;\n        }\n      }]);\n      function Pi(t, i, o, r, n, s) {\n        _classCallCheck(this, Pi);\n        var a = t.gl;\n        this.program = a.createProgram();\n        var l = function (e) {\n            var t = [];\n            for (var _i245 = 0; _i245 < e.length; _i245++) {\n              if (null === e[_i245]) continue;\n              var _o134 = e[_i245].split(\" \");\n              t.push(_o134.pop());\n            }\n            return t;\n          }(o.staticAttributes),\n          c = r ? r.getBinderAttributes() : [],\n          h = l.concat(c);\n        var u = r ? r.defines() : [];\n        u = u.concat(s.map(function (e) {\n          return \"#define \".concat(e);\n        }));\n        var _ = t.isWebGL2 ? \"#version 300 es\\n\" : \"\",\n          d = _ + u.concat(t.extStandardDerivatives && 0 === _.length ? \"#extension GL_OES_standard_derivatives : enable\\n\".concat(hi) : hi, hi, ci, li.fragmentSource, si.fragmentSource, o.fragmentSource).join(\"\\n\"),\n          p = _ + u.concat(\"\\n#ifdef GL_ES\\nprecision highp float;\\n#else\\n\\n#if !defined(lowp)\\n#define lowp\\n#endif\\n\\n#if !defined(mediump)\\n#define mediump\\n#endif\\n\\n#if !defined(highp)\\n#define highp\\n#endif\\n\\n#endif\", ci, li.vertexSource, si.vertexSource, ni.vertexSource, o.vertexSource).join(\"\\n\"),\n          m = a.createShader(a.FRAGMENT_SHADER);\n        if (a.isContextLost()) return void (this.failedToCreate = !0);\n        a.shaderSource(m, d), a.compileShader(m), a.attachShader(this.program, m);\n        var f = a.createShader(a.VERTEX_SHADER);\n        if (a.isContextLost()) this.failedToCreate = !0;else {\n          a.shaderSource(f, p), a.compileShader(f), a.attachShader(this.program, f), this.attributes = {}, this.numAttributes = h.length;\n          for (var _e403 = 0; _e403 < this.numAttributes; _e403++) h[_e403] && (a.bindAttribLocation(this.program, _e403, h[_e403]), this.attributes[h[_e403]] = _e403);\n          a.linkProgram(this.program), a.deleteShader(f), a.deleteShader(m), this.fixedUniforms = n(t), this.binderUniforms = r ? r.getUniforms(t) : [], s.includes(\"TERRAIN\") && (this.terrainUniforms = function (t) {\n            return {\n              u_dem: new e.Uniform1i(t),\n              u_dem_prev: new e.Uniform1i(t),\n              u_dem_unpack: new e.Uniform4f(t),\n              u_dem_tl: new e.Uniform2f(t),\n              u_dem_scale: new e.Uniform1f(t),\n              u_dem_tl_prev: new e.Uniform2f(t),\n              u_dem_scale_prev: new e.Uniform1f(t),\n              u_dem_size: new e.Uniform1f(t),\n              u_dem_lerp: new e.Uniform1f(t),\n              u_exaggeration: new e.Uniform1f(t),\n              u_depth: new e.Uniform1i(t),\n              u_depth_size_inv: new e.Uniform2f(t),\n              u_meter_to_dem: new e.Uniform1f(t),\n              u_label_plane_matrix_inv: new e.UniformMatrix4f(t)\n            };\n          }(t)), s.includes(\"GLOBE\") && (this.globeUniforms = function (t) {\n            return {\n              u_tile_tl_up: new e.Uniform3f(t),\n              u_tile_tr_up: new e.Uniform3f(t),\n              u_tile_br_up: new e.Uniform3f(t),\n              u_tile_bl_up: new e.Uniform3f(t),\n              u_tile_up_scale: new e.Uniform1f(t)\n            };\n          }(t)), s.includes(\"FOG\") && (this.fogUniforms = function (t) {\n            return {\n              u_fog_matrix: new e.UniformMatrix4f(t),\n              u_fog_range: new e.Uniform2f(t),\n              u_fog_color: new e.Uniform4f(t),\n              u_fog_horizon_blend: new e.Uniform1f(t),\n              u_fog_temporal_offset: new e.Uniform1f(t),\n              u_frustum_tl: new e.Uniform3f(t),\n              u_frustum_tr: new e.Uniform3f(t),\n              u_frustum_br: new e.Uniform3f(t),\n              u_frustum_bl: new e.Uniform3f(t),\n              u_globe_pos: new e.Uniform3f(t),\n              u_globe_radius: new e.Uniform1f(t),\n              u_globe_transition: new e.Uniform1f(t),\n              u_is_globe: new e.Uniform1i(t),\n              u_viewport: new e.Uniform2f(t)\n            };\n          }(t));\n        }\n      }\n      _createClass(Pi, [{\n        key: \"setTerrainUniformValues\",\n        value: function setTerrainUniformValues(e, t) {\n          if (!this.terrainUniforms) return;\n          var i = this.terrainUniforms;\n          if (!this.failedToCreate) {\n            e.program.set(this.program);\n            for (var _e404 in t) i[_e404] && i[_e404].set(this.program, _e404, t[_e404]);\n          }\n        }\n      }, {\n        key: \"setGlobeUniformValues\",\n        value: function setGlobeUniformValues(e, t) {\n          if (!this.globeUniforms) return;\n          var i = this.globeUniforms;\n          if (!this.failedToCreate) {\n            e.program.set(this.program);\n            for (var _e405 in t) i[_e405] && i[_e405].set(this.program, _e405, t[_e405]);\n          }\n        }\n      }, {\n        key: \"setFogUniformValues\",\n        value: function setFogUniformValues(e, t) {\n          if (!this.fogUniforms) return;\n          var i = this.fogUniforms;\n          if (!this.failedToCreate) {\n            e.program.set(this.program);\n            for (var _e406 in t) i[_e406].set(this.program, _e406, t[_e406]);\n          }\n        }\n      }, {\n        key: \"draw\",\n        value: function draw(e, t, i, o, r, n, s, a, l, c, h, u, _, d, p) {\n          var _m$LINES$m$TRIANGLES$;\n          var m = e.gl;\n          if (this.failedToCreate) return;\n          e.program.set(this.program), e.setDepthMode(i), e.setStencilMode(o), e.setColorMode(r), e.setCullFace(n);\n          for (var _i246 = 0, _Object$keys14 = Object.keys(this.fixedUniforms); _i246 < _Object$keys14.length; _i246++) {\n            var _e407 = _Object$keys14[_i246];\n            this.fixedUniforms[_e407].set(this.program, _e407, s[_e407]);\n          }\n          d && d.setUniforms(this.program, e, this.binderUniforms, u, {\n            zoom: _\n          });\n          var f = (_m$LINES$m$TRIANGLES$ = {}, _defineProperty(_m$LINES$m$TRIANGLES$, m.LINES, 2), _defineProperty(_m$LINES$m$TRIANGLES$, m.TRIANGLES, 3), _defineProperty(_m$LINES$m$TRIANGLES$, m.LINE_STRIP, 1), _m$LINES$m$TRIANGLES$)[t];\n          var _iterator253 = _createForOfIteratorHelper(h.get()),\n            _step253;\n          try {\n            for (_iterator253.s(); !(_step253 = _iterator253.n()).done;) {\n              var _i247 = _step253.value;\n              var _o135 = _i247.vaos || (_i247.vaos = {});\n              (_o135[a] || (_o135[a] = new pi())).bind(e, this, l, d ? d.getPaintVertexBuffers() : [], c, _i247.vertexOffset, p || []), m.drawElements(t, _i247.primitiveLength * f, m.UNSIGNED_SHORT, _i247.primitiveOffset * f * 2);\n            }\n          } catch (err) {\n            _iterator253.e(err);\n          } finally {\n            _iterator253.f();\n          }\n        }\n      }]);\n      return Pi;\n    }();\n    function Ri(e, t) {\n      var i = Math.pow(2, t.tileID.overscaledZ),\n        o = t.tileSize * Math.pow(2, e.transform.tileZoom) / i,\n        r = o * (t.tileID.canonical.x + t.tileID.wrap * i),\n        n = o * t.tileID.canonical.y;\n      return {\n        u_image: 0,\n        u_texsize: t.imageAtlasTexture.size,\n        u_tile_units_to_pixels: 1 / P(t, 1, e.transform.tileZoom),\n        u_pixel_coord_upper: [r >> 16, n >> 16],\n        u_pixel_coord_lower: [65535 & r, 65535 & n]\n      };\n    }\n    var Oi = e.create(),\n      Bi = function Bi(t, i, o, r, n, s, a, l, c, h, u) {\n        var _ = i.style.light,\n          d = _.properties.get(\"position\"),\n          p = [d.x, d.y, d.z],\n          m = e.create$1();\n        \"viewport\" === _.properties.get(\"anchor\") && (e.fromRotation(m, -i.transform.angle), e.transformMat3(p, p, m));\n        var f = _.properties.get(\"color\"),\n          g = i.transform,\n          v = {\n            u_matrix: t,\n            u_lightpos: p,\n            u_lightintensity: _.properties.get(\"intensity\"),\n            u_lightcolor: [f.r, f.g, f.b],\n            u_vertical_gradient: +o,\n            u_opacity: r,\n            u_tile_id: [0, 0, 0],\n            u_zoom_transition: 0,\n            u_inv_rot_matrix: Oi,\n            u_merc_center: [0, 0],\n            u_up_dir: [0, 0, 0],\n            u_height_lift: 0,\n            u_ao: n,\n            u_edge_radius: s\n          };\n        return \"globe\" === g.projection.name && (v.u_tile_id = [a.canonical.x, a.canonical.y, 1 << a.canonical.z], v.u_zoom_transition = c, v.u_inv_rot_matrix = u, v.u_merc_center = h, v.u_up_dir = g.projection.upVector(new e.CanonicalTileID(0, 0, 0), h[0] * e.EXTENT, h[1] * e.EXTENT), v.u_height_lift = l), v;\n      },\n      ki = function ki(t, i, o, r, n, s, a, l, c, h, u, _) {\n        var d = Bi(t, i, o, r, n, s, a, c, h, u, _),\n          p = {\n            u_height_factor: -Math.pow(2, a.overscaledZ) / l.tileSize / 8\n          };\n        return e.extend(d, Ri(i, l), p);\n      },\n      Fi = function Fi(e) {\n        return {\n          u_matrix: e\n        };\n      },\n      Ui = function Ui(t, i, o) {\n        return e.extend(Fi(t), Ri(i, o));\n      },\n      Ni = function Ni(e, t) {\n        return {\n          u_matrix: e,\n          u_world: t\n        };\n      },\n      Gi = function Gi(t, i, o, r) {\n        return e.extend(Ui(t, i, o), {\n          u_world: r\n        });\n      },\n      ji = e.create(),\n      Zi = function Zi(t, i, o, r, n, s) {\n        var a = t.transform,\n          l = \"globe\" === a.projection.name;\n        var c;\n        if (\"map\" === s.paint.get(\"circle-pitch-alignment\")) {\n          if (l) {\n            var _t412 = e.globePixelsToTileUnits(a.zoom, i.canonical) * a._pixelsPerMercatorPixel;\n            c = Float32Array.from([_t412, 0, 0, _t412]);\n          } else c = a.calculatePixelsToTileUnitsMatrix(o);\n        } else c = new Float32Array([a.pixelsToGLUnits[0], 0, 0, a.pixelsToGLUnits[1]]);\n        var h = {\n          u_camera_to_center_distance: a.cameraToCenterDistance,\n          u_matrix: t.translatePosMatrix(i.projMatrix, o, s.paint.get(\"circle-translate\"), s.paint.get(\"circle-translate-anchor\")),\n          u_device_pixel_ratio: e.exported.devicePixelRatio,\n          u_extrude_scale: c,\n          u_inv_rot_matrix: ji,\n          u_merc_center: [0, 0],\n          u_tile_id: [0, 0, 0],\n          u_zoom_transition: 0,\n          u_up_dir: [0, 0, 0]\n        };\n        if (l) {\n          h.u_inv_rot_matrix = r, h.u_merc_center = n, h.u_tile_id = [i.canonical.x, i.canonical.y, 1 << i.canonical.z], h.u_zoom_transition = e.globeToMercatorTransition(a.zoom);\n          var _t413 = n[0] * e.EXTENT,\n            _o136 = n[1] * e.EXTENT;\n          h.u_up_dir = a.projection.upVector(new e.CanonicalTileID(0, 0, 0), _t413, _o136);\n        }\n        return h;\n      },\n      Vi = function Vi(e) {\n        var t = [];\n        return \"map\" === e.paint.get(\"circle-pitch-alignment\") && t.push(\"PITCH_WITH_MAP\"), \"map\" === e.paint.get(\"circle-pitch-scale\") && t.push(\"SCALE_WITH_MAP\"), t;\n      },\n      Wi = function Wi(t, i, o, r) {\n        var n = e.EXTENT / o.tileSize;\n        return {\n          u_matrix: t,\n          u_camera_to_center_distance: i.getCameraToCenterDistance(r),\n          u_extrude_scale: [i.pixelsToGLUnits[0] / n, i.pixelsToGLUnits[1] / n]\n        };\n      },\n      Xi = function Xi(e, t) {\n        var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n        return {\n          u_matrix: e,\n          u_color: t,\n          u_overlay: 0,\n          u_overlay_scale: i\n        };\n      },\n      qi = e.create(),\n      $i = function $i(t, i, o, r, n, s, a) {\n        var l = t.transform,\n          c = \"globe\" === l.projection.name,\n          h = c ? e.globePixelsToTileUnits(l.zoom, i.canonical) * l._pixelsPerMercatorPixel : P(o, 1, s),\n          u = {\n            u_matrix: i.projMatrix,\n            u_extrude_scale: h,\n            u_intensity: a,\n            u_inv_rot_matrix: qi,\n            u_merc_center: [0, 0],\n            u_tile_id: [0, 0, 0],\n            u_zoom_transition: 0,\n            u_up_dir: [0, 0, 0]\n          };\n        if (c) {\n          u.u_inv_rot_matrix = r, u.u_merc_center = n, u.u_tile_id = [i.canonical.x, i.canonical.y, 1 << i.canonical.z], u.u_zoom_transition = e.globeToMercatorTransition(l.zoom);\n          var _t414 = n[0] * e.EXTENT,\n            _o137 = n[1] * e.EXTENT;\n          u.u_up_dir = l.projection.upVector(new e.CanonicalTileID(0, 0, 0), _t414, _o137);\n        }\n        return u;\n      },\n      Hi = function Hi(e, t, i, o, r, n, s) {\n        var a = e.transform,\n          l = a.calculatePixelsToTileUnitsMatrix(t);\n        return {\n          u_matrix: Ji(e, t, i, o),\n          u_pixels_to_tile_units: l,\n          u_device_pixel_ratio: n,\n          u_units_to_pixels: [1 / a.pixelsToGLUnits[0], 1 / a.pixelsToGLUnits[1]],\n          u_dash_image: 0,\n          u_gradient_image: 1,\n          u_image_height: r,\n          u_texsize: Qi(i) ? t.lineAtlasTexture.size : [0, 0],\n          u_tile_units_to_pixels: Ki(t, e.transform),\n          u_alpha_discard_threshold: 0,\n          u_trim_offset: s\n        };\n      },\n      Yi = function Yi(e, t, i, o, r) {\n        var n = e.transform;\n        return {\n          u_matrix: Ji(e, t, i, o),\n          u_texsize: t.imageAtlasTexture.size,\n          u_pixels_to_tile_units: n.calculatePixelsToTileUnitsMatrix(t),\n          u_device_pixel_ratio: r,\n          u_image: 0,\n          u_tile_units_to_pixels: Ki(t, n),\n          u_units_to_pixels: [1 / n.pixelsToGLUnits[0], 1 / n.pixelsToGLUnits[1]],\n          u_alpha_discard_threshold: 0\n        };\n      };\n    function Ki(e, t) {\n      return 1 / P(e, 1, t.tileZoom);\n    }\n    function Ji(e, t, i, o) {\n      return e.translatePosMatrix(o || t.tileID.projMatrix, t, i.paint.get(\"line-translate\"), i.paint.get(\"line-translate-anchor\"));\n    }\n    function Qi(e) {\n      var t = e.paint.get(\"line-dasharray\").value;\n      return t.value || \"constant\" !== t.kind;\n    }\n    var eo = function eo(e, t, i, o, r, n) {\n      return {\n        u_matrix: e,\n        u_tl_parent: t,\n        u_scale_parent: i,\n        u_fade_t: o.mix,\n        u_opacity: o.opacity * r.paint.get(\"raster-opacity\"),\n        u_image0: 0,\n        u_image1: 1,\n        u_brightness_low: r.paint.get(\"raster-brightness-min\"),\n        u_brightness_high: r.paint.get(\"raster-brightness-max\"),\n        u_saturation_factor: (a = r.paint.get(\"raster-saturation\"), a > 0 ? 1 - 1 / (1.001 - a) : -a),\n        u_contrast_factor: (s = r.paint.get(\"raster-contrast\"), s > 0 ? 1 / (1 - s) : 1 + s),\n        u_spin_weights: to(r.paint.get(\"raster-hue-rotate\")),\n        u_perspective_transform: n\n      };\n      var s, a;\n    };\n    function to(e) {\n      e *= Math.PI / 180;\n      var t = Math.sin(e),\n        i = Math.cos(e);\n      return [(2 * i + 1) / 3, (-Math.sqrt(3) * t - i + 1) / 3, (Math.sqrt(3) * t - i + 1) / 3];\n    }\n    var io = e.create(),\n      oo = function oo(t, i, o, r, n, s, a, l, c, h, u, _, d, p, m, f) {\n        var g = n.transform,\n          v = {\n            u_is_size_zoom_constant: +(\"constant\" === t || \"source\" === t),\n            u_is_size_feature_constant: +(\"constant\" === t || \"camera\" === t),\n            u_size_t: i ? i.uSizeT : 0,\n            u_size: i ? i.uSize : 0,\n            u_camera_to_center_distance: g.cameraToCenterDistance,\n            u_rotate_symbol: +o,\n            u_aspect_ratio: g.width / g.height,\n            u_fade_change: n.options.fadeDuration ? n.symbolFadeChange : 1,\n            u_matrix: s,\n            u_label_plane_matrix: a,\n            u_coord_matrix: l,\n            u_is_text: +c,\n            u_pitch_with_map: +r,\n            u_texsize: h,\n            u_texture: 0,\n            u_tile_id: [0, 0, 0],\n            u_zoom_transition: 0,\n            u_inv_rot_matrix: io,\n            u_merc_center: [0, 0],\n            u_camera_forward: [0, 0, 0],\n            u_ecef_origin: [0, 0, 0],\n            u_tile_matrix: io,\n            u_up_vector: [0, -1, 0]\n          };\n        return \"globe\" === f.name && (v.u_tile_id = [u.canonical.x, u.canonical.y, 1 << u.canonical.z], v.u_zoom_transition = _, v.u_inv_rot_matrix = p, v.u_merc_center = d, v.u_camera_forward = g._camera.forward(), v.u_ecef_origin = e.globeECEFOrigin(g.globeMatrix, u.toUnwrapped()), v.u_tile_matrix = Float32Array.from(g.globeMatrix), v.u_up_vector = m), v;\n      },\n      ro = function ro(t, i, o, r, n, s, a, l, c, h, u, _, d, p, m, f, g) {\n        return e.extend(oo(t, i, o, r, n, s, a, l, c, h, _, d, p, m, f, g), {\n          u_gamma_scale: r ? n.transform.cameraToCenterDistance * Math.cos(n.terrain ? 0 : n.transform._pitch) : 1,\n          u_device_pixel_ratio: e.exported.devicePixelRatio,\n          u_is_halo: +u\n        });\n      },\n      no = function no(t, i, o, r, n, s, a, l, c, h, u, _, d, p, m, f) {\n        return e.extend(ro(t, i, o, r, n, s, a, l, !0, c, !0, u, _, d, p, m, f), {\n          u_texsize_icon: h,\n          u_texture_icon: 1\n        });\n      },\n      so = function so(e, t, i) {\n        return {\n          u_matrix: e,\n          u_opacity: t,\n          u_color: i\n        };\n      },\n      ao = function ao(t, i, o, r, n) {\n        return e.extend(function (e, t, i) {\n          var o = t.imageManager.getPattern(e.toString()),\n            _t$imageManager$getPi = t.imageManager.getPixelSize(),\n            r = _t$imageManager$getPi.width,\n            n = _t$imageManager$getPi.height,\n            s = Math.pow(2, i.tileID.overscaledZ),\n            a = i.tileSize * Math.pow(2, t.transform.tileZoom) / s,\n            l = a * (i.tileID.canonical.x + i.tileID.wrap * s),\n            c = a * i.tileID.canonical.y;\n          return {\n            u_image: 0,\n            u_pattern_tl: o.tl,\n            u_pattern_br: o.br,\n            u_texsize: [r, n],\n            u_pattern_size: o.displaySize,\n            u_tile_units_to_pixels: 1 / P(i, 1, t.transform.tileZoom),\n            u_pixel_coord_upper: [l >> 16, c >> 16],\n            u_pixel_coord_lower: [65535 & l, 65535 & c]\n          };\n        }(r, o, n), {\n          u_matrix: t,\n          u_opacity: i\n        });\n      },\n      lo = {\n        fillExtrusion: function fillExtrusion(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_lightpos: new e.Uniform3f(t),\n            u_lightintensity: new e.Uniform1f(t),\n            u_lightcolor: new e.Uniform3f(t),\n            u_vertical_gradient: new e.Uniform1f(t),\n            u_opacity: new e.Uniform1f(t),\n            u_edge_radius: new e.Uniform1f(t),\n            u_ao: new e.Uniform2f(t),\n            u_tile_id: new e.Uniform3f(t),\n            u_zoom_transition: new e.Uniform1f(t),\n            u_inv_rot_matrix: new e.UniformMatrix4f(t),\n            u_merc_center: new e.Uniform2f(t),\n            u_up_dir: new e.Uniform3f(t),\n            u_height_lift: new e.Uniform1f(t)\n          };\n        },\n        fillExtrusionPattern: function fillExtrusionPattern(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_lightpos: new e.Uniform3f(t),\n            u_lightintensity: new e.Uniform1f(t),\n            u_lightcolor: new e.Uniform3f(t),\n            u_vertical_gradient: new e.Uniform1f(t),\n            u_height_factor: new e.Uniform1f(t),\n            u_edge_radius: new e.Uniform1f(t),\n            u_ao: new e.Uniform2f(t),\n            u_tile_id: new e.Uniform3f(t),\n            u_zoom_transition: new e.Uniform1f(t),\n            u_inv_rot_matrix: new e.UniformMatrix4f(t),\n            u_merc_center: new e.Uniform2f(t),\n            u_up_dir: new e.Uniform3f(t),\n            u_height_lift: new e.Uniform1f(t),\n            u_image: new e.Uniform1i(t),\n            u_texsize: new e.Uniform2f(t),\n            u_pixel_coord_upper: new e.Uniform2f(t),\n            u_pixel_coord_lower: new e.Uniform2f(t),\n            u_tile_units_to_pixels: new e.Uniform1f(t),\n            u_opacity: new e.Uniform1f(t)\n          };\n        },\n        fill: function fill(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t)\n          };\n        },\n        fillPattern: function fillPattern(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_image: new e.Uniform1i(t),\n            u_texsize: new e.Uniform2f(t),\n            u_pixel_coord_upper: new e.Uniform2f(t),\n            u_pixel_coord_lower: new e.Uniform2f(t),\n            u_tile_units_to_pixels: new e.Uniform1f(t)\n          };\n        },\n        fillOutline: function fillOutline(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_world: new e.Uniform2f(t)\n          };\n        },\n        fillOutlinePattern: function fillOutlinePattern(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_world: new e.Uniform2f(t),\n            u_image: new e.Uniform1i(t),\n            u_texsize: new e.Uniform2f(t),\n            u_pixel_coord_upper: new e.Uniform2f(t),\n            u_pixel_coord_lower: new e.Uniform2f(t),\n            u_tile_units_to_pixels: new e.Uniform1f(t)\n          };\n        },\n        circle: function circle(t) {\n          return {\n            u_camera_to_center_distance: new e.Uniform1f(t),\n            u_extrude_scale: new e.UniformMatrix2f(t),\n            u_device_pixel_ratio: new e.Uniform1f(t),\n            u_matrix: new e.UniformMatrix4f(t),\n            u_inv_rot_matrix: new e.UniformMatrix4f(t),\n            u_merc_center: new e.Uniform2f(t),\n            u_tile_id: new e.Uniform3f(t),\n            u_zoom_transition: new e.Uniform1f(t),\n            u_up_dir: new e.Uniform3f(t)\n          };\n        },\n        collisionBox: function collisionBox(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_camera_to_center_distance: new e.Uniform1f(t),\n            u_extrude_scale: new e.Uniform2f(t)\n          };\n        },\n        collisionCircle: function collisionCircle(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_inv_matrix: new e.UniformMatrix4f(t),\n            u_camera_to_center_distance: new e.Uniform1f(t),\n            u_viewport_size: new e.Uniform2f(t)\n          };\n        },\n        debug: function debug(t) {\n          return {\n            u_color: new e.UniformColor(t),\n            u_matrix: new e.UniformMatrix4f(t),\n            u_overlay: new e.Uniform1i(t),\n            u_overlay_scale: new e.Uniform1f(t)\n          };\n        },\n        clippingMask: function clippingMask(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t)\n          };\n        },\n        heatmap: function heatmap(t) {\n          return {\n            u_extrude_scale: new e.Uniform1f(t),\n            u_intensity: new e.Uniform1f(t),\n            u_matrix: new e.UniformMatrix4f(t),\n            u_inv_rot_matrix: new e.UniformMatrix4f(t),\n            u_merc_center: new e.Uniform2f(t),\n            u_tile_id: new e.Uniform3f(t),\n            u_zoom_transition: new e.Uniform1f(t),\n            u_up_dir: new e.Uniform3f(t)\n          };\n        },\n        heatmapTexture: function heatmapTexture(t) {\n          return {\n            u_image: new e.Uniform1i(t),\n            u_color_ramp: new e.Uniform1i(t),\n            u_opacity: new e.Uniform1f(t)\n          };\n        },\n        hillshade: function hillshade(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_image: new e.Uniform1i(t),\n            u_latrange: new e.Uniform2f(t),\n            u_light: new e.Uniform2f(t),\n            u_shadow: new e.UniformColor(t),\n            u_highlight: new e.UniformColor(t),\n            u_accent: new e.UniformColor(t)\n          };\n        },\n        hillshadePrepare: function hillshadePrepare(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_image: new e.Uniform1i(t),\n            u_dimension: new e.Uniform2f(t),\n            u_zoom: new e.Uniform1f(t),\n            u_unpack: new e.Uniform4f(t)\n          };\n        },\n        line: function line(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_pixels_to_tile_units: new e.UniformMatrix2f(t),\n            u_device_pixel_ratio: new e.Uniform1f(t),\n            u_units_to_pixels: new e.Uniform2f(t),\n            u_dash_image: new e.Uniform1i(t),\n            u_gradient_image: new e.Uniform1i(t),\n            u_image_height: new e.Uniform1f(t),\n            u_texsize: new e.Uniform2f(t),\n            u_tile_units_to_pixels: new e.Uniform1f(t),\n            u_alpha_discard_threshold: new e.Uniform1f(t),\n            u_trim_offset: new e.Uniform2f(t)\n          };\n        },\n        linePattern: function linePattern(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_texsize: new e.Uniform2f(t),\n            u_pixels_to_tile_units: new e.UniformMatrix2f(t),\n            u_device_pixel_ratio: new e.Uniform1f(t),\n            u_image: new e.Uniform1i(t),\n            u_units_to_pixels: new e.Uniform2f(t),\n            u_tile_units_to_pixels: new e.Uniform1f(t),\n            u_alpha_discard_threshold: new e.Uniform1f(t)\n          };\n        },\n        raster: function raster(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_tl_parent: new e.Uniform2f(t),\n            u_scale_parent: new e.Uniform1f(t),\n            u_fade_t: new e.Uniform1f(t),\n            u_opacity: new e.Uniform1f(t),\n            u_image0: new e.Uniform1i(t),\n            u_image1: new e.Uniform1i(t),\n            u_brightness_low: new e.Uniform1f(t),\n            u_brightness_high: new e.Uniform1f(t),\n            u_saturation_factor: new e.Uniform1f(t),\n            u_contrast_factor: new e.Uniform1f(t),\n            u_spin_weights: new e.Uniform3f(t),\n            u_perspective_transform: new e.Uniform2f(t)\n          };\n        },\n        symbolIcon: function symbolIcon(t) {\n          return {\n            u_is_size_zoom_constant: new e.Uniform1i(t),\n            u_is_size_feature_constant: new e.Uniform1i(t),\n            u_size_t: new e.Uniform1f(t),\n            u_size: new e.Uniform1f(t),\n            u_camera_to_center_distance: new e.Uniform1f(t),\n            u_rotate_symbol: new e.Uniform1i(t),\n            u_aspect_ratio: new e.Uniform1f(t),\n            u_fade_change: new e.Uniform1f(t),\n            u_matrix: new e.UniformMatrix4f(t),\n            u_label_plane_matrix: new e.UniformMatrix4f(t),\n            u_coord_matrix: new e.UniformMatrix4f(t),\n            u_is_text: new e.Uniform1i(t),\n            u_pitch_with_map: new e.Uniform1i(t),\n            u_texsize: new e.Uniform2f(t),\n            u_tile_id: new e.Uniform3f(t),\n            u_zoom_transition: new e.Uniform1f(t),\n            u_inv_rot_matrix: new e.UniformMatrix4f(t),\n            u_merc_center: new e.Uniform2f(t),\n            u_camera_forward: new e.Uniform3f(t),\n            u_tile_matrix: new e.UniformMatrix4f(t),\n            u_up_vector: new e.Uniform3f(t),\n            u_ecef_origin: new e.Uniform3f(t),\n            u_texture: new e.Uniform1i(t)\n          };\n        },\n        symbolSDF: function symbolSDF(t) {\n          return {\n            u_is_size_zoom_constant: new e.Uniform1i(t),\n            u_is_size_feature_constant: new e.Uniform1i(t),\n            u_size_t: new e.Uniform1f(t),\n            u_size: new e.Uniform1f(t),\n            u_camera_to_center_distance: new e.Uniform1f(t),\n            u_rotate_symbol: new e.Uniform1i(t),\n            u_aspect_ratio: new e.Uniform1f(t),\n            u_fade_change: new e.Uniform1f(t),\n            u_matrix: new e.UniformMatrix4f(t),\n            u_label_plane_matrix: new e.UniformMatrix4f(t),\n            u_coord_matrix: new e.UniformMatrix4f(t),\n            u_is_text: new e.Uniform1i(t),\n            u_pitch_with_map: new e.Uniform1i(t),\n            u_texsize: new e.Uniform2f(t),\n            u_texture: new e.Uniform1i(t),\n            u_gamma_scale: new e.Uniform1f(t),\n            u_device_pixel_ratio: new e.Uniform1f(t),\n            u_tile_id: new e.Uniform3f(t),\n            u_zoom_transition: new e.Uniform1f(t),\n            u_inv_rot_matrix: new e.UniformMatrix4f(t),\n            u_merc_center: new e.Uniform2f(t),\n            u_camera_forward: new e.Uniform3f(t),\n            u_tile_matrix: new e.UniformMatrix4f(t),\n            u_up_vector: new e.Uniform3f(t),\n            u_ecef_origin: new e.Uniform3f(t),\n            u_is_halo: new e.Uniform1i(t)\n          };\n        },\n        symbolTextAndIcon: function symbolTextAndIcon(t) {\n          return {\n            u_is_size_zoom_constant: new e.Uniform1i(t),\n            u_is_size_feature_constant: new e.Uniform1i(t),\n            u_size_t: new e.Uniform1f(t),\n            u_size: new e.Uniform1f(t),\n            u_camera_to_center_distance: new e.Uniform1f(t),\n            u_rotate_symbol: new e.Uniform1i(t),\n            u_aspect_ratio: new e.Uniform1f(t),\n            u_fade_change: new e.Uniform1f(t),\n            u_matrix: new e.UniformMatrix4f(t),\n            u_label_plane_matrix: new e.UniformMatrix4f(t),\n            u_coord_matrix: new e.UniformMatrix4f(t),\n            u_is_text: new e.Uniform1i(t),\n            u_pitch_with_map: new e.Uniform1i(t),\n            u_texsize: new e.Uniform2f(t),\n            u_texsize_icon: new e.Uniform2f(t),\n            u_texture: new e.Uniform1i(t),\n            u_texture_icon: new e.Uniform1i(t),\n            u_gamma_scale: new e.Uniform1f(t),\n            u_device_pixel_ratio: new e.Uniform1f(t),\n            u_is_halo: new e.Uniform1i(t)\n          };\n        },\n        background: function background(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_opacity: new e.Uniform1f(t),\n            u_color: new e.UniformColor(t)\n          };\n        },\n        backgroundPattern: function backgroundPattern(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_opacity: new e.Uniform1f(t),\n            u_image: new e.Uniform1i(t),\n            u_pattern_tl: new e.Uniform2f(t),\n            u_pattern_br: new e.Uniform2f(t),\n            u_texsize: new e.Uniform2f(t),\n            u_pattern_size: new e.Uniform2f(t),\n            u_pixel_coord_upper: new e.Uniform2f(t),\n            u_pixel_coord_lower: new e.Uniform2f(t),\n            u_tile_units_to_pixels: new e.Uniform1f(t)\n          };\n        },\n        terrainRaster: xi,\n        terrainDepth: xi,\n        skybox: function skybox(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_sun_direction: new e.Uniform3f(t),\n            u_cubemap: new e.Uniform1i(t),\n            u_opacity: new e.Uniform1f(t),\n            u_temporal_offset: new e.Uniform1f(t)\n          };\n        },\n        skyboxGradient: function skyboxGradient(t) {\n          return {\n            u_matrix: new e.UniformMatrix4f(t),\n            u_color_ramp: new e.Uniform1i(t),\n            u_center_direction: new e.Uniform3f(t),\n            u_radius: new e.Uniform1f(t),\n            u_opacity: new e.Uniform1f(t),\n            u_temporal_offset: new e.Uniform1f(t)\n          };\n        },\n        skyboxCapture: function skyboxCapture(t) {\n          return {\n            u_matrix_3f: new e.UniformMatrix3f(t),\n            u_sun_direction: new e.Uniform3f(t),\n            u_sun_intensity: new e.Uniform1f(t),\n            u_color_tint_r: new e.Uniform4f(t),\n            u_color_tint_m: new e.Uniform4f(t),\n            u_luminance: new e.Uniform1f(t)\n          };\n        },\n        globeRaster: function globeRaster(t) {\n          return {\n            u_proj_matrix: new e.UniformMatrix4f(t),\n            u_globe_matrix: new e.UniformMatrix4f(t),\n            u_normalize_matrix: new e.UniformMatrix4f(t),\n            u_merc_matrix: new e.UniformMatrix4f(t),\n            u_zoom_transition: new e.Uniform1f(t),\n            u_merc_center: new e.Uniform2f(t),\n            u_image0: new e.Uniform1i(t),\n            u_grid_matrix: new e.UniformMatrix3f(t),\n            u_skirt_height: new e.Uniform1f(t),\n            u_frustum_tl: new e.Uniform3f(t),\n            u_frustum_tr: new e.Uniform3f(t),\n            u_frustum_br: new e.Uniform3f(t),\n            u_frustum_bl: new e.Uniform3f(t),\n            u_globe_pos: new e.Uniform3f(t),\n            u_globe_radius: new e.Uniform1f(t),\n            u_viewport: new e.Uniform2f(t)\n          };\n        },\n        globeAtmosphere: function globeAtmosphere(t) {\n          return {\n            u_frustum_tl: new e.Uniform3f(t),\n            u_frustum_tr: new e.Uniform3f(t),\n            u_frustum_br: new e.Uniform3f(t),\n            u_frustum_bl: new e.Uniform3f(t),\n            u_horizon: new e.Uniform1f(t),\n            u_transition: new e.Uniform1f(t),\n            u_fadeout_range: new e.Uniform1f(t),\n            u_color: new e.Uniform4f(t),\n            u_high_color: new e.Uniform4f(t),\n            u_space_color: new e.Uniform4f(t),\n            u_star_intensity: new e.Uniform1f(t),\n            u_star_density: new e.Uniform1f(t),\n            u_star_size: new e.Uniform1f(t),\n            u_temporal_offset: new e.Uniform1f(t),\n            u_horizon_angle: new e.Uniform1f(t),\n            u_rotation_matrix: new e.UniformMatrix4f(t)\n          };\n        }\n      };\n    var co;\n    function ho(t, i, o, r, n, s, a) {\n      var l = t.context,\n        c = l.gl,\n        h = t.transform,\n        u = t.useProgram(\"collisionBox\"),\n        _ = [];\n      var d = 0,\n        p = 0;\n      for (var _m13 = 0; _m13 < r.length; _m13++) {\n        var _f25 = r[_m13],\n          _g19 = i.getTile(_f25),\n          _v13 = _g19.getBucket(o);\n        if (!_v13) continue;\n        var _x18 = yt(_f25, _v13, h);\n        var _y14 = _x18;\n        0 === n[0] && 0 === n[1] || (_y14 = t.translatePosMatrix(_x18, _g19, n, s));\n        var _b12 = a ? _v13.textCollisionBox : _v13.iconCollisionBox,\n          _w12 = _v13.collisionCircleArray;\n        if (_w12.length > 0) {\n          var _t415 = e.create(),\n            _i248 = _y14;\n          e.mul(_t415, _v13.placementInvProjMatrix, h.glCoordMatrix), e.mul(_t415, _t415, _v13.placementViewportMatrix), _.push({\n            circleArray: _w12,\n            circleOffset: p,\n            transform: _i248,\n            invTransform: _t415,\n            projection: _v13.getProjection()\n          }), d += _w12.length / 4, p = d;\n        }\n        _b12 && (t.terrain && t.terrain.setupElevationDraw(_g19, u), u.draw(l, c.LINES, e.DepthMode.disabled, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.disabled, Wi(_y14, h, _g19, _v13.getProjection()), o.id, _b12.layoutVertexBuffer, _b12.indexBuffer, _b12.segments, null, h.zoom, null, [_b12.collisionVertexBuffer, _b12.collisionVertexBufferExt]));\n      }\n      if (!a || !_.length) return;\n      var m = t.useProgram(\"collisionCircle\"),\n        f = new e.StructArrayLayout2f1f2i16();\n      f.resize(4 * d), f._trim();\n      var g = 0;\n      for (var _i249 = 0, _arr2 = _; _i249 < _arr2.length; _i249++) {\n        var _e408 = _arr2[_i249];\n        for (var _t416 = 0; _t416 < _e408.circleArray.length / 4; _t416++) {\n          var _i250 = 4 * _t416,\n            _o138 = _e408.circleArray[_i250 + 0],\n            _r275 = _e408.circleArray[_i250 + 1],\n            _n189 = _e408.circleArray[_i250 + 2],\n            _s152 = _e408.circleArray[_i250 + 3];\n          f.emplace(g++, _o138, _r275, _n189, _s152, 0), f.emplace(g++, _o138, _r275, _n189, _s152, 1), f.emplace(g++, _o138, _r275, _n189, _s152, 2), f.emplace(g++, _o138, _r275, _n189, _s152, 3);\n        }\n      }\n      (!co || co.length < 2 * d) && (co = function (t) {\n        var i = 2 * t,\n          o = new e.StructArrayLayout3ui6();\n        o.resize(i), o._trim();\n        for (var _e409 = 0; _e409 < i; _e409++) {\n          var _t417 = 6 * _e409;\n          o.uint16[_t417 + 0] = 4 * _e409 + 0, o.uint16[_t417 + 1] = 4 * _e409 + 1, o.uint16[_t417 + 2] = 4 * _e409 + 2, o.uint16[_t417 + 3] = 4 * _e409 + 2, o.uint16[_t417 + 4] = 4 * _e409 + 3, o.uint16[_t417 + 5] = 4 * _e409 + 0;\n        }\n        return o;\n      }(d));\n      var v = l.createIndexBuffer(co, !0),\n        x = l.createVertexBuffer(f, e.collisionCircleLayout.members, !0);\n      for (var _i251 = 0, _arr3 = _; _i251 < _arr3.length; _i251++) {\n        var _i252 = _arr3[_i251];\n        var _r276 = {\n          u_matrix: _i252.transform,\n          u_inv_matrix: _i252.invTransform,\n          u_camera_to_center_distance: (y = h).getCameraToCenterDistance(_i252.projection),\n          u_viewport_size: [y.width, y.height]\n        };\n        m.draw(l, c.TRIANGLES, e.DepthMode.disabled, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.disabled, _r276, o.id, x, v, e.SegmentVector.simpleSegment(0, 2 * _i252.circleOffset, _i252.circleArray.length, _i252.circleArray.length / 2), null, h.zoom);\n      }\n      var y;\n      x.destroy(), v.destroy();\n    }\n    var uo = e.create();\n    function _o(_ref143, s) {\n      var t = _ref143.width,\n        i = _ref143.height,\n        o = _ref143.anchor,\n        r = _ref143.textOffset,\n        n = _ref143.textScale;\n      var _e$getAnchorAlignment2 = e.getAnchorAlignment(o),\n        a = _e$getAnchorAlignment2.horizontalAlign,\n        l = _e$getAnchorAlignment2.verticalAlign,\n        c = -(a - .5) * t,\n        h = -(l - .5) * i,\n        u = e.evaluateVariableOffset(o, r);\n      return new e.pointGeometry((c / n + u[0]) * s, (h / n + u[1]) * s);\n    }\n    function po(t, i, o, r, n, s, a, l, c, h, u) {\n      var _ = t.text.placedSymbolArray,\n        d = t.text.dynamicLayoutVertexArray,\n        p = t.icon.dynamicLayoutVertexArray,\n        m = {},\n        f = t.getProjection(),\n        g = bt(l, f, s),\n        v = s.elevation,\n        x = f.upVectorScale(l.canonical, s.center.lat, s.worldSize).metersToTile;\n      d.clear();\n      for (var _p38 = 0; _p38 < _.length; _p38++) {\n        var _y15 = _.get(_p38),\n          _b13 = _y15.tileAnchorX,\n          _w13 = _y15.tileAnchorY,\n          _T8 = _y15.numGlyphs,\n          _E6 = t.allowVerticalPlacement && !_y15.placedOrientation,\n          _C5 = _y15.hidden || !_y15.crossTileID || _E6 ? null : r[_y15.crossTileID];\n        if (_C5) {\n          var _f$projectTilePoint, _nt7, _nt8;\n          var _r277 = 0,\n            _18 = 0,\n            _p39 = 0;\n          if (v) {\n            var _e410 = v ? v.getAtTileOffset(l, _b13, _w13) : 0,\n              _f$upVector = f.upVector(l.canonical, _b13, _w13),\n              _f$upVector2 = _slicedToArray(_f$upVector, 3),\n              _t418 = _f$upVector2[0],\n              _i253 = _f$upVector2[1],\n              _o139 = _f$upVector2[2];\n            _r277 = _e410 * _t418 * x, _18 = _e410 * _i253 * x, _p39 = _e410 * _o139 * x;\n          }\n          var _nt5 = nt(_y15.projectedAnchorX + _r277, _y15.projectedAnchorY + _18, _y15.projectedAnchorZ + _p39, o ? g : a),\n            _nt6 = _slicedToArray(_nt5, 4),\n            _E7 = _nt6[0],\n            _M7 = _nt6[1],\n            _I8 = _nt6[2],\n            _S13 = _nt6[3];\n          var _D3 = st(s.getCameraToCenterDistance(f), _S13);\n          var _L3 = n.evaluateSizeForFeature(t.textSizeData, h, _y15) * _D3 / e.ONE_EM;\n          o && (_L3 *= t.tilePixelRatio / c);\n          var _A12 = _o(_C5, _L3);\n          o ? ((_f$projectTilePoint = f.projectTilePoint(_b13 + _A12.x, _w13 + _A12.y, l.canonical), _E7 = _f$projectTilePoint.x, _M7 = _f$projectTilePoint.y, _I8 = _f$projectTilePoint.z, _f$projectTilePoint), (_nt7 = nt(_E7 + _r277, _M7 + _18, _I8 + _p39, a), _nt8 = _slicedToArray(_nt7, 3), _E7 = _nt8[0], _M7 = _nt8[1], _I8 = _nt8[2], _nt7)) : (i && _A12._rotate(-s.angle), _E7 += _A12.x, _M7 += _A12.y, _I8 = 0);\n          var _z4 = t.allowVerticalPlacement && _y15.placedOrientation === e.WritingMode.vertical ? Math.PI / 2 : 0;\n          for (var _t419 = 0; _t419 < _T8; _t419++) e.addDynamicAttributes(d, _E7, _M7, _I8, _z4);\n          u && _y15.associatedIconIndex >= 0 && (m[_y15.associatedIconIndex] = {\n            x: _E7,\n            y: _M7,\n            z: _I8,\n            angle: _z4\n          });\n        } else mt(_T8, d);\n      }\n      if (u) {\n        p.clear();\n        var _i254 = t.icon.placedSymbolArray;\n        for (var _t420 = 0; _t420 < _i254.length; _t420++) {\n          var _o140 = _i254.get(_t420),\n            _r278 = _o140.numGlyphs,\n            _n190 = m[_t420];\n          if (_o140.hidden || !_n190) mt(_r278, p);else {\n            var _t421 = _n190.x,\n              _i255 = _n190.y,\n              _o141 = _n190.z,\n              _s153 = _n190.angle;\n            for (var _n191 = 0; _n191 < _r278; _n191++) e.addDynamicAttributes(p, _t421, _i255, _o141, _s153);\n          }\n        }\n        t.icon.dynamicLayoutVertexBuffer.updateData(p);\n      }\n      t.text.dynamicLayoutVertexBuffer.updateData(d);\n    }\n    function mo(e, t, i) {\n      return i.iconsInText && t ? \"symbolTextAndIcon\" : e ? \"symbolSDF\" : \"symbolIcon\";\n    }\n    function fo(t, i, o, r, n, s, a, l, c, h, u, _) {\n      var d = t.context,\n        p = d.gl,\n        m = t.transform,\n        f = \"map\" === l,\n        g = \"map\" === c,\n        v = f && \"point\" !== o.layout.get(\"symbol-placement\"),\n        x = f && !g && !v,\n        y = void 0 !== o.layout.get(\"symbol-sort-key\").constantOr(1);\n      var b = !1;\n      var w = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),\n        T = [e.mercatorXfromLng(m.center.lng), e.mercatorYfromLat(m.center.lat)],\n        E = o.layout.get(\"text-variable-anchor\"),\n        C = \"globe\" === m.projection.name,\n        M = [],\n        I = [0, -1, 0];\n      var S = I;\n      !C && !m.mercatorFromTransition || f || (S = function (t) {\n        var i = t._camera.getWorldToCamera(t.worldSize, 1),\n          o = e.multiply([], i, t.globeMatrix);\n        e.invert(o, o);\n        var r = [0, 0, 0],\n          n = [0, 1, 0, 0];\n        return e.transformMat4$1(n, n, o), r[0] = n[0], r[1] = n[1], r[2] = n[2], e.normalize(r, r), r;\n      }(m));\n      var _iterator254 = _createForOfIteratorHelper(r),\n        _step254;\n      try {\n        for (_iterator254.s(); !(_step254 = _iterator254.n()).done;) {\n          var _l76 = _step254.value;\n          var _r280 = i.getTile(_l76),\n            _c60 = _r280.getBucket(o);\n          if (!_c60) continue;\n          if (\"mercator\" === _c60.projection.name && C) continue;\n          var _u62 = n ? _c60.text : _c60.icon;\n          if (!_u62 || _c60.fullyClipped || !_u62.segments.get().length) continue;\n          var _19 = _u62.programConfigurations.get(o.id),\n            _d24 = n || _c60.sdfIcons,\n            _w14 = n ? _c60.textSizeData : _c60.iconSizeData,\n            _D4 = g || 0 !== m.pitch,\n            _L4 = e.evaluateSizeForZoom(_w14, m.zoom);\n          var _A13 = void 0,\n            _z5 = void 0,\n            _P2 = void 0,\n            _R2 = void 0,\n            _O2 = [0, 0],\n            _B3 = null;\n          if (n) {\n            if (_z5 = _r280.glyphAtlasTexture, _P2 = p.LINEAR, _A13 = _r280.glyphAtlasTexture.size, _c60.iconsInText) {\n              _O2 = _r280.imageAtlasTexture.size, _B3 = _r280.imageAtlasTexture;\n              var _e412 = \"composite\" === _w14.kind || \"camera\" === _w14.kind;\n              _R2 = _D4 || t.options.rotating || t.options.zooming || _e412 ? p.LINEAR : p.NEAREST;\n            }\n          } else {\n            var _e413 = 1 !== o.layout.get(\"icon-size\").constantOr(0) || _c60.iconsNeedLinear;\n            _z5 = _r280.imageAtlasTexture, _P2 = _d24 || t.options.rotating || t.options.zooming || _e413 || _D4 ? p.LINEAR : p.NEAREST, _A13 = _r280.imageAtlasTexture.size;\n          }\n          var _k7 = \"globe\" === _c60.projection.name,\n            _F = _k7 ? S : I,\n            _U = _k7 ? e.globeToMercatorTransition(m.zoom) : 0,\n            _N = bt(_l76, _c60.getProjection(), m),\n            _G = m.calculatePixelsToTileUnitsMatrix(_r280),\n            _j = it(_N, _r280.tileID.canonical, g, f, m, _c60.getProjection(), _G),\n            _Z33 = t.terrain && g && v ? e.invert(e.create(), _j) : uo,\n            _V = rt(_N, _r280.tileID.canonical, g, f, m, _c60.getProjection(), _G),\n            _W = E && _c60.hasTextData(),\n            _X = \"none\" !== o.layout.get(\"icon-text-fit\") && _W && _c60.hasIconData();\n          if (v) {\n            var _e414 = m.elevation,\n              _i258 = _e414 ? _e414.getAtTileOffsetFunc(_l76, m.center.lat, m.worldSize, _c60.getProjection()) : null,\n              _o142 = ot(_N, _r280.tileID.canonical, g, f, m, _c60.getProjection(), _G);\n            lt(_c60, _N, t, n, _o142, _V, g, h, _i258, _l76);\n          }\n          var _q = v || n && E || _X,\n            _$ = t.translatePosMatrix(_N, _r280, s, a),\n            _H = _q ? uo : _j,\n            _Y = t.translatePosMatrix(_V, _r280, s, a, !0),\n            _K = _c60.getProjection().createInversionMatrix(m, _l76.canonical),\n            _J = [];\n          t.terrainRenderModeElevated() && g && _J.push(\"PITCH_WITH_MAP_TERRAIN\"), _k7 && _J.push(\"PROJECTION_GLOBE_VIEW\"), _q && _J.push(\"PROJECTED_POS_ON_VIEWPORT\");\n          var _Q = _d24 && 0 !== o.paint.get(n ? \"text-halo-width\" : \"icon-halo-width\").constantOr(1);\n          var _ee = void 0;\n          _ee = _d24 ? _c60.iconsInText ? no(_w14.kind, _L4, x, g, t, _$, _H, _Y, _A13, _O2, _l76, _U, T, _K, _F, _c60.getProjection()) : ro(_w14.kind, _L4, x, g, t, _$, _H, _Y, n, _A13, !0, _l76, _U, T, _K, _F, _c60.getProjection()) : oo(_w14.kind, _L4, x, g, t, _$, _H, _Y, n, _A13, _l76, _U, T, _K, _F, _c60.getProjection());\n          var _te = {\n            program: t.useProgram(mo(_d24, n, _c60), _19, _J),\n            buffers: _u62,\n            uniformValues: _ee,\n            atlasTexture: _z5,\n            atlasTextureIcon: _B3,\n            atlasInterpolation: _P2,\n            atlasInterpolationIcon: _R2,\n            isSDF: _d24,\n            hasHalo: _Q,\n            tile: _r280,\n            labelPlaneMatrixInv: _Z33\n          };\n          if (y && _c60.canOverlap) {\n            b = !0;\n            var _t422 = _u62.segments.get();\n            var _iterator255 = _createForOfIteratorHelper(_t422),\n              _step255;\n            try {\n              for (_iterator255.s(); !(_step255 = _iterator255.n()).done;) {\n                var _i259 = _step255.value;\n                M.push({\n                  segments: new e.SegmentVector([_i259]),\n                  sortKey: _i259.sortKey,\n                  state: _te\n                });\n              }\n            } catch (err) {\n              _iterator255.e(err);\n            } finally {\n              _iterator255.f();\n            }\n          } else M.push({\n            segments: _u62.segments,\n            sortKey: 0,\n            state: _te\n          });\n        }\n      } catch (err) {\n        _iterator254.e(err);\n      } finally {\n        _iterator254.f();\n      }\n      b && M.sort(function (e, t) {\n        return e.sortKey - t.sortKey;\n      });\n      for (var _i256 = 0, _M8 = M; _i256 < _M8.length; _i256++) {\n        var _e411 = _M8[_i256];\n        var _i257 = _e411.state;\n        if (t.terrain && t.terrain.setupElevationDraw(_i257.tile, _i257.program, {\n          useDepthForOcclusion: !C,\n          labelPlaneMatrixInv: _i257.labelPlaneMatrixInv\n        }), d.activeTexture.set(p.TEXTURE0), _i257.atlasTexture.bind(_i257.atlasInterpolation, p.CLAMP_TO_EDGE), _i257.atlasTextureIcon && (d.activeTexture.set(p.TEXTURE1), _i257.atlasTextureIcon && _i257.atlasTextureIcon.bind(_i257.atlasInterpolationIcon, p.CLAMP_TO_EDGE)), _i257.isSDF) {\n          var _r279 = _i257.uniformValues;\n          _i257.hasHalo && (_r279.u_is_halo = 1, go(_i257.buffers, _e411.segments, o, t, _i257.program, w, u, _, _r279)), _r279.u_is_halo = 0;\n        }\n        go(_i257.buffers, _e411.segments, o, t, _i257.program, w, u, _, _i257.uniformValues);\n      }\n    }\n    function go(t, i, o, r, n, s, a, l, c) {\n      var h = r.context,\n        u = [t.dynamicLayoutVertexBuffer, t.opacityVertexBuffer, t.globeExtVertexBuffer];\n      n.draw(h, h.gl.TRIANGLES, s, a, l, e.CullFaceMode.disabled, c, o.id, t.layoutVertexBuffer, t.indexBuffer, i, o.paint, r.transform.zoom, t.programConfigurations.get(o.id), u);\n    }\n    function vo(t, i, o, r, n, s, a) {\n      var l = t.context.gl,\n        c = o.paint.get(\"fill-pattern\"),\n        h = c && c.constantOr(1);\n      var u, _, d, p, m;\n      a ? (_ = h && !o.getPaintProperty(\"fill-outline-color\") ? \"fillOutlinePattern\" : \"fillOutline\", u = l.LINES) : (_ = h ? \"fillPattern\" : \"fill\", u = l.TRIANGLES);\n      var _iterator256 = _createForOfIteratorHelper(r),\n        _step256;\n      try {\n        for (_iterator256.s(); !(_step256 = _iterator256.n()).done;) {\n          var _f26 = _step256.value;\n          var _r281 = i.getTile(_f26);\n          if (h && !_r281.patternsLoaded()) continue;\n          var _g20 = _r281.getBucket(o);\n          if (!_g20) continue;\n          t.prepareDrawTile();\n          var _v14 = _g20.programConfigurations.get(o.id),\n            _x19 = t.useProgram(_, _v14);\n          h && (t.context.activeTexture.set(l.TEXTURE0), _r281.imageAtlasTexture.bind(l.LINEAR, l.CLAMP_TO_EDGE), _v14.updatePaintBuffers());\n          var _y16 = c.constantOr(null);\n          if (_y16 && _r281.imageAtlas) {\n            var _e415 = _r281.imageAtlas.patternPositions[_y16.toString()];\n            _e415 && _v14.setConstantPatternPositions(_e415);\n          }\n          var _b14 = t.translatePosMatrix(_f26.projMatrix, _r281, o.paint.get(\"fill-translate\"), o.paint.get(\"fill-translate-anchor\"));\n          if (a) {\n            p = _g20.indexBuffer2, m = _g20.segments2;\n            var _e416 = t.terrain && t.terrain.renderingToTexture ? t.terrain.drapeBufferSize : [l.drawingBufferWidth, l.drawingBufferHeight];\n            d = \"fillOutlinePattern\" === _ && h ? Gi(_b14, t, _r281, _e416) : Ni(_b14, _e416);\n          } else p = _g20.indexBuffer, m = _g20.segments, d = h ? Ui(_b14, t, _r281) : Fi(_b14);\n          t.prepareDrawProgram(t.context, _x19, _f26.toUnwrapped()), _x19.draw(t.context, u, n, t.stencilModeForClipping(_f26), s, e.CullFaceMode.disabled, d, o.id, _g20.layoutVertexBuffer, p, m, o.paint, t.transform.zoom, _v14);\n        }\n      } catch (err) {\n        _iterator256.e(err);\n      } finally {\n        _iterator256.f();\n      }\n    }\n    function xo(t, i, o, r, n, s, a) {\n      var l = t.context,\n        c = l.gl,\n        h = t.transform,\n        u = o.paint.get(\"fill-extrusion-pattern\"),\n        _ = u.constantOr(1),\n        d = o.paint.get(\"fill-extrusion-opacity\"),\n        p = [o.paint.get(\"fill-extrusion-ambient-occlusion-intensity\"), o.paint.get(\"fill-extrusion-ambient-occlusion-radius\")],\n        m = o.layout.get(\"fill-extrusion-edge-radius\"),\n        f = \"globe\" === h.projection.name ? e.fillExtrusionHeightLift() : 0,\n        g = \"globe\" === h.projection.name,\n        v = g ? e.globeToMercatorTransition(h.zoom) : 0,\n        x = [e.mercatorXfromLng(h.center.lng), e.mercatorYfromLat(h.center.lat)],\n        y = [];\n      g && y.push(\"PROJECTION_GLOBE_VIEW\"), p[0] > 0 && y.push(\"FAUX_AO\");\n      var _iterator257 = _createForOfIteratorHelper(r),\n        _step257;\n      try {\n        for (_iterator257.s(); !(_step257 = _iterator257.n()).done;) {\n          var _b15 = _step257.value;\n          var _r282 = i.getTile(_b15),\n            _w15 = _r282.getBucket(o);\n          if (!_w15 || _w15.projection.name !== h.projection.name) continue;\n          var _T9 = _w15.programConfigurations.get(o.id),\n            _E8 = t.useProgram(_ ? \"fillExtrusionPattern\" : \"fillExtrusion\", _T9, y);\n          if (t.terrain) {\n            var _e417 = t.terrain;\n            if (t.style.terrainSetForDrapingOnly()) _e417.setupElevationDraw(_r282, _E8, {\n              useMeterToDem: !0\n            });else {\n              if (!_w15.enableTerrain) continue;\n              if (_e417.setupElevationDraw(_r282, _E8, {\n                useMeterToDem: !0\n              }), yo(l, i, _b15, _w15, o, _e417), !_w15.centroidVertexBuffer) {\n                var _e418 = _E8.attributes.a_centroid_pos;\n                void 0 !== _e418 && c.vertexAttrib2f(_e418, 0, 0);\n              }\n            }\n          }\n          _ && (t.context.activeTexture.set(c.TEXTURE0), _r282.imageAtlasTexture.bind(c.LINEAR, c.CLAMP_TO_EDGE), _T9.updatePaintBuffers());\n          var _C6 = u.constantOr(null);\n          if (_C6 && _r282.imageAtlas) {\n            var _e419 = _r282.imageAtlas.patternPositions[_C6.toString()];\n            _e419 && _T9.setConstantPatternPositions(_e419);\n          }\n          var _M9 = t.translatePosMatrix(_b15.projMatrix, _r282, o.paint.get(\"fill-extrusion-translate\"), o.paint.get(\"fill-extrusion-translate-anchor\")),\n            _I9 = h.projection.createInversionMatrix(h, _b15.canonical),\n            _S14 = o.paint.get(\"fill-extrusion-vertical-gradient\"),\n            _D5 = _ ? ki(_M9, t, _S14, d, p, m, _b15, _r282, f, v, x, _I9) : Bi(_M9, t, _S14, d, p, m, _b15, f, v, x, _I9);\n          t.prepareDrawProgram(l, _E8, _b15.toUnwrapped());\n          var _L5 = [];\n          t.terrain && _L5.push(_w15.centroidVertexBuffer), g && _L5.push(_w15.layoutVertexExtBuffer), _E8.draw(l, l.gl.TRIANGLES, n, s, a, e.CullFaceMode.backCCW, _D5, o.id, _w15.layoutVertexBuffer, _w15.indexBuffer, _w15.segments, o.paint, t.transform.zoom, _T9, _L5);\n        }\n      } catch (err) {\n        _iterator257.e(err);\n      } finally {\n        _iterator257.f();\n      }\n    }\n    function yo(t, i, o, r, n, s) {\n      var a = [function (t) {\n          var i = t.canonical.x - 1,\n            o = t.wrap;\n          return i < 0 && (i = (1 << t.canonical.z) - 1, o--), new e.OverscaledTileID(t.overscaledZ, o, t.canonical.z, i, t.canonical.y);\n        }, function (t) {\n          var i = t.canonical.x + 1,\n            o = t.wrap;\n          return i === 1 << t.canonical.z && (i = 0, o++), new e.OverscaledTileID(t.overscaledZ, o, t.canonical.z, i, t.canonical.y);\n        }, function (t) {\n          return new e.OverscaledTileID(t.overscaledZ, t.wrap, t.canonical.z, t.canonical.x, (0 === t.canonical.y ? 1 << t.canonical.z : t.canonical.y) - 1);\n        }, function (t) {\n          return new e.OverscaledTileID(t.overscaledZ, t.wrap, t.canonical.z, t.canonical.x, t.canonical.y === (1 << t.canonical.z) - 1 ? 0 : t.canonical.y + 1);\n        }],\n        l = function l(e) {\n          var t = i.getSource().minzoom,\n            o = function o(e) {\n              var t = i.getTileByID(e);\n              if (t && t.hasData()) return t.getBucket(n);\n            },\n            r = [0, -1, 1];\n          for (var _i260 = 0, _r283 = r; _i260 < _r283.length; _i260++) {\n            var _i261 = _r283[_i260];\n            if (e.overscaledZ + _i261 < t) continue;\n            var _r284 = o(e.calculateScaledKey(e.overscaledZ + _i261));\n            if (_r284) return _r284;\n          }\n        },\n        c = [0, 0, 0],\n        h = function h(t, i) {\n          return c[0] = Math.min(t.min.y, i.min.y), c[1] = Math.max(t.max.y, i.max.y), c[2] = e.EXTENT - i.min.x > t.max.x ? i.min.x - e.EXTENT : t.max.x, c;\n        },\n        u = function u(t, i) {\n          return c[0] = Math.min(t.min.x, i.min.x), c[1] = Math.max(t.max.x, i.max.x), c[2] = e.EXTENT - i.min.y > t.max.y ? i.min.y - e.EXTENT : t.max.y, c;\n        },\n        _ = [function (e, t) {\n          return h(e, t);\n        }, function (e, t) {\n          return h(t, e);\n        }, function (e, t) {\n          return u(e, t);\n        }, function (e, t) {\n          return u(t, e);\n        }],\n        d = new e.pointGeometry(0, 0);\n      var p, m, f;\n      var g = function g(t, i, r, n, a) {\n        var l = [[n ? r : t, n ? t : r, 0], [n ? r : i, n ? i : r, 0]],\n          c = a < 0 ? e.EXTENT + a : a,\n          h = [n ? c : (t + i) / 2, n ? (t + i) / 2 : c, 0];\n        return 0 === r && a < 0 || 0 !== r && a > 0 ? s.getForTilePoints(f, [h], !0, m) : l.push(h), s.getForTilePoints(o, l, !0, p), Math.max(l[0][2], l[1][2], h[2]) / s.exaggeration();\n      };\n      for (var _t423 = 0; _t423 < 4; _t423++) {\n        var _i262 = (_t423 < 2 ? 1 : 5) - _t423,\n          _n192 = r.borders[_t423];\n        if (0 === _n192.length) continue;\n        var _c61 = f = a[_t423](o),\n          _h45 = l(_c61);\n        if (!(_h45 && _h45 instanceof e.FillExtrusionBucket && _h45.enableTerrain)) continue;\n        if (r.borderDoneWithNeighborZ[_t423] === _h45.canonical.z && _h45.borderDoneWithNeighborZ[_i262] === r.canonical.z) continue;\n        if (m = s.findDEMTileFor(_c61), !m || !m.dem) continue;\n        if (!p) {\n          var _e420 = s.findDEMTileFor(o);\n          if (!_e420 || !_e420.dem) return;\n          p = _e420;\n        }\n        var _u63 = _h45.borders[_i262];\n        var _v15 = 0;\n        var _x20 = _h45.borderDoneWithNeighborZ[_i262] !== r.canonical.z;\n        if (r.canonical.z === _h45.canonical.z) {\n          for (var _o143 = 0; _o143 < _n192.length; _o143++) {\n            var _s154 = r.featuresOnBorder[_n192[_o143]],\n              _a126 = _s154.borders[_t423];\n            var _l77 = void 0;\n            for (; _v15 < _u63.length && (_l77 = _h45.featuresOnBorder[_u63[_v15]], !(_l77.borders[_i262][1] > _a126[0] + 3));) _x20 && _h45.encodeCentroid(void 0, _l77, !1), _v15++;\n            if (_l77 && _v15 < _u63.length) {\n              var _o144 = _v15;\n              var _n193 = 0;\n              for (; !(_l77.borders[_i262][0] > _a126[1] - 3) && (_n193++, ++_v15 !== _u63.length);) _l77 = _h45.featuresOnBorder[_u63[_v15]];\n              if (_l77 = _h45.featuresOnBorder[_u63[_o144]], _s154.intersectsCount() > 1 || _l77.intersectsCount() > 1 || 1 !== _n193) {\n                1 !== _n193 && (_v15 = _o144), r.encodeCentroid(void 0, _s154, !1), _x20 && _h45.encodeCentroid(void 0, _l77, !1);\n                continue;\n              }\n              var _c62 = _[_t423](_s154, _l77),\n                _p40 = _t423 % 2 ? e.EXTENT - 1 : 0;\n              d.x = g(_c62[0], Math.min(e.EXTENT - 1, _c62[1]), _p40, _t423 < 2, _c62[2]), d.y = 0, r.encodeCentroid(d, _s154, !1), _x20 && _h45.encodeCentroid(d, _l77, !1);\n            } else r.encodeCentroid(void 0, _s154, !1);\n          }\n          r.borderDoneWithNeighborZ[_t423] = _h45.canonical.z, r.needsCentroidUpdate = !0, _x20 && (_h45.borderDoneWithNeighborZ[_i262] = r.canonical.z, _h45.needsCentroidUpdate = !0);\n        } else {\n          var _iterator258 = _createForOfIteratorHelper(_n192),\n            _step258;\n          try {\n            for (_iterator258.s(); !(_step258 = _iterator258.n()).done;) {\n              var _e422 = _step258.value;\n              r.encodeCentroid(void 0, r.featuresOnBorder[_e422], !1);\n            }\n          } catch (err) {\n            _iterator258.e(err);\n          } finally {\n            _iterator258.f();\n          }\n          if (_x20) {\n            var _iterator259 = _createForOfIteratorHelper(_u63),\n              _step259;\n            try {\n              for (_iterator259.s(); !(_step259 = _iterator259.n()).done;) {\n                var _e421 = _step259.value;\n                _h45.encodeCentroid(void 0, _h45.featuresOnBorder[_e421], !1);\n              }\n            } catch (err) {\n              _iterator259.e(err);\n            } finally {\n              _iterator259.f();\n            }\n            _h45.borderDoneWithNeighborZ[_i262] = r.canonical.z, _h45.needsCentroidUpdate = !0;\n          }\n          r.borderDoneWithNeighborZ[_t423] = _h45.canonical.z, r.needsCentroidUpdate = !0;\n        }\n      }\n      (r.needsCentroidUpdate || !r.centroidVertexBuffer && 0 !== r.centroidVertexArray.length) && r.uploadCentroid(t);\n    }\n    var bo = new e.Color(1, 0, 0, 1),\n      wo = new e.Color(0, 1, 0, 1),\n      To = new e.Color(0, 0, 1, 1),\n      Eo = new e.Color(1, 0, 1, 1),\n      Co = new e.Color(0, 1, 1, 1);\n    function Mo(t, i, o) {\n      var r = t.context,\n        n = t.transform,\n        s = r.gl,\n        a = \"globe\" === n.projection.name,\n        l = a ? [\"PROJECTION_GLOBE_VIEW\"] : null;\n      var c = o.projMatrix;\n      if (a && e.globeToMercatorTransition(n.zoom) > 0) {\n        var _t424 = e.transitionTileAABBinECEF(o.canonical, n),\n          _i263 = e.globeDenormalizeECEF(_t424);\n        c = e.multiply(new Float32Array(16), n.globeMatrix, _i263), e.multiply(c, n.projMatrix, c);\n      }\n      var h = t.useProgram(\"debug\", null, l),\n        u = i.getTileByID(o.key);\n      t.terrain && t.terrain.setupElevationDraw(u, h);\n      var _ = e.DepthMode.disabled,\n        d = e.StencilMode.disabled,\n        p = t.colorModeForRenderPass(),\n        m = \"$debug\";\n      r.activeTexture.set(s.TEXTURE0), t.emptyTexture.bind(s.LINEAR, s.CLAMP_TO_EDGE), a ? u._makeGlobeTileDebugBuffers(t.context, n) : u._makeDebugTileBoundsBuffers(t.context, n.projection);\n      var f = u._tileDebugBuffer || t.debugBuffer,\n        g = u._tileDebugIndexBuffer || t.debugIndexBuffer,\n        v = u._tileDebugSegments || t.debugSegments;\n      h.draw(r, s.LINE_STRIP, _, d, p, e.CullFaceMode.disabled, Xi(c, e.Color.red), m, f, g, v, null, null, null, [u._globeTileDebugBorderBuffer]);\n      var x = u.latestRawTileData,\n        y = Math.floor((x && x.byteLength || 0) / 1024),\n        b = i.getTile(o).tileSize,\n        w = 512 / Math.min(b, 512) * (o.overscaledZ / n.zoom) * .5;\n      var T = o.canonical.toString();\n      o.overscaledZ !== o.canonical.z && (T += \" => \".concat(o.overscaledZ)), T += \" \".concat(y, \"kb\"), function (e, t) {\n        e.initDebugOverlayCanvas();\n        var i = e.debugOverlayCanvas,\n          o = e.context.gl,\n          r = e.debugOverlayCanvas.getContext(\"2d\");\n        r.clearRect(0, 0, i.width, i.height), r.shadowColor = \"white\", r.shadowBlur = 2, r.lineWidth = 1.5, r.strokeStyle = \"white\", r.textBaseline = \"top\", r.font = \"bold 36px Open Sans, sans-serif\", r.fillText(t, 5, 5), r.strokeText(t, 5, 5), e.debugOverlayTexture.update(i), e.debugOverlayTexture.bind(o.LINEAR, o.CLAMP_TO_EDGE);\n      }(t, T);\n      var E = u._tileDebugTextBuffer || t.debugBuffer,\n        C = u._tileDebugTextIndexBuffer || t.quadTriangleIndexBuffer,\n        M = u._tileDebugTextSegments || t.debugSegments;\n      h.draw(r, s.TRIANGLES, _, d, e.ColorMode.alphaBlended, e.CullFaceMode.disabled, Xi(c, e.Color.transparent, w), m, E, C, M, null, null, null, [u._globeTileDebugTextBuffer]);\n    }\n    function Io(e, t, i, o) {\n      Do(e, 0, t + i / 2, e.transform.width, i, o);\n    }\n    function So(e, t, i, o) {\n      Do(e, t - i / 2, 0, i, e.transform.height, o);\n    }\n    function Do(t, i, o, r, n, s) {\n      var a = t.context,\n        l = a.gl;\n      l.enable(l.SCISSOR_TEST), l.scissor(i * e.exported.devicePixelRatio, o * e.exported.devicePixelRatio, r * e.exported.devicePixelRatio, n * e.exported.devicePixelRatio), a.clear({\n        color: s\n      }), l.disable(l.SCISSOR_TEST);\n    }\n    var Lo = e.createLayout([{\n        name: \"a_pos_3f\",\n        components: 3,\n        type: \"Float32\"\n      }]),\n      Ao = Lo.members;\n    function zo(e, t, i, o) {\n      e.emplaceBack(t, i, o);\n    }\n    var Po = function Po(t) {\n      _classCallCheck(this, Po);\n      this.vertexArray = new e.StructArrayLayout3f12(), this.indices = new e.StructArrayLayout3ui6(), zo(this.vertexArray, -1, -1, 1), zo(this.vertexArray, 1, -1, 1), zo(this.vertexArray, -1, 1, 1), zo(this.vertexArray, 1, 1, 1), zo(this.vertexArray, -1, -1, -1), zo(this.vertexArray, 1, -1, -1), zo(this.vertexArray, -1, 1, -1), zo(this.vertexArray, 1, 1, -1), this.indices.emplaceBack(5, 1, 3), this.indices.emplaceBack(3, 7, 5), this.indices.emplaceBack(6, 2, 0), this.indices.emplaceBack(0, 4, 6), this.indices.emplaceBack(2, 6, 7), this.indices.emplaceBack(7, 3, 2), this.indices.emplaceBack(5, 4, 0), this.indices.emplaceBack(0, 1, 5), this.indices.emplaceBack(0, 2, 3), this.indices.emplaceBack(3, 1, 0), this.indices.emplaceBack(7, 6, 4), this.indices.emplaceBack(4, 5, 7), this.vertexBuffer = t.createVertexBuffer(this.vertexArray, Ao), this.indexBuffer = t.createIndexBuffer(this.indices), this.segment = e.SegmentVector.simpleSegment(0, 0, 36, 12);\n    };\n    function Ro(t, i, o, r, n, s) {\n      var a = t.gl,\n        l = i.paint.get(\"sky-atmosphere-color\"),\n        c = i.paint.get(\"sky-atmosphere-halo-color\"),\n        h = i.paint.get(\"sky-atmosphere-sun-intensity\"),\n        u = function (e, t, i, o, r) {\n          return {\n            u_matrix_3f: e,\n            u_sun_direction: t,\n            u_sun_intensity: i,\n            u_color_tint_r: [o.r, o.g, o.b, o.a],\n            u_color_tint_m: [r.r, r.g, r.b, r.a],\n            u_luminance: 5e-5\n          };\n        }(e.fromMat4(e.create$1(), r), n, h, l, c);\n      a.framebufferTexture2D(a.FRAMEBUFFER, a.COLOR_ATTACHMENT0, a.TEXTURE_CUBE_MAP_POSITIVE_X + s, i.skyboxTexture, 0), o.draw(t, a.TRIANGLES, e.DepthMode.disabled, e.StencilMode.disabled, e.ColorMode.unblended, e.CullFaceMode.frontCW, u, \"skyboxCapture\", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);\n    }\n    var Oo = e.createLayout([{\n      type: \"Float32\",\n      name: \"a_pos\",\n      components: 3\n    }, {\n      type: \"Float32\",\n      name: \"a_uv\",\n      components: 2\n    }]);\n    var Bo = /*#__PURE__*/function () {\n      function Bo(t) {\n        _classCallCheck(this, Bo);\n        var i = new e.StructArrayLayout5f20();\n        i.emplaceBack(-1, 1, 1, 0, 0), i.emplaceBack(1, 1, 1, 1, 0), i.emplaceBack(1, -1, 1, 1, 1), i.emplaceBack(-1, -1, 1, 0, 1);\n        var o = new e.StructArrayLayout3ui6();\n        o.emplaceBack(0, 1, 2), o.emplaceBack(2, 3, 0), this.vertexBuffer = t.createVertexBuffer(i, Oo.members), this.indexBuffer = t.createIndexBuffer(o), this.segments = e.SegmentVector.simpleSegment(0, 0, 4, 2);\n      }\n      _createClass(Bo, [{\n        key: \"destroy\",\n        value: function destroy() {\n          this.vertexBuffer.destroy(), this.indexBuffer.destroy(), this.segments.destroy();\n        }\n      }]);\n      return Bo;\n    }();\n    var ko = {\n      symbol: function symbol(t, i, o, r, n) {\n        if (\"translucent\" !== t.renderPass) return;\n        var s = e.StencilMode.disabled,\n          a = t.colorModeForRenderPass();\n        o.layout.get(\"text-variable-anchor\") && function (t, i, o, r, n, s, a) {\n          var l = i.transform,\n            c = \"map\" === n,\n            h = \"map\" === s;\n          var _iterator260 = _createForOfIteratorHelper(t),\n            _step260;\n          try {\n            for (_iterator260.s(); !(_step260 = _iterator260.n()).done;) {\n              var _i264 = _step260.value;\n              var _t425 = r.getTile(_i264),\n                _n194 = _t425.getBucket(o);\n              if (!_n194 || !_n194.text || !_n194.text.segments.get().length) continue;\n              var _s155 = e.evaluateSizeForZoom(_n194.textSizeData, l.zoom),\n                _u64 = bt(_i264, _n194.getProjection(), l),\n                _20 = l.calculatePixelsToTileUnitsMatrix(_t425),\n                _d25 = it(_u64, _t425.tileID.canonical, h, c, l, _n194.getProjection(), _20),\n                _p41 = \"none\" !== o.layout.get(\"icon-text-fit\") && _n194.hasIconData();\n              if (_s155) {\n                var _o145 = Math.pow(2, l.zoom - _t425.tileID.overscaledZ);\n                po(_n194, c, h, a, e.symbolSize, l, _d25, _i264, _o145, _s155, _p41);\n              }\n            }\n          } catch (err) {\n            _iterator260.e(err);\n          } finally {\n            _iterator260.f();\n          }\n        }(r, t, o, i, o.layout.get(\"text-rotation-alignment\"), o.layout.get(\"text-pitch-alignment\"), n), 0 !== o.paint.get(\"icon-opacity\").constantOr(1) && fo(t, i, o, r, !1, o.paint.get(\"icon-translate\"), o.paint.get(\"icon-translate-anchor\"), o.layout.get(\"icon-rotation-alignment\"), o.layout.get(\"icon-pitch-alignment\"), o.layout.get(\"icon-keep-upright\"), s, a), 0 !== o.paint.get(\"text-opacity\").constantOr(1) && fo(t, i, o, r, !0, o.paint.get(\"text-translate\"), o.paint.get(\"text-translate-anchor\"), o.layout.get(\"text-rotation-alignment\"), o.layout.get(\"text-pitch-alignment\"), o.layout.get(\"text-keep-upright\"), s, a), i.map.showCollisionBoxes && (ho(t, i, o, r, o.paint.get(\"text-translate\"), o.paint.get(\"text-translate-anchor\"), !0), ho(t, i, o, r, o.paint.get(\"icon-translate\"), o.paint.get(\"icon-translate-anchor\"), !1));\n      },\n      circle: function circle(t, i, o, r) {\n        if (\"translucent\" !== t.renderPass) return;\n        var n = o.paint.get(\"circle-opacity\"),\n          s = o.paint.get(\"circle-stroke-width\"),\n          a = o.paint.get(\"circle-stroke-opacity\"),\n          l = void 0 !== o.layout.get(\"circle-sort-key\").constantOr(1);\n        if (0 === n.constantOr(1) && (0 === s.constantOr(1) || 0 === a.constantOr(1))) return;\n        var c = t.context,\n          h = c.gl,\n          u = t.transform,\n          _ = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),\n          d = e.StencilMode.disabled,\n          p = t.colorModeForRenderPass(),\n          m = \"globe\" === u.projection.name,\n          f = [e.mercatorXfromLng(u.center.lng), e.mercatorYfromLat(u.center.lat)],\n          g = [];\n        for (var _n195 = 0; _n195 < r.length; _n195++) {\n          var _s156 = r[_n195],\n            _a127 = i.getTile(_s156),\n            _c63 = _a127.getBucket(o);\n          if (!_c63 || _c63.projection.name !== u.projection.name) continue;\n          var _h46 = _c63.programConfigurations.get(o.id),\n            _21 = Vi(o);\n          m && _21.push(\"PROJECTION_GLOBE_VIEW\");\n          var _d26 = t.useProgram(\"circle\", _h46, _21),\n            _p42 = _c63.layoutVertexBuffer,\n            _v16 = _c63.globeExtVertexBuffer,\n            _x21 = _c63.indexBuffer,\n            _y17 = u.projection.createInversionMatrix(u, _s156.canonical),\n            _b16 = {\n              programConfiguration: _h46,\n              program: _d26,\n              layoutVertexBuffer: _p42,\n              globeExtVertexBuffer: _v16,\n              indexBuffer: _x21,\n              uniformValues: Zi(t, _s156, _a127, _y17, f, o),\n              tile: _a127\n            };\n          if (l) {\n            var _t426 = _c63.segments.get();\n            var _iterator261 = _createForOfIteratorHelper(_t426),\n              _step261;\n            try {\n              for (_iterator261.s(); !(_step261 = _iterator261.n()).done;) {\n                var _i265 = _step261.value;\n                g.push({\n                  segments: new e.SegmentVector([_i265]),\n                  sortKey: _i265.sortKey,\n                  state: _b16\n                });\n              }\n            } catch (err) {\n              _iterator261.e(err);\n            } finally {\n              _iterator261.f();\n            }\n          } else g.push({\n            segments: _c63.segments,\n            sortKey: 0,\n            state: _b16\n          });\n        }\n        l && g.sort(function (e, t) {\n          return e.sortKey - t.sortKey;\n        });\n        var v = {\n          useDepthForOcclusion: !m\n        };\n        for (var _i266 = 0, _g21 = g; _i266 < _g21.length; _i266++) {\n          var _i267 = _g21[_i266];\n          var _i267$state = _i267.state,\n            _r285 = _i267$state.programConfiguration,\n            _n196 = _i267$state.program,\n            _s157 = _i267$state.layoutVertexBuffer,\n            _a128 = _i267$state.globeExtVertexBuffer,\n            _l78 = _i267$state.indexBuffer,\n            _m14 = _i267$state.uniformValues,\n            _f27 = _i267$state.tile,\n            _g22 = _i267.segments;\n          t.terrain && t.terrain.setupElevationDraw(_f27, _n196, v), t.prepareDrawProgram(c, _n196, _f27.tileID.toUnwrapped()), _n196.draw(c, h.TRIANGLES, _, d, p, e.CullFaceMode.disabled, _m14, o.id, _s157, _l78, _g22, o.paint, u.zoom, _r285, [_a128]);\n        }\n      },\n      heatmap: function heatmap(t, i, o, r) {\n        if (0 !== o.paint.get(\"heatmap-opacity\")) if (\"offscreen\" === t.renderPass) {\n          var _n197 = t.context,\n            _s158 = _n197.gl,\n            _a129 = e.StencilMode.disabled,\n            _l79 = new e.ColorMode([_s158.ONE, _s158.ONE], e.Color.transparent, [!0, !0, !0, !0]);\n          !function (e, t, i, o) {\n            var r = e.gl,\n              n = t.width * o,\n              s = t.height * o;\n            e.activeTexture.set(r.TEXTURE1), e.viewport.set([0, 0, n, s]);\n            var a = i.heatmapFbo;\n            if (!a || a && (a.width !== n || a.height !== s)) {\n              a && a.destroy();\n              var _t427 = r.createTexture();\n              r.bindTexture(r.TEXTURE_2D, _t427), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_S, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_WRAP_T, r.CLAMP_TO_EDGE), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, r.LINEAR), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, r.LINEAR), a = i.heatmapFbo = e.createFramebuffer(n, s, !1), function (e, t, i, o, r, n) {\n                var s = e.gl;\n                s.texImage2D(s.TEXTURE_2D, 0, e.isWebGL2 && e.extRenderToTextureHalfFloat ? s.RGBA16F : s.RGBA, r, n, 0, s.RGBA, e.extRenderToTextureHalfFloat ? e.isWebGL2 ? s.HALF_FLOAT : e.extTextureHalfFloat.HALF_FLOAT_OES : s.UNSIGNED_BYTE, null), o.colorAttachment.set(i);\n              }(e, 0, _t427, a, n, s);\n            } else r.bindTexture(r.TEXTURE_2D, a.colorAttachment.get()), e.bindFramebuffer.set(a.framebuffer);\n          }(_n197, t, o, \"globe\" === t.transform.projection.name ? .5 : .25), _n197.clear({\n            color: e.Color.transparent\n          });\n          var _c64 = t.transform,\n            _h47 = \"globe\" === _c64.projection.name,\n            _u65 = _h47 ? [\"PROJECTION_GLOBE_VIEW\"] : null,\n            _22 = _h47 ? e.CullFaceMode.frontCCW : e.CullFaceMode.disabled,\n            _d27 = [e.mercatorXfromLng(_c64.center.lng), e.mercatorYfromLat(_c64.center.lat)];\n          for (var _p43 = 0; _p43 < r.length; _p43++) {\n            var _m15 = r[_p43];\n            if (i.hasRenderableParent(_m15)) continue;\n            var _f28 = i.getTile(_m15),\n              _g23 = _f28.getBucket(o);\n            if (!_g23 || _g23.projection.name !== _c64.projection.name) continue;\n            var _v17 = _g23.programConfigurations.get(o.id),\n              _x22 = t.useProgram(\"heatmap\", _v17, _u65),\n              _y18 = t.transform.zoom;\n            t.terrain && t.terrain.setupElevationDraw(_f28, _x22), t.prepareDrawProgram(_n197, _x22, _m15.toUnwrapped());\n            var _b17 = _c64.projection.createInversionMatrix(_c64, _m15.canonical);\n            _x22.draw(_n197, _s158.TRIANGLES, e.DepthMode.disabled, _a129, _l79, _22, $i(t, _m15, _f28, _b17, _d27, _y18, o.paint.get(\"heatmap-intensity\")), o.id, _g23.layoutVertexBuffer, _g23.indexBuffer, _g23.segments, o.paint, t.transform.zoom, _v17, _h47 ? [_g23.globeExtVertexBuffer] : null);\n          }\n          _n197.viewport.set([0, 0, t.width, t.height]);\n        } else \"translucent\" === t.renderPass && (t.context.setColorMode(t.colorModeForRenderPass()), function (t, i) {\n          var o = t.context,\n            r = o.gl,\n            n = i.heatmapFbo;\n          if (!n) return;\n          o.activeTexture.set(r.TEXTURE0), r.bindTexture(r.TEXTURE_2D, n.colorAttachment.get()), o.activeTexture.set(r.TEXTURE1);\n          var s = i.colorRampTexture;\n          s || (s = i.colorRampTexture = new e.Texture(o, i.colorRamp, r.RGBA)), s.bind(r.LINEAR, r.CLAMP_TO_EDGE), t.useProgram(\"heatmapTexture\").draw(o, r.TRIANGLES, e.DepthMode.disabled, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.disabled, function (e, t, i, o) {\n            return {\n              u_image: 0,\n              u_color_ramp: 1,\n              u_opacity: t.paint.get(\"heatmap-opacity\")\n            };\n          }(0, i), i.id, t.viewportBuffer, t.quadTriangleIndexBuffer, t.viewportSegments, i.paint, t.transform.zoom);\n        }(t, o));\n      },\n      line: function line(t, i, o, r) {\n        if (\"translucent\" !== t.renderPass) return;\n        var n = o.paint.get(\"line-opacity\"),\n          s = o.paint.get(\"line-width\");\n        if (0 === n.constantOr(1) || 0 === s.constantOr(1)) return;\n        var a = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),\n          l = t.colorModeForRenderPass(),\n          c = t.terrain && t.terrain.renderingToTexture ? 1 : e.exported.devicePixelRatio,\n          h = o.paint.get(\"line-dasharray\"),\n          u = h.constantOr(1),\n          _ = o.layout.get(\"line-cap\"),\n          d = o.paint.get(\"line-pattern\"),\n          p = d.constantOr(1),\n          m = o.paint.get(\"line-gradient\"),\n          f = p ? \"linePattern\" : \"line\",\n          g = t.context,\n          v = g.gl,\n          x = function (e) {\n            var t = [];\n            Qi(e) && t.push(\"RENDER_LINE_DASH\"), e.paint.get(\"line-gradient\") && t.push(\"RENDER_LINE_GRADIENT\");\n            var i = e.paint.get(\"line-trim-offset\");\n            0 === i[0] && 0 === i[1] || t.push(\"RENDER_LINE_TRIM_OFFSET\");\n            var o = e.paint.get(\"line-pattern\").constantOr(1),\n              r = 1 !== e.paint.get(\"line-opacity\").constantOr(1);\n            return !o && r && t.push(\"RENDER_LINE_ALPHA_DISCARD\"), t;\n          }(o);\n        var y = x.includes(\"RENDER_LINE_ALPHA_DISCARD\");\n        t.terrain && t.terrain.clipOrMaskOverlapStencilType() && (y = !1);\n        var _iterator262 = _createForOfIteratorHelper(r),\n          _step262;\n        try {\n          var _loop14 = function _loop14() {\n            var n = _step262.value;\n            var r = i.getTile(n);\n            if (p && !r.patternsLoaded()) return \"continue\";\n            var s = r.getBucket(o);\n            if (!s) return \"continue\";\n            t.prepareDrawTile();\n            var b = s.programConfigurations.get(o.id),\n              w = t.useProgram(f, b, x),\n              T = d.constantOr(null);\n            if (T && r.imageAtlas) {\n              var _e423 = r.imageAtlas.patternPositions[T.toString()];\n              _e423 && b.setConstantPatternPositions(_e423);\n            }\n            var E = h.constantOr(null),\n              C = _.constantOr(null);\n            if (!p && E && C && r.lineAtlas) {\n              var _e424 = r.lineAtlas.getDash(E, C);\n              _e424 && b.setConstantPatternPositions(_e424);\n            }\n            var _o$paint$get = o.paint.get(\"line-trim-offset\"),\n              _o$paint$get2 = _slicedToArray(_o$paint$get, 2),\n              M = _o$paint$get2[0],\n              I = _o$paint$get2[1];\n            if (\"round\" === C || \"square\" === C) {\n              var _e425 = 1;\n              M !== I && (0 === M && (M -= _e425), 1 === I && (I += _e425));\n            }\n            var S = t.terrain ? n.projMatrix : null,\n              D = p ? Yi(t, r, o, S, c) : Hi(t, r, o, S, s.lineClipsArray.length, c, [M, I]);\n            if (m) {\n              var _r286 = s.gradients[o.id];\n              var _a130 = _r286.texture;\n              if (o.gradientVersion !== _r286.version) {\n                var _l80 = 256;\n                if (o.stepInterpolant) {\n                  var _o146 = i.getSource().maxzoom,\n                    _r287 = n.canonical.z === _o146 ? Math.ceil(1 << t.transform.maxZoom - n.canonical.z) : 1;\n                  _l80 = e.clamp(e.nextPowerOfTwo(s.maxLineLength / e.EXTENT * 1024 * _r287), 256, g.maxTextureSize);\n                }\n                _r286.gradient = e.renderColorRamp({\n                  expression: o.gradientExpression(),\n                  evaluationKey: \"lineProgress\",\n                  resolution: _l80,\n                  image: _r286.gradient || void 0,\n                  clips: s.lineClipsArray\n                }), _r286.texture ? _r286.texture.update(_r286.gradient) : _r286.texture = new e.Texture(g, _r286.gradient, v.RGBA), _r286.version = o.gradientVersion, _a130 = _r286.texture;\n              }\n              g.activeTexture.set(v.TEXTURE1), _a130.bind(o.stepInterpolant ? v.NEAREST : v.LINEAR, v.CLAMP_TO_EDGE);\n            }\n            u && (g.activeTexture.set(v.TEXTURE0), r.lineAtlasTexture.bind(v.LINEAR, v.REPEAT), b.updatePaintBuffers()), p && (g.activeTexture.set(v.TEXTURE0), r.imageAtlasTexture.bind(v.LINEAR, v.CLAMP_TO_EDGE), b.updatePaintBuffers()), t.prepareDrawProgram(g, w, n.toUnwrapped());\n            var L = function L(i) {\n              w.draw(g, v.TRIANGLES, a, i, l, e.CullFaceMode.disabled, D, o.id, s.layoutVertexBuffer, s.indexBuffer, s.segments, o.paint, t.transform.zoom, b, [s.layoutVertexBuffer2]);\n            };\n            if (y) {\n              var _i268 = t.stencilModeForClipping(n).ref;\n              0 === _i268 && t.terrain && g.clear({\n                stencil: 0\n              });\n              var _o147 = {\n                func: v.EQUAL,\n                mask: 255\n              };\n              D.u_alpha_discard_threshold = .8, L(new e.StencilMode(_o147, _i268, 255, v.KEEP, v.KEEP, v.INVERT)), D.u_alpha_discard_threshold = 0, L(new e.StencilMode(_o147, _i268, 255, v.KEEP, v.KEEP, v.KEEP));\n            } else L(t.stencilModeForClipping(n));\n          };\n          for (_iterator262.s(); !(_step262 = _iterator262.n()).done;) {\n            var _ret6 = _loop14();\n            if (_ret6 === \"continue\") continue;\n          }\n        } catch (err) {\n          _iterator262.e(err);\n        } finally {\n          _iterator262.f();\n        }\n        y && (t.resetStencilClippingMasks(), t.terrain && g.clear({\n          stencil: 0\n        }));\n      },\n      fill: function fill(t, i, o, r) {\n        var n = o.paint.get(\"fill-color\"),\n          s = o.paint.get(\"fill-opacity\");\n        if (0 === s.constantOr(1)) return;\n        var a = t.colorModeForRenderPass(),\n          l = o.paint.get(\"fill-pattern\"),\n          c = t.opaquePassEnabledForLayer() && !l.constantOr(1) && 1 === n.constantOr(e.Color.transparent).a && 1 === s.constantOr(0) ? \"opaque\" : \"translucent\";\n        if (t.renderPass === c) {\n          var _n198 = t.depthModeForSublayer(1, \"opaque\" === t.renderPass ? e.DepthMode.ReadWrite : e.DepthMode.ReadOnly);\n          vo(t, i, o, r, _n198, a, !1);\n        }\n        if (\"translucent\" === t.renderPass && o.paint.get(\"fill-antialias\")) {\n          var _n199 = t.depthModeForSublayer(o.getPaintProperty(\"fill-outline-color\") ? 2 : 0, e.DepthMode.ReadOnly);\n          vo(t, i, o, r, _n199, a, !0);\n        }\n      },\n      \"fill-extrusion\": function fillExtrusion(t, i, o, r) {\n        var n = o.paint.get(\"fill-extrusion-opacity\");\n        if (0 !== n && \"translucent\" === t.renderPass) {\n          var _s159 = new e.DepthMode(t.context.gl.LEQUAL, e.DepthMode.ReadWrite, t.depthRangeFor3D);\n          if (1 !== n || o.paint.get(\"fill-extrusion-pattern\").constantOr(1)) xo(t, i, o, r, _s159, e.StencilMode.disabled, e.ColorMode.disabled), xo(t, i, o, r, _s159, t.stencilModeFor3D(), t.colorModeForRenderPass()), t.resetStencilClippingMasks();else {\n            var _n200 = t.colorModeForRenderPass();\n            xo(t, i, o, r, _s159, e.StencilMode.disabled, _n200);\n          }\n        }\n      },\n      hillshade: function hillshade(t, i, o, r) {\n        if (\"offscreen\" !== t.renderPass && \"translucent\" !== t.renderPass) return;\n        var n = t.context,\n          s = t.depthModeForSublayer(0, e.DepthMode.ReadOnly),\n          a = t.colorModeForRenderPass(),\n          l = t.terrain && t.terrain.renderingToTexture,\n          _ref144 = \"translucent\" !== t.renderPass || l ? [{}, r] : t.stencilConfigForOverlap(r),\n          _ref145 = _slicedToArray(_ref144, 2),\n          c = _ref145[0],\n          h = _ref145[1];\n        var _iterator263 = _createForOfIteratorHelper(h),\n          _step263;\n        try {\n          for (_iterator263.s(); !(_step263 = _iterator263.n()).done;) {\n            var _r288 = _step263.value;\n            var _n201 = i.getTile(_r288);\n            if (_n201.needsHillshadePrepare && \"offscreen\" === t.renderPass) vi(t, _n201, o, s, e.StencilMode.disabled, a);else if (\"translucent\" === t.renderPass) {\n              var _e426 = l && t.terrain ? t.terrain.stencilModeForRTTOverlap(_r288) : c[_r288.overscaledZ];\n              fi(t, _r288, _n201, o, s, _e426, a);\n            }\n          }\n        } catch (err) {\n          _iterator263.e(err);\n        } finally {\n          _iterator263.f();\n        }\n        n.viewport.set([0, 0, t.width, t.height]), t.resetStencilClippingMasks();\n      },\n      raster: function raster(t, i, o, r, n, s) {\n        if (\"translucent\" !== t.renderPass) return;\n        if (0 === o.paint.get(\"raster-opacity\")) return;\n        if (!r.length) return;\n        var a = t.context,\n          l = a.gl,\n          c = i.getSource(),\n          h = t.useProgram(\"raster\"),\n          u = t.colorModeForRenderPass(),\n          _ = t.terrain && t.terrain.renderingToTexture,\n          _ref146 = c instanceof Ae || _ ? [{}, r] : t.stencilConfigForOverlap(r),\n          _ref147 = _slicedToArray(_ref146, 2),\n          d = _ref147[0],\n          p = _ref147[1],\n          m = p[p.length - 1].overscaledZ,\n          f = !t.options.moving;\n        var _iterator264 = _createForOfIteratorHelper(p),\n          _step264;\n        try {\n          for (_iterator264.s(); !(_step264 = _iterator264.n()).done;) {\n            var _r289 = _step264.value;\n            var _n202 = _ ? e.DepthMode.disabled : t.depthModeForSublayer(_r289.overscaledZ - m, 1 === o.paint.get(\"raster-opacity\") ? e.DepthMode.ReadWrite : e.DepthMode.ReadOnly, l.LESS),\n              _p44 = _r289.toUnwrapped(),\n              _g24 = i.getTile(_r289);\n            if (_ && (!_g24 || !_g24.hasData())) continue;\n            var _v18 = _ ? _r289.projMatrix : t.transform.calculateProjMatrix(_p44, f),\n              _x23 = t.terrain && _ ? t.terrain.stencilModeForRTTOverlap(_r289) : d[_r289.overscaledZ],\n              _y19 = s ? 0 : o.paint.get(\"raster-fade-duration\");\n            _g24.registerFadeDuration(_y19);\n            var _b18 = i.findLoadedParent(_r289, 0),\n              _w16 = Si(_g24, _b18, i, t.transform, _y19);\n            var _T10 = void 0,\n              _E9 = void 0;\n            t.terrain && t.terrain.prepareDrawTile();\n            var _C7 = \"nearest\" === o.paint.get(\"raster-resampling\") ? l.NEAREST : l.LINEAR;\n            a.activeTexture.set(l.TEXTURE0), _g24.texture.bind(_C7, l.CLAMP_TO_EDGE), a.activeTexture.set(l.TEXTURE1), _b18 ? (_b18.texture.bind(_C7, l.CLAMP_TO_EDGE), _T10 = Math.pow(2, _b18.tileID.overscaledZ - _g24.tileID.overscaledZ), _E9 = [_g24.tileID.canonical.x * _T10 % 1, _g24.tileID.canonical.y * _T10 % 1]) : _g24.texture.bind(_C7, l.CLAMP_TO_EDGE), _g24.texture.useMipmap && a.extTextureFilterAnisotropic && t.transform.pitch > 20 && l.texParameterf(l.TEXTURE_2D, a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, a.extTextureFilterAnisotropicMax);\n            var _M10 = eo(_v18, _E9 || [0, 0], _T10 || 1, _w16, o, c instanceof Ae ? c.perspectiveTransform : [0, 0]);\n            if (t.prepareDrawProgram(a, h, _p44), c instanceof Ae) c.boundsBuffer && c.boundsSegments && h.draw(a, l.TRIANGLES, _n202, e.StencilMode.disabled, u, e.CullFaceMode.disabled, _M10, o.id, c.boundsBuffer, t.quadTriangleIndexBuffer, c.boundsSegments);else {\n              var _t$getTileBoundsBuffe2 = t.getTileBoundsBuffers(_g24),\n                _i269 = _t$getTileBoundsBuffe2.tileBoundsBuffer,\n                _r290 = _t$getTileBoundsBuffe2.tileBoundsIndexBuffer,\n                _s160 = _t$getTileBoundsBuffe2.tileBoundsSegments;\n              h.draw(a, l.TRIANGLES, _n202, _x23, u, e.CullFaceMode.disabled, _M10, o.id, _i269, _r290, _s160);\n            }\n          }\n        } catch (err) {\n          _iterator264.e(err);\n        } finally {\n          _iterator264.f();\n        }\n        t.resetStencilClippingMasks();\n      },\n      background: function background(t, i, o, r) {\n        var n = o.paint.get(\"background-color\"),\n          s = o.paint.get(\"background-opacity\");\n        if (0 === s) return;\n        var a = t.context,\n          l = a.gl,\n          c = t.transform,\n          h = c.tileSize,\n          u = o.paint.get(\"background-pattern\");\n        if (t.isPatternMissing(u)) return;\n        var _ = !u && 1 === n.a && 1 === s && t.opaquePassEnabledForLayer() ? \"opaque\" : \"translucent\";\n        if (t.renderPass !== _) return;\n        var d = e.StencilMode.disabled,\n          p = t.depthModeForSublayer(0, \"opaque\" === _ ? e.DepthMode.ReadWrite : e.DepthMode.ReadOnly),\n          m = t.colorModeForRenderPass(),\n          f = t.useProgram(u ? \"backgroundPattern\" : \"background\");\n        var g,\n          v = r;\n        v || (g = t.getBackgroundTiles(), v = Object.values(g).map(function (e) {\n          return e.tileID;\n        })), u && (a.activeTexture.set(l.TEXTURE0), t.imageManager.bind(t.context));\n        var _iterator265 = _createForOfIteratorHelper(v),\n          _step265;\n        try {\n          for (_iterator265.s(); !(_step265 = _iterator265.n()).done;) {\n            var _23 = _step265.value;\n            var _v19 = _23.toUnwrapped(),\n              _x24 = r ? _23.projMatrix : t.transform.calculateProjMatrix(_v19);\n            t.prepareDrawTile();\n            var _y20 = i ? i.getTile(_23) : g ? g[_23.key] : new e.Tile(_23, h, c.zoom, t),\n              _b19 = u ? ao(_x24, s, t, u, {\n                tileID: _23,\n                tileSize: h\n              }) : so(_x24, s, n);\n            t.prepareDrawProgram(a, f, _v19);\n            var _t$getTileBoundsBuffe3 = t.getTileBoundsBuffers(_y20),\n              _w17 = _t$getTileBoundsBuffe3.tileBoundsBuffer,\n              _T11 = _t$getTileBoundsBuffe3.tileBoundsIndexBuffer,\n              _E10 = _t$getTileBoundsBuffe3.tileBoundsSegments;\n            f.draw(a, l.TRIANGLES, p, d, m, e.CullFaceMode.disabled, _b19, o.id, _w17, _T11, _E10);\n          }\n        } catch (err) {\n          _iterator265.e(err);\n        } finally {\n          _iterator265.f();\n        }\n      },\n      sky: function sky(t, i, o) {\n        var r = t.transform,\n          n = \"mercator\" === r.projection.name || \"globe\" === r.projection.name ? 1 : e.smoothstep(7, 8, r.zoom),\n          s = o.paint.get(\"sky-opacity\") * n;\n        if (0 === s) return;\n        var a = t.context,\n          l = o.paint.get(\"sky-type\"),\n          c = new e.DepthMode(a.gl.LEQUAL, e.DepthMode.ReadOnly, [0, 1]),\n          h = t.frameCounter / 1e3 % 1;\n        \"atmosphere\" === l ? \"offscreen\" === t.renderPass ? o.needsSkyboxCapture(t) && (function (t, i, o, r) {\n          var n = t.context,\n            s = n.gl;\n          var a = i.skyboxFbo;\n          if (!a) {\n            a = i.skyboxFbo = n.createFramebuffer(32, 32, !1), i.skyboxGeometry = new Po(n), i.skyboxTexture = n.gl.createTexture(), s.bindTexture(s.TEXTURE_CUBE_MAP, i.skyboxTexture), s.texParameteri(s.TEXTURE_CUBE_MAP, s.TEXTURE_WRAP_S, s.CLAMP_TO_EDGE), s.texParameteri(s.TEXTURE_CUBE_MAP, s.TEXTURE_WRAP_T, s.CLAMP_TO_EDGE), s.texParameteri(s.TEXTURE_CUBE_MAP, s.TEXTURE_MIN_FILTER, s.LINEAR), s.texParameteri(s.TEXTURE_CUBE_MAP, s.TEXTURE_MAG_FILTER, s.LINEAR);\n            for (var _e427 = 0; _e427 < 6; ++_e427) s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X + _e427, 0, s.RGBA, 32, 32, 0, s.RGBA, s.UNSIGNED_BYTE, null);\n          }\n          n.bindFramebuffer.set(a.framebuffer), n.viewport.set([0, 0, 32, 32]);\n          var l = i.getCenter(t, !0),\n            c = t.useProgram(\"skyboxCapture\"),\n            h = new Float64Array(16);\n          e.identity(h), e.rotateY(h, h, .5 * -Math.PI), Ro(n, i, c, h, l, 0), e.identity(h), e.rotateY(h, h, .5 * Math.PI), Ro(n, i, c, h, l, 1), e.identity(h), e.rotateX(h, h, .5 * -Math.PI), Ro(n, i, c, h, l, 2), e.identity(h), e.rotateX(h, h, .5 * Math.PI), Ro(n, i, c, h, l, 3), e.identity(h), Ro(n, i, c, h, l, 4), e.identity(h), e.rotateY(h, h, Math.PI), Ro(n, i, c, h, l, 5), n.viewport.set([0, 0, t.width, t.height]);\n        }(t, o), o.markSkyboxValid(t)) : \"sky\" === t.renderPass && function (t, i, o, r, n) {\n          var s = t.context,\n            a = s.gl,\n            l = t.transform,\n            c = t.useProgram(\"skybox\");\n          s.activeTexture.set(a.TEXTURE0), a.bindTexture(a.TEXTURE_CUBE_MAP, i.skyboxTexture);\n          var h = function (e, t, i, o, r) {\n            return {\n              u_matrix: e,\n              u_sun_direction: t,\n              u_cubemap: 0,\n              u_opacity: o,\n              u_temporal_offset: r\n            };\n          }(l.skyboxMatrix, i.getCenter(t, !1), 0, r, n);\n          t.prepareDrawProgram(s, c), c.draw(s, a.TRIANGLES, o, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.backCW, h, \"skybox\", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);\n        }(t, o, c, s, h) : \"gradient\" === l && \"sky\" === t.renderPass && function (t, i, o, r, n) {\n          var s = t.context,\n            a = s.gl,\n            l = t.transform,\n            c = t.useProgram(\"skyboxGradient\");\n          i.skyboxGeometry || (i.skyboxGeometry = new Po(s)), s.activeTexture.set(a.TEXTURE0);\n          var h = i.colorRampTexture;\n          h || (h = i.colorRampTexture = new e.Texture(s, i.colorRamp, a.RGBA)), h.bind(a.LINEAR, a.CLAMP_TO_EDGE);\n          var u = function (t, i, o, r, n) {\n            return {\n              u_matrix: t,\n              u_color_ramp: 0,\n              u_center_direction: i,\n              u_radius: e.degToRad(o),\n              u_opacity: r,\n              u_temporal_offset: n\n            };\n          }(l.skyboxMatrix, i.getCenter(t, !1), i.paint.get(\"sky-gradient-radius\"), r, n);\n          t.prepareDrawProgram(s, c), c.draw(s, a.TRIANGLES, o, e.StencilMode.disabled, t.colorModeForRenderPass(), e.CullFaceMode.backCW, u, \"skyboxGradient\", i.skyboxGeometry.vertexBuffer, i.skyboxGeometry.indexBuffer, i.skyboxGeometry.segment);\n        }(t, o, c, s, h);\n      },\n      debug: function debug(e, t, i) {\n        for (var _o148 = 0; _o148 < i.length; _o148++) Mo(e, t, i[_o148]);\n      },\n      custom: function custom(t, i, o, r) {\n        var n = t.context,\n          s = o.implementation;\n        if (!t.transform.projection.unsupportedLayers || !t.transform.projection.unsupportedLayers.includes(\"custom\") || t.terrain && (t.terrain.renderingToTexture || \"offscreen\" === t.renderPass) && o.isLayerDraped()) {\n          if (\"offscreen\" === t.renderPass) {\n            var _i270 = s.prerender;\n            if (_i270) {\n              if (t.setCustomLayerDefaults(), n.setColorMode(t.colorModeForRenderPass()), \"globe\" === t.transform.projection.name) {\n                var _o149 = t.transform.pointMerc;\n                _i270.call(s, n.gl, t.transform.customLayerMatrix(), t.transform.getProjection(), t.transform.globeToMercatorMatrix(), e.globeToMercatorTransition(t.transform.zoom), [_o149.x, _o149.y], t.transform.pixelsPerMeterRatio);\n              } else _i270.call(s, n.gl, t.transform.customLayerMatrix());\n              n.setDirty(), t.setBaseState();\n            }\n          } else if (\"translucent\" === t.renderPass) {\n            if (t.terrain && t.terrain.renderingToTexture) {\n              var _i271 = s.renderToTile;\n              if (_i271) {\n                var _o150 = r[0].canonical,\n                  _a131 = new e.MercatorCoordinate(_o150.x + r[0].wrap * (1 << _o150.z), _o150.y, _o150.z);\n                n.setDepthMode(e.DepthMode.disabled), n.setStencilMode(e.StencilMode.disabled), n.setColorMode(t.colorModeForRenderPass()), t.setCustomLayerDefaults(), _i271.call(s, n.gl, _a131), n.setDirty(), t.setBaseState();\n              }\n              return;\n            }\n            t.setCustomLayerDefaults(), n.setColorMode(t.colorModeForRenderPass()), n.setStencilMode(e.StencilMode.disabled);\n            var _i272 = \"3d\" === s.renderingMode ? new e.DepthMode(t.context.gl.LEQUAL, e.DepthMode.ReadWrite, t.depthRangeFor3D) : t.depthModeForSublayer(0, e.DepthMode.ReadOnly);\n            if (n.setDepthMode(_i272), \"globe\" === t.transform.projection.name) {\n              var _i273 = t.transform.pointMerc;\n              s.render(n.gl, t.transform.customLayerMatrix(), t.transform.getProjection(), t.transform.globeToMercatorMatrix(), e.globeToMercatorTransition(t.transform.zoom), [_i273.x, _i273.y], t.transform.pixelsPerMeterRatio);\n            } else s.render(n.gl, t.transform.customLayerMatrix());\n            n.setDirty(), t.setBaseState(), n.bindFramebuffer.set(null);\n          }\n        } else e.warnOnce(\"Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.\");\n      }\n    };\n    var Fo = /*#__PURE__*/function () {\n      function Fo(t, i) {\n        var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n        _classCallCheck(this, Fo);\n        this.context = new Me(t, o), this.transform = i, this._tileTextures = {}, this.frameCopies = [], this.loadTimeStamps = [], this.setup(), this.numSublayers = e.SourceCache.maxUnderzooming + e.SourceCache.maxOverzooming + 1, this.depthEpsilon = 1 / Math.pow(2, 16), this.crossTileSymbolIndex = new qt(), this.deferredRenderGpuTimeQueries = [], this.gpuTimers = {}, this.frameCounter = 0, this._backgroundTiles = {};\n      }\n      _createClass(Fo, [{\n        key: \"updateTerrain\",\n        value: function updateTerrain(e, t) {\n          var i = !!e && !!e.terrain && this.transform.projection.supportsTerrain;\n          if (!(i || this._terrain && this._terrain.enabled)) return;\n          this._terrain || (this._terrain = new zi(this, e));\n          var o = this._terrain;\n          this.transform.elevation = i ? o : null, o.update(e, this.transform, t);\n        }\n      }, {\n        key: \"_updateFog\",\n        value: function _updateFog(e) {\n          var t = e.fog;\n          if (!t || \"globe\" === this.transform.projection.name || t.getOpacity(this.transform.pitch) < 1 || t.properties.get(\"horizon-blend\") < .03) return void (this.transform.fogCullDistSq = null);\n          var _t$getFovAdjustedRang = t.getFovAdjustedRange(this.transform._fov),\n            _t$getFovAdjustedRang2 = _slicedToArray(_t$getFovAdjustedRang, 2),\n            i = _t$getFovAdjustedRang2[0],\n            o = _t$getFovAdjustedRang2[1];\n          if (i > o) return void (this.transform.fogCullDistSq = null);\n          var r = i + .78 * (o - i);\n          this.transform.fogCullDistSq = r * r;\n        }\n      }, {\n        key: \"resize\",\n        value: function resize(t, i) {\n          if (this.width = t * e.exported.devicePixelRatio, this.height = i * e.exported.devicePixelRatio, this.context.viewport.set([0, 0, this.width, this.height]), this.style) {\n            var _iterator266 = _createForOfIteratorHelper(this.style.order),\n              _step266;\n            try {\n              for (_iterator266.s(); !(_step266 = _iterator266.n()).done;) {\n                var _e428 = _step266.value;\n                this.style._layers[_e428].resize();\n              }\n            } catch (err) {\n              _iterator266.e(err);\n            } finally {\n              _iterator266.f();\n            }\n          }\n        }\n      }, {\n        key: \"setup\",\n        value: function setup() {\n          var t = this.context,\n            i = new e.StructArrayLayout2i4();\n          i.emplaceBack(0, 0), i.emplaceBack(e.EXTENT, 0), i.emplaceBack(0, e.EXTENT), i.emplaceBack(e.EXTENT, e.EXTENT), this.tileExtentBuffer = t.createVertexBuffer(i, e.posAttributes.members), this.tileExtentSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);\n          var o = new e.StructArrayLayout2i4();\n          o.emplaceBack(0, 0), o.emplaceBack(e.EXTENT, 0), o.emplaceBack(0, e.EXTENT), o.emplaceBack(e.EXTENT, e.EXTENT), this.debugBuffer = t.createVertexBuffer(o, e.posAttributes.members), this.debugSegments = e.SegmentVector.simpleSegment(0, 0, 4, 5);\n          var r = new e.StructArrayLayout2i4();\n          r.emplaceBack(-1, -1), r.emplaceBack(1, -1), r.emplaceBack(-1, 1), r.emplaceBack(1, 1), this.viewportBuffer = t.createVertexBuffer(r, e.posAttributes.members), this.viewportSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);\n          var n = new e.StructArrayLayout4i8();\n          n.emplaceBack(0, 0, 0, 0), n.emplaceBack(e.EXTENT, 0, e.EXTENT, 0), n.emplaceBack(0, e.EXTENT, 0, e.EXTENT), n.emplaceBack(e.EXTENT, e.EXTENT, e.EXTENT, e.EXTENT), this.mercatorBoundsBuffer = t.createVertexBuffer(n, e.boundsAttributes.members), this.mercatorBoundsSegments = e.SegmentVector.simpleSegment(0, 0, 4, 2);\n          var s = new e.StructArrayLayout3ui6();\n          s.emplaceBack(0, 1, 2), s.emplaceBack(2, 1, 3), this.quadTriangleIndexBuffer = t.createIndexBuffer(s);\n          var a = new e.StructArrayLayout1ui2();\n          for (var _i274 = 0, _arr4 = [0, 1, 3, 2, 0]; _i274 < _arr4.length; _i274++) {\n            var _e429 = _arr4[_i274];\n            a.emplaceBack(_e429);\n          }\n          this.debugIndexBuffer = t.createIndexBuffer(a), this.emptyTexture = new e.Texture(t, new e.RGBAImage({\n            width: 1,\n            height: 1\n          }, Uint8Array.of(0, 0, 0, 0)), t.gl.RGBA), this.identityMat = e.create();\n          var l = this.context.gl;\n          this.stencilClearMode = new e.StencilMode({\n            func: l.ALWAYS,\n            mask: 0\n          }, 0, 255, l.ZERO, l.ZERO, l.ZERO), this.loadTimeStamps.push(e.window.performance.now()), this.atmosphereBuffer = new Bo(this.context);\n        }\n      }, {\n        key: \"getMercatorTileBoundsBuffers\",\n        value: function getMercatorTileBoundsBuffers() {\n          return {\n            tileBoundsBuffer: this.mercatorBoundsBuffer,\n            tileBoundsIndexBuffer: this.quadTriangleIndexBuffer,\n            tileBoundsSegments: this.mercatorBoundsSegments\n          };\n        }\n      }, {\n        key: \"getTileBoundsBuffers\",\n        value: function getTileBoundsBuffers(e) {\n          return e._makeTileBoundsBuffers(this.context, this.transform.projection), e._tileBoundsBuffer ? {\n            tileBoundsBuffer: e._tileBoundsBuffer,\n            tileBoundsIndexBuffer: e._tileBoundsIndexBuffer,\n            tileBoundsSegments: e._tileBoundsSegments\n          } : this.getMercatorTileBoundsBuffers();\n        }\n      }, {\n        key: \"clearStencil\",\n        value: function clearStencil() {\n          var t = this.context,\n            i = t.gl;\n          this.nextStencilID = 1, this.currentStencilSource = void 0, this._tileClippingMaskIDs = {}, this.useProgram(\"clippingMask\").draw(t, i.TRIANGLES, e.DepthMode.disabled, this.stencilClearMode, e.ColorMode.disabled, e.CullFaceMode.disabled, Ii(this.identityMat), \"$clipping\", this.viewportBuffer, this.quadTriangleIndexBuffer, this.viewportSegments);\n        }\n      }, {\n        key: \"resetStencilClippingMasks\",\n        value: function resetStencilClippingMasks() {\n          this.terrain || (this.currentStencilSource = void 0, this._tileClippingMaskIDs = {});\n        }\n      }, {\n        key: \"_renderTileClippingMasks\",\n        value: function _renderTileClippingMasks(t, i, o) {\n          if (!i || this.currentStencilSource === i.id || !t.isTileClipped() || !o || 0 === o.length) return;\n          if (this._tileClippingMaskIDs && !this.terrain) {\n            var _e430 = !1;\n            var _iterator267 = _createForOfIteratorHelper(o),\n              _step267;\n            try {\n              for (_iterator267.s(); !(_step267 = _iterator267.n()).done;) {\n                var _t428 = _step267.value;\n                if (void 0 === this._tileClippingMaskIDs[_t428.key]) {\n                  _e430 = !0;\n                  break;\n                }\n              }\n            } catch (err) {\n              _iterator267.e(err);\n            } finally {\n              _iterator267.f();\n            }\n            if (!_e430) return;\n          }\n          this.currentStencilSource = i.id;\n          var r = this.context,\n            n = r.gl;\n          this.nextStencilID + o.length > 256 && this.clearStencil(), r.setColorMode(e.ColorMode.disabled), r.setDepthMode(e.DepthMode.disabled);\n          var s = this.useProgram(\"clippingMask\");\n          this._tileClippingMaskIDs = {};\n          var _iterator268 = _createForOfIteratorHelper(o),\n            _step268;\n          try {\n            for (_iterator268.s(); !(_step268 = _iterator268.n()).done;) {\n              var _t429 = _step268.value;\n              var _o151 = i.getTile(_t429),\n                _a132 = this._tileClippingMaskIDs[_t429.key] = this.nextStencilID++,\n                _this$getTileBoundsBu = this.getTileBoundsBuffers(_o151),\n                _l81 = _this$getTileBoundsBu.tileBoundsBuffer,\n                _c65 = _this$getTileBoundsBu.tileBoundsIndexBuffer,\n                _h48 = _this$getTileBoundsBu.tileBoundsSegments;\n              s.draw(r, n.TRIANGLES, e.DepthMode.disabled, new e.StencilMode({\n                func: n.ALWAYS,\n                mask: 0\n              }, _a132, 255, n.KEEP, n.KEEP, n.REPLACE), e.ColorMode.disabled, e.CullFaceMode.disabled, Ii(_t429.projMatrix), \"$clipping\", _l81, _c65, _h48);\n            }\n          } catch (err) {\n            _iterator268.e(err);\n          } finally {\n            _iterator268.f();\n          }\n        }\n      }, {\n        key: \"stencilModeFor3D\",\n        value: function stencilModeFor3D() {\n          this.currentStencilSource = void 0, this.nextStencilID + 1 > 256 && this.clearStencil();\n          var t = this.nextStencilID++,\n            i = this.context.gl;\n          return new e.StencilMode({\n            func: i.NOTEQUAL,\n            mask: 255\n          }, t, 255, i.KEEP, i.KEEP, i.REPLACE);\n        }\n      }, {\n        key: \"stencilModeForClipping\",\n        value: function stencilModeForClipping(t) {\n          if (this.terrain) return this.terrain.stencilModeForRTTOverlap(t);\n          var i = this.context.gl;\n          return new e.StencilMode({\n            func: i.EQUAL,\n            mask: 255\n          }, this._tileClippingMaskIDs[t.key], 0, i.KEEP, i.KEEP, i.REPLACE);\n        }\n      }, {\n        key: \"stencilConfigForOverlap\",\n        value: function stencilConfigForOverlap(t) {\n          var i = this.context.gl,\n            o = t.sort(function (e, t) {\n              return t.overscaledZ - e.overscaledZ;\n            }),\n            r = o[o.length - 1].overscaledZ,\n            n = o[0].overscaledZ - r + 1;\n          if (n > 1) {\n            this.currentStencilSource = void 0, this.nextStencilID + n > 256 && this.clearStencil();\n            var _t430 = {};\n            for (var _o152 = 0; _o152 < n; _o152++) _t430[_o152 + r] = new e.StencilMode({\n              func: i.GEQUAL,\n              mask: 255\n            }, _o152 + this.nextStencilID, 255, i.KEEP, i.KEEP, i.REPLACE);\n            return this.nextStencilID += n, [_t430, o];\n          }\n          return [_defineProperty({}, r, e.StencilMode.disabled), o];\n        }\n      }, {\n        key: \"colorModeForRenderPass\",\n        value: function colorModeForRenderPass() {\n          var t = this.context.gl;\n          if (this._showOverdrawInspector) {\n            var _i275 = 1 / 8;\n            return new e.ColorMode([t.CONSTANT_COLOR, t.ONE], new e.Color(_i275, _i275, _i275, 0), [!0, !0, !0, !0]);\n          }\n          return \"opaque\" === this.renderPass ? e.ColorMode.unblended : e.ColorMode.alphaBlended;\n        }\n      }, {\n        key: \"depthModeForSublayer\",\n        value: function depthModeForSublayer(t, i, o) {\n          if (!this.opaquePassEnabledForLayer()) return e.DepthMode.disabled;\n          var r = 1 - ((1 + this.currentLayer) * this.numSublayers + t) * this.depthEpsilon;\n          return new e.DepthMode(o || this.context.gl.LEQUAL, i, [r, r]);\n        }\n      }, {\n        key: \"opaquePassEnabledForLayer\",\n        value: function opaquePassEnabledForLayer() {\n          return this.currentLayer < this.opaquePassCutoff;\n        }\n      }, {\n        key: \"render\",\n        value: function render(t, i) {\n          var _this116 = this;\n          this.style = t, this.options = i, this.imageManager = t.imageManager, this.glyphManager = t.glyphManager, this.symbolFadeChange = t.placement.symbolFadeChange(e.exported.now()), this.imageManager.beginFrame();\n          var o = this.style.order,\n            r = this.style._sourceCaches;\n          for (var _e431 in r) {\n            var _t431 = r[_e431];\n            _t431.used && _t431.prepare(this.context);\n          }\n          var n = {},\n            s = {},\n            a = {};\n          for (var _e432 in r) {\n            var _t432 = r[_e432];\n            n[_e432] = _t432.getVisibleCoordinates(), s[_e432] = n[_e432].slice().reverse(), a[_e432] = _t432.getVisibleCoordinates(!0).reverse();\n          }\n          this.opaquePassCutoff = 1 / 0;\n          for (var _e433 = 0; _e433 < o.length; _e433++) if (this.style._layers[o[_e433]].is3D()) {\n            this.opaquePassCutoff = _e433;\n            break;\n          }\n          if (this.terrain && (this.terrain.updateTileBinding(a), this.opaquePassCutoff = 0), \"globe\" !== this.transform.projection.name || this.globeSharedBuffers || (this.globeSharedBuffers = new e.GlobeSharedBuffers(this.context)), !e.isMapAuthenticated(this.context.gl)) return;\n          this.renderPass = \"offscreen\";\n          var _iterator269 = _createForOfIteratorHelper(o),\n            _step269;\n          try {\n            for (_iterator269.s(); !(_step269 = _iterator269.n()).done;) {\n              var _e437 = _step269.value;\n              var _i280 = this.style._layers[_e437],\n                _o153 = t._getLayerSourceCache(_i280);\n              if (!_i280.hasOffscreenPass() || _i280.isHidden(this.transform.zoom)) continue;\n              var _r293 = _o153 ? s[_o153.id] : void 0;\n              (\"custom\" === _i280.type || _i280.isSky() || _r293 && _r293.length) && this.renderLayer(this, _o153, _i280, _r293);\n            }\n          } catch (err) {\n            _iterator269.e(err);\n          } finally {\n            _iterator269.f();\n          }\n          this.depthRangeFor3D = [0, 1 - (t.order.length + 2) * this.numSublayers * this.depthEpsilon];\n          var l = this.terrain;\n          if (l && (this.style.hasSymbolLayers() || this.style.hasCircleLayers()) && l.drawDepth(), this.context.bindFramebuffer.set(null), this.context.viewport.set([0, 0, this.width, this.height]), this.context.clear({\n            color: i.showOverdrawInspector ? e.Color.black : e.Color.transparent,\n            depth: 1\n          }), this.clearStencil(), this._showOverdrawInspector = i.showOverdrawInspector, this.renderPass = \"opaque\", !this.terrain) for (this.currentLayer = o.length - 1; this.currentLayer >= 0; this.currentLayer--) {\n            var _e434 = this.style._layers[o[this.currentLayer]],\n              _i276 = t._getLayerSourceCache(_e434);\n            if (_e434.isSky()) continue;\n            var _r291 = _i276 ? s[_i276.id] : void 0;\n            this._renderTileClippingMasks(_e434, _i276, _r291), this.renderLayer(this, _i276, _e434, _r291);\n          }\n          if (this.style.fog && this.transform.projection.supportsFog && function (t, i) {\n            var o = t.context,\n              r = o.gl,\n              n = t.transform,\n              s = new e.DepthMode(r.LEQUAL, e.DepthMode.ReadOnly, [0, 1]),\n              a = t.useProgram(\"globeAtmosphere\", null, \"globe\" === n.projection.name ? [\"PROJECTION_GLOBE_VIEW\", \"FOG\"] : [\"FOG\"]),\n              l = e.globeToMercatorTransition(n.zoom),\n              c = i.properties.get(\"color\").toArray01(),\n              h = i.properties.get(\"high-color\").toArray01(),\n              u = i.properties.get(\"space-color\").toArray01PremultipliedAlpha(),\n              _ = e.identity$1([]);\n            e.rotateY$1(_, _, -e.degToRad(n._center.lng)), e.rotateX$1(_, _, e.degToRad(n._center.lat)), e.rotateZ$1(_, _, n.angle), e.rotateX$1(_, _, -n._pitch);\n            var d = e.fromQuat(new Float32Array(16), _),\n              p = e.mapValue(i.properties.get(\"star-intensity\"), 0, 1, 0, .25),\n              m = 5e-4,\n              f = e.mapValue(i.properties.get(\"horizon-blend\"), 0, 1, m, .25),\n              g = e.globeUseCustomAntiAliasing(t, o, n) && f === m ? n.worldSize / (2 * Math.PI * 1.025) - 1 : n.globeRadius,\n              v = t.frameCounter / 1e3 % 1,\n              x = e.length(n.globeCenterInViewSpace),\n              y = Math.sqrt(Math.pow(x, 2) - Math.pow(g, 2)),\n              b = Math.acos(y / x),\n              w = function (t, i, o, r, n, s, a, l, c, h, u, _, d, p) {\n                return {\n                  u_frustum_tl: t,\n                  u_frustum_tr: i,\n                  u_frustum_br: o,\n                  u_frustum_bl: r,\n                  u_horizon: n,\n                  u_transition: s,\n                  u_fadeout_range: a,\n                  u_color: l,\n                  u_high_color: c,\n                  u_space_color: h,\n                  u_star_intensity: u,\n                  u_star_size: 5 * e.exported.devicePixelRatio,\n                  u_star_density: 0,\n                  u_temporal_offset: _,\n                  u_horizon_angle: d,\n                  u_rotation_matrix: p\n                };\n              }(n.frustumCorners.TL, n.frustumCorners.TR, n.frustumCorners.BR, n.frustumCorners.BL, n.frustumCorners.horizon, l, f, c, h, u, p, v, b, d);\n            t.prepareDrawProgram(o, a);\n            var T = t.atmosphereBuffer;\n            T && a.draw(o, r.TRIANGLES, s, e.StencilMode.disabled, e.ColorMode.alphaBlended, e.CullFaceMode.backCW, w, \"skybox\", T.vertexBuffer, T.indexBuffer, T.segments);\n          }(this, this.style.fog), this.renderPass = \"sky\", (e.globeToMercatorTransition(this.transform.zoom) > 0 || \"globe\" !== this.transform.projection.name) && this.transform.isHorizonVisible()) for (this.currentLayer = 0; this.currentLayer < o.length; this.currentLayer++) {\n            var _e435 = this.style._layers[o[this.currentLayer]],\n              _i277 = t._getLayerSourceCache(_e435);\n            _e435.isSky() && this.renderLayer(this, _i277, _e435, _i277 ? s[_i277.id] : void 0);\n          }\n          for (this.renderPass = \"translucent\", this.currentLayer = 0; this.currentLayer < o.length;) {\n            var _e436 = this.style._layers[o[this.currentLayer]],\n              _i278 = t._getLayerSourceCache(_e436);\n            if (_e436.isSky()) {\n              ++this.currentLayer;\n              continue;\n            }\n            if (this.terrain && this.style.isLayerDraped(_e436)) {\n              if (_e436.isHidden(this.transform.zoom)) {\n                ++this.currentLayer;\n                continue;\n              }\n              this.currentLayer = this.terrain.renderBatch(this.currentLayer);\n              continue;\n            }\n            var _r292 = _i278 ? (\"symbol\" === _e436.type ? a : s)[_i278.id] : void 0;\n            this._renderTileClippingMasks(_e436, _i278, _i278 ? n[_i278.id] : void 0), this.renderLayer(this, _i278, _e436, _r292), ++this.currentLayer;\n          }\n          if (this.terrain && this.terrain.postRender(), this.options.showTileBoundaries || this.options.showQueryGeometry || this.options.showTileAABBs) {\n            var _i279 = null;\n            e.values(this.style._layers).forEach(function (e) {\n              var o = t._getLayerSourceCache(e);\n              o && !e.isHidden(_this116.transform.zoom) && (!_i279 || _i279.getSource().maxzoom < o.getSource().maxzoom) && (_i279 = o);\n            }), _i279 && this.options.showTileBoundaries && ko.debug(this, _i279, _i279.getVisibleCoordinates());\n          }\n          this.options.showPadding && function (e) {\n            var t = e.transform.padding;\n            Io(e, e.transform.height - (t.top || 0), 3, bo), Io(e, t.bottom || 0, 3, wo), So(e, t.left || 0, 3, To), So(e, e.transform.width - (t.right || 0), 3, Eo);\n            var i = e.transform.centerPoint;\n            !function (e, t, i, o) {\n              Do(e, t - 1, i - 10, 2, 20, o), Do(e, t - 10, i - 1, 20, 2, o);\n            }(e, i.x, e.transform.height - i.y, Co);\n          }(this), this.context.setDefault(), this.frameCounter = (this.frameCounter + 1) % Number.MAX_SAFE_INTEGER, this.tileLoaded && this.options.speedIndexTiming && (this.loadTimeStamps.push(e.window.performance.now()), this.saveCanvasCopy());\n        }\n      }, {\n        key: \"renderLayer\",\n        value: function renderLayer(e, t, i, o) {\n          i.isHidden(this.transform.zoom) || (\"background\" === i.type || \"sky\" === i.type || \"custom\" === i.type || o && o.length) && (this.id = i.id, this.gpuTimingStart(i), (!e.transform.projection.unsupportedLayers || !e.transform.projection.unsupportedLayers.includes(i.type) || e.terrain && \"custom\" === i.type) && ko[i.type](e, t, i, o, this.style.placement.variableOffsets, this.options.isInitialLoad), this.gpuTimingEnd());\n        }\n      }, {\n        key: \"gpuTimingStart\",\n        value: function gpuTimingStart(e) {\n          if (!this.options.gpuTiming) return;\n          var t = this.context.extTimerQuery;\n          var i = this.gpuTimers[e.id];\n          i || (i = this.gpuTimers[e.id] = {\n            calls: 0,\n            cpuTime: 0,\n            query: t.createQueryEXT()\n          }), i.calls++, t.beginQueryEXT(t.TIME_ELAPSED_EXT, i.query);\n        }\n      }, {\n        key: \"gpuTimingDeferredRenderStart\",\n        value: function gpuTimingDeferredRenderStart() {\n          if (this.options.gpuTimingDeferredRender) {\n            var _e438 = this.context.extTimerQuery,\n              _t433 = _e438.createQueryEXT();\n            this.deferredRenderGpuTimeQueries.push(_t433), _e438.beginQueryEXT(_e438.TIME_ELAPSED_EXT, _t433);\n          }\n        }\n      }, {\n        key: \"gpuTimingDeferredRenderEnd\",\n        value: function gpuTimingDeferredRenderEnd() {\n          if (!this.options.gpuTimingDeferredRender) return;\n          var e = this.context.extTimerQuery;\n          e.endQueryEXT(e.TIME_ELAPSED_EXT);\n        }\n      }, {\n        key: \"gpuTimingEnd\",\n        value: function gpuTimingEnd() {\n          if (!this.options.gpuTiming) return;\n          var e = this.context.extTimerQuery;\n          e.endQueryEXT(e.TIME_ELAPSED_EXT);\n        }\n      }, {\n        key: \"collectGpuTimers\",\n        value: function collectGpuTimers() {\n          var e = this.gpuTimers;\n          return this.gpuTimers = {}, e;\n        }\n      }, {\n        key: \"collectDeferredRenderGpuQueries\",\n        value: function collectDeferredRenderGpuQueries() {\n          var e = this.deferredRenderGpuTimeQueries;\n          return this.deferredRenderGpuTimeQueries = [], e;\n        }\n      }, {\n        key: \"queryGpuTimers\",\n        value: function queryGpuTimers(e) {\n          var t = {};\n          for (var _i281 in e) {\n            var _o154 = e[_i281],\n              _r294 = this.context.extTimerQuery,\n              _n203 = _r294.getQueryObjectEXT(_o154.query, _r294.QUERY_RESULT_EXT) / 1e6;\n            _r294.deleteQueryEXT(_o154.query), t[_i281] = _n203;\n          }\n          return t;\n        }\n      }, {\n        key: \"queryGpuTimeDeferredRender\",\n        value: function queryGpuTimeDeferredRender(e) {\n          if (!this.options.gpuTimingDeferredRender) return 0;\n          var t = this.context.extTimerQuery;\n          var i = 0;\n          var _iterator270 = _createForOfIteratorHelper(e),\n            _step270;\n          try {\n            for (_iterator270.s(); !(_step270 = _iterator270.n()).done;) {\n              var _o155 = _step270.value;\n              i += t.getQueryObjectEXT(_o155, t.QUERY_RESULT_EXT) / 1e6, t.deleteQueryEXT(_o155);\n            }\n          } catch (err) {\n            _iterator270.e(err);\n          } finally {\n            _iterator270.f();\n          }\n          return i;\n        }\n      }, {\n        key: \"translatePosMatrix\",\n        value: function translatePosMatrix(t, i, o, r, n) {\n          if (!o[0] && !o[1]) return t;\n          var s = n ? \"map\" === r ? this.transform.angle : 0 : \"viewport\" === r ? -this.transform.angle : 0;\n          if (s) {\n            var _e439 = Math.sin(s),\n              _t434 = Math.cos(s);\n            o = [o[0] * _t434 - o[1] * _e439, o[0] * _e439 + o[1] * _t434];\n          }\n          var a = [n ? o[0] : P(i, o[0], this.transform.zoom), n ? o[1] : P(i, o[1], this.transform.zoom), 0],\n            l = new Float32Array(16);\n          return e.translate(l, t, a), l;\n        }\n      }, {\n        key: \"saveTileTexture\",\n        value: function saveTileTexture(e) {\n          var t = this._tileTextures[e.size[0]];\n          t ? t.push(e) : this._tileTextures[e.size[0]] = [e];\n        }\n      }, {\n        key: \"getTileTexture\",\n        value: function getTileTexture(e) {\n          var t = this._tileTextures[e];\n          return t && t.length > 0 ? t.pop() : null;\n        }\n      }, {\n        key: \"isPatternMissing\",\n        value: function isPatternMissing(e) {\n          return null === e || void 0 !== e && !this.imageManager.getPattern(e.toString());\n        }\n      }, {\n        key: \"terrainRenderModeElevated\",\n        value: function terrainRenderModeElevated() {\n          return this.style && !!this.style.getTerrain() && !!this.terrain && !this.terrain.renderingToTexture;\n        }\n      }, {\n        key: \"currentGlobalDefines\",\n        value: function currentGlobalDefines() {\n          var e = this.terrain && this.terrain.renderingToTexture,\n            t = this.terrain && 0 === this.terrain.exaggeration(),\n            i = this.style && this.style.fog,\n            o = [];\n          return this.terrainRenderModeElevated() && o.push(\"TERRAIN\"), \"globe\" === this.transform.projection.name && o.push(\"GLOBE\"), t && o.push(\"ZERO_EXAGGERATION\"), i && !e && 0 !== i.getOpacity(this.transform.pitch) && o.push(\"FOG\"), e && o.push(\"RENDER_TO_TEXTURE\"), this._showOverdrawInspector && o.push(\"OVERDRAW_INSPECTOR\"), o;\n        }\n      }, {\n        key: \"useProgram\",\n        value: function useProgram(e, t, i) {\n          this.cache = this.cache || {};\n          var o = i || [],\n            r = this.currentGlobalDefines().concat(o),\n            n = Pi.cacheKey(ui[e], e, r, t);\n          return this.cache[n] || (this.cache[n] = new Pi(this.context, e, ui[e], t, lo[e], r)), this.cache[n];\n        }\n      }, {\n        key: \"setCustomLayerDefaults\",\n        value: function setCustomLayerDefaults() {\n          this.context.unbindVAO(), this.context.cullFace.setDefault(), this.context.frontFace.setDefault(), this.context.cullFaceSide.setDefault(), this.context.activeTexture.setDefault(), this.context.pixelStoreUnpack.setDefault(), this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(), this.context.pixelStoreUnpackFlipY.setDefault();\n        }\n      }, {\n        key: \"setBaseState\",\n        value: function setBaseState() {\n          var e = this.context.gl;\n          this.context.cullFace.set(!1), this.context.viewport.set([0, 0, this.width, this.height]), this.context.blendEquation.set(e.FUNC_ADD);\n        }\n      }, {\n        key: \"initDebugOverlayCanvas\",\n        value: function initDebugOverlayCanvas() {\n          null == this.debugOverlayCanvas && (this.debugOverlayCanvas = e.window.document.createElement(\"canvas\"), this.debugOverlayCanvas.width = 512, this.debugOverlayCanvas.height = 512, this.debugOverlayTexture = new e.Texture(this.context, this.debugOverlayCanvas, this.context.gl.RGBA));\n        }\n      }, {\n        key: \"destroy\",\n        value: function destroy() {\n          this._terrain && this._terrain.destroy(), this.globeSharedBuffers && this.globeSharedBuffers.destroy(), this.emptyTexture.destroy(), this.debugOverlayTexture && this.debugOverlayTexture.destroy(), this.atmosphereBuffer && this.atmosphereBuffer.destroy();\n        }\n      }, {\n        key: \"prepareDrawTile\",\n        value: function prepareDrawTile() {\n          this.terrain && this.terrain.prepareDrawTile();\n        }\n      }, {\n        key: \"prepareDrawProgram\",\n        value: function prepareDrawProgram(t, i, o) {\n          if (this.terrain && this.terrain.renderingToTexture) return;\n          var r = this.style.fog;\n          if (r) {\n            var _n204 = r.getOpacity(this.transform.pitch),\n              _s161 = function (t, i, o, r, n, s, a, l, c, h, u) {\n                var _ = t.transform,\n                  d = i.properties.get(\"color\").toArray01();\n                d[3] = r;\n                var p = t.frameCounter / 1e3 % 1;\n                return {\n                  u_fog_matrix: o ? _.calculateFogTileMatrix(o) : t.identityMat,\n                  u_fog_range: i.getFovAdjustedRange(_._fov),\n                  u_fog_color: d,\n                  u_fog_horizon_blend: i.properties.get(\"horizon-blend\"),\n                  u_fog_temporal_offset: p,\n                  u_frustum_tl: n,\n                  u_frustum_tr: s,\n                  u_frustum_br: a,\n                  u_frustum_bl: l,\n                  u_globe_pos: c,\n                  u_globe_radius: h,\n                  u_viewport: u,\n                  u_globe_transition: e.globeToMercatorTransition(_.zoom),\n                  u_is_globe: +(\"globe\" === _.projection.name)\n                };\n              }(this, r, o, _n204, this.transform.frustumCorners.TL, this.transform.frustumCorners.TR, this.transform.frustumCorners.BR, this.transform.frustumCorners.BL, this.transform.globeCenterInViewSpace, this.transform.globeRadius, [this.transform.width * e.exported.devicePixelRatio, this.transform.height * e.exported.devicePixelRatio]);\n            i.setFogUniformValues(t, _s161);\n          }\n        }\n      }, {\n        key: \"setTileLoadedFlag\",\n        value: function setTileLoadedFlag(e) {\n          this.tileLoaded = e;\n        }\n      }, {\n        key: \"saveCanvasCopy\",\n        value: function saveCanvasCopy() {\n          var e = this.canvasCopy();\n          e && (this.frameCopies.push(e), this.tileLoaded = !1);\n        }\n      }, {\n        key: \"canvasCopy\",\n        value: function canvasCopy() {\n          var e = this.context.gl,\n            t = e.createTexture();\n          return e.bindTexture(e.TEXTURE_2D, t), e.copyTexImage2D(e.TEXTURE_2D, 0, e.RGBA, 0, 0, e.drawingBufferWidth, e.drawingBufferHeight, 0), t;\n        }\n      }, {\n        key: \"getCanvasCopiesAndTimestamps\",\n        value: function getCanvasCopiesAndTimestamps() {\n          return {\n            canvasCopies: this.frameCopies,\n            timeStamps: this.loadTimeStamps\n          };\n        }\n      }, {\n        key: \"averageElevationNeedsEasing\",\n        value: function averageElevationNeedsEasing() {\n          if (!this.transform._elevation) return !1;\n          var e = this.style && this.style.fog;\n          return !!e && 0 !== e.getOpacity(this.transform.pitch);\n        }\n      }, {\n        key: \"getBackgroundTiles\",\n        value: function getBackgroundTiles() {\n          var t = this._backgroundTiles,\n            i = this._backgroundTiles = {},\n            o = this.transform.coveringTiles({\n              tileSize: 512\n            });\n          var _iterator271 = _createForOfIteratorHelper(o),\n            _step271;\n          try {\n            for (_iterator271.s(); !(_step271 = _iterator271.n()).done;) {\n              var _r295 = _step271.value;\n              i[_r295.key] = t[_r295.key] || new e.Tile(_r295, 512, this.transform.tileZoom, this);\n            }\n          } catch (err) {\n            _iterator271.e(err);\n          } finally {\n            _iterator271.f();\n          }\n          return i;\n        }\n      }, {\n        key: \"clearBackgroundTiles\",\n        value: function clearBackgroundTiles() {\n          this._backgroundTiles = {};\n        }\n      }, {\n        key: \"terrain\",\n        get: function get() {\n          return this.transform._terrainEnabled() && this._terrain && this._terrain.enabled ? this._terrain : null;\n        }\n      }]);\n      return Fo;\n    }();\n    var Uo = /*#__PURE__*/function () {\n      function Uo() {\n        var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n        var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n        var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        _classCallCheck(this, Uo);\n        if (isNaN(e) || e < 0 || isNaN(t) || t < 0 || isNaN(i) || i < 0 || isNaN(o) || o < 0) throw new Error(\"Invalid value for edge-insets, top, bottom, left and right must all be numbers\");\n        this.top = e, this.bottom = t, this.left = i, this.right = o;\n      }\n      _createClass(Uo, [{\n        key: \"interpolate\",\n        value: function interpolate(t, i, o) {\n          return null != i.top && null != t.top && (this.top = e.number(t.top, i.top, o)), null != i.bottom && null != t.bottom && (this.bottom = e.number(t.bottom, i.bottom, o)), null != i.left && null != t.left && (this.left = e.number(t.left, i.left, o)), null != i.right && null != t.right && (this.right = e.number(t.right, i.right, o)), this;\n        }\n      }, {\n        key: \"getCenter\",\n        value: function getCenter(t, i) {\n          var o = e.clamp((this.left + t - this.right) / 2, 0, t),\n            r = e.clamp((this.top + i - this.bottom) / 2, 0, i);\n          return new e.pointGeometry(o, r);\n        }\n      }, {\n        key: \"equals\",\n        value: function equals(e) {\n          return this.top === e.top && this.bottom === e.bottom && this.left === e.left && this.right === e.right;\n        }\n      }, {\n        key: \"clone\",\n        value: function clone() {\n          return new Uo(this.top, this.bottom, this.left, this.right);\n        }\n      }, {\n        key: \"toJSON\",\n        value: function toJSON() {\n          return {\n            top: this.top,\n            bottom: this.bottom,\n            left: this.left,\n            right: this.right\n          };\n        }\n      }]);\n      return Uo;\n    }();\n    function No(t, i) {\n      var o = e.getColumn(t, 3);\n      e.fromQuat(t, i), e.setColumn(t, 3, o);\n    }\n    function Go(t, i) {\n      var o = e.identity$1([]);\n      return e.rotateZ$1(o, o, -i), e.rotateX$1(o, o, -t), o;\n    }\n    function jo(t, i) {\n      var o = [t[0], t[1], 0],\n        r = [i[0], i[1], 0];\n      if (e.length(o) >= 1e-15) {\n        var _t435 = e.normalize([], o);\n        e.scale$2(r, _t435, e.dot(r, _t435)), i[0] = r[0], i[1] = r[1];\n      }\n      var n = e.cross([], i, t);\n      if (e.len(n) < 1e-15) return null;\n      var s = Math.atan2(-n[1], n[0]);\n      return Go(Math.atan2(Math.sqrt(t[0] * t[0] + t[1] * t[1]), -t[2]), s);\n    }\n    var Zo = /*#__PURE__*/function () {\n      function Zo(e, t) {\n        _classCallCheck(this, Zo);\n        this.position = e, this.orientation = t;\n      }\n      _createClass(Zo, [{\n        key: \"lookAtPoint\",\n        value: function lookAtPoint(t, i) {\n          if (this.orientation = null, !this.position) return;\n          var o = this.position,\n            r = this._elevation ? this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)) : 0,\n            n = e.MercatorCoordinate.fromLngLat(t, r),\n            s = [n.x - o.x, n.y - o.y, n.z - o.z];\n          i || (i = [0, 0, 1]), i[2] = Math.abs(i[2]), this.orientation = jo(s, i);\n        }\n      }, {\n        key: \"setPitchBearing\",\n        value: function setPitchBearing(t, i) {\n          this.orientation = Go(e.degToRad(t), e.degToRad(-i));\n        }\n      }, {\n        key: \"position\",\n        get: function get() {\n          return this._position;\n        },\n        set: function set(t) {\n          if (t) {\n            var _i282 = t instanceof e.MercatorCoordinate ? t : new e.MercatorCoordinate(t[0], t[1], t[2]);\n            this._renderWorldCopies && (_i282.x = e.wrap(_i282.x, 0, 1)), this._position = _i282;\n          } else this._position = null;\n        }\n      }]);\n      return Zo;\n    }();\n    var Vo = /*#__PURE__*/function () {\n      function Vo(t, i) {\n        _classCallCheck(this, Vo);\n        this._transform = e.identity([]), this.orientation = i, this.position = t;\n      }\n      _createClass(Vo, [{\n        key: \"getPitchBearing\",\n        value: function getPitchBearing() {\n          var e = this.forward(),\n            t = this.right();\n          return {\n            bearing: Math.atan2(-t[1], t[0]),\n            pitch: Math.atan2(Math.sqrt(e[0] * e[0] + e[1] * e[1]), -e[2])\n          };\n        }\n      }, {\n        key: \"setPitchBearing\",\n        value: function setPitchBearing(e, t) {\n          this._orientation = Go(e, t), No(this._transform, this._orientation);\n        }\n      }, {\n        key: \"forward\",\n        value: function forward() {\n          var t = e.getColumn(this._transform, 2);\n          return [-t[0], -t[1], -t[2]];\n        }\n      }, {\n        key: \"up\",\n        value: function up() {\n          var t = e.getColumn(this._transform, 1);\n          return [-t[0], -t[1], -t[2]];\n        }\n      }, {\n        key: \"right\",\n        value: function right() {\n          var t = e.getColumn(this._transform, 0);\n          return [t[0], t[1], t[2]];\n        }\n      }, {\n        key: \"getCameraToWorld\",\n        value: function getCameraToWorld(t, i) {\n          var o = new Float64Array(16);\n          return e.invert(o, this.getWorldToCamera(t, i)), o;\n        }\n      }, {\n        key: \"getWorldToCameraPosition\",\n        value: function getWorldToCameraPosition(t, i, o) {\n          var r = this.position;\n          e.scale$2(r, r, -t);\n          var n = new Float64Array(16);\n          return e.fromScaling(n, [o, o, o]), e.translate(n, n, r), n[10] *= i, n;\n        }\n      }, {\n        key: \"getWorldToCamera\",\n        value: function getWorldToCamera(t, i) {\n          var o = new Float64Array(16),\n            r = new Float64Array(4),\n            n = this.position;\n          return e.conjugate(r, this._orientation), e.scale$2(n, n, -t), e.fromQuat(o, r), e.translate(o, o, n), o[1] *= -1, o[5] *= -1, o[9] *= -1, o[13] *= -1, o[8] *= i, o[9] *= i, o[10] *= i, o[11] *= i, o;\n        }\n      }, {\n        key: \"getCameraToClipPerspective\",\n        value: function getCameraToClipPerspective(t, i, o, r) {\n          var n = new Float64Array(16);\n          return e.perspective(n, t, i, o, r), n;\n        }\n      }, {\n        key: \"getDistanceToElevation\",\n        value: function getDistanceToElevation(t) {\n          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n          var o = 0 === t ? 0 : e.mercatorZfromAltitude(t, i ? e.latFromMercatorY(this.position[1]) : this.position[1]),\n            r = this.forward();\n          return (o - this.position[2]) / r[2];\n        }\n      }, {\n        key: \"clone\",\n        value: function clone() {\n          return new Vo(_toConsumableArray(this.position), _toConsumableArray(this.orientation));\n        }\n      }, {\n        key: \"mercatorPosition\",\n        get: function get() {\n          var t = this.position;\n          return new e.MercatorCoordinate(t[0], t[1], t[2]);\n        }\n      }, {\n        key: \"position\",\n        get: function get() {\n          var t = e.getColumn(this._transform, 3);\n          return [t[0], t[1], t[2]];\n        },\n        set: function set(t) {\n          var i;\n          t && e.setColumn(this._transform, 3, [(i = t)[0], i[1], i[2], 1]);\n        }\n      }, {\n        key: \"orientation\",\n        get: function get() {\n          return this._orientation;\n        },\n        set: function set(t) {\n          this._orientation = t || e.identity$1([]), t && No(this._transform, this._orientation);\n        }\n      }]);\n      return Vo;\n    }();\n    function Wo(t, i) {\n      var o = qo(t.projection, t.zoom, t.width, t.height),\n        r = function (t, i, o, r, n) {\n          var s = new e.LngLat(o.lng - 180 * $o, o.lat),\n            a = new e.LngLat(o.lng + 180 * $o, o.lat),\n            l = t.project(s.lng, s.lat),\n            c = t.project(a.lng, a.lat),\n            h = -Math.atan2(c.y - l.y, c.x - l.x),\n            u = e.MercatorCoordinate.fromLngLat(o);\n          u.y = e.clamp(u.y, -.999975, .999975);\n          var _ = u.toLngLat(),\n            d = t.project(_.lng, _.lat),\n            p = e.MercatorCoordinate.fromLngLat(_);\n          p.x += $o;\n          var m = p.toLngLat(),\n            f = t.project(m.lng, m.lat),\n            g = Yo(f.x - d.x, f.y - d.y, h),\n            v = e.MercatorCoordinate.fromLngLat(_);\n          v.y += $o;\n          var x = v.toLngLat(),\n            y = t.project(x.lng, x.lat),\n            b = Yo(y.x - d.x, y.y - d.y, h),\n            w = Math.abs(g.x) / Math.abs(b.y),\n            T = e.identity([]);\n          e.rotateZ(T, T, -h * (1 - (n ? 0 : r)));\n          var E = e.identity([]);\n          return e.scale(E, E, [1, 1 - (1 - w) * r, 1]), E[4] = -b.x / b.y * r, e.rotateZ(E, E, h), e.multiply(E, T, E), E;\n        }(t.projection, 0, t.center, o, i),\n        n = Xo(t);\n      return e.scale(r, r, [n, n, 1]), r;\n    }\n    function Xo(t) {\n      var i = t.projection,\n        o = qo(t.projection, t.zoom, t.width, t.height),\n        r = Ho(i, t.center),\n        n = Ho(i, e.LngLat.convert(i.center));\n      return Math.pow(2, r * o + (1 - o) * n);\n    }\n    function qo(t, i, o, r) {\n      var n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1 / 0;\n      var s = t.range;\n      if (!s) return 0;\n      var a = Math.min(n, Math.max(o, r)),\n        l = Math.log(a / 1024) / Math.LN2;\n      return e.smoothstep(s[0] + l, s[1] + l, i);\n    }\n    var $o = 1 / 4e4;\n    function Ho(t, i) {\n      var o = e.clamp(i.lat, -e.MAX_MERCATOR_LATITUDE, e.MAX_MERCATOR_LATITUDE),\n        r = new e.LngLat(i.lng - 180 * $o, o),\n        n = new e.LngLat(i.lng + 180 * $o, o),\n        s = t.project(r.lng, o),\n        a = t.project(n.lng, o),\n        l = e.MercatorCoordinate.fromLngLat(r),\n        c = e.MercatorCoordinate.fromLngLat(n),\n        h = a.x - s.x,\n        u = a.y - s.y,\n        _ = c.x - l.x,\n        d = c.y - l.y,\n        p = Math.sqrt((_ * _ + d * d) / (h * h + u * u));\n      return Math.log(p) / Math.LN2;\n    }\n    function Yo(e, t, i) {\n      var o = Math.cos(i),\n        r = Math.sin(i);\n      return {\n        x: e * o - t * r,\n        y: e * r + t * o\n      };\n    }\n    var Ko = /*#__PURE__*/function () {\n      function Ko(t, i, o, r, n, s, a) {\n        _classCallCheck(this, Ko);\n        this.tileSize = 512, this._renderWorldCopies = void 0 === n || n, this._minZoom = t || 0, this._maxZoom = i || 22, this._minPitch = null == o ? 0 : o, this._maxPitch = null == r ? 60 : r, this.setProjection(s), this.setMaxBounds(a), this.width = 0, this.height = 0, this._center = new e.LngLat(0, 0), this.zoom = 0, this.angle = 0, this._fov = .6435011087932844, this._pitch = 0, this._nearZ = 0, this._farZ = 0, this._unmodified = !0, this._edgeInsets = new Uo(), this._projMatrixCache = {}, this._alignedProjMatrixCache = {}, this._fogTileMatrixCache = {}, this._distanceTileDataCache = {}, this._camera = new Vo(), this._centerAltitude = 0, this._averageElevation = 0, this.cameraElevationReference = \"ground\", this._pixelsPerMercatorPixel = 1, this.globeRadius = 0, this.globeCenterInViewSpace = [0, 0, 0], this._horizonShift = .1;\n      }\n      _createClass(Ko, [{\n        key: \"clone\",\n        value: function clone() {\n          var e = new Ko(this._minZoom, this._maxZoom, this._minPitch, this.maxPitch, this._renderWorldCopies, this.getProjection());\n          return e._elevation = this._elevation, e._centerAltitude = this._centerAltitude, e._centerAltitudeValidForExaggeration = this._centerAltitudeValidForExaggeration, e.tileSize = this.tileSize, e.mercatorFromTransition = this.mercatorFromTransition, e.width = this.width, e.height = this.height, e.cameraElevationReference = this.cameraElevationReference, e._center = this._center, e._setZoom(this.zoom), e._seaLevelZoom = this._seaLevelZoom, e.angle = this.angle, e._fov = this._fov, e._pitch = this._pitch, e._nearZ = this._nearZ, e._farZ = this._farZ, e._averageElevation = this._averageElevation, e._unmodified = this._unmodified, e._edgeInsets = this._edgeInsets.clone(), e._camera = this._camera.clone(), e._calcMatrices(), e.freezeTileCoverage = this.freezeTileCoverage, e.frustumCorners = this.frustumCorners, e;\n        }\n      }, {\n        key: \"updateElevation\",\n        value: function updateElevation(e) {\n          var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n          var i = this._elevation && this._elevation.exaggeration() !== this._centerAltitudeValidForExaggeration;\n          (null == this._seaLevelZoom || i) && this._updateCameraOnTerrain(), (e || i) && this._constrainCamera(t), this._calcMatrices();\n        }\n      }, {\n        key: \"getProjection\",\n        value: function getProjection() {\n          return e.pick(this.projection, [\"name\", \"center\", \"parallels\"]);\n        }\n      }, {\n        key: \"setProjection\",\n        value: function setProjection(i) {\n          this.projectionOptions = i || {\n            name: \"mercator\"\n          };\n          var o = this.projection ? this.getProjection() : void 0;\n          this.projection = e.getProjection(this.projectionOptions);\n          var r = !t(o, this.getProjection());\n          return r && this._calcMatrices(), this.mercatorFromTransition = !1, r;\n        }\n      }, {\n        key: \"setMercatorFromTransition\",\n        value: function setMercatorFromTransition() {\n          var t = this.projection.name;\n          this.mercatorFromTransition = !0, this.projectionOptions = {\n            name: \"mercator\"\n          }, this.projection = e.getProjection({\n            name: \"mercator\"\n          });\n          var i = t !== this.projection.name;\n          return i && this._calcMatrices(), i;\n        }\n      }, {\n        key: \"_setZoom\",\n        value: function _setZoom(e) {\n          this._zoom = e, this.scale = this.zoomScale(e), this.tileZoom = Math.floor(e), this.zoomFraction = e - this.tileZoom;\n        }\n      }, {\n        key: \"_updateCameraOnTerrain\",\n        value: function _updateCameraOnTerrain() {\n          if (!this._elevation || !this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center))) return this._centerAltitude = 0, this._seaLevelZoom = null, void (this._centerAltitudeValidForExaggeration = void 0);\n          var e = this._elevation;\n          this._centerAltitude = e.getAtPointOrZero(this.locationCoordinate(this.center)), this._centerAltitudeValidForExaggeration = e.exaggeration(), this._updateSeaLevelZoom();\n        }\n      }, {\n        key: \"_updateSeaLevelZoom\",\n        value: function _updateSeaLevelZoom() {\n          void 0 !== this._centerAltitudeValidForExaggeration && (this._seaLevelZoom = this._zoomFromMercatorZ((this.pixelsPerMeter * this._centerAltitude + this.cameraToCenterDistance) / this.worldSize));\n        }\n      }, {\n        key: \"sampleAverageElevation\",\n        value: function sampleAverageElevation() {\n          if (!this._elevation) return 0;\n          var t = this._elevation,\n            i = [[.5, .2], [.3, .5], [.5, .5], [.7, .5], [.5, .8]],\n            o = this.horizonLineFromTop();\n          var r = 0,\n            n = 0;\n          for (var _s162 = 0; _s162 < i.length; _s162++) {\n            var _a133 = new e.pointGeometry(i[_s162][0] * this.width, o + i[_s162][1] * (this.height - o)),\n              _l82 = t.pointCoordinate(_a133);\n            if (!_l82) continue;\n            var _c66 = 1 / Math.hypot(_l82[0] - this._camera.position[0], _l82[1] - this._camera.position[1]);\n            r += _l82[3] * _c66, n += _c66;\n          }\n          return 0 === n ? NaN : r / n;\n        }\n      }, {\n        key: \"_updateZoomFromElevation\",\n        value: function _updateZoomFromElevation() {\n          if (null == this._seaLevelZoom || !this._elevation) return;\n          var e = this._seaLevelZoom,\n            t = this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),\n            i = this.pixelsPerMeter / this.worldSize * t,\n            o = this._mercatorZfromZoom(e),\n            r = this._mercatorZfromZoom(this._maxZoom),\n            n = Math.max(o - i, r);\n          this._setZoom(this._zoomFromMercatorZ(n));\n        }\n      }, {\n        key: \"computeZoomRelativeTo\",\n        value: function computeZoomRelativeTo(t) {\n          var i = this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint, t.toAltitude()));\n          var o;\n          o = t.z < this._camera.position[2] ? [i.x, i.y, i.z] : [t.x, t.y, t.z];\n          var r = e.length(e.sub([], this._camera.position, o));\n          return e.clamp(this._zoomFromMercatorZ(r), this._minZoom, this._maxZoom);\n        }\n      }, {\n        key: \"setFreeCameraOptions\",\n        value: function setFreeCameraOptions(t) {\n          if (!this.height) return;\n          if (!t.position && !t.orientation) return;\n          this._updateCameraState();\n          var i = !1;\n          if (t.orientation && !e.exactEquals(t.orientation, this._camera.orientation) && (i = this._setCameraOrientation(t.orientation)), t.position) {\n            var _o156 = [t.position.x, t.position.y, t.position.z];\n            e.exactEquals$1(_o156, this._camera.position) || (this._setCameraPosition(_o156), i = !0);\n          }\n          i && (this._updateStateFromCamera(), this.recenterOnTerrain());\n        }\n      }, {\n        key: \"getFreeCameraOptions\",\n        value: function getFreeCameraOptions() {\n          this._updateCameraState();\n          var t = this._camera.position,\n            i = new Zo();\n          return i.position = new e.MercatorCoordinate(t[0], t[1], t[2]), i.orientation = this._camera.orientation, i._elevation = this.elevation, i._renderWorldCopies = this.renderWorldCopies, i;\n        }\n      }, {\n        key: \"_setCameraOrientation\",\n        value: function _setCameraOrientation(t) {\n          if (!e.length$1(t)) return !1;\n          e.normalize$1(t, t);\n          var i = e.transformQuat([], [0, 0, -1], t),\n            o = e.transformQuat([], [0, -1, 0], t);\n          if (o[2] < 0) return !1;\n          var r = jo(i, o);\n          return !!r && (this._camera.orientation = r, !0);\n        }\n      }, {\n        key: \"_setCameraPosition\",\n        value: function _setCameraPosition(t) {\n          var i = this.zoomScale(this.minZoom) * this.tileSize,\n            o = this.zoomScale(this.maxZoom) * this.tileSize,\n            r = this.cameraToCenterDistance;\n          t[2] = e.clamp(t[2], r / o, r / i), this._camera.position = t;\n        }\n      }, {\n        key: \"isPaddingEqual\",\n        value: function isPaddingEqual(e) {\n          return this._edgeInsets.equals(e);\n        }\n      }, {\n        key: \"interpolatePadding\",\n        value: function interpolatePadding(e, t, i) {\n          this._unmodified = !1, this._edgeInsets.interpolate(e, t, i), this._constrain(), this._calcMatrices();\n        }\n      }, {\n        key: \"coveringZoomLevel\",\n        value: function coveringZoomLevel(e) {\n          var t = (e.roundZoom ? Math.round : Math.floor)(this.zoom + this.scaleZoom(this.tileSize / e.tileSize));\n          return Math.max(0, t);\n        }\n      }, {\n        key: \"getVisibleUnwrappedCoordinates\",\n        value: function getVisibleUnwrappedCoordinates(t) {\n          var i = [new e.UnwrappedTileID(0, t)];\n          if (this.renderWorldCopies) {\n            var _o157 = this.pointCoordinate(new e.pointGeometry(0, 0)),\n              _r296 = this.pointCoordinate(new e.pointGeometry(this.width, 0)),\n              _n205 = this.pointCoordinate(new e.pointGeometry(this.width, this.height)),\n              _s163 = this.pointCoordinate(new e.pointGeometry(0, this.height)),\n              _a134 = Math.floor(Math.min(_o157.x, _r296.x, _n205.x, _s163.x)),\n              _l83 = Math.floor(Math.max(_o157.x, _r296.x, _n205.x, _s163.x)),\n              _c67 = 1;\n            for (var _o158 = _a134 - _c67; _o158 <= _l83 + _c67; _o158++) 0 !== _o158 && i.push(new e.UnwrappedTileID(_o158, t));\n          }\n          return i;\n        }\n      }, {\n        key: \"coveringTiles\",\n        value: function coveringTiles(t) {\n          var _this117 = this;\n          var i = this.coveringZoomLevel(t);\n          var o = i,\n            r = this.elevation && !t.isTerrainDEM,\n            n = \"mercator\" === this.projection.name;\n          if (void 0 !== t.minzoom && i < t.minzoom) return [];\n          void 0 !== t.maxzoom && i > t.maxzoom && (i = t.maxzoom);\n          var s = this.locationCoordinate(this.center),\n            a = this.center.lat,\n            l = 1 << i,\n            c = [l * s.x, l * s.y, 0],\n            h = \"globe\" === this.projection.name,\n            u = !h,\n            _ = e.Frustum.fromInvProjectionMatrix(this.invProjMatrix, this.worldSize, i, u),\n            d = h ? this._camera.mercatorPosition : this.pointCoordinate(this.getCameraPoint()),\n            p = l * e.mercatorZfromAltitude(1, this.center.lat),\n            m = this._camera.position[2] / e.mercatorZfromAltitude(1, this.center.lat),\n            f = [l * d.x, l * d.y, m * (u ? 1 : p)],\n            g = this.cameraToCenterDistance / t.tileSize * (t.roundZoom ? 1 : .502),\n            v = this.pitch <= 60 && this._edgeInsets.top <= this._edgeInsets.bottom && !this._elevation && !this.projection.isReprojectedInTileSpace ? i : 0,\n            x = t.isTerrainDEM && this._elevation ? 1e4 * this._elevation.exaggeration() : this._centerAltitude,\n            y = t.isTerrainDEM ? -x : this._elevation ? this._elevation.getMinElevationBelowMSL() : 0,\n            b = this.projection.isReprojectedInTileSpace ? Xo(this) : 1,\n            w = function w(t) {\n              var i = 1 / 4e4,\n                o = new e.MercatorCoordinate(t.x + i, t.y, t.z),\n                r = new e.MercatorCoordinate(t.x, t.y + i, t.z),\n                n = t.toLngLat(),\n                s = o.toLngLat(),\n                a = r.toLngLat(),\n                l = _this117.locationCoordinate(n),\n                c = _this117.locationCoordinate(s),\n                h = _this117.locationCoordinate(a),\n                u = Math.hypot(c.x - l.x, c.y - l.y),\n                _ = Math.hypot(h.x - l.x, h.y - l.y);\n              return Math.sqrt(u * _) * b / i;\n            },\n            T = function T(t) {\n              var i = x,\n                o = y;\n              return {\n                aabb: e.tileAABB(_this117, l, 0, 0, 0, t, o, i, _this117.projection),\n                zoom: 0,\n                x: 0,\n                y: 0,\n                minZ: o,\n                maxZ: i,\n                wrap: t,\n                fullyVisible: !1\n              };\n            },\n            E = [];\n          var C = [];\n          var M = i,\n            I = t.reparseOverscaled ? o : i,\n            S = function S(e) {\n              return e * e;\n            },\n            D = S((m - this._centerAltitude) * p),\n            L = function L(e) {\n              if (!_this117._elevation || !e.tileID || !n) return;\n              var t = _this117._elevation.getMinMaxForTile(e.tileID),\n                i = e.aabb;\n              t ? (i.min[2] = t.min, i.max[2] = t.max, i.center[2] = (i.min[2] + i.max[2]) / 2) : (e.shouldSplit = A(e), e.shouldSplit || (i.min[2] = i.max[2] = i.center[2] = _this117._centerAltitude));\n            },\n            A = function A(t) {\n              if (t.zoom < v) return !0;\n              if (t.zoom === M) return !1;\n              if (null != t.shouldSplit) return t.shouldSplit;\n              var i = t.aabb.distanceX(f),\n                n = t.aabb.distanceY(f);\n              var s = D,\n                l = 1;\n              if (h) {\n                s = S(t.aabb.distanceZ(f));\n                var _i283 = Math.pow(2, t.zoom),\n                  _o159 = e.latFromMercatorY((t.y + 1) / _i283),\n                  _r297 = e.latFromMercatorY(t.y / _i283),\n                  _n206 = Math.min(Math.max(a, _o159), _r297),\n                  _c68 = e.circumferenceAtLatitude(_n206) / e.circumferenceAtLatitude(a);\n                if (l = _n206 === a ? 1 / Math.max(1, _this117._mercatorScaleRatio - .3) : Math.min(1, _c68 / _this117._mercatorScaleRatio), _this117.zoom <= e.GLOBE_ZOOM_THRESHOLD_MIN && t.zoom === M - 1 && _c68 >= .9) return !0;\n              } else if (r && (s = S(t.aabb.distanceZ(f) * p)), _this117.projection.isReprojectedInTileSpace && o <= 5) {\n                var _i284 = Math.pow(2, t.zoom),\n                  _o160 = w(new e.MercatorCoordinate((t.x + .5) / _i284, (t.y + .5) / _i284));\n                l = _o160 > .85 ? 1 : _o160;\n              }\n              var c = i * i + n * n + s,\n                u = S((1 << M - t.zoom) * g * l * function (e, t) {\n                  if (t * S(.707) < e) return 1;\n                  var i = Math.sqrt(t / e);\n                  return i / (1.4144271570014144 + (Math.pow(1.1, i - 1.4144271570014144 + 1) - 1) / (1.1 - 1) - 1);\n                }(Math.max(s, D), c));\n              return c < u;\n            };\n          if (this.renderWorldCopies) for (var _e440 = 1; _e440 <= 3; _e440++) E.push(T(-_e440)), E.push(T(_e440));\n          for (E.push(T(0)); E.length > 0;) {\n            var _o161 = E.pop(),\n              _s164 = _o161.x,\n              _a135 = _o161.y;\n            var _u66 = _o161.fullyVisible;\n            if (!_u66) {\n              var _e441 = _o161.aabb.intersects(_);\n              if (0 === _e441) continue;\n              _u66 = 2 === _e441;\n            }\n            if (_o161.zoom !== M && A(_o161)) for (var _t436 = 0; _t436 < 4; _t436++) {\n              var _i285 = (_s164 << 1) + _t436 % 2,\n                _c69 = (_a135 << 1) + (_t436 >> 1),\n                _24 = {\n                  aabb: n ? _o161.aabb.quadrant(_t436) : e.tileAABB(this, l, _o161.zoom + 1, _i285, _c69, _o161.wrap, _o161.minZ, _o161.maxZ, this.projection),\n                  zoom: _o161.zoom + 1,\n                  x: _i285,\n                  y: _c69,\n                  wrap: _o161.wrap,\n                  fullyVisible: _u66,\n                  tileID: void 0,\n                  shouldSplit: void 0,\n                  minZ: _o161.minZ,\n                  maxZ: _o161.maxZ\n                };\n              r && !h && (_24.tileID = new e.OverscaledTileID(_o161.zoom + 1 === M ? I : _o161.zoom + 1, _o161.wrap, _o161.zoom + 1, _i285, _c69), L(_24)), E.push(_24);\n            } else {\n              var _r298 = _o161.zoom === M ? I : _o161.zoom;\n              if (t.minzoom && t.minzoom > _r298) continue;\n              var _n207 = c[0] - (.5 + _s164 + (_o161.wrap << _o161.zoom)) * (1 << i - _o161.zoom),\n                _l84 = c[1] - .5 - _a135,\n                _h49 = _o161.tileID ? _o161.tileID : new e.OverscaledTileID(_r298, _o161.wrap, _o161.zoom, _s164, _a135);\n              C.push({\n                tileID: _h49,\n                distanceSq: _n207 * _n207 + _l84 * _l84\n              });\n            }\n          }\n          if (this.fogCullDistSq) {\n            var _i286 = this.fogCullDistSq,\n              _o162 = this.horizonLineFromTop();\n            C = C.filter(function (r) {\n              var n = [0, 0, 0, 1],\n                s = [e.EXTENT, e.EXTENT, 0, 1],\n                a = _this117.calculateFogTileMatrix(r.tileID.toUnwrapped());\n              e.transformMat4$1(n, n, a), e.transformMat4$1(s, s, a);\n              var l = e.getAABBPointSquareDist(n, s);\n              if (0 === l) return !0;\n              var c = !1;\n              var h = _this117._elevation;\n              if (h && l > _i286 && 0 !== _o162) {\n                var _i287 = _this117.calculateProjMatrix(r.tileID.toUnwrapped());\n                var _n208;\n                t.isTerrainDEM || (_n208 = h.getMinMaxForTile(r.tileID)), _n208 || (_n208 = {\n                  min: y,\n                  max: x\n                });\n                var _s165 = e.furthestTileCorner(_this117.rotation),\n                  _a136 = [_s165[0] * e.EXTENT, _s165[1] * e.EXTENT, _n208.max];\n                e.transformMat4(_a136, _a136, _i287), c = (1 - _a136[1]) * _this117.height * .5 < _o162;\n              }\n              return l < _i286 || c;\n            });\n          }\n          return C.sort(function (e, t) {\n            return e.distanceSq - t.distanceSq;\n          }).map(function (e) {\n            return e.tileID;\n          });\n        }\n      }, {\n        key: \"resize\",\n        value: function resize(e, t) {\n          this.width = e, this.height = t, this.pixelsToGLUnits = [2 / e, -2 / t], this._constrain(), this._calcMatrices();\n        }\n      }, {\n        key: \"zoomScale\",\n        value: function zoomScale(e) {\n          return Math.pow(2, e);\n        }\n      }, {\n        key: \"scaleZoom\",\n        value: function scaleZoom(e) {\n          return Math.log(e) / Math.LN2;\n        }\n      }, {\n        key: \"project\",\n        value: function project(t) {\n          var i = e.clamp(t.lat, -e.MAX_MERCATOR_LATITUDE, e.MAX_MERCATOR_LATITUDE),\n            o = this.projection.project(t.lng, i);\n          return new e.pointGeometry(o.x * this.worldSize, o.y * this.worldSize);\n        }\n      }, {\n        key: \"unproject\",\n        value: function unproject(e) {\n          return this.projection.unproject(e.x / this.worldSize, e.y / this.worldSize);\n        }\n      }, {\n        key: \"setLocationAtPoint\",\n        value: function setLocationAtPoint(t, i) {\n          var o, r;\n          var n = this.centerPoint;\n          if (\"globe\" === this.projection.name) {\n            var _e442 = this.worldSize;\n            o = (i.x - n.x) / _e442, r = (i.y - n.y) / _e442;\n          } else {\n            var _e443 = this.pointCoordinate(i),\n              _t437 = this.pointCoordinate(n);\n            o = _e443.x - _t437.x, r = _e443.y - _t437.y;\n          }\n          var s = this.locationCoordinate(t);\n          this.setLocation(new e.MercatorCoordinate(s.x - o, s.y - r));\n        }\n      }, {\n        key: \"setLocation\",\n        value: function setLocation(e) {\n          this.center = this.coordinateLocation(e), this.projection.wrap && (this.center = this.center.wrap());\n        }\n      }, {\n        key: \"locationPoint\",\n        value: function locationPoint(e) {\n          return this.projection.locationPoint(this, e);\n        }\n      }, {\n        key: \"locationPoint3D\",\n        value: function locationPoint3D(e) {\n          return this.projection.locationPoint(this, e, !0);\n        }\n      }, {\n        key: \"pointLocation\",\n        value: function pointLocation(e) {\n          return this.coordinateLocation(this.pointCoordinate(e));\n        }\n      }, {\n        key: \"pointLocation3D\",\n        value: function pointLocation3D(e) {\n          return this.coordinateLocation(this.pointCoordinate3D(e));\n        }\n      }, {\n        key: \"locationCoordinate\",\n        value: function locationCoordinate(t, i) {\n          var o = i ? e.mercatorZfromAltitude(i, t.lat) : void 0,\n            r = this.projection.project(t.lng, t.lat);\n          return new e.MercatorCoordinate(r.x, r.y, o);\n        }\n      }, {\n        key: \"coordinateLocation\",\n        value: function coordinateLocation(e) {\n          return this.projection.unproject(e.x, e.y);\n        }\n      }, {\n        key: \"pointRayIntersection\",\n        value: function pointRayIntersection(t, i) {\n          var o = null != i ? i : this._centerAltitude,\n            r = [t.x, t.y, 0, 1],\n            n = [t.x, t.y, 1, 1];\n          e.transformMat4$1(r, r, this.pixelMatrixInverse), e.transformMat4$1(n, n, this.pixelMatrixInverse);\n          var s = n[3];\n          e.scale$1(r, r, 1 / r[3]), e.scale$1(n, n, 1 / s);\n          var a = r[2],\n            l = n[2];\n          return {\n            p0: r,\n            p1: n,\n            t: a === l ? 0 : (o - a) / (l - a)\n          };\n        }\n      }, {\n        key: \"screenPointToMercatorRay\",\n        value: function screenPointToMercatorRay(t) {\n          var i = [t.x, t.y, 0, 1],\n            o = [t.x, t.y, 1, 1];\n          return e.transformMat4$1(i, i, this.pixelMatrixInverse), e.transformMat4$1(o, o, this.pixelMatrixInverse), e.scale$1(i, i, 1 / i[3]), e.scale$1(o, o, 1 / o[3]), i[2] = e.mercatorZfromAltitude(i[2], this._center.lat) * this.worldSize, o[2] = e.mercatorZfromAltitude(o[2], this._center.lat) * this.worldSize, e.scale$1(i, i, 1 / this.worldSize), e.scale$1(o, o, 1 / this.worldSize), new e.Ray([i[0], i[1], i[2]], e.normalize([], e.sub([], o, i)));\n        }\n      }, {\n        key: \"rayIntersectionCoordinate\",\n        value: function rayIntersectionCoordinate(t) {\n          var i = t.p0,\n            o = t.p1,\n            r = t.t,\n            n = e.mercatorZfromAltitude(i[2], this._center.lat),\n            s = e.mercatorZfromAltitude(o[2], this._center.lat);\n          return new e.MercatorCoordinate(e.number(i[0], o[0], r) / this.worldSize, e.number(i[1], o[1], r) / this.worldSize, e.number(n, s, r));\n        }\n      }, {\n        key: \"pointCoordinate\",\n        value: function pointCoordinate(e) {\n          var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._centerAltitude;\n          return this.projection.pointCoordinate(this, e.x, e.y, t);\n        }\n      }, {\n        key: \"pointCoordinate3D\",\n        value: function pointCoordinate3D(t) {\n          if (!this.elevation) return this.pointCoordinate(t);\n          var i = this.projection.pointCoordinate3D(this, t.x, t.y);\n          if (i) return new e.MercatorCoordinate(i[0], i[1], i[2]);\n          var o = 0,\n            r = this.horizonLineFromTop();\n          if (t.y > r) return this.pointCoordinate(t);\n          var n = .02 * r,\n            s = t.clone();\n          for (var _t438 = 0; _t438 < 10 && r - o > n; _t438++) {\n            s.y = e.number(o, r, .66);\n            var _t439 = this.projection.pointCoordinate3D(this, s.x, s.y);\n            _t439 ? (r = s.y, i = _t439) : o = s.y;\n          }\n          return i ? new e.MercatorCoordinate(i[0], i[1], i[2]) : this.pointCoordinate(t);\n        }\n      }, {\n        key: \"isPointAboveHorizon\",\n        value: function isPointAboveHorizon(e) {\n          return this.projection.isPointAboveHorizon(this, e);\n        }\n      }, {\n        key: \"_coordinatePoint\",\n        value: function _coordinatePoint(t, i) {\n          var o = i && this.elevation ? this.elevation.getAtPointOrZero(t, this._centerAltitude) : this._centerAltitude,\n            r = [t.x * this.worldSize, t.y * this.worldSize, o + t.toAltitude(), 1];\n          return e.transformMat4$1(r, r, this.pixelMatrix), r[3] > 0 ? new e.pointGeometry(r[0] / r[3], r[1] / r[3]) : new e.pointGeometry(Number.MAX_VALUE, Number.MAX_VALUE);\n        }\n      }, {\n        key: \"_getBoundsNonRectangular\",\n        value: function _getBoundsNonRectangular() {\n          var _this118 = this;\n          var _this$_edgeInsets = this._edgeInsets,\n            t = _this$_edgeInsets.top,\n            i = _this$_edgeInsets.left,\n            o = this.height - this._edgeInsets.bottom,\n            r = this.width - this._edgeInsets.right,\n            n = this.pointLocation3D(new e.pointGeometry(i, t)),\n            s = this.pointLocation3D(new e.pointGeometry(r, t)),\n            a = this.pointLocation3D(new e.pointGeometry(r, o)),\n            l = this.pointLocation3D(new e.pointGeometry(i, o));\n          var c = Math.min(n.lng, s.lng, a.lng, l.lng),\n            h = Math.max(n.lng, s.lng, a.lng, l.lng),\n            u = Math.min(n.lat, s.lat, a.lat, l.lat),\n            _ = Math.max(n.lat, s.lat, a.lat, l.lat);\n          var d = Math.pow(2, -this.zoom) / 16 * 270,\n            p = \"globe\" === this.projection.name ? 1 : 4,\n            m = function m(t, i, o, r, n) {\n              var s = (t + o) / 2,\n                a = (i + r) / 2,\n                l = new e.pointGeometry(s, a),\n                _this118$pointLocatio = _this118.pointLocation3D(l),\n                f = _this118$pointLocatio.lng,\n                g = _this118$pointLocatio.lat,\n                v = Math.max(0, c - f, u - g, f - h, g - _);\n              c = Math.min(c, f), h = Math.max(h, f), u = Math.min(u, g), _ = Math.max(_, g), (n < p || v > d) && (m(t, i, s, a, n + 1), m(s, a, o, r, n + 1));\n            };\n          if (m(i, t, r, t, 1), m(r, t, r, o, 1), m(r, o, i, o, 1), m(i, o, i, t, 1), \"globe\" === this.projection.name) {\n            var _e$polesInViewport = e.polesInViewport(this),\n              _e$polesInViewport2 = _slicedToArray(_e$polesInViewport, 2),\n              _t440 = _e$polesInViewport2[0],\n              _i288 = _e$polesInViewport2[1];\n            _t440 ? (_ = 90, h = 180, c = -180) : _i288 && (u = -90, h = 180, c = -180);\n          }\n          return new e.LngLatBounds(new e.LngLat(c, u), new e.LngLat(h, _));\n        }\n      }, {\n        key: \"_getBoundsRectangular\",\n        value: function _getBoundsRectangular(t, i) {\n          var _this$_edgeInsets2 = this._edgeInsets,\n            o = _this$_edgeInsets2.top,\n            r = _this$_edgeInsets2.left,\n            n = this.height - this._edgeInsets.bottom,\n            s = this.width - this._edgeInsets.right,\n            a = new e.pointGeometry(r, o),\n            l = new e.pointGeometry(s, o),\n            c = new e.pointGeometry(s, n),\n            h = new e.pointGeometry(r, n);\n          var u = this.pointCoordinate(a, t),\n            _ = this.pointCoordinate(l, t);\n          var d = this.pointCoordinate(c, i),\n            p = this.pointCoordinate(h, i),\n            m = function m(e, t) {\n              return (t.y - e.y) / (t.x - e.x);\n            };\n          return u.y > 1 && _.y >= 0 ? u = new e.MercatorCoordinate((1 - p.y) / m(p, u) + p.x, 1) : u.y < 0 && _.y <= 1 && (u = new e.MercatorCoordinate(-p.y / m(p, u) + p.x, 0)), _.y > 1 && u.y >= 0 ? _ = new e.MercatorCoordinate((1 - d.y) / m(d, _) + d.x, 1) : _.y < 0 && u.y <= 1 && (_ = new e.MercatorCoordinate(-d.y / m(d, _) + d.x, 0)), new e.LngLatBounds().extend(this.coordinateLocation(u)).extend(this.coordinateLocation(_)).extend(this.coordinateLocation(p)).extend(this.coordinateLocation(d));\n        }\n      }, {\n        key: \"_getBoundsRectangularTerrain\",\n        value: function _getBoundsRectangularTerrain() {\n          var e = this.elevation;\n          if (!e.visibleDemTiles.length || e.isUsingMockSource()) return this._getBoundsRectangular(0, 0);\n          var t = e.visibleDemTiles.reduce(function (e, t) {\n            if (t.dem) {\n              var _i289 = t.dem.tree;\n              e.min = Math.min(e.min, _i289.minimums[0]), e.max = Math.max(e.max, _i289.maximums[0]);\n            }\n            return e;\n          }, {\n            min: Number.MAX_VALUE,\n            max: 0\n          });\n          return this._getBoundsRectangular(t.min * e.exaggeration(), t.max * e.exaggeration());\n        }\n      }, {\n        key: \"getBounds\",\n        value: function getBounds() {\n          return \"mercator\" === this.projection.name || \"equirectangular\" === this.projection.name ? this._terrainEnabled() ? this._getBoundsRectangularTerrain() : this._getBoundsRectangular(0, 0) : this._getBoundsNonRectangular();\n        }\n      }, {\n        key: \"horizonLineFromTop\",\n        value: function horizonLineFromTop() {\n          var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n          var t = this.height / 2 / Math.tan(this._fov / 2) / Math.tan(Math.max(this._pitch, .1)) + this.centerOffset.y,\n            i = this.height / 2 - t * (1 - this._horizonShift);\n          return e ? Math.max(0, i) : i;\n        }\n      }, {\n        key: \"getMaxBounds\",\n        value: function getMaxBounds() {\n          return this.maxBounds;\n        }\n      }, {\n        key: \"setMaxBounds\",\n        value: function setMaxBounds(t) {\n          this.maxBounds = t, this.minLat = -e.MAX_MERCATOR_LATITUDE, this.maxLat = e.MAX_MERCATOR_LATITUDE, this.minLng = -180, this.maxLng = 180, t && (this.minLat = t.getSouth(), this.maxLat = t.getNorth(), this.minLng = t.getWest(), this.maxLng = t.getEast(), this.maxLng < this.minLng && (this.maxLng += 360)), this.worldMinX = e.mercatorXfromLng(this.minLng) * this.tileSize, this.worldMaxX = e.mercatorXfromLng(this.maxLng) * this.tileSize, this.worldMinY = e.mercatorYfromLat(this.maxLat) * this.tileSize, this.worldMaxY = e.mercatorYfromLat(this.minLat) * this.tileSize, this._constrain();\n        }\n      }, {\n        key: \"calculatePosMatrix\",\n        value: function calculatePosMatrix(e, t) {\n          return this.projection.createTileMatrix(this, t, e);\n        }\n      }, {\n        key: \"calculateDistanceTileData\",\n        value: function calculateDistanceTileData(t) {\n          var i = t.key,\n            o = this._distanceTileDataCache;\n          if (o[i]) return o[i];\n          var r = t.canonical,\n            n = 1 / this.height,\n            s = this.cameraWorldSize,\n            a = s / this.zoomScale(r.z),\n            l = (r.x + Math.pow(2, r.z) * t.wrap) * a,\n            c = r.y * a,\n            h = this.point;\n          h.x *= s / this.worldSize, h.y *= s / this.worldSize;\n          var u = this.angle,\n            _ = Math.sin(-u),\n            d = -Math.cos(-u);\n          return o[i] = {\n            bearing: [_, d],\n            center: [(h.x - l) * n, (h.y - c) * n],\n            scale: a / e.EXTENT * n\n          }, o[i];\n        }\n      }, {\n        key: \"calculateFogTileMatrix\",\n        value: function calculateFogTileMatrix(t) {\n          var i = t.key,\n            o = this._fogTileMatrixCache;\n          if (o[i]) return o[i];\n          var r = this.projection.createTileMatrix(this, this.cameraWorldSizeForFog, t);\n          return e.multiply(r, this.worldToFogMatrix, r), o[i] = new Float32Array(r), o[i];\n        }\n      }, {\n        key: \"calculateProjMatrix\",\n        value: function calculateProjMatrix(t) {\n          var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n          var o = t.key,\n            r = i ? this._alignedProjMatrixCache : this._projMatrixCache;\n          if (r[o]) return r[o];\n          var n = this.calculatePosMatrix(t, this.worldSize);\n          return e.multiply(n, this.projection.isReprojectedInTileSpace ? this.mercatorMatrix : i ? this.alignedProjMatrix : this.projMatrix, n), r[o] = new Float32Array(n), r[o];\n        }\n      }, {\n        key: \"calculatePixelsToTileUnitsMatrix\",\n        value: function calculatePixelsToTileUnitsMatrix(t) {\n          var i = t.tileID.key,\n            o = this._pixelsToTileUnitsCache;\n          if (o[i]) return o[i];\n          var r = function (t, i) {\n            var o = t.tileTransform.scale,\n              r = o * e.EXTENT / (t.tileSize * Math.pow(2, i.zoom - t.tileID.overscaledZ + t.tileID.canonical.z));\n            return n = new Float32Array(4), l = (s = i.inverseAdjustmentMatrix)[1], c = s[2], h = s[3], _ = (a = [r, r])[1], n[0] = s[0] * (u = a[0]), n[1] = l * u, n[2] = c * _, n[3] = h * _, n;\n            var n, s, a, l, c, h, u, _;\n          }(t, this);\n          return o[i] = r, o[i];\n        }\n      }, {\n        key: \"customLayerMatrix\",\n        value: function customLayerMatrix() {\n          return this.mercatorMatrix.slice();\n        }\n      }, {\n        key: \"globeToMercatorMatrix\",\n        value: function globeToMercatorMatrix() {\n          if (\"globe\" === this.projection.name) {\n            var _t441 = 1 / this.worldSize,\n              _i290 = e.fromScaling([], [_t441, _t441, _t441]);\n            return e.multiply(_i290, _i290, this.globeMatrix), _i290;\n          }\n        }\n      }, {\n        key: \"recenterOnTerrain\",\n        value: function recenterOnTerrain() {\n          if (!this._elevation || \"globe\" === this.projection.name) return;\n          var t = this._elevation;\n          this._updateCameraState();\n          var i = e.mercatorZfromAltitude(1, this._center.lat) * this.worldSize,\n            o = this._computeCameraPosition(i),\n            r = this._camera.forward(),\n            n = e.mercatorZfromAltitude(1, this._center.lat);\n          o[2] /= n, r[2] /= n, e.normalize(r, r);\n          var s = t.raycast(o, r, t.exaggeration());\n          if (s) {\n            var _t442 = e.scaleAndAdd([], o, r, s),\n              _i291 = new e.MercatorCoordinate(_t442[0], _t442[1], e.mercatorZfromAltitude(_t442[2], e.latFromMercatorY(_t442[1]))),\n              _a137 = (_i291.z + e.length([_i291.x - o[0], _i291.y - o[1], _i291.z - o[2] * n])) * this._pixelsPerMercatorPixel;\n            this._seaLevelZoom = this._zoomFromMercatorZ(_a137), this._centerAltitude = _i291.toAltitude(), this._center = this.coordinateLocation(_i291), this._updateZoomFromElevation(), this._constrain(), this._calcMatrices();\n          }\n        }\n      }, {\n        key: \"_constrainCamera\",\n        value: function _constrainCamera() {\n          var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !1;\n          if (!this._elevation) return;\n          var i = this._elevation,\n            o = e.mercatorZfromAltitude(1, this._center.lat) * this.worldSize,\n            r = this._computeCameraPosition(o),\n            n = i.getAtPointOrZero(_construct(e.MercatorCoordinate, _toConsumableArray(r))),\n            s = this.pixelsPerMeter / this.worldSize * n,\n            a = this._minimumHeightOverTerrain(),\n            l = r[2] - s;\n          if (l <= a) if (l < 0 || t) {\n            var _t443 = this.locationCoordinate(this._center, this._centerAltitude),\n              _i292 = [r[0], r[1], _t443.z - r[2]],\n              _o163 = e.length(_i292);\n            _i292[2] -= (a - l) / this._pixelsPerMercatorPixel;\n            var _n209 = e.length(_i292);\n            if (0 === _n209) return;\n            e.scale$2(_i292, _i292, _o163 / _n209 * this._pixelsPerMercatorPixel), this._camera.position = [r[0], r[1], _t443.z * this._pixelsPerMercatorPixel - _i292[2]], this._updateStateFromCamera();\n          } else this._isCameraConstrained = !0;\n        }\n      }, {\n        key: \"_constrain\",\n        value: function _constrain() {\n          if (!this.center || !this.width || !this.height || this._constraining) return;\n          this._constraining = !0;\n          var t = \"globe\" === this.projection.name || this.mercatorFromTransition;\n          if (this.projection.isReprojectedInTileSpace || t) {\n            var _i293 = this.center;\n            return _i293.lat = e.clamp(_i293.lat, this.minLat, this.maxLat), (this.maxBounds || !this.renderWorldCopies && !t) && (_i293.lng = e.clamp(_i293.lng, this.minLng, this.maxLng)), this.center = _i293, void (this._constraining = !1);\n          }\n          var i = this._unmodified,\n            _this$point = this.point,\n            o = _this$point.x,\n            r = _this$point.y;\n          var n = 0,\n            s = o,\n            a = r;\n          var l = this.width / 2,\n            c = this.height / 2,\n            h = this.worldMinY * this.scale,\n            u = this.worldMaxY * this.scale;\n          if (r - c < h && (a = h + c), r + c > u && (a = u - c), u - h < this.height && (n = Math.max(n, this.height / (u - h)), a = (u + h) / 2), this.maxBounds || !this._renderWorldCopies || !this.projection.wrap) {\n            var _e444 = this.worldMinX * this.scale,\n              _t444 = this.worldMaxX * this.scale,\n              _i294 = this.worldSize / 2 - (_e444 + _t444) / 2;\n            s = (o + _i294 + this.worldSize) % this.worldSize - _i294, s - l < _e444 && (s = _e444 + l), s + l > _t444 && (s = _t444 - l), _t444 - _e444 < this.width && (n = Math.max(n, this.width / (_t444 - _e444)), s = (_t444 + _e444) / 2);\n          }\n          s === o && a === r || (this.center = this.unproject(new e.pointGeometry(s, a))), n && (this.zoom += this.scaleZoom(n)), this._constrainCamera(), this._unmodified = i, this._constraining = !1;\n        }\n      }, {\n        key: \"_minZoomForBounds\",\n        value: function _minZoomForBounds() {\n          var e = Math.max(0, this.scaleZoom(this.height / (this.worldMaxY - this.worldMinY)));\n          return this.maxBounds && (e = Math.max(e, this.scaleZoom(this.width / (this.worldMaxX - this.worldMinX)))), e;\n        }\n      }, {\n        key: \"_maxCameraBoundsDistance\",\n        value: function _maxCameraBoundsDistance() {\n          return this._mercatorZfromZoom(this._minZoomForBounds());\n        }\n      }, {\n        key: \"_calcMatrices\",\n        value: function _calcMatrices() {\n          if (!this.height) return;\n          var t = this.centerOffset,\n            i = this.pixelsPerMeter;\n          \"globe\" === this.projection.name && (this._mercatorScaleRatio = e.mercatorZfromAltitude(1, this.center.lat) / e.mercatorZfromAltitude(1, e.GLOBE_SCALE_MATCH_LATITUDE));\n          var o = qo(this.projection, this.zoom, this.width, this.height, 1024);\n          this._pixelsPerMercatorPixel = this.projection.pixelSpaceConversion(this.center.lat, this.worldSize, o), this.cameraToCenterDistance = .5 / Math.tan(.5 * this._fov) * this.height * this._pixelsPerMercatorPixel, this._updateCameraState(), this._farZ = this.projection.farthestPixelDistance(this), this._nearZ = this.height / 50;\n          var r = \"meters\" === this.projection.zAxisUnit ? i : 1,\n            n = this._camera.getWorldToCamera(this.worldSize, r),\n            s = this._camera.getCameraToClipPerspective(this._fov, this.width / this.height, this._nearZ, this._farZ);\n          s[8] = 2 * -t.x / this.width, s[9] = 2 * t.y / this.height;\n          var a = e.mul([], s, n);\n          if (this.projection.isReprojectedInTileSpace) {\n            var _t445 = this.locationCoordinate(this.center),\n              _i295 = e.identity([]);\n            e.translate(_i295, _i295, [_t445.x * this.worldSize, _t445.y * this.worldSize, 0]), e.multiply(_i295, _i295, Wo(this)), e.translate(_i295, _i295, [-_t445.x * this.worldSize, -_t445.y * this.worldSize, 0]), e.multiply(a, a, _i295), this.inverseAdjustmentMatrix = function (e) {\n              var t = Wo(e, !0);\n              return v([], [t[0], t[1], t[4], t[5]]);\n            }(this);\n          } else this.inverseAdjustmentMatrix = [1, 0, 0, 1];\n          this.mercatorMatrix = e.scale([], a, [this.worldSize, this.worldSize, this.worldSize / r, 1]), this.projMatrix = a, this.invProjMatrix = e.invert(new Float64Array(16), this.projMatrix);\n          var l = e.invert([], s);\n          this.frustumCorners = e.FrustumCorners.fromInvProjectionMatrix(l, this.horizonLineFromTop(), this.height);\n          var c = new Float32Array(16);\n          e.identity(c), e.scale(c, c, [1, -1, 1]), e.rotateX(c, c, this._pitch), e.rotateZ(c, c, this.angle);\n          var h = e.perspective(new Float32Array(16), this._fov, this.width / this.height, this._nearZ, this._farZ),\n            u = (Math.PI / 2 - this._pitch) * (this.height / this._fov) * this._horizonShift;\n          h[8] = 2 * -t.x / this.width, h[9] = 2 * (t.y + u) / this.height, this.skyboxMatrix = e.multiply(c, h, c);\n          var _ = this.point,\n            d = _.x,\n            p = _.y,\n            m = this.width % 2 / 2,\n            f = this.height % 2 / 2,\n            g = Math.cos(this.angle),\n            x = Math.sin(this.angle),\n            y = d - Math.round(d) + g * m + x * f,\n            b = p - Math.round(p) + g * f + x * m,\n            w = new Float64Array(a);\n          if (e.translate(w, w, [y > .5 ? y - 1 : y, b > .5 ? b - 1 : b, 0]), this.alignedProjMatrix = w, a = e.create(), e.scale(a, a, [this.width / 2, -this.height / 2, 1]), e.translate(a, a, [1, -1, 0]), this.labelPlaneMatrix = a, a = e.create(), e.scale(a, a, [1, -1, 1]), e.translate(a, a, [-1, -1, 0]), e.scale(a, a, [2 / this.width, 2 / this.height, 1]), this.glCoordMatrix = a, this.pixelMatrix = e.multiply(new Float64Array(16), this.labelPlaneMatrix, this.projMatrix), this._calcFogMatrices(), this._distanceTileDataCache = {}, a = e.invert(new Float64Array(16), this.pixelMatrix), !a) throw new Error(\"failed to invert matrix\");\n          if (this.pixelMatrixInverse = a, \"globe\" === this.projection.name || this.mercatorFromTransition) {\n            this.globeMatrix = e.calculateGlobeMatrix(this);\n            var _t446 = [this.globeMatrix[12], this.globeMatrix[13], this.globeMatrix[14]];\n            this.globeCenterInViewSpace = e.transformMat4(_t446, _t446, n), this.globeRadius = this.worldSize / 2 / Math.PI - 1;\n          } else this.globeMatrix = a;\n          this._projMatrixCache = {}, this._alignedProjMatrixCache = {}, this._pixelsToTileUnitsCache = {};\n        }\n      }, {\n        key: \"_calcFogMatrices\",\n        value: function _calcFogMatrices() {\n          this._fogTileMatrixCache = {};\n          var t = this.cameraWorldSizeForFog,\n            i = this.cameraPixelsPerMeter,\n            o = this._camera.position,\n            r = 1 / this.height / this._pixelsPerMercatorPixel,\n            n = [t, t, i];\n          e.scale$2(n, n, r), e.scale$2(o, o, -1), e.multiply$2(o, o, n);\n          var s = e.create();\n          e.translate(s, s, o), e.scale(s, s, n), this.mercatorFogMatrix = s, this.worldToFogMatrix = this._camera.getWorldToCameraPosition(t, i, r);\n        }\n      }, {\n        key: \"_computeCameraPosition\",\n        value: function _computeCameraPosition(e) {\n          var t = (e = e || this.pixelsPerMeter) / this.pixelsPerMeter,\n            i = this._camera.forward(),\n            o = this.point,\n            r = this._mercatorZfromZoom(this._seaLevelZoom ? this._seaLevelZoom : this._zoom) * t - e / this.worldSize * this._centerAltitude;\n          return [o.x / this.worldSize - i[0] * r, o.y / this.worldSize - i[1] * r, e / this.worldSize * this._centerAltitude - i[2] * r];\n        }\n      }, {\n        key: \"_updateCameraState\",\n        value: function _updateCameraState() {\n          this.height && (this._camera.setPitchBearing(this._pitch, this.angle), this._camera.position = this._computeCameraPosition());\n        }\n      }, {\n        key: \"_translateCameraConstrained\",\n        value: function _translateCameraConstrained(t) {\n          var i = this._maxCameraBoundsDistance() * Math.cos(this._pitch),\n            o = this._camera.position[2],\n            r = t[2];\n          var n = 1;\n          this.projection.wrap && (this.center = this.center.wrap()), r > 0 && (n = Math.min((i - o) / r, 1)), this._camera.position = e.scaleAndAdd([], this._camera.position, t, n), this._updateStateFromCamera();\n        }\n      }, {\n        key: \"_updateStateFromCamera\",\n        value: function _updateStateFromCamera() {\n          var t = this._camera.position,\n            i = this._camera.forward(),\n            _this$_camera$getPitc = this._camera.getPitchBearing(),\n            o = _this$_camera$getPitc.pitch,\n            r = _this$_camera$getPitc.bearing,\n            n = e.mercatorZfromAltitude(this._centerAltitude, this.center.lat) * this._pixelsPerMercatorPixel,\n            s = this._mercatorZfromZoom(this._maxZoom) * Math.cos(e.degToRad(this._maxPitch)),\n            a = Math.max((t[2] - n) / Math.cos(o), s),\n            l = this._zoomFromMercatorZ(a);\n          e.scaleAndAdd(t, t, i, a), this._pitch = e.clamp(o, e.degToRad(this.minPitch), e.degToRad(this.maxPitch)), this.angle = e.wrap(r, -Math.PI, Math.PI), this._setZoom(e.clamp(l, this._minZoom, this._maxZoom)), this._updateSeaLevelZoom(), this._center = this.coordinateLocation(new e.MercatorCoordinate(t[0], t[1], t[2])), this._unmodified = !1, this._constrain(), this._calcMatrices();\n        }\n      }, {\n        key: \"_worldSizeFromZoom\",\n        value: function _worldSizeFromZoom(e) {\n          return Math.pow(2, e) * this.tileSize;\n        }\n      }, {\n        key: \"_mercatorZfromZoom\",\n        value: function _mercatorZfromZoom(e) {\n          return this.cameraToCenterDistance / this._worldSizeFromZoom(e);\n        }\n      }, {\n        key: \"_minimumHeightOverTerrain\",\n        value: function _minimumHeightOverTerrain() {\n          var e = Math.min((null != this._seaLevelZoom ? this._seaLevelZoom : this._zoom) + 4, this._maxZoom);\n          return this._mercatorZfromZoom(e);\n        }\n      }, {\n        key: \"_zoomFromMercatorZ\",\n        value: function _zoomFromMercatorZ(e) {\n          return this.scaleZoom(this.cameraToCenterDistance / (e * this.tileSize));\n        }\n      }, {\n        key: \"zoomFromMercatorZAdjusted\",\n        value: function zoomFromMercatorZAdjusted(t) {\n          var i = 0,\n            o = e.GLOBE_ZOOM_THRESHOLD_MAX,\n            r = 0,\n            n = 1 / 0;\n          for (; o - i > 1e-6 && o > i;) {\n            var _e445 = i + .5 * (o - i),\n              _s166 = this.tileSize * Math.pow(2, _e445),\n              _a138 = this.getCameraToCenterDistance(this.projection, _e445, _s166),\n              _l85 = this.scaleZoom(_a138 / (t * this.tileSize)),\n              _c70 = Math.abs(_e445 - _l85);\n            _c70 < n && (n = _c70, r = _e445), _e445 < _l85 ? i = _e445 : o = _e445;\n          }\n          return r;\n        }\n      }, {\n        key: \"_terrainEnabled\",\n        value: function _terrainEnabled() {\n          return !(!this._elevation || !this.projection.supportsTerrain && (e.warnOnce(\"Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain.\"), 1));\n        }\n      }, {\n        key: \"anyCornerOffEdge\",\n        value: function anyCornerOffEdge(t, i) {\n          var o = Math.min(t.x, i.x),\n            r = Math.max(t.x, i.x),\n            n = Math.min(t.y, i.y),\n            s = Math.max(t.y, i.y);\n          if (n < this.horizonLineFromTop(!1)) return !0;\n          if (\"mercator\" !== this.projection.name) return !1;\n          var a = [new e.pointGeometry(o, n), new e.pointGeometry(r, s), new e.pointGeometry(o, s), new e.pointGeometry(r, n)],\n            l = this.renderWorldCopies ? -3 : 0,\n            c = this.renderWorldCopies ? 4 : 1;\n          for (var _i296 = 0, _a139 = a; _i296 < _a139.length; _i296++) {\n            var _e446 = _a139[_i296];\n            var _t447 = this.pointRayIntersection(_e446);\n            if (_t447.t < 0) return !0;\n            var _i297 = this.rayIntersectionCoordinate(_t447);\n            if (_i297.x < l || _i297.y < 0 || _i297.x > c || _i297.y > 1) return !0;\n          }\n          return !1;\n        }\n      }, {\n        key: \"isHorizonVisible\",\n        value: function isHorizonVisible() {\n          return this.pitch + e.radToDeg(this.fovAboveCenter) > 88 || this.anyCornerOffEdge(new e.pointGeometry(0, 0), new e.pointGeometry(this.width, this.height));\n        }\n      }, {\n        key: \"zoomDeltaToMovement\",\n        value: function zoomDeltaToMovement(t, i) {\n          var o = e.length(e.sub([], this._camera.position, t)),\n            r = this._zoomFromMercatorZ(o) + i;\n          return o - this._mercatorZfromZoom(r);\n        }\n      }, {\n        key: \"getCameraPoint\",\n        value: function getCameraPoint() {\n          if (\"globe\" === this.projection.name) {\n            var _t448 = function (_ref149, r) {\n              var _ref150 = _slicedToArray(_ref149, 3),\n                t = _ref150[0],\n                i = _ref150[1],\n                o = _ref150[2];\n              var n = [t, i, o, 1];\n              e.transformMat4$1(n, n, r);\n              var s = n[3] = Math.max(n[3], 1e-6);\n              return n[0] /= s, n[1] /= s, n[2] /= s, n;\n            }([this.globeMatrix[12], this.globeMatrix[13], this.globeMatrix[14]], this.pixelMatrix);\n            return new e.pointGeometry(_t448[0], _t448[1]);\n          }\n          {\n            var _t449 = Math.tan(this._pitch) * (this.cameraToCenterDistance || 1);\n            return this.centerPoint.add(new e.pointGeometry(0, _t449));\n          }\n        }\n      }, {\n        key: \"getCameraToCenterDistance\",\n        value: function getCameraToCenterDistance(e) {\n          var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.zoom;\n          var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.worldSize;\n          var o = qo(e, t, this.width, this.height, 1024),\n            r = e.pixelSpaceConversion(this.center.lat, i, o);\n          return .5 / Math.tan(.5 * this._fov) * this.height * r;\n        }\n      }, {\n        key: \"getWorldToCameraMatrix\",\n        value: function getWorldToCameraMatrix() {\n          var t = this._camera.getWorldToCamera(this.worldSize, \"meters\" === this.projection.zAxisUnit ? this.pixelsPerMeter : 1);\n          return \"globe\" === this.projection.name && e.multiply(t, t, this.globeMatrix), t;\n        }\n      }, {\n        key: \"elevation\",\n        get: function get() {\n          return this._elevation;\n        },\n        set: function set(e) {\n          this._elevation !== e && (this._elevation = e, this._updateCameraOnTerrain(), this._calcMatrices());\n        }\n      }, {\n        key: \"minZoom\",\n        get: function get() {\n          return this._minZoom;\n        },\n        set: function set(e) {\n          this._minZoom !== e && (this._minZoom = e, this.zoom = Math.max(this.zoom, e));\n        }\n      }, {\n        key: \"maxZoom\",\n        get: function get() {\n          return this._maxZoom;\n        },\n        set: function set(e) {\n          this._maxZoom !== e && (this._maxZoom = e, this.zoom = Math.min(this.zoom, e));\n        }\n      }, {\n        key: \"minPitch\",\n        get: function get() {\n          return this._minPitch;\n        },\n        set: function set(e) {\n          this._minPitch !== e && (this._minPitch = e, this.pitch = Math.max(this.pitch, e));\n        }\n      }, {\n        key: \"maxPitch\",\n        get: function get() {\n          return this._maxPitch;\n        },\n        set: function set(e) {\n          this._maxPitch !== e && (this._maxPitch = e, this.pitch = Math.min(this.pitch, e));\n        }\n      }, {\n        key: \"renderWorldCopies\",\n        get: function get() {\n          return this._renderWorldCopies && !0 === this.projection.supportsWorldCopies;\n        },\n        set: function set(e) {\n          void 0 === e ? e = !0 : null === e && (e = !1), this._renderWorldCopies = e;\n        }\n      }, {\n        key: \"worldSize\",\n        get: function get() {\n          return this.tileSize * this.scale;\n        }\n      }, {\n        key: \"cameraWorldSizeForFog\",\n        get: function get() {\n          var e = Math.max(this._camera.getDistanceToElevation(this._averageElevation), Number.EPSILON);\n          return this._worldSizeFromZoom(this._zoomFromMercatorZ(e));\n        }\n      }, {\n        key: \"cameraWorldSize\",\n        get: function get() {\n          var e = Math.max(this._camera.getDistanceToElevation(this._averageElevation, !0), Number.EPSILON);\n          return this._worldSizeFromZoom(this._zoomFromMercatorZ(e));\n        }\n      }, {\n        key: \"pixelsPerMeter\",\n        get: function get() {\n          return this.projection.pixelsPerMeter(this.center.lat, this.worldSize);\n        }\n      }, {\n        key: \"cameraPixelsPerMeter\",\n        get: function get() {\n          return e.mercatorZfromAltitude(this.center.lat, this.cameraWorldSizeForFog);\n        }\n      }, {\n        key: \"centerOffset\",\n        get: function get() {\n          return this.centerPoint._sub(this.size._div(2));\n        }\n      }, {\n        key: \"size\",\n        get: function get() {\n          return new e.pointGeometry(this.width, this.height);\n        }\n      }, {\n        key: \"bearing\",\n        get: function get() {\n          return e.wrap(this.rotation, -180, 180);\n        },\n        set: function set(e) {\n          this.rotation = e;\n        }\n      }, {\n        key: \"rotation\",\n        get: function get() {\n          return -this.angle / Math.PI * 180;\n        },\n        set: function set(t) {\n          var i = -t * Math.PI / 180;\n          var o;\n          this.angle !== i && (this._unmodified = !1, this.angle = i, this._calcMatrices(), this.rotationMatrix = (o = new e.ARRAY_TYPE(4), e.ARRAY_TYPE != Float32Array && (o[1] = 0, o[2] = 0), o[0] = 1, o[3] = 1, o), function (e, t, i) {\n            var o = t[0],\n              r = t[1],\n              n = t[2],\n              s = t[3],\n              a = Math.sin(i),\n              l = Math.cos(i);\n            e[0] = o * l + n * a, e[1] = r * l + s * a, e[2] = o * -a + n * l, e[3] = r * -a + s * l;\n          }(this.rotationMatrix, this.rotationMatrix, this.angle));\n        }\n      }, {\n        key: \"pitch\",\n        get: function get() {\n          return this._pitch / Math.PI * 180;\n        },\n        set: function set(t) {\n          var i = e.clamp(t, this.minPitch, this.maxPitch) / 180 * Math.PI;\n          this._pitch !== i && (this._unmodified = !1, this._pitch = i, this._calcMatrices());\n        }\n      }, {\n        key: \"aspect\",\n        get: function get() {\n          return this.width / this.height;\n        }\n      }, {\n        key: \"fov\",\n        get: function get() {\n          return this._fov / Math.PI * 180;\n        },\n        set: function set(t) {\n          t = Math.max(.01, Math.min(60, t)), this._fov !== t && (this._unmodified = !1, this._fov = e.degToRad(t), this._calcMatrices());\n        }\n      }, {\n        key: \"fovX\",\n        get: function get() {\n          return this._fov;\n        }\n      }, {\n        key: \"fovY\",\n        get: function get() {\n          var e = 1 / Math.tan(.5 * this.fovX);\n          return 2 * Math.atan(1 / this.aspect / e);\n        }\n      }, {\n        key: \"averageElevation\",\n        get: function get() {\n          return this._averageElevation;\n        },\n        set: function set(e) {\n          this._averageElevation = e, this._calcFogMatrices(), this._distanceTileDataCache = {};\n        }\n      }, {\n        key: \"zoom\",\n        get: function get() {\n          return this._zoom;\n        },\n        set: function set(e) {\n          var t = Math.min(Math.max(e, this.minZoom), this.maxZoom);\n          this._zoom !== t && (this._unmodified = !1, this._setZoom(t), this._updateSeaLevelZoom(), this._constrain(), this._calcMatrices());\n        }\n      }, {\n        key: \"center\",\n        get: function get() {\n          return this._center;\n        },\n        set: function set(e) {\n          e.lat === this._center.lat && e.lng === this._center.lng || (this._unmodified = !1, this._center = e, this._terrainEnabled() && (\"ground\" === this.cameraElevationReference ? this._updateCameraOnTerrain() : this._updateZoomFromElevation()), this._constrain(), this._calcMatrices());\n        }\n      }, {\n        key: \"padding\",\n        get: function get() {\n          return this._edgeInsets.toJSON();\n        },\n        set: function set(e) {\n          this._edgeInsets.equals(e) || (this._unmodified = !1, this._edgeInsets.interpolate(this._edgeInsets, e, 1), this._calcMatrices());\n        }\n      }, {\n        key: \"centerPoint\",\n        get: function get() {\n          return this._edgeInsets.getCenter(this.width, this.height);\n        }\n      }, {\n        key: \"fovAboveCenter\",\n        get: function get() {\n          return this._fov * (.5 + this.centerOffset.y / this.height);\n        }\n      }, {\n        key: \"unmodified\",\n        get: function get() {\n          return this._unmodified;\n        }\n      }, {\n        key: \"point\",\n        get: function get() {\n          return this.project(this.center);\n        }\n      }, {\n        key: \"pointMerc\",\n        get: function get() {\n          return this.point._div(this.worldSize);\n        }\n      }, {\n        key: \"pixelsPerMeterRatio\",\n        get: function get() {\n          return this.pixelsPerMeter / e.mercatorZfromAltitude(1, this.center.lat) / this.worldSize;\n        }\n      }]);\n      return Ko;\n    }();\n    function Jo(e, t) {\n      var i = !1,\n        o = null;\n      var r = function r() {\n        o = null, i && (e(), o = setTimeout(r, t), i = !1);\n      };\n      return function () {\n        return i = !0, o || r(), o;\n      };\n    }\n    var Qo = /*#__PURE__*/function () {\n      function Qo(t) {\n        _classCallCheck(this, Qo);\n        this._hashName = t && encodeURIComponent(t), e.bindAll([\"_getCurrentHash\", \"_onHashChange\", \"_updateHash\"], this), this._updateHash = Jo(this._updateHashUnthrottled.bind(this), 300);\n      }\n      _createClass(Qo, [{\n        key: \"addTo\",\n        value: function addTo(t) {\n          return this._map = t, e.window.addEventListener(\"hashchange\", this._onHashChange, !1), t.on(\"moveend\", this._updateHash), this;\n        }\n      }, {\n        key: \"remove\",\n        value: function remove() {\n          return this._map ? (this._map.off(\"moveend\", this._updateHash), e.window.removeEventListener(\"hashchange\", this._onHashChange, !1), clearTimeout(this._updateHash()), this._map = void 0, this) : this;\n        }\n      }, {\n        key: \"getHashString\",\n        value: function getHashString() {\n          var t = this._map;\n          if (!t) return \"\";\n          var i = er(t);\n          if (this._hashName) {\n            var _t450 = this._hashName;\n            var _o164 = !1;\n            var _r299 = e.window.location.hash.slice(1).split(\"&\").map(function (e) {\n              var r = e.split(\"=\")[0];\n              return r === _t450 ? (_o164 = !0, \"\".concat(r, \"=\").concat(i)) : e;\n            }).filter(function (e) {\n              return e;\n            });\n            return _o164 || _r299.push(\"\".concat(_t450, \"=\").concat(i)), \"#\".concat(_r299.join(\"&\"));\n          }\n          return \"#\".concat(i);\n        }\n      }, {\n        key: \"_getCurrentHash\",\n        value: function _getCurrentHash() {\n          var _this119 = this;\n          var t = e.window.location.hash.replace(\"#\", \"\");\n          if (this._hashName) {\n            var _e447;\n            return t.split(\"&\").map(function (e) {\n              return e.split(\"=\");\n            }).forEach(function (t) {\n              t[0] === _this119._hashName && (_e447 = t);\n            }), (_e447 && _e447[1] || \"\").split(\"/\");\n          }\n          return t.split(\"/\");\n        }\n      }, {\n        key: \"_onHashChange\",\n        value: function _onHashChange() {\n          var e = this._map;\n          if (!e) return !1;\n          var t = this._getCurrentHash();\n          if (t.length >= 3 && !t.some(function (e) {\n            return isNaN(e);\n          })) {\n            var _i298 = e.dragRotate.isEnabled() && e.touchZoomRotate.isEnabled() ? +(t[3] || 0) : e.getBearing();\n            return e.jumpTo({\n              center: [+t[2], +t[1]],\n              zoom: +t[0],\n              bearing: _i298,\n              pitch: +(t[4] || 0)\n            }), !0;\n          }\n          return !1;\n        }\n      }, {\n        key: \"_updateHashUnthrottled\",\n        value: function _updateHashUnthrottled() {\n          var t = e.window.location.href.replace(/(#.+)?$/, this.getHashString());\n          e.window.history.replaceState(e.window.history.state, null, t);\n        }\n      }]);\n      return Qo;\n    }();\n    function er(e, t) {\n      var i = e.getCenter(),\n        o = Math.round(100 * e.getZoom()) / 100,\n        r = Math.ceil((o * Math.LN2 + Math.log(512 / 360 / .5)) / Math.LN10),\n        n = Math.pow(10, r),\n        s = Math.round(i.lng * n) / n,\n        a = Math.round(i.lat * n) / n,\n        l = e.getBearing(),\n        c = e.getPitch();\n      var h = t ? \"/\".concat(s, \"/\").concat(a, \"/\").concat(o) : \"\".concat(o, \"/\").concat(a, \"/\").concat(s);\n      return (l || c) && (h += \"/\" + Math.round(10 * l) / 10), c && (h += \"/\".concat(Math.round(c))), h;\n    }\n    var tr = {\n        linearity: .3,\n        easing: e.bezier(0, 0, .3, 1)\n      },\n      ir = e.extend({\n        deceleration: 2500,\n        maxSpeed: 1400\n      }, tr),\n      or = e.extend({\n        deceleration: 20,\n        maxSpeed: 1400\n      }, tr),\n      rr = e.extend({\n        deceleration: 1e3,\n        maxSpeed: 360\n      }, tr),\n      nr = e.extend({\n        deceleration: 1e3,\n        maxSpeed: 90\n      }, tr);\n    var sr = /*#__PURE__*/function () {\n      function sr(e) {\n        _classCallCheck(this, sr);\n        this._map = e, this.clear();\n      }\n      _createClass(sr, [{\n        key: \"clear\",\n        value: function clear() {\n          this._inertiaBuffer = [];\n        }\n      }, {\n        key: \"record\",\n        value: function record(t) {\n          this._drainInertiaBuffer(), this._inertiaBuffer.push({\n            time: e.exported.now(),\n            settings: t\n          });\n        }\n      }, {\n        key: \"_drainInertiaBuffer\",\n        value: function _drainInertiaBuffer() {\n          var t = this._inertiaBuffer,\n            i = e.exported.now();\n          for (; t.length > 0 && i - t[0].time > 160;) t.shift();\n        }\n      }, {\n        key: \"_onMoveEnd\",\n        value: function _onMoveEnd(t) {\n          if (e.exported.prefersReducedMotion) return;\n          if (this._drainInertiaBuffer(), this._inertiaBuffer.length < 2) return;\n          var i = {\n            zoom: 0,\n            bearing: 0,\n            pitch: 0,\n            pan: new e.pointGeometry(0, 0),\n            pinchAround: void 0,\n            around: void 0\n          };\n          var _iterator272 = _createForOfIteratorHelper(this._inertiaBuffer),\n            _step272;\n          try {\n            for (_iterator272.s(); !(_step272 = _iterator272.n()).done;) {\n              var _e451 = _step272.value.settings;\n              i.zoom += _e451.zoomDelta || 0, i.bearing += _e451.bearingDelta || 0, i.pitch += _e451.pitchDelta || 0, _e451.panDelta && i.pan._add(_e451.panDelta), _e451.around && (i.around = _e451.around), _e451.pinchAround && (i.pinchAround = _e451.pinchAround);\n            }\n          } catch (err) {\n            _iterator272.e(err);\n          } finally {\n            _iterator272.f();\n          }\n          var o = this._inertiaBuffer[this._inertiaBuffer.length - 1].time - this._inertiaBuffer[0].time,\n            r = {};\n          if (i.pan.mag()) {\n            var _n210 = lr(i.pan.mag(), o, e.extend({}, ir, t || {}));\n            r.offset = i.pan.mult(_n210.amount / i.pan.mag()), r.center = this._map.transform.center, ar(r, _n210);\n          }\n          if (i.zoom) {\n            var _e448 = lr(i.zoom, o, or);\n            r.zoom = this._map.transform.zoom + _e448.amount, ar(r, _e448);\n          }\n          if (i.bearing) {\n            var _t451 = lr(i.bearing, o, rr);\n            r.bearing = this._map.transform.bearing + e.clamp(_t451.amount, -179, 179), ar(r, _t451);\n          }\n          if (i.pitch) {\n            var _e449 = lr(i.pitch, o, nr);\n            r.pitch = this._map.transform.pitch + _e449.amount, ar(r, _e449);\n          }\n          if (r.zoom || r.bearing) {\n            var _e450 = void 0 === i.pinchAround ? i.around : i.pinchAround;\n            r.around = _e450 ? this._map.unproject(_e450) : this._map.getCenter();\n          }\n          return this.clear(), r.noMoveStart = !0, r;\n        }\n      }]);\n      return sr;\n    }();\n    function ar(e, t) {\n      (!e.duration || e.duration < t.duration) && (e.duration = t.duration, e.easing = t.easing);\n    }\n    function lr(t, i, o) {\n      var r = o.maxSpeed,\n        n = o.linearity,\n        s = o.deceleration,\n        a = e.clamp(t * n / (i / 1e3), -r, r),\n        l = Math.abs(a) / (s * n);\n      return {\n        easing: o.easing,\n        duration: 1e3 * l,\n        amount: a * (l / 2)\n      };\n    }\n    var cr = /*#__PURE__*/function (_e$Event) {\n      _inherits(cr, _e$Event);\n      _createClass(cr, [{\n        key: \"preventDefault\",\n        value: function preventDefault() {\n          this._defaultPrevented = !0;\n        }\n      }, {\n        key: \"defaultPrevented\",\n        get: function get() {\n          return this._defaultPrevented;\n        }\n      }]);\n      function cr(t, i, o) {\n        var _this120;\n        var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n        _classCallCheck(this, cr);\n        var n = p(i.getCanvasContainer(), o),\n          s = i.unproject(n);\n        _this120 = _possibleConstructorReturn(this, _getPrototypeOf(cr).call(this, t, e.extend({\n          point: n,\n          lngLat: s,\n          originalEvent: o\n        }, r))), _this120._defaultPrevented = !1, _this120.target = i;\n        return _this120;\n      }\n      return cr;\n    }(e.Event);\n    var hr = /*#__PURE__*/function (_e$Event2) {\n      _inherits(hr, _e$Event2);\n      _createClass(hr, [{\n        key: \"preventDefault\",\n        value: function preventDefault() {\n          this._defaultPrevented = !0;\n        }\n      }, {\n        key: \"defaultPrevented\",\n        get: function get() {\n          return this._defaultPrevented;\n        }\n      }]);\n      function hr(t, i, o) {\n        var _this121;\n        _classCallCheck(this, hr);\n        var r = \"touchend\" === t ? o.changedTouches : o.touches,\n          n = m(i.getCanvasContainer(), r),\n          s = n.map(function (e) {\n            return i.unproject(e);\n          }),\n          a = n.reduce(function (e, t, i, o) {\n            return e.add(t.div(o.length));\n          }, new e.pointGeometry(0, 0));\n        _this121 = _possibleConstructorReturn(this, _getPrototypeOf(hr).call(this, t, {\n          points: n,\n          point: a,\n          lngLats: s,\n          lngLat: i.unproject(a),\n          originalEvent: o\n        })), _this121._defaultPrevented = !1;\n        return _this121;\n      }\n      return hr;\n    }(e.Event);\n    var ur = /*#__PURE__*/function (_e$Event3) {\n      _inherits(ur, _e$Event3);\n      _createClass(ur, [{\n        key: \"preventDefault\",\n        value: function preventDefault() {\n          this._defaultPrevented = !0;\n        }\n      }, {\n        key: \"defaultPrevented\",\n        get: function get() {\n          return this._defaultPrevented;\n        }\n      }]);\n      function ur(e, t, i) {\n        var _this122;\n        _classCallCheck(this, ur);\n        _this122 = _possibleConstructorReturn(this, _getPrototypeOf(ur).call(this, e, {\n          originalEvent: i\n        })), _this122._defaultPrevented = !1;\n        return _this122;\n      }\n      return ur;\n    }(e.Event);\n    var _r = /*#__PURE__*/function () {\n      function _r(e, t) {\n        _classCallCheck(this, _r);\n        this._map = e, this._clickTolerance = t.clickTolerance;\n      }\n      _createClass(_r, [{\n        key: \"reset\",\n        value: function reset() {\n          this._mousedownPos = void 0;\n        }\n      }, {\n        key: \"wheel\",\n        value: function wheel(e) {\n          return this._firePreventable(new ur(e.type, this._map, e));\n        }\n      }, {\n        key: \"mousedown\",\n        value: function mousedown(e, t) {\n          return this._mousedownPos = t, this._firePreventable(new cr(e.type, this._map, e));\n        }\n      }, {\n        key: \"mouseup\",\n        value: function mouseup(e) {\n          this._map.fire(new cr(e.type, this._map, e));\n        }\n      }, {\n        key: \"preclick\",\n        value: function preclick(t) {\n          var i = e.extend({}, t);\n          i.type = \"preclick\", this._map.fire(new cr(i.type, this._map, i));\n        }\n      }, {\n        key: \"click\",\n        value: function click(e, t) {\n          this._mousedownPos && this._mousedownPos.dist(t) >= this._clickTolerance || (this.preclick(e), this._map.fire(new cr(e.type, this._map, e)));\n        }\n      }, {\n        key: \"dblclick\",\n        value: function dblclick(e) {\n          return this._firePreventable(new cr(e.type, this._map, e));\n        }\n      }, {\n        key: \"mouseover\",\n        value: function mouseover(e) {\n          this._map.fire(new cr(e.type, this._map, e));\n        }\n      }, {\n        key: \"mouseout\",\n        value: function mouseout(e) {\n          this._map.fire(new cr(e.type, this._map, e));\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(e) {\n          return this._firePreventable(new hr(e.type, this._map, e));\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(e) {\n          this._map.fire(new hr(e.type, this._map, e));\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e) {\n          this._map.fire(new hr(e.type, this._map, e));\n        }\n      }, {\n        key: \"touchcancel\",\n        value: function touchcancel(e) {\n          this._map.fire(new hr(e.type, this._map, e));\n        }\n      }, {\n        key: \"_firePreventable\",\n        value: function _firePreventable(e) {\n          if (this._map.fire(e), e.defaultPrevented) return {};\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return !0;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return !1;\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {}\n      }, {\n        key: \"disable\",\n        value: function disable() {}\n      }]);\n      return _r;\n    }();\n    var dr = /*#__PURE__*/function () {\n      function dr(e) {\n        _classCallCheck(this, dr);\n        this._map = e;\n      }\n      _createClass(dr, [{\n        key: \"reset\",\n        value: function reset() {\n          this._delayContextMenu = !1, this._contextMenuEvent = void 0;\n        }\n      }, {\n        key: \"mousemove\",\n        value: function mousemove(e) {\n          this._map.fire(new cr(e.type, this._map, e));\n        }\n      }, {\n        key: \"mousedown\",\n        value: function mousedown() {\n          this._delayContextMenu = !0;\n        }\n      }, {\n        key: \"mouseup\",\n        value: function mouseup() {\n          this._delayContextMenu = !1, this._contextMenuEvent && (this._map.fire(new cr(\"contextmenu\", this._map, this._contextMenuEvent)), delete this._contextMenuEvent);\n        }\n      }, {\n        key: \"contextmenu\",\n        value: function contextmenu(e) {\n          this._delayContextMenu ? this._contextMenuEvent = e : this._map.fire(new cr(e.type, this._map, e)), this._map.listens(\"contextmenu\") && e.preventDefault();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return !0;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return !1;\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {}\n      }, {\n        key: \"disable\",\n        value: function disable() {}\n      }]);\n      return dr;\n    }();\n    var pr = /*#__PURE__*/function () {\n      function pr(e, t) {\n        _classCallCheck(this, pr);\n        this._map = e, this._el = e.getCanvasContainer(), this._container = e.getContainer(), this._clickTolerance = t.clickTolerance || 1;\n      }\n      _createClass(pr, [{\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return !!this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return !!this._active;\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {\n          this.isEnabled() || (this._enabled = !0);\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this.isEnabled() && (this._enabled = !1);\n        }\n      }, {\n        key: \"mousedown\",\n        value: function mousedown(e, t) {\n          this.isEnabled() && e.shiftKey && 0 === e.button && (h(), this._startPos = this._lastPos = t, this._active = !0);\n        }\n      }, {\n        key: \"mousemoveWindow\",\n        value: function mousemoveWindow(e, t) {\n          var _this123 = this;\n          if (!this._active) return;\n          var i = t,\n            o = this._startPos,\n            r = this._lastPos;\n          if (!o || !r || r.equals(i) || !this._box && i.dist(o) < this._clickTolerance) return;\n          this._lastPos = i, this._box || (this._box = n(\"div\", \"mapboxgl-boxzoom\", this._container), this._container.classList.add(\"mapboxgl-crosshair\"), this._fireEvent(\"boxzoomstart\", e));\n          var s = Math.min(o.x, i.x),\n            a = Math.max(o.x, i.x),\n            l = Math.min(o.y, i.y),\n            c = Math.max(o.y, i.y);\n          this._map._requestDomTask(function () {\n            _this123._box && (_this123._box.style.transform = \"translate(\".concat(s, \"px,\").concat(l, \"px)\"), _this123._box.style.width = a - s + \"px\", _this123._box.style.height = c - l + \"px\");\n          });\n        }\n      }, {\n        key: \"mouseupWindow\",\n        value: function mouseupWindow(t, i) {\n          var _this124 = this;\n          if (!this._active) return;\n          var o = this._startPos,\n            r = i;\n          if (o && 0 === t.button) {\n            if (this.reset(), d(), o.x !== r.x || o.y !== r.y) return this._map.fire(new e.Event(\"boxzoomend\", {\n              originalEvent: t\n            })), {\n              cameraAnimation: function cameraAnimation(e) {\n                return e.fitScreenCoordinates(o, r, _this124._map.getBearing(), {\n                  linear: !1\n                });\n              }\n            };\n            this._fireEvent(\"boxzoomcancel\", t);\n          }\n        }\n      }, {\n        key: \"keydown\",\n        value: function keydown(e) {\n          this._active && 27 === e.keyCode && (this.reset(), this._fireEvent(\"boxzoomcancel\", e));\n        }\n      }, {\n        key: \"blur\",\n        value: function blur() {\n          this.reset();\n        }\n      }, {\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1, this._container.classList.remove(\"mapboxgl-crosshair\"), this._box && (this._box.remove(), this._box = null), u(), delete this._startPos, delete this._lastPos;\n        }\n      }, {\n        key: \"_fireEvent\",\n        value: function _fireEvent(t, i) {\n          return this._map.fire(new e.Event(t, {\n            originalEvent: i\n          }));\n        }\n      }]);\n      return pr;\n    }();\n    function mr(e, t) {\n      var i = {};\n      for (var _o165 = 0; _o165 < e.length; _o165++) i[e[_o165].identifier] = t[_o165];\n      return i;\n    }\n    var fr = /*#__PURE__*/function () {\n      function fr(e) {\n        _classCallCheck(this, fr);\n        this.reset(), this.numTouches = e.numTouches;\n      }\n      _createClass(fr, [{\n        key: \"reset\",\n        value: function reset() {\n          this.centroid = void 0, this.startTime = 0, this.touches = {}, this.aborted = !1;\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(t, i, o) {\n          (this.centroid || o.length > this.numTouches) && (this.aborted = !0), this.aborted || (0 === this.startTime && (this.startTime = t.timeStamp), o.length === this.numTouches && (this.centroid = function (t) {\n            var i = new e.pointGeometry(0, 0);\n            var _iterator273 = _createForOfIteratorHelper(t),\n              _step273;\n            try {\n              for (_iterator273.s(); !(_step273 = _iterator273.n()).done;) {\n                var _e452 = _step273.value;\n                i._add(_e452);\n              }\n            } catch (err) {\n              _iterator273.e(err);\n            } finally {\n              _iterator273.f();\n            }\n            return i.div(t.length);\n          }(i), this.touches = mr(o, i)));\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(e, t, i) {\n          if (this.aborted || !this.centroid) return;\n          var o = mr(i, t);\n          for (var _e453 in this.touches) {\n            var _t452 = this.touches[_e453],\n              _i299 = o[_e453];\n            (!_i299 || _i299.dist(_t452) > 30) && (this.aborted = !0);\n          }\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e, t, i) {\n          if ((!this.centroid || e.timeStamp - this.startTime > 500) && (this.aborted = !0), 0 === i.length) {\n            var _e454 = !this.aborted && this.centroid;\n            if (this.reset(), _e454) return _e454;\n          }\n        }\n      }]);\n      return fr;\n    }();\n    var gr = /*#__PURE__*/function () {\n      function gr(e) {\n        _classCallCheck(this, gr);\n        this.singleTap = new fr(e), this.numTaps = e.numTaps, this.reset();\n      }\n      _createClass(gr, [{\n        key: \"reset\",\n        value: function reset() {\n          this.lastTime = 1 / 0, this.lastTap = void 0, this.count = 0, this.singleTap.reset();\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(e, t, i) {\n          this.singleTap.touchstart(e, t, i);\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(e, t, i) {\n          this.singleTap.touchmove(e, t, i);\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e, t, i) {\n          var o = this.singleTap.touchend(e, t, i);\n          if (o) {\n            var _t453 = e.timeStamp - this.lastTime < 500,\n              _i300 = !this.lastTap || this.lastTap.dist(o) < 30;\n            if (_t453 && _i300 || this.reset(), this.count++, this.lastTime = e.timeStamp, this.lastTap = o, this.count === this.numTaps) return this.reset(), o;\n          }\n        }\n      }]);\n      return gr;\n    }();\n    var vr = /*#__PURE__*/function () {\n      function vr() {\n        _classCallCheck(this, vr);\n        this._zoomIn = new gr({\n          numTouches: 1,\n          numTaps: 2\n        }), this._zoomOut = new gr({\n          numTouches: 2,\n          numTaps: 1\n        }), this.reset();\n      }\n      _createClass(vr, [{\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1, this._zoomIn.reset(), this._zoomOut.reset();\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(e, t, i) {\n          this._zoomIn.touchstart(e, t, i), this._zoomOut.touchstart(e, t, i);\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(e, t, i) {\n          this._zoomIn.touchmove(e, t, i), this._zoomOut.touchmove(e, t, i);\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e, t, i) {\n          var _this125 = this;\n          var o = this._zoomIn.touchend(e, t, i),\n            r = this._zoomOut.touchend(e, t, i);\n          return o ? (this._active = !0, e.preventDefault(), setTimeout(function () {\n            return _this125.reset();\n          }, 0), {\n            cameraAnimation: function cameraAnimation(t) {\n              return t.easeTo({\n                duration: 300,\n                zoom: t.getZoom() + 1,\n                around: t.unproject(o)\n              }, {\n                originalEvent: e\n              });\n            }\n          }) : r ? (this._active = !0, e.preventDefault(), setTimeout(function () {\n            return _this125.reset();\n          }, 0), {\n            cameraAnimation: function cameraAnimation(t) {\n              return t.easeTo({\n                duration: 300,\n                zoom: t.getZoom() - 1,\n                around: t.unproject(r)\n              }, {\n                originalEvent: e\n              });\n            }\n          }) : void 0;\n        }\n      }, {\n        key: \"touchcancel\",\n        value: function touchcancel() {\n          this.reset();\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {\n          this._enabled = !0;\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._enabled = !1, this.reset();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._active;\n        }\n      }]);\n      return vr;\n    }();\n    var xr = {\n      0: 1,\n      2: 2\n    };\n    var yr = /*#__PURE__*/function () {\n      function yr(e) {\n        _classCallCheck(this, yr);\n        this.reset(), this._clickTolerance = e.clickTolerance || 1;\n      }\n      _createClass(yr, [{\n        key: \"blur\",\n        value: function blur() {\n          this.reset();\n        }\n      }, {\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1, this._moved = !1, this._lastPoint = void 0, this._eventButton = void 0;\n        }\n      }, {\n        key: \"_correctButton\",\n        value: function _correctButton(e, t) {\n          return !1;\n        }\n      }, {\n        key: \"_move\",\n        value: function _move(e, t) {\n          return {};\n        }\n      }, {\n        key: \"mousedown\",\n        value: function mousedown(e, t) {\n          if (this._lastPoint) return;\n          var i = f(e);\n          this._correctButton(e, i) && (this._lastPoint = t, this._eventButton = i);\n        }\n      }, {\n        key: \"mousemoveWindow\",\n        value: function mousemoveWindow(e, t) {\n          var i = this._lastPoint;\n          if (i) if (e.preventDefault(), null != this._eventButton && function (e, t) {\n            var i = xr[t];\n            return void 0 === e.buttons || (e.buttons & i) !== i;\n          }(e, this._eventButton)) this.reset();else if (this._moved || !(t.dist(i) < this._clickTolerance)) return this._moved = !0, this._lastPoint = t, this._move(i, t);\n        }\n      }, {\n        key: \"mouseupWindow\",\n        value: function mouseupWindow(e) {\n          this._lastPoint && f(e) === this._eventButton && (this._moved && d(), this.reset());\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {\n          this._enabled = !0;\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._enabled = !1, this.reset();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._active;\n        }\n      }]);\n      return yr;\n    }();\n    var br = /*#__PURE__*/function (_yr) {\n      _inherits(br, _yr);\n      function br() {\n        _classCallCheck(this, br);\n        return _possibleConstructorReturn(this, _getPrototypeOf(br).apply(this, arguments));\n      }\n      _createClass(br, [{\n        key: \"mousedown\",\n        value: function mousedown(e, t) {\n          _get(_getPrototypeOf(br.prototype), \"mousedown\", this).call(this, e, t), this._lastPoint && (this._active = !0);\n        }\n      }, {\n        key: \"_correctButton\",\n        value: function _correctButton(e, t) {\n          return 0 === t && !e.ctrlKey;\n        }\n      }, {\n        key: \"_move\",\n        value: function _move(e, t) {\n          return {\n            around: t,\n            panDelta: t.sub(e)\n          };\n        }\n      }]);\n      return br;\n    }(yr);\n    var wr = /*#__PURE__*/function (_yr2) {\n      _inherits(wr, _yr2);\n      function wr() {\n        _classCallCheck(this, wr);\n        return _possibleConstructorReturn(this, _getPrototypeOf(wr).apply(this, arguments));\n      }\n      _createClass(wr, [{\n        key: \"_correctButton\",\n        value: function _correctButton(e, t) {\n          return 0 === t && e.ctrlKey || 2 === t;\n        }\n      }, {\n        key: \"_move\",\n        value: function _move(e, t) {\n          var i = .8 * (t.x - e.x);\n          if (i) return this._active = !0, {\n            bearingDelta: i\n          };\n        }\n      }, {\n        key: \"contextmenu\",\n        value: function contextmenu(e) {\n          e.preventDefault();\n        }\n      }]);\n      return wr;\n    }(yr);\n    var Tr = /*#__PURE__*/function (_yr3) {\n      _inherits(Tr, _yr3);\n      function Tr() {\n        _classCallCheck(this, Tr);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Tr).apply(this, arguments));\n      }\n      _createClass(Tr, [{\n        key: \"_correctButton\",\n        value: function _correctButton(e, t) {\n          return 0 === t && e.ctrlKey || 2 === t;\n        }\n      }, {\n        key: \"_move\",\n        value: function _move(e, t) {\n          var i = -.5 * (t.y - e.y);\n          if (i) return this._active = !0, {\n            pitchDelta: i\n          };\n        }\n      }, {\n        key: \"contextmenu\",\n        value: function contextmenu(e) {\n          e.preventDefault();\n        }\n      }]);\n      return Tr;\n    }(yr);\n    var Er = /*#__PURE__*/function () {\n      function Er(t, i) {\n        _classCallCheck(this, Er);\n        this._map = t, this._el = t.getCanvasContainer(), this._minTouches = 1, this._clickTolerance = i.clickTolerance || 1, this.reset(), e.bindAll([\"_addTouchPanBlocker\", \"_showTouchPanBlockerAlert\"], this);\n      }\n      _createClass(Er, [{\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1, this._touches = {}, this._sum = new e.pointGeometry(0, 0);\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(e, t, i) {\n          return this._calculateTransform(e, t, i);\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(t, i, o) {\n          if (this._active && !(o.length < this._minTouches)) {\n            if (this._map._cooperativeGestures && !this._map.isMoving()) {\n              if (1 === o.length && !e.isFullscreen()) return void this._showTouchPanBlockerAlert();\n              \"hidden\" !== this._alertContainer.style.visibility && (this._alertContainer.style.visibility = \"hidden\", clearTimeout(this._alertTimer));\n            }\n            return t.cancelable && t.preventDefault(), this._calculateTransform(t, i, o);\n          }\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e, t, i) {\n          this._calculateTransform(e, t, i), this._active && i.length < this._minTouches && this.reset();\n        }\n      }, {\n        key: \"touchcancel\",\n        value: function touchcancel() {\n          this.reset();\n        }\n      }, {\n        key: \"_calculateTransform\",\n        value: function _calculateTransform(t, i, o) {\n          o.length > 0 && (this._active = !0);\n          var r = mr(o, i),\n            n = new e.pointGeometry(0, 0),\n            s = new e.pointGeometry(0, 0);\n          var a = 0;\n          for (var _e455 in r) {\n            var _t454 = r[_e455],\n              _i301 = this._touches[_e455];\n            _i301 && (n._add(_t454), s._add(_t454.sub(_i301)), a++, r[_e455] = _t454);\n          }\n          if (this._touches = r, a < this._minTouches || !s.mag()) return;\n          var l = s.div(a);\n          return this._sum._add(l), this._sum.mag() < this._clickTolerance ? void 0 : {\n            around: n.div(a),\n            panDelta: l\n          };\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {\n          this._enabled = !0, this._map._cooperativeGestures && (this._addTouchPanBlocker(), this._el.classList.add(\"mapboxgl-touch-pan-blocker-override\", \"mapboxgl-scrollable-page\"));\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._enabled = !1, this._map._cooperativeGestures && (clearTimeout(this._alertTimer), this._alertContainer.remove(), this._el.classList.remove(\"mapboxgl-touch-pan-blocker-override\", \"mapboxgl-scrollable-page\")), this.reset();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return !!this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return !!this._active;\n        }\n      }, {\n        key: \"_addTouchPanBlocker\",\n        value: function _addTouchPanBlocker() {\n          this._map && !this._alertContainer && (this._alertContainer = n(\"div\", \"mapboxgl-touch-pan-blocker\", this._map._container), this._alertContainer.textContent = this._map._getUIString(\"TouchPanBlocker.Message\"), this._alertContainer.style.fontSize = \"\".concat(Math.max(10, Math.min(24, Math.floor(.05 * this._el.clientWidth))), \"px\"));\n        }\n      }, {\n        key: \"_showTouchPanBlockerAlert\",\n        value: function _showTouchPanBlockerAlert() {\n          var _this126 = this;\n          this._alertContainer.style.visibility = \"visible\", this._alertContainer.classList.add(\"mapboxgl-touch-pan-blocker-show\"), this._alertContainer.setAttribute(\"role\", \"alert\"), clearTimeout(this._alertTimer), this._alertTimer = setTimeout(function () {\n            _this126._alertContainer.classList.remove(\"mapboxgl-touch-pan-blocker-show\"), _this126._alertContainer.setAttribute(\"role\", \"null\");\n          }, 500);\n        }\n      }]);\n      return Er;\n    }();\n    var Cr = /*#__PURE__*/function () {\n      function Cr() {\n        _classCallCheck(this, Cr);\n        this.reset();\n      }\n      _createClass(Cr, [{\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1, this._firstTwoTouches = void 0;\n        }\n      }, {\n        key: \"_start\",\n        value: function _start(e) {}\n      }, {\n        key: \"_move\",\n        value: function _move(e, t, i) {\n          return {};\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(e, t, i) {\n          this._firstTwoTouches || i.length < 2 || (this._firstTwoTouches = [i[0].identifier, i[1].identifier], this._start([t[0], t[1]]));\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(e, t, i) {\n          var o = this._firstTwoTouches;\n          if (!o) return;\n          e.preventDefault();\n          var _o166 = _slicedToArray(o, 2),\n            r = _o166[0],\n            n = _o166[1],\n            s = Mr(i, t, r),\n            a = Mr(i, t, n);\n          if (!s || !a) return;\n          var l = this._aroundCenter ? null : s.add(a).div(2);\n          return this._move([s, a], l, e);\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e, t, i) {\n          if (!this._firstTwoTouches) return;\n          var _this$_firstTwoTouche = _slicedToArray(this._firstTwoTouches, 2),\n            o = _this$_firstTwoTouche[0],\n            r = _this$_firstTwoTouche[1],\n            n = Mr(i, t, o),\n            s = Mr(i, t, r);\n          n && s || (this._active && d(), this.reset());\n        }\n      }, {\n        key: \"touchcancel\",\n        value: function touchcancel() {\n          this.reset();\n        }\n      }, {\n        key: \"enable\",\n        value: function enable(e) {\n          this._enabled = !0, this._aroundCenter = !!e && \"center\" === e.around;\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._enabled = !1, this.reset();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._active;\n        }\n      }]);\n      return Cr;\n    }();\n    function Mr(e, t, i) {\n      for (var _o167 = 0; _o167 < e.length; _o167++) if (e[_o167].identifier === i) return t[_o167];\n    }\n    function Ir(e, t) {\n      return Math.log(e / t) / Math.LN2;\n    }\n    var Sr = /*#__PURE__*/function (_Cr) {\n      _inherits(Sr, _Cr);\n      function Sr() {\n        _classCallCheck(this, Sr);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Sr).apply(this, arguments));\n      }\n      _createClass(Sr, [{\n        key: \"reset\",\n        value: function reset() {\n          _get(_getPrototypeOf(Sr.prototype), \"reset\", this).call(this), this._distance = 0, this._startDistance = 0;\n        }\n      }, {\n        key: \"_start\",\n        value: function _start(e) {\n          this._startDistance = this._distance = e[0].dist(e[1]);\n        }\n      }, {\n        key: \"_move\",\n        value: function _move(e, t) {\n          var i = this._distance;\n          if (this._distance = e[0].dist(e[1]), this._active || !(Math.abs(Ir(this._distance, this._startDistance)) < .1)) return this._active = !0, {\n            zoomDelta: Ir(this._distance, i),\n            pinchAround: t\n          };\n        }\n      }]);\n      return Sr;\n    }(Cr);\n    function Dr(e, t) {\n      return 180 * e.angleWith(t) / Math.PI;\n    }\n    var Lr = /*#__PURE__*/function (_Cr2) {\n      _inherits(Lr, _Cr2);\n      function Lr() {\n        _classCallCheck(this, Lr);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Lr).apply(this, arguments));\n      }\n      _createClass(Lr, [{\n        key: \"reset\",\n        value: function reset() {\n          _get(_getPrototypeOf(Lr.prototype), \"reset\", this).call(this), this._minDiameter = 0, this._startVector = void 0, this._vector = void 0;\n        }\n      }, {\n        key: \"_start\",\n        value: function _start(e) {\n          this._startVector = this._vector = e[0].sub(e[1]), this._minDiameter = e[0].dist(e[1]);\n        }\n      }, {\n        key: \"_move\",\n        value: function _move(e, t) {\n          var i = this._vector;\n          if (this._vector = e[0].sub(e[1]), i && (this._active || !this._isBelowThreshold(this._vector))) return this._active = !0, {\n            bearingDelta: Dr(this._vector, i),\n            pinchAround: t\n          };\n        }\n      }, {\n        key: \"_isBelowThreshold\",\n        value: function _isBelowThreshold(e) {\n          this._minDiameter = Math.min(this._minDiameter, e.mag());\n          var t = 25 / (Math.PI * this._minDiameter) * 360,\n            i = this._startVector;\n          if (!i) return !1;\n          var o = Dr(e, i);\n          return Math.abs(o) < t;\n        }\n      }]);\n      return Lr;\n    }(Cr);\n    function Ar(e) {\n      return Math.abs(e.y) > Math.abs(e.x);\n    }\n    var zr = /*#__PURE__*/function (_Cr3) {\n      _inherits(zr, _Cr3);\n      function zr(e) {\n        var _this127;\n        _classCallCheck(this, zr);\n        _this127 = _possibleConstructorReturn(this, _getPrototypeOf(zr).call(this)), _this127._map = e;\n        return _this127;\n      }\n      _createClass(zr, [{\n        key: \"reset\",\n        value: function reset() {\n          _get(_getPrototypeOf(zr.prototype), \"reset\", this).call(this), this._valid = void 0, this._firstMove = void 0, this._lastPoints = void 0;\n        }\n      }, {\n        key: \"_start\",\n        value: function _start(e) {\n          this._lastPoints = e, Ar(e[0].sub(e[1])) && (this._valid = !1);\n        }\n      }, {\n        key: \"_move\",\n        value: function _move(t, i, o) {\n          var r = this._lastPoints;\n          if (!r) return;\n          var n = t[0].sub(r[0]),\n            s = t[1].sub(r[1]);\n          return this._map._cooperativeGestures && !e.isFullscreen() && o.touches.length < 3 || (this._valid = this.gestureBeginsVertically(n, s, o.timeStamp), !this._valid) ? void 0 : (this._lastPoints = t, this._active = !0, {\n            pitchDelta: (n.y + s.y) / 2 * -.5\n          });\n        }\n      }, {\n        key: \"gestureBeginsVertically\",\n        value: function gestureBeginsVertically(e, t, i) {\n          if (void 0 !== this._valid) return this._valid;\n          var o = e.mag() >= 2,\n            r = t.mag() >= 2;\n          if (!o && !r) return;\n          if (!o || !r) return null == this._firstMove && (this._firstMove = i), i - this._firstMove < 100 && void 0;\n          var n = e.y > 0 == t.y > 0;\n          return Ar(e) && Ar(t) && n;\n        }\n      }]);\n      return zr;\n    }(Cr);\n    var Pr = {\n      panStep: 100,\n      bearingStep: 15,\n      pitchStep: 10\n    };\n    var Rr = /*#__PURE__*/function () {\n      function Rr() {\n        _classCallCheck(this, Rr);\n        var e = Pr;\n        this._panStep = e.panStep, this._bearingStep = e.bearingStep, this._pitchStep = e.pitchStep, this._rotationDisabled = !1;\n      }\n      _createClass(Rr, [{\n        key: \"blur\",\n        value: function blur() {\n          this.reset();\n        }\n      }, {\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1;\n        }\n      }, {\n        key: \"keydown\",\n        value: function keydown(e) {\n          var _this128 = this;\n          if (e.altKey || e.ctrlKey || e.metaKey) return;\n          var t = 0,\n            i = 0,\n            o = 0,\n            r = 0,\n            n = 0;\n          switch (e.keyCode) {\n            case 61:\n            case 107:\n            case 171:\n            case 187:\n              t = 1;\n              break;\n            case 189:\n            case 109:\n            case 173:\n              t = -1;\n              break;\n            case 37:\n              e.shiftKey ? i = -1 : (e.preventDefault(), r = -1);\n              break;\n            case 39:\n              e.shiftKey ? i = 1 : (e.preventDefault(), r = 1);\n              break;\n            case 38:\n              e.shiftKey ? o = 1 : (e.preventDefault(), n = -1);\n              break;\n            case 40:\n              e.shiftKey ? o = -1 : (e.preventDefault(), n = 1);\n              break;\n            default:\n              return;\n          }\n          return this._rotationDisabled && (i = 0, o = 0), {\n            cameraAnimation: function cameraAnimation(s) {\n              var a = s.getZoom();\n              s.easeTo({\n                duration: 300,\n                easeId: \"keyboardHandler\",\n                easing: Or,\n                zoom: t ? Math.round(a) + t * (e.shiftKey ? 2 : 1) : a,\n                bearing: s.getBearing() + i * _this128._bearingStep,\n                pitch: s.getPitch() + o * _this128._pitchStep,\n                offset: [-r * _this128._panStep, -n * _this128._panStep],\n                center: s.getCenter()\n              }, {\n                originalEvent: e\n              });\n            }\n          };\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {\n          this._enabled = !0;\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._enabled = !1, this.reset();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._active;\n        }\n      }, {\n        key: \"disableRotation\",\n        value: function disableRotation() {\n          this._rotationDisabled = !0;\n        }\n      }, {\n        key: \"enableRotation\",\n        value: function enableRotation() {\n          this._rotationDisabled = !1;\n        }\n      }]);\n      return Rr;\n    }();\n    function Or(e) {\n      return e * (2 - e);\n    }\n    var Br = 4.000244140625;\n    var kr = /*#__PURE__*/function () {\n      function kr(t, i) {\n        _classCallCheck(this, kr);\n        this._map = t, this._el = t.getCanvasContainer(), this._handler = i, this._delta = 0, this._defaultZoomRate = .01, this._wheelZoomRate = .0022222222222222222, e.bindAll([\"_onTimeout\", \"_addScrollZoomBlocker\", \"_showBlockerAlert\"], this);\n      }\n      _createClass(kr, [{\n        key: \"setZoomRate\",\n        value: function setZoomRate(e) {\n          this._defaultZoomRate = e;\n        }\n      }, {\n        key: \"setWheelZoomRate\",\n        value: function setWheelZoomRate(e) {\n          this._wheelZoomRate = e;\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return !!this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._active || void 0 !== this._finishTimeout;\n        }\n      }, {\n        key: \"isZooming\",\n        value: function isZooming() {\n          return !!this._zooming;\n        }\n      }, {\n        key: \"enable\",\n        value: function enable(e) {\n          this.isEnabled() || (this._enabled = !0, this._aroundCenter = !!e && \"center\" === e.around, this._map._cooperativeGestures && this._addScrollZoomBlocker());\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this.isEnabled() && (this._enabled = !1, this._map._cooperativeGestures && (clearTimeout(this._alertTimer), this._alertContainer.remove()));\n        }\n      }, {\n        key: \"wheel\",\n        value: function wheel(t) {\n          if (!this.isEnabled()) return;\n          if (this._map._cooperativeGestures) {\n            if (!(t.ctrlKey || t.metaKey || this.isZooming() || e.isFullscreen())) return void this._showBlockerAlert();\n            \"hidden\" !== this._alertContainer.style.visibility && (this._alertContainer.style.visibility = \"hidden\", clearTimeout(this._alertTimer));\n          }\n          var i = t.deltaMode === e.window.WheelEvent.DOM_DELTA_LINE ? 40 * t.deltaY : t.deltaY;\n          var o = e.exported.now(),\n            r = o - (this._lastWheelEventTime || 0);\n          this._lastWheelEventTime = o, 0 !== i && i % Br == 0 ? this._type = \"wheel\" : 0 !== i && Math.abs(i) < 4 ? this._type = \"trackpad\" : r > 400 ? (this._type = null, this._lastValue = i, this._timeout = setTimeout(this._onTimeout, 40, t)) : this._type || (this._type = Math.abs(r * i) < 200 ? \"trackpad\" : \"wheel\", this._timeout && (clearTimeout(this._timeout), this._timeout = null, i += this._lastValue)), t.shiftKey && i && (i /= 4), this._type && (this._lastWheelEvent = t, this._delta -= i, this._active || this._start(t)), t.preventDefault();\n        }\n      }, {\n        key: \"_onTimeout\",\n        value: function _onTimeout(e) {\n          this._type = \"wheel\", this._delta -= this._lastValue, this._active || this._start(e);\n        }\n      }, {\n        key: \"_start\",\n        value: function _start(e) {\n          if (!this._delta) return;\n          this._frameId && (this._frameId = null), this._active = !0, this.isZooming() || (this._zooming = !0), this._finishTimeout && (clearTimeout(this._finishTimeout), delete this._finishTimeout);\n          var t = p(this._el, e);\n          this._aroundPoint = this._aroundCenter ? this._map.transform.centerPoint : t, this._aroundCoord = this._map.transform.pointCoordinate3D(this._aroundPoint), this._targetZoom = void 0, this._frameId || (this._frameId = !0, this._handler._triggerRenderFrame());\n        }\n      }, {\n        key: \"renderFrame\",\n        value: function renderFrame() {\n          var _this129 = this;\n          if (!this._frameId) return;\n          if (this._frameId = null, !this.isActive()) return;\n          var t = this._map.transform;\n          \"wheel\" === this._type && t.projection.wrap && (t._center.lng >= 180 || t._center.lng <= -180) && (this._prevEase = null, this._easing = null, this._lastWheelEvent = null, this._lastWheelEventTime = 0);\n          var i = function i() {\n            return t._terrainEnabled() && _this129._aroundCoord ? t.computeZoomRelativeTo(_this129._aroundCoord) : t.zoom;\n          };\n          if (0 !== this._delta) {\n            var _e456 = \"wheel\" === this._type && Math.abs(this._delta) > Br ? this._wheelZoomRate : this._defaultZoomRate;\n            var _o168 = 2 / (1 + Math.exp(-Math.abs(this._delta * _e456)));\n            this._delta < 0 && 0 !== _o168 && (_o168 = 1 / _o168);\n            var _r300 = i(),\n              _n211 = Math.pow(2, _r300),\n              _s167 = \"number\" == typeof this._targetZoom ? t.zoomScale(this._targetZoom) : _n211;\n            this._targetZoom = Math.min(t.maxZoom, Math.max(t.minZoom, t.scaleZoom(_s167 * _o168))), \"wheel\" === this._type && (this._startZoom = _r300, this._easing = this._smoothOutEasing(200)), this._delta = 0;\n          }\n          var o = \"number\" == typeof this._targetZoom ? this._targetZoom : i(),\n            r = this._startZoom,\n            n = this._easing;\n          var s,\n            a = !1;\n          if (\"wheel\" === this._type && r && n) {\n            var _t455 = Math.min((e.exported.now() - this._lastWheelEventTime) / 200, 1),\n              _i302 = n(_t455);\n            s = e.number(r, o, _i302), _t455 < 1 ? this._frameId || (this._frameId = !0) : a = !0;\n          } else s = o, a = !0;\n          return this._active = !0, a && (this._active = !1, this._finishTimeout = setTimeout(function () {\n            _this129._zooming = !1, _this129._handler._triggerRenderFrame(), delete _this129._targetZoom, delete _this129._finishTimeout;\n          }, 200)), {\n            noInertia: !0,\n            needsRenderFrame: !a,\n            zoomDelta: s - i(),\n            around: this._aroundPoint,\n            aroundCoord: this._aroundCoord,\n            originalEvent: this._lastWheelEvent\n          };\n        }\n      }, {\n        key: \"_smoothOutEasing\",\n        value: function _smoothOutEasing(t) {\n          var i = e.ease;\n          if (this._prevEase) {\n            var _t456 = this._prevEase,\n              _o169 = (e.exported.now() - _t456.start) / _t456.duration,\n              _r301 = _t456.easing(_o169 + .01) - _t456.easing(_o169),\n              _n212 = .27 / Math.sqrt(_r301 * _r301 + 1e-4) * .01,\n              _s168 = Math.sqrt(.0729 - _n212 * _n212);\n            i = e.bezier(_n212, _s168, .25, 1);\n          }\n          return this._prevEase = {\n            start: e.exported.now(),\n            duration: t,\n            easing: i\n          }, i;\n        }\n      }, {\n        key: \"blur\",\n        value: function blur() {\n          this.reset();\n        }\n      }, {\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1;\n        }\n      }, {\n        key: \"_addScrollZoomBlocker\",\n        value: function _addScrollZoomBlocker() {\n          this._map && !this._alertContainer && (this._alertContainer = n(\"div\", \"mapboxgl-scroll-zoom-blocker\", this._map._container), this._alertContainer.textContent = /(Mac|iPad)/i.test(e.window.navigator.userAgent) ? this._map._getUIString(\"ScrollZoomBlocker.CmdMessage\") : this._map._getUIString(\"ScrollZoomBlocker.CtrlMessage\"), this._alertContainer.style.fontSize = \"\".concat(Math.max(10, Math.min(24, Math.floor(.05 * this._el.clientWidth))), \"px\"));\n        }\n      }, {\n        key: \"_showBlockerAlert\",\n        value: function _showBlockerAlert() {\n          var _this130 = this;\n          this._alertContainer.style.visibility = \"visible\", this._alertContainer.classList.add(\"mapboxgl-scroll-zoom-blocker-show\"), this._alertContainer.setAttribute(\"role\", \"alert\"), clearTimeout(this._alertTimer), this._alertTimer = setTimeout(function () {\n            _this130._alertContainer.classList.remove(\"mapboxgl-scroll-zoom-blocker-show\"), _this130._alertContainer.setAttribute(\"role\", \"null\");\n          }, 200);\n        }\n      }]);\n      return kr;\n    }();\n    var Fr = /*#__PURE__*/function () {\n      function Fr(e, t) {\n        _classCallCheck(this, Fr);\n        this._clickZoom = e, this._tapZoom = t;\n      }\n      _createClass(Fr, [{\n        key: \"enable\",\n        value: function enable() {\n          this._clickZoom.enable(), this._tapZoom.enable();\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._clickZoom.disable(), this._tapZoom.disable();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._clickZoom.isEnabled() && this._tapZoom.isEnabled();\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._clickZoom.isActive() || this._tapZoom.isActive();\n        }\n      }]);\n      return Fr;\n    }();\n    var Ur = /*#__PURE__*/function () {\n      function Ur() {\n        _classCallCheck(this, Ur);\n        this.reset();\n      }\n      _createClass(Ur, [{\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1;\n        }\n      }, {\n        key: \"blur\",\n        value: function blur() {\n          this.reset();\n        }\n      }, {\n        key: \"dblclick\",\n        value: function dblclick(e, t) {\n          return e.preventDefault(), {\n            cameraAnimation: function cameraAnimation(i) {\n              i.easeTo({\n                duration: 300,\n                zoom: i.getZoom() + (e.shiftKey ? -1 : 1),\n                around: i.unproject(t)\n              }, {\n                originalEvent: e\n              });\n            }\n          };\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {\n          this._enabled = !0;\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._enabled = !1, this.reset();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._active;\n        }\n      }]);\n      return Ur;\n    }();\n    var Nr = /*#__PURE__*/function () {\n      function Nr() {\n        _classCallCheck(this, Nr);\n        this._tap = new gr({\n          numTouches: 1,\n          numTaps: 1\n        }), this.reset();\n      }\n      _createClass(Nr, [{\n        key: \"reset\",\n        value: function reset() {\n          this._active = !1, this._swipePoint = void 0, this._swipeTouch = 0, this._tapTime = 0, this._tap.reset();\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(e, t, i) {\n          this._swipePoint || (this._tapTime && e.timeStamp - this._tapTime > 500 && this.reset(), this._tapTime ? i.length > 0 && (this._swipePoint = t[0], this._swipeTouch = i[0].identifier) : this._tap.touchstart(e, t, i));\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(e, t, i) {\n          if (this._tapTime) {\n            if (this._swipePoint) {\n              if (i[0].identifier !== this._swipeTouch) return;\n              var _o170 = t[0],\n                _r302 = _o170.y - this._swipePoint.y;\n              return this._swipePoint = _o170, e.preventDefault(), this._active = !0, {\n                zoomDelta: _r302 / 128\n              };\n            }\n          } else this._tap.touchmove(e, t, i);\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e, t, i) {\n          this._tapTime ? this._swipePoint && 0 === i.length && this.reset() : this._tap.touchend(e, t, i) && (this._tapTime = e.timeStamp);\n        }\n      }, {\n        key: \"touchcancel\",\n        value: function touchcancel() {\n          this.reset();\n        }\n      }, {\n        key: \"enable\",\n        value: function enable() {\n          this._enabled = !0;\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._enabled = !1, this.reset();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._enabled;\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._active;\n        }\n      }]);\n      return Nr;\n    }();\n    var Gr = /*#__PURE__*/function () {\n      function Gr(e, t, i) {\n        _classCallCheck(this, Gr);\n        this._el = e, this._mousePan = t, this._touchPan = i;\n      }\n      _createClass(Gr, [{\n        key: \"enable\",\n        value: function enable(e) {\n          this._inertiaOptions = e || {}, this._mousePan.enable(), this._touchPan.enable(), this._el.classList.add(\"mapboxgl-touch-drag-pan\");\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._mousePan.disable(), this._touchPan.disable(), this._el.classList.remove(\"mapboxgl-touch-drag-pan\");\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._mousePan.isEnabled() && this._touchPan.isEnabled();\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._mousePan.isActive() || this._touchPan.isActive();\n        }\n      }]);\n      return Gr;\n    }();\n    var jr = /*#__PURE__*/function () {\n      function jr(e, t, i) {\n        _classCallCheck(this, jr);\n        this._pitchWithRotate = e.pitchWithRotate, this._mouseRotate = t, this._mousePitch = i;\n      }\n      _createClass(jr, [{\n        key: \"enable\",\n        value: function enable() {\n          this._mouseRotate.enable(), this._pitchWithRotate && this._mousePitch.enable();\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._mouseRotate.disable(), this._mousePitch.disable();\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._mouseRotate.isEnabled() && (!this._pitchWithRotate || this._mousePitch.isEnabled());\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._mouseRotate.isActive() || this._mousePitch.isActive();\n        }\n      }]);\n      return jr;\n    }();\n    var Zr = /*#__PURE__*/function () {\n      function Zr(e, t, i, o) {\n        _classCallCheck(this, Zr);\n        this._el = e, this._touchZoom = t, this._touchRotate = i, this._tapDragZoom = o, this._rotationDisabled = !1, this._enabled = !0;\n      }\n      _createClass(Zr, [{\n        key: \"enable\",\n        value: function enable(e) {\n          this._touchZoom.enable(e), this._rotationDisabled || this._touchRotate.enable(e), this._tapDragZoom.enable(), this._el.classList.add(\"mapboxgl-touch-zoom-rotate\");\n        }\n      }, {\n        key: \"disable\",\n        value: function disable() {\n          this._touchZoom.disable(), this._touchRotate.disable(), this._tapDragZoom.disable(), this._el.classList.remove(\"mapboxgl-touch-zoom-rotate\");\n        }\n      }, {\n        key: \"isEnabled\",\n        value: function isEnabled() {\n          return this._touchZoom.isEnabled() && (this._rotationDisabled || this._touchRotate.isEnabled()) && this._tapDragZoom.isEnabled();\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          return this._touchZoom.isActive() || this._touchRotate.isActive() || this._tapDragZoom.isActive();\n        }\n      }, {\n        key: \"disableRotation\",\n        value: function disableRotation() {\n          this._rotationDisabled = !0, this._touchRotate.disable();\n        }\n      }, {\n        key: \"enableRotation\",\n        value: function enableRotation() {\n          this._rotationDisabled = !1, this._touchZoom.isEnabled() && this._touchRotate.enable();\n        }\n      }]);\n      return Zr;\n    }();\n    var Vr = function Vr(e) {\n      return e.zoom || e.drag || e.pitch || e.rotate;\n    };\n    var Wr = /*#__PURE__*/function (_e$Event4) {\n      _inherits(Wr, _e$Event4);\n      function Wr() {\n        _classCallCheck(this, Wr);\n        return _possibleConstructorReturn(this, _getPrototypeOf(Wr).apply(this, arguments));\n      }\n      return Wr;\n    }(e.Event);\n    var Xr = /*#__PURE__*/function () {\n      function Xr() {\n        _classCallCheck(this, Xr);\n        this.constants = [1, 1, .01], this.radius = 0;\n      }\n      _createClass(Xr, [{\n        key: \"setup\",\n        value: function setup(t, i) {\n          var o = e.sub([], i, t);\n          this.radius = e.length(o[2] < 0 ? e.div([], o, this.constants) : [o[0], o[1], 0]);\n        }\n      }, {\n        key: \"projectRay\",\n        value: function projectRay(t) {\n          e.div(t, t, this.constants), e.normalize(t, t), e.mul$1(t, t, this.constants);\n          var i = e.scale$2([], t, this.radius);\n          if (i[2] > 0) {\n            var _t457 = e.scale$2([], [0, 0, 1], e.dot(i, [0, 0, 1])),\n              _o171 = e.scale$2([], e.normalize([], [i[0], i[1], 0]), this.radius),\n              _r303 = e.add([], i, e.scale$2([], e.sub([], e.add([], _o171, _t457), i), 2));\n            i[0] = _r303[0], i[1] = _r303[1];\n          }\n          return i;\n        }\n      }]);\n      return Xr;\n    }();\n    function qr(e) {\n      return e.panDelta && e.panDelta.mag() || e.zoomDelta || e.bearingDelta || e.pitchDelta;\n    }\n    var $r = /*#__PURE__*/function () {\n      function $r(t, i) {\n        _classCallCheck(this, $r);\n        this._map = t, this._el = this._map.getCanvasContainer(), this._handlers = [], this._handlersById = {}, this._changes = [], this._inertia = new sr(t), this._bearingSnap = i.bearingSnap, this._previousActiveHandlers = {}, this._trackingEllipsoid = new Xr(), this._dragOrigin = null, this._eventsInProgress = {}, this._addDefaultHandlers(i), e.bindAll([\"handleEvent\", \"handleWindowEvent\"], this);\n        var o = this._el;\n        this._listeners = [[o, \"touchstart\", {\n          passive: !0\n        }], [o, \"touchmove\", {\n          passive: !1\n        }], [o, \"touchend\", void 0], [o, \"touchcancel\", void 0], [o, \"mousedown\", void 0], [o, \"mousemove\", void 0], [o, \"mouseup\", void 0], [e.window.document, \"mousemove\", {\n          capture: !0\n        }], [e.window.document, \"mouseup\", void 0], [o, \"mouseover\", void 0], [o, \"mouseout\", void 0], [o, \"dblclick\", void 0], [o, \"click\", void 0], [o, \"keydown\", {\n          capture: !1\n        }], [o, \"keyup\", void 0], [o, \"wheel\", {\n          passive: !1\n        }], [o, \"contextmenu\", void 0], [e.window, \"blur\", void 0]];\n        var _iterator274 = _createForOfIteratorHelper(this._listeners),\n          _step274;\n        try {\n          for (_iterator274.s(); !(_step274 = _iterator274.n()).done;) {\n            var _step274$value = _slicedToArray(_step274.value, 3),\n              _t458 = _step274$value[0],\n              _i303 = _step274$value[1],\n              _o172 = _step274$value[2];\n            _t458.addEventListener(_i303, _t458 === e.window.document ? this.handleWindowEvent : this.handleEvent, _o172);\n          }\n        } catch (err) {\n          _iterator274.e(err);\n        } finally {\n          _iterator274.f();\n        }\n      }\n      _createClass($r, [{\n        key: \"destroy\",\n        value: function destroy() {\n          var _iterator275 = _createForOfIteratorHelper(this._listeners),\n            _step275;\n          try {\n            for (_iterator275.s(); !(_step275 = _iterator275.n()).done;) {\n              var _step275$value = _slicedToArray(_step275.value, 3),\n                _t459 = _step275$value[0],\n                _i304 = _step275$value[1],\n                _o173 = _step275$value[2];\n              _t459.removeEventListener(_i304, _t459 === e.window.document ? this.handleWindowEvent : this.handleEvent, _o173);\n            }\n          } catch (err) {\n            _iterator275.e(err);\n          } finally {\n            _iterator275.f();\n          }\n        }\n      }, {\n        key: \"_addDefaultHandlers\",\n        value: function _addDefaultHandlers(e) {\n          var t = this._map,\n            i = t.getCanvasContainer();\n          this._add(\"mapEvent\", new _r(t, e));\n          var o = t.boxZoom = new pr(t, e);\n          this._add(\"boxZoom\", o);\n          var r = new vr(),\n            n = new Ur();\n          t.doubleClickZoom = new Fr(n, r), this._add(\"tapZoom\", r), this._add(\"clickZoom\", n);\n          var s = new Nr();\n          this._add(\"tapDragZoom\", s);\n          var a = t.touchPitch = new zr(t);\n          this._add(\"touchPitch\", a);\n          var l = new wr(e),\n            c = new Tr(e);\n          t.dragRotate = new jr(e, l, c), this._add(\"mouseRotate\", l, [\"mousePitch\"]), this._add(\"mousePitch\", c, [\"mouseRotate\"]);\n          var h = new br(e),\n            u = new Er(t, e);\n          t.dragPan = new Gr(i, h, u), this._add(\"mousePan\", h), this._add(\"touchPan\", u, [\"touchZoom\", \"touchRotate\"]);\n          var _ = new Lr(),\n            d = new Sr();\n          t.touchZoomRotate = new Zr(i, d, _, s), this._add(\"touchRotate\", _, [\"touchPan\", \"touchZoom\"]), this._add(\"touchZoom\", d, [\"touchPan\", \"touchRotate\"]), this._add(\"blockableMapEvent\", new dr(t));\n          var p = t.scrollZoom = new kr(t, this);\n          this._add(\"scrollZoom\", p, [\"mousePan\"]);\n          var m = t.keyboard = new Rr();\n          this._add(\"keyboard\", m);\n          for (var _i305 = 0, _arr5 = [\"boxZoom\", \"doubleClickZoom\", \"tapDragZoom\", \"touchPitch\", \"dragRotate\", \"dragPan\", \"touchZoomRotate\", \"scrollZoom\", \"keyboard\"]; _i305 < _arr5.length; _i305++) {\n            var _i306 = _arr5[_i305];\n            e.interactive && e[_i306] && t[_i306].enable(e[_i306]);\n          }\n        }\n      }, {\n        key: \"_add\",\n        value: function _add(e, t, i) {\n          this._handlers.push({\n            handlerName: e,\n            handler: t,\n            allowed: i\n          }), this._handlersById[e] = t;\n        }\n      }, {\n        key: \"stop\",\n        value: function stop(e) {\n          if (!this._updatingCamera) {\n            var _iterator276 = _createForOfIteratorHelper(this._handlers),\n              _step276;\n            try {\n              for (_iterator276.s(); !(_step276 = _iterator276.n()).done;) {\n                var _e457 = _step276.value.handler;\n                _e457.reset();\n              }\n            } catch (err) {\n              _iterator276.e(err);\n            } finally {\n              _iterator276.f();\n            }\n            this._inertia.clear(), this._fireEvents({}, {}, e), this._changes = [];\n          }\n        }\n      }, {\n        key: \"isActive\",\n        value: function isActive() {\n          var _iterator277 = _createForOfIteratorHelper(this._handlers),\n            _step277;\n          try {\n            for (_iterator277.s(); !(_step277 = _iterator277.n()).done;) {\n              var _e458 = _step277.value.handler;\n              if (_e458.isActive()) return !0;\n            }\n          } catch (err) {\n            _iterator277.e(err);\n          } finally {\n            _iterator277.f();\n          }\n          return !1;\n        }\n      }, {\n        key: \"isZooming\",\n        value: function isZooming() {\n          return !!this._eventsInProgress.zoom || this._map.scrollZoom.isZooming();\n        }\n      }, {\n        key: \"isRotating\",\n        value: function isRotating() {\n          return !!this._eventsInProgress.rotate;\n        }\n      }, {\n        key: \"isMoving\",\n        value: function isMoving() {\n          return !!Vr(this._eventsInProgress) || this.isZooming();\n        }\n      }, {\n        key: \"_isDragging\",\n        value: function _isDragging() {\n          return !!this._eventsInProgress.drag;\n        }\n      }, {\n        key: \"_blockedByActive\",\n        value: function _blockedByActive(e, t, i) {\n          for (var _o174 in e) if (_o174 !== i && (!t || t.indexOf(_o174) < 0)) return !0;\n          return !1;\n        }\n      }, {\n        key: \"handleWindowEvent\",\n        value: function handleWindowEvent(e) {\n          this.handleEvent(e, \"\".concat(e.type, \"Window\"));\n        }\n      }, {\n        key: \"_getMapTouches\",\n        value: function _getMapTouches(e) {\n          var t = [];\n          var _iterator278 = _createForOfIteratorHelper(e),\n            _step278;\n          try {\n            for (_iterator278.s(); !(_step278 = _iterator278.n()).done;) {\n              var _i307 = _step278.value;\n              this._el.contains(_i307.target) && t.push(_i307);\n            }\n          } catch (err) {\n            _iterator278.e(err);\n          } finally {\n            _iterator278.f();\n          }\n          return t;\n        }\n      }, {\n        key: \"handleEvent\",\n        value: function handleEvent(e, t) {\n          this._updatingCamera = !0;\n          var i = \"renderFrame\" === e.type,\n            o = i ? void 0 : e,\n            r = {\n              needsRenderFrame: !1\n            },\n            n = {},\n            s = {},\n            a = e.touches ? this._getMapTouches(e.touches) : void 0,\n            l = a ? m(this._el, a) : i ? void 0 : p(this._el, e);\n          var _iterator279 = _createForOfIteratorHelper(this._handlers),\n            _step279;\n          try {\n            for (_iterator279.s(); !(_step279 = _iterator279.n()).done;) {\n              var _step279$value = _step279.value,\n                _i308 = _step279$value.handlerName,\n                _c71 = _step279$value.handler,\n                _h50 = _step279$value.allowed;\n              if (!_c71.isEnabled()) continue;\n              var _u67 = void 0;\n              this._blockedByActive(s, _h50, _i308) ? _c71.reset() : _c71[t || e.type] && (_u67 = _c71[t || e.type](e, l, a), this.mergeHandlerResult(r, n, _u67, _i308, o), _u67 && _u67.needsRenderFrame && this._triggerRenderFrame()), (_u67 || _c71.isActive()) && (s[_i308] = _c71);\n            }\n          } catch (err) {\n            _iterator279.e(err);\n          } finally {\n            _iterator279.f();\n          }\n          var c = {};\n          for (var _e459 in this._previousActiveHandlers) s[_e459] || (c[_e459] = o);\n          this._previousActiveHandlers = s, (Object.keys(c).length || qr(r)) && (this._changes.push([r, n, c]), this._triggerRenderFrame()), (Object.keys(s).length || qr(r)) && this._map._stop(!0), this._updatingCamera = !1;\n          var h = r.cameraAnimation;\n          h && (this._inertia.clear(), this._fireEvents({}, {}, !0), this._changes = [], h(this._map));\n        }\n      }, {\n        key: \"mergeHandlerResult\",\n        value: function mergeHandlerResult(t, i, o, r, n) {\n          if (!o) return;\n          e.extend(t, o);\n          var s = {\n            handlerName: r,\n            originalEvent: o.originalEvent || n\n          };\n          void 0 !== o.zoomDelta && (i.zoom = s), void 0 !== o.panDelta && (i.drag = s), void 0 !== o.pitchDelta && (i.pitch = s), void 0 !== o.bearingDelta && (i.rotate = s);\n        }\n      }, {\n        key: \"_applyChanges\",\n        value: function _applyChanges() {\n          var t = {},\n            i = {},\n            o = {};\n          var _iterator280 = _createForOfIteratorHelper(this._changes),\n            _step280;\n          try {\n            for (_iterator280.s(); !(_step280 = _iterator280.n()).done;) {\n              var _step280$value = _slicedToArray(_step280.value, 3),\n                _r304 = _step280$value[0],\n                _n213 = _step280$value[1],\n                _s169 = _step280$value[2];\n              _r304.panDelta && (t.panDelta = (t.panDelta || new e.pointGeometry(0, 0))._add(_r304.panDelta)), _r304.zoomDelta && (t.zoomDelta = (t.zoomDelta || 0) + _r304.zoomDelta), _r304.bearingDelta && (t.bearingDelta = (t.bearingDelta || 0) + _r304.bearingDelta), _r304.pitchDelta && (t.pitchDelta = (t.pitchDelta || 0) + _r304.pitchDelta), void 0 !== _r304.around && (t.around = _r304.around), void 0 !== _r304.aroundCoord && (t.aroundCoord = _r304.aroundCoord), void 0 !== _r304.pinchAround && (t.pinchAround = _r304.pinchAround), _r304.noInertia && (t.noInertia = _r304.noInertia), e.extend(i, _n213), e.extend(o, _s169);\n            }\n          } catch (err) {\n            _iterator280.e(err);\n          } finally {\n            _iterator280.f();\n          }\n          this._updateMapTransform(t, i, o), this._changes = [];\n        }\n      }, {\n        key: \"_updateMapTransform\",\n        value: function _updateMapTransform(t, i, o) {\n          var _this131 = this;\n          var r = this._map,\n            n = r.transform,\n            s = function s(e) {\n              return [e.x, e.y, e.z];\n            };\n          if (function (e) {\n            var t = _this131._eventsInProgress.drag;\n            return t && !_this131._handlersById[t.handlerName].isActive();\n          }() && !qr(t)) {\n            var _e460 = n.zoom;\n            n.cameraElevationReference = \"sea\", n.recenterOnTerrain(), n.cameraElevationReference = \"ground\", _e460 !== n.zoom && this._map._update(!0);\n          }\n          if (n._isCameraConstrained && r._stop(!0), !qr(t)) return void this._fireEvents(i, o, !0);\n          var a = t.panDelta,\n            l = t.zoomDelta,\n            c = t.bearingDelta,\n            h = t.pitchDelta,\n            u = t.around,\n            _ = t.aroundCoord,\n            d = t.pinchAround;\n          n._isCameraConstrained && (l > 0 && (l = 0), n._isCameraConstrained = !1), void 0 !== d && (u = d), (l || function (e) {\n            return i.drag && !_this131._eventsInProgress.drag;\n          }()) && u && (this._dragOrigin = s(n.pointCoordinate3D(u)), this._trackingEllipsoid.setup(n._camera.position, this._dragOrigin)), n.cameraElevationReference = \"sea\", r._stop(!0), u = u || r.transform.centerPoint, c && (n.bearing += c), h && (n.pitch += h), n._updateCameraState();\n          var p = [0, 0, 0];\n          if (a) if (\"mercator\" === n.projection.name) {\n            var _e461 = this._trackingEllipsoid.projectRay(n.screenPointToMercatorRay(u).dir),\n              _t460 = this._trackingEllipsoid.projectRay(n.screenPointToMercatorRay(u.sub(a)).dir);\n            p[0] = _t460[0] - _e461[0], p[1] = _t460[1] - _e461[1];\n          } else {\n            var _t461 = n.pointCoordinate(u);\n            if (\"globe\" === n.projection.name) {\n              a = a.rotate(-n.angle);\n              var _i309 = n._pixelsPerMercatorPixel / n.worldSize;\n              p[0] = -a.x * e.mercatorScale(e.latFromMercatorY(_t461.y)) * _i309, p[1] = -a.y * e.mercatorScale(n.center.lat) * _i309;\n            } else {\n              var _e462 = n.pointCoordinate(u.sub(a));\n              _t461 && _e462 && (p[0] = _e462.x - _t461.x, p[1] = _e462.y - _t461.y);\n            }\n          }\n          var m = n.zoom,\n            f = [0, 0, 0];\n          if (l) {\n            var _t462 = s(_ || n.pointCoordinate3D(u)),\n              _i310 = {\n                dir: e.normalize([], e.sub([], _t462, n._camera.position))\n              };\n            if (_i310.dir[2] < 0) {\n              var _o175 = n.zoomDeltaToMovement(_t462, l);\n              e.scale$2(f, _i310.dir, _o175);\n            }\n          }\n          var g = e.add(p, p, f);\n          n._translateCameraConstrained(g), l && Math.abs(n.zoom - m) > 1e-4 && n.recenterOnTerrain(), n.cameraElevationReference = \"ground\", this._map._update(), t.noInertia || this._inertia.record(t), this._fireEvents(i, o, !0);\n        }\n      }, {\n        key: \"_fireEvents\",\n        value: function _fireEvents(t, i, o) {\n          var _this132 = this;\n          var r = Vr(this._eventsInProgress),\n            n = Vr(t),\n            s = {};\n          for (var _e463 in t) {\n            var _i311 = t[_e463].originalEvent;\n            this._eventsInProgress[_e463] || (s[\"\".concat(_e463, \"start\")] = _i311), this._eventsInProgress[_e463] = t[_e463];\n          }\n          !r && n && this._fireEvent(\"movestart\", n.originalEvent);\n          for (var _e464 in s) this._fireEvent(_e464, s[_e464]);\n          n && this._fireEvent(\"move\", n.originalEvent);\n          for (var _e465 in t) {\n            var _i312 = t[_e465].originalEvent;\n            this._fireEvent(_e465, _i312);\n          }\n          var a = {};\n          var l;\n          for (var _e466 in this._eventsInProgress) {\n            var _this$_eventsInProgre = this._eventsInProgress[_e466],\n              _t463 = _this$_eventsInProgre.handlerName,\n              _o176 = _this$_eventsInProgre.originalEvent;\n            this._handlersById[_t463].isActive() || (delete this._eventsInProgress[_e466], l = i[_t463] || _o176, a[\"\".concat(_e466, \"end\")] = l);\n          }\n          for (var _e467 in a) this._fireEvent(_e467, a[_e467]);\n          var c = Vr(this._eventsInProgress);\n          if (o && (r || n) && !c) {\n            this._updatingCamera = !0;\n            var _t464 = this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),\n              _i313 = function _i313(e) {\n                return 0 !== e && -_this132._bearingSnap < e && e < _this132._bearingSnap;\n              };\n            _t464 ? (_i313(_t464.bearing || this._map.getBearing()) && (_t464.bearing = 0), this._map.easeTo(_t464, {\n              originalEvent: l\n            })) : (this._map.fire(new e.Event(\"moveend\", {\n              originalEvent: l\n            })), _i313(this._map.getBearing()) && this._map.resetNorth()), this._updatingCamera = !1;\n          }\n        }\n      }, {\n        key: \"_fireEvent\",\n        value: function _fireEvent(t, i) {\n          this._map.fire(new e.Event(t, i ? {\n            originalEvent: i\n          } : {}));\n        }\n      }, {\n        key: \"_requestFrame\",\n        value: function _requestFrame() {\n          var _this133 = this;\n          return this._map.triggerRepaint(), this._map._renderTaskQueue.add(function (e) {\n            _this133._frameId = void 0, _this133.handleEvent(new Wr(\"renderFrame\", {\n              timeStamp: e\n            })), _this133._applyChanges();\n          });\n        }\n      }, {\n        key: \"_triggerRenderFrame\",\n        value: function _triggerRenderFrame() {\n          void 0 === this._frameId && (this._frameId = this._requestFrame());\n        }\n      }]);\n      return $r;\n    }();\n    var Hr = \"map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.\";\n    var Yr = /*#__PURE__*/function (_e$Evented11) {\n      _inherits(Yr, _e$Evented11);\n      function Yr(t, i) {\n        var _this134;\n        _classCallCheck(this, Yr);\n        _this134 = _possibleConstructorReturn(this, _getPrototypeOf(Yr).call(this)), _this134._moving = !1, _this134._zooming = !1, _this134.transform = t, _this134._bearingSnap = i.bearingSnap, e.bindAll([\"_renderFrameCallback\"], _assertThisInitialized(_assertThisInitialized(_this134)));\n        return _this134;\n      }\n      _createClass(Yr, [{\n        key: \"getCenter\",\n        value: function getCenter() {\n          return new e.LngLat(this.transform.center.lng, this.transform.center.lat);\n        }\n      }, {\n        key: \"setCenter\",\n        value: function setCenter(e, t) {\n          return this.jumpTo({\n            center: e\n          }, t);\n        }\n      }, {\n        key: \"panBy\",\n        value: function panBy(t, i, o) {\n          return t = e.pointGeometry.convert(t).mult(-1), this.panTo(this.transform.center, e.extend({\n            offset: t\n          }, i), o);\n        }\n      }, {\n        key: \"panTo\",\n        value: function panTo(t, i, o) {\n          return this.easeTo(e.extend({\n            center: t\n          }, i), o);\n        }\n      }, {\n        key: \"getZoom\",\n        value: function getZoom() {\n          return this.transform.zoom;\n        }\n      }, {\n        key: \"setZoom\",\n        value: function setZoom(e, t) {\n          return this.jumpTo({\n            zoom: e\n          }, t), this;\n        }\n      }, {\n        key: \"zoomTo\",\n        value: function zoomTo(t, i, o) {\n          return this.easeTo(e.extend({\n            zoom: t\n          }, i), o);\n        }\n      }, {\n        key: \"zoomIn\",\n        value: function zoomIn(e, t) {\n          return this.zoomTo(this.getZoom() + 1, e, t), this;\n        }\n      }, {\n        key: \"zoomOut\",\n        value: function zoomOut(e, t) {\n          return this.zoomTo(this.getZoom() - 1, e, t), this;\n        }\n      }, {\n        key: \"getBearing\",\n        value: function getBearing() {\n          return this.transform.bearing;\n        }\n      }, {\n        key: \"setBearing\",\n        value: function setBearing(e, t) {\n          return this.jumpTo({\n            bearing: e\n          }, t), this;\n        }\n      }, {\n        key: \"getPadding\",\n        value: function getPadding() {\n          return this.transform.padding;\n        }\n      }, {\n        key: \"setPadding\",\n        value: function setPadding(e, t) {\n          return this.jumpTo({\n            padding: e\n          }, t), this;\n        }\n      }, {\n        key: \"rotateTo\",\n        value: function rotateTo(t, i, o) {\n          return this.easeTo(e.extend({\n            bearing: t\n          }, i), o);\n        }\n      }, {\n        key: \"resetNorth\",\n        value: function resetNorth(t, i) {\n          return this.rotateTo(0, e.extend({\n            duration: 1e3\n          }, t), i), this;\n        }\n      }, {\n        key: \"resetNorthPitch\",\n        value: function resetNorthPitch(t, i) {\n          return this.easeTo(e.extend({\n            bearing: 0,\n            pitch: 0,\n            duration: 1e3\n          }, t), i), this;\n        }\n      }, {\n        key: \"snapToNorth\",\n        value: function snapToNorth(e, t) {\n          return Math.abs(this.getBearing()) < this._bearingSnap ? this.resetNorth(e, t) : this;\n        }\n      }, {\n        key: \"getPitch\",\n        value: function getPitch() {\n          return this.transform.pitch;\n        }\n      }, {\n        key: \"setPitch\",\n        value: function setPitch(e, t) {\n          return this.jumpTo({\n            pitch: e\n          }, t), this;\n        }\n      }, {\n        key: \"cameraForBounds\",\n        value: function cameraForBounds(t, i) {\n          t = e.LngLatBounds.convert(t);\n          var o = i && i.bearing || 0,\n            r = i && i.pitch || 0,\n            n = t.getNorthWest(),\n            s = t.getSouthEast();\n          return this._cameraForBounds(this.transform, n, s, o, r, i);\n        }\n      }, {\n        key: \"_extendCameraOptions\",\n        value: function _extendCameraOptions(t) {\n          var i = {\n            top: 0,\n            bottom: 0,\n            right: 0,\n            left: 0\n          };\n          if (\"number\" == typeof (t = e.extend({\n            padding: i,\n            offset: [0, 0],\n            maxZoom: this.transform.maxZoom\n          }, t)).padding) {\n            var _e468 = t.padding;\n            t.padding = {\n              top: _e468,\n              bottom: _e468,\n              right: _e468,\n              left: _e468\n            };\n          }\n          return t.padding = e.extend(i, t.padding), t;\n        }\n      }, {\n        key: \"_minimumAABBFrustumDistance\",\n        value: function _minimumAABBFrustumDistance(e, t) {\n          var i = t.max[0] - t.min[0],\n            o = t.max[1] - t.min[1];\n          return i / o > e.aspect ? i / (2 * Math.tan(.5 * e.fovX) * e.aspect) : o / (2 * Math.tan(.5 * e.fovY) * e.aspect);\n        }\n      }, {\n        key: \"_cameraForBoundsOnGlobe\",\n        value: function _cameraForBoundsOnGlobe(t, i, o, r, n, s) {\n          var a = t.clone(),\n            l = this._extendCameraOptions(s);\n          a.bearing = r, a.pitch = n;\n          var c = e.LngLat.convert(i),\n            h = e.LngLat.convert(o),\n            u = .5 * (c.lat + h.lat),\n            _ = .5 * (c.lng + h.lng),\n            d = e.latLngToECEF(u, _),\n            p = e.normalize([], d),\n            m = e.normalize([], e.cross([], p, [0, 1, 0])),\n            f = e.cross([], m, p),\n            g = [m[0], m[1], m[2], 0, f[0], f[1], f[2], 0, p[0], p[1], p[2], 0, 0, 0, 0, 1],\n            v = [d, e.latLngToECEF(c.lat, c.lng), e.latLngToECEF(h.lat, c.lng), e.latLngToECEF(h.lat, h.lng), e.latLngToECEF(c.lat, h.lng), e.latLngToECEF(u, c.lng), e.latLngToECEF(u, h.lng), e.latLngToECEF(c.lat, _), e.latLngToECEF(h.lat, _)];\n          var x = e.Aabb.fromPoints(v.map(function (t) {\n            return [e.dot(m, t), e.dot(f, t), e.dot(p, t)];\n          }));\n          var y = e.transformMat4([], x.center, g);\n          0 === e.squaredLength(y) && e.set(y, 0, 0, 1), e.normalize(y, y), e.scale$2(y, y, e.GLOBE_RADIUS), a.center = e.ecefToLatLng(y);\n          var b = a.getWorldToCameraMatrix(),\n            w = e.invert(new Float64Array(16), b);\n          x = e.Aabb.applyTransform(x, e.multiply([], b, g)), e.transformMat4(y, y, b);\n          var T = .5 * (x.max[2] - x.min[2]),\n            E = this._minimumAABBFrustumDistance(a, x),\n            C = e.scale$2([], [0, 0, 1], T),\n            M = e.add(C, y, C),\n            I = E + (0 === a.pitch ? 0 : e.distance(y, M)),\n            S = a.globeCenterInViewSpace,\n            D = e.sub([], y, [S[0], S[1], S[2]]);\n          e.normalize(D, D), e.scale$2(D, D, I);\n          var L = e.add([], y, D);\n          e.transformMat4(L, L, w);\n          var A = e.earthRadius / e.GLOBE_RADIUS,\n            z = e.length(L),\n            P = e.mercatorZfromAltitude(Math.max(z * A - e.earthRadius, Number.EPSILON), 0),\n            R = Math.min(a.zoomFromMercatorZAdjusted(P), l.maxZoom);\n          return R > .5 * (e.GLOBE_ZOOM_THRESHOLD_MIN + e.GLOBE_ZOOM_THRESHOLD_MAX) ? (a.setProjection({\n            name: \"mercator\"\n          }), a.zoom = R, this._cameraForBounds(a, i, o, r, n, s)) : {\n            center: a.center,\n            zoom: R,\n            bearing: r,\n            pitch: n\n          };\n        }\n      }, {\n        key: \"queryTerrainElevation\",\n        value: function queryTerrainElevation(t, i) {\n          var o = this.transform.elevation;\n          return o ? (i = e.extend({}, {\n            exaggerated: !0\n          }, i), o.getAtPoint(e.MercatorCoordinate.fromLngLat(t), null, i.exaggerated)) : null;\n        }\n      }, {\n        key: \"_cameraForBounds\",\n        value: function _cameraForBounds(t, i, o, r, n, s) {\n          if (\"globe\" === t.projection.name) return this._cameraForBoundsOnGlobe(t, i, o, r, n, s);\n          var a = t.clone(),\n            l = this._extendCameraOptions(s),\n            c = a.padding;\n          a.bearing = r, a.pitch = n;\n          var h = e.LngLat.convert(i),\n            u = e.LngLat.convert(o),\n            _ = new e.LngLat(h.lng, u.lat),\n            d = new e.LngLat(u.lng, h.lat),\n            p = a.project(h),\n            m = a.project(u),\n            f = this.queryTerrainElevation(h),\n            g = this.queryTerrainElevation(u),\n            v = this.queryTerrainElevation(_),\n            x = this.queryTerrainElevation(d),\n            y = [[p.x, p.y, Math.min(f || 0, g || 0, v || 0, x || 0)], [m.x, m.y, Math.max(f || 0, g || 0, v || 0, x || 0)]];\n          var b = e.Aabb.fromPoints(y);\n          var w = a.getWorldToCameraMatrix(),\n            T = e.invert(new Float64Array(16), w);\n          b = e.Aabb.applyTransform(b, w);\n          var E = e.sub([], b.max, b.min),\n            C = c.left || 0,\n            M = c.right || 0,\n            I = c.bottom || 0,\n            S = c.top || 0,\n            _l$padding = l.padding,\n            D = _l$padding.left,\n            L = _l$padding.right,\n            A = _l$padding.top,\n            z = _l$padding.bottom,\n            P = .5 * (C + M),\n            R = .5 * (S + I),\n            O = Math.min(a.scaleZoom(a.scale * Math.min((a.width - (C + M + D + L)) / E[0], (a.height - (I + S + z + A)) / E[1])), l.maxZoom),\n            B = a.scale / a.zoomScale(O);\n          b = new e.Aabb([b.min[0] - (D + P) * B, b.min[1] - (z + R) * B, b.min[2]], [b.max[0] + (L + P) * B, b.max[1] + (A + R) * B, b.max[2]]);\n          var k = .5 * E[2],\n            F = this._minimumAABBFrustumDistance(a, b),\n            U = [0, 0, 1, 0];\n          e.transformMat4$1(U, U, w), e.normalize$2(U, U);\n          var N = e.scale$2([], U, F + k),\n            G = e.add([], b.center, N),\n            j = (\"number\" == typeof l.offset.x && \"number\" == typeof l.offset.y ? new e.pointGeometry(l.offset.x, l.offset.y) : e.pointGeometry.convert(l.offset)).rotate(-e.degToRad(r));\n          b.center[0] -= j.x * B, b.center[1] += j.y * B, e.transformMat4(b.center, b.center, T), e.transformMat4(G, G, T);\n          var Z = [b.center[0], b.center[1], G[2] * a.pixelsPerMeter];\n          e.scale$2(Z, Z, 1 / a.worldSize);\n          var V = e.lngFromMercatorX(Z[0]),\n            W = e.latFromMercatorY(Z[1]),\n            X = Math.min(a._zoomFromMercatorZ(Z[2]), l.maxZoom),\n            q = new e.LngLat(V, W);\n          return a.mercatorFromTransition && X < .5 * (e.GLOBE_ZOOM_THRESHOLD_MIN + e.GLOBE_ZOOM_THRESHOLD_MAX) ? (a.setProjection({\n            name: \"globe\"\n          }), a.zoom = X, this._cameraForBounds(a, i, o, r, n, s)) : {\n            center: q,\n            zoom: X,\n            bearing: r,\n            pitch: n\n          };\n        }\n      }, {\n        key: \"fitBounds\",\n        value: function fitBounds(e, t, i) {\n          var o = this.cameraForBounds(e, t);\n          return this._fitInternal(o, t, i);\n        }\n      }, {\n        key: \"fitScreenCoordinates\",\n        value: function fitScreenCoordinates(t, i, o, r, n) {\n          var s = e.pointGeometry.convert(t),\n            a = e.pointGeometry.convert(i),\n            l = new e.pointGeometry(Math.min(s.x, a.x), Math.min(s.y, a.y)),\n            c = new e.pointGeometry(Math.max(s.x, a.x), Math.max(s.y, a.y));\n          if (\"mercator\" === this.transform.projection.name && this.transform.anyCornerOffEdge(s, a)) return this;\n          var h = this.transform.pointLocation3D(l),\n            u = this.transform.pointLocation3D(c),\n            _ = this.transform.pointLocation3D(new e.pointGeometry(l.x, c.y)),\n            d = this.transform.pointLocation3D(new e.pointGeometry(c.x, l.y)),\n            p = [Math.min(h.lng, u.lng, _.lng, d.lng), Math.min(h.lat, u.lat, _.lat, d.lat)],\n            m = [Math.max(h.lng, u.lng, _.lng, d.lng), Math.max(h.lat, u.lat, _.lat, d.lat)],\n            f = r && r.pitch ? r.pitch : this.getPitch(),\n            g = this._cameraForBounds(this.transform, p, m, o, f, r);\n          return this._fitInternal(g, r, n);\n        }\n      }, {\n        key: \"_fitInternal\",\n        value: function _fitInternal(t, i, o) {\n          return t ? (delete (i = e.extend(t, i)).padding, i.linear ? this.easeTo(i, o) : this.flyTo(i, o)) : this;\n        }\n      }, {\n        key: \"jumpTo\",\n        value: function jumpTo(t, i) {\n          this.stop();\n          var o = t.preloadOnly ? this.transform.clone() : this.transform;\n          var r = !1,\n            n = !1,\n            s = !1;\n          return \"zoom\" in t && o.zoom !== +t.zoom && (r = !0, o.zoom = +t.zoom), void 0 !== t.center && (o.center = e.LngLat.convert(t.center)), \"bearing\" in t && o.bearing !== +t.bearing && (n = !0, o.bearing = +t.bearing), \"pitch\" in t && o.pitch !== +t.pitch && (s = !0, o.pitch = +t.pitch), null == t.padding || o.isPaddingEqual(t.padding) || (o.padding = t.padding), t.preloadOnly ? (this._preloadTiles(o), this) : (this.fire(new e.Event(\"movestart\", i)).fire(new e.Event(\"move\", i)), r && this.fire(new e.Event(\"zoomstart\", i)).fire(new e.Event(\"zoom\", i)).fire(new e.Event(\"zoomend\", i)), n && this.fire(new e.Event(\"rotatestart\", i)).fire(new e.Event(\"rotate\", i)).fire(new e.Event(\"rotateend\", i)), s && this.fire(new e.Event(\"pitchstart\", i)).fire(new e.Event(\"pitch\", i)).fire(new e.Event(\"pitchend\", i)), this.fire(new e.Event(\"moveend\", i)));\n        }\n      }, {\n        key: \"getFreeCameraOptions\",\n        value: function getFreeCameraOptions() {\n          return this.transform.projection.supportsFreeCamera || e.warnOnce(Hr), this.transform.getFreeCameraOptions();\n        }\n      }, {\n        key: \"setFreeCameraOptions\",\n        value: function setFreeCameraOptions(t, i) {\n          var o = this.transform;\n          if (!o.projection.supportsFreeCamera) return e.warnOnce(Hr), this;\n          this.stop();\n          var r = o.zoom,\n            n = o.pitch,\n            s = o.bearing;\n          o.setFreeCameraOptions(t);\n          var a = r !== o.zoom,\n            l = n !== o.pitch,\n            c = s !== o.bearing;\n          return this.fire(new e.Event(\"movestart\", i)).fire(new e.Event(\"move\", i)), a && this.fire(new e.Event(\"zoomstart\", i)).fire(new e.Event(\"zoom\", i)).fire(new e.Event(\"zoomend\", i)), c && this.fire(new e.Event(\"rotatestart\", i)).fire(new e.Event(\"rotate\", i)).fire(new e.Event(\"rotateend\", i)), l && this.fire(new e.Event(\"pitchstart\", i)).fire(new e.Event(\"pitch\", i)).fire(new e.Event(\"pitchend\", i)), this.fire(new e.Event(\"moveend\", i)), this;\n        }\n      }, {\n        key: \"easeTo\",\n        value: function easeTo(t, i) {\n          var _this135 = this;\n          this._stop(!1, t.easeId), (!1 === (t = e.extend({\n            offset: [0, 0],\n            duration: 500,\n            easing: e.ease\n          }, t)).animate || !t.essential && e.exported.prefersReducedMotion) && (t.duration = 0);\n          var o = this.transform,\n            r = this.getZoom(),\n            n = this.getBearing(),\n            s = this.getPitch(),\n            a = this.getPadding(),\n            l = \"zoom\" in t ? +t.zoom : r,\n            c = \"bearing\" in t ? this._normalizeBearing(t.bearing, n) : n,\n            h = \"pitch\" in t ? +t.pitch : s,\n            u = \"padding\" in t ? t.padding : o.padding,\n            _ = e.pointGeometry.convert(t.offset);\n          var d, p, m;\n          if (\"globe\" === o.projection.name) {\n            var _i314 = e.MercatorCoordinate.fromLngLat(o.center),\n              _r305 = _.rotate(-o.angle);\n            _i314.x += _r305.x / o.worldSize, _i314.y += _r305.y / o.worldSize;\n            var _n214 = _i314.toLngLat(),\n              _s170 = e.LngLat.convert(t.center || _n214);\n            this._normalizeCenter(_s170), d = o.centerPoint.add(_r305), p = new e.pointGeometry(_i314.x, _i314.y).mult(o.worldSize), m = new e.pointGeometry(e.mercatorXfromLng(_s170.lng), e.mercatorYfromLat(_s170.lat)).mult(o.worldSize).sub(p);\n          } else {\n            d = o.centerPoint.add(_);\n            var _i315 = o.pointLocation(d),\n              _r306 = e.LngLat.convert(t.center || _i315);\n            this._normalizeCenter(_r306), p = o.project(_i315), m = o.project(_r306).sub(p);\n          }\n          var f = o.zoomScale(l - r);\n          var g, v;\n          t.around && (g = e.LngLat.convert(t.around), v = o.locationPoint(g));\n          var x = this._zooming || l !== r,\n            y = this._rotating || n !== c,\n            b = this._pitching || h !== s,\n            w = !o.isPaddingEqual(u),\n            T = function T(o) {\n              return function (T) {\n                if (x && (o.zoom = e.number(r, l, T)), y && (o.bearing = e.number(n, c, T)), b && (o.pitch = e.number(s, h, T)), w && (o.interpolatePadding(a, u, T), d = o.centerPoint.add(_)), g) o.setLocationAtPoint(g, v);else {\n                  var _e469 = o.zoomScale(o.zoom - r),\n                    _t465 = l > r ? Math.min(2, f) : Math.max(.5, f),\n                    _i316 = Math.pow(_t465, 1 - T),\n                    _n215 = o.unproject(p.add(m.mult(T * _i316)).mult(_e469));\n                  o.setLocationAtPoint(o.renderWorldCopies ? _n215.wrap() : _n215, d);\n                }\n                return t.preloadOnly || _this135._fireMoveEvents(i), o;\n              };\n            };\n          if (t.preloadOnly) {\n            var _e470 = this._emulate(T, t.duration, o);\n            return this._preloadTiles(_e470), this;\n          }\n          var E = {\n            moving: this._moving,\n            zooming: this._zooming,\n            rotating: this._rotating,\n            pitching: this._pitching\n          };\n          return this._zooming = x, this._rotating = y, this._pitching = b, this._padding = w, this._easeId = t.easeId, this._prepareEase(i, t.noMoveStart, E), this._ease(T(o), function (e) {\n            o.recenterOnTerrain(), _this135._afterEase(i, e);\n          }, t), this;\n        }\n      }, {\n        key: \"_prepareEase\",\n        value: function _prepareEase(t, i) {\n          var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n          this._moving = !0, this.transform.cameraElevationReference = \"sea\", i || o.moving || this.fire(new e.Event(\"movestart\", t)), this._zooming && !o.zooming && this.fire(new e.Event(\"zoomstart\", t)), this._rotating && !o.rotating && this.fire(new e.Event(\"rotatestart\", t)), this._pitching && !o.pitching && this.fire(new e.Event(\"pitchstart\", t));\n        }\n      }, {\n        key: \"_fireMoveEvents\",\n        value: function _fireMoveEvents(t) {\n          this.fire(new e.Event(\"move\", t)), this._zooming && this.fire(new e.Event(\"zoom\", t)), this._rotating && this.fire(new e.Event(\"rotate\", t)), this._pitching && this.fire(new e.Event(\"pitch\", t));\n        }\n      }, {\n        key: \"_afterEase\",\n        value: function _afterEase(t, i) {\n          if (this._easeId && i && this._easeId === i) return;\n          this._easeId = void 0, this.transform.cameraElevationReference = \"ground\";\n          var o = this._zooming,\n            r = this._rotating,\n            n = this._pitching;\n          this._moving = !1, this._zooming = !1, this._rotating = !1, this._pitching = !1, this._padding = !1, o && this.fire(new e.Event(\"zoomend\", t)), r && this.fire(new e.Event(\"rotateend\", t)), n && this.fire(new e.Event(\"pitchend\", t)), this.fire(new e.Event(\"moveend\", t));\n        }\n      }, {\n        key: \"flyTo\",\n        value: function flyTo(t, i) {\n          var _this136 = this;\n          if (!t.essential && e.exported.prefersReducedMotion) {\n            var _o177 = e.pick(t, [\"center\", \"zoom\", \"bearing\", \"pitch\", \"around\"]);\n            return this.jumpTo(_o177, i);\n          }\n          this.stop(), t = e.extend({\n            offset: [0, 0],\n            speed: 1.2,\n            curve: 1.42,\n            easing: e.ease\n          }, t);\n          var o = this.transform,\n            r = this.getZoom(),\n            n = this.getBearing(),\n            s = this.getPitch(),\n            a = this.getPadding(),\n            l = \"zoom\" in t ? e.clamp(+t.zoom, o.minZoom, o.maxZoom) : r,\n            c = \"bearing\" in t ? this._normalizeBearing(t.bearing, n) : n,\n            h = \"pitch\" in t ? +t.pitch : s,\n            u = \"padding\" in t ? t.padding : o.padding,\n            _ = o.zoomScale(l - r),\n            d = e.pointGeometry.convert(t.offset);\n          var p = o.centerPoint.add(d);\n          var m = o.pointLocation(p),\n            f = e.LngLat.convert(t.center || m);\n          this._normalizeCenter(f);\n          var g = o.project(m),\n            v = o.project(f).sub(g);\n          var x = t.curve;\n          var y = Math.max(o.width, o.height),\n            b = y / _,\n            w = v.mag();\n          if (\"minZoom\" in t) {\n            var _i317 = e.clamp(Math.min(t.minZoom, r, l), o.minZoom, o.maxZoom),\n              _n216 = y / o.zoomScale(_i317 - r);\n            x = Math.sqrt(_n216 / w * 2);\n          }\n          var T = x * x;\n          function E(e) {\n            var t = (b * b - y * y + (e ? -1 : 1) * T * T * w * w) / (2 * (e ? b : y) * T * w);\n            return Math.log(Math.sqrt(t * t + 1) - t);\n          }\n          function C(e) {\n            return (Math.exp(e) - Math.exp(-e)) / 2;\n          }\n          function M(e) {\n            return (Math.exp(e) + Math.exp(-e)) / 2;\n          }\n          var I = E(0);\n          var S = function S(e) {\n              return M(I) / M(I + x * e);\n            },\n            D = function D(e) {\n              return y * ((M(I) * (C(t = I + x * e) / M(t)) - C(I)) / T) / w;\n              var t;\n            },\n            L = (E(1) - I) / x;\n          if (Math.abs(w) < 1e-6 || !isFinite(L)) {\n            if (Math.abs(y - b) < 1e-6) return this.easeTo(t, i);\n            var _e471 = b < y ? -1 : 1;\n            L = Math.abs(Math.log(b / y)) / x, D = function D() {\n              return 0;\n            }, S = function S(t) {\n              return Math.exp(_e471 * x * t);\n            };\n          }\n          t.duration = \"duration\" in t ? +t.duration : 1e3 * L / (\"screenSpeed\" in t ? +t.screenSpeed / x : +t.speed), t.maxDuration && t.duration > t.maxDuration && (t.duration = 0);\n          var A = n !== c,\n            z = h !== s,\n            P = !o.isPaddingEqual(u),\n            R = function R(o) {\n              return function (_) {\n                var m = _ * L,\n                  x = 1 / S(m);\n                o.zoom = 1 === _ ? l : r + o.scaleZoom(x), A && (o.bearing = e.number(n, c, _)), z && (o.pitch = e.number(s, h, _)), P && (o.interpolatePadding(a, u, _), p = o.centerPoint.add(d));\n                var y = 1 === _ ? f : o.unproject(g.add(v.mult(D(m))).mult(x));\n                return o.setLocationAtPoint(o.renderWorldCopies ? y.wrap() : y, p), o._updateCameraOnTerrain(), t.preloadOnly || _this136._fireMoveEvents(i), o;\n              };\n            };\n          if (t.preloadOnly) {\n            var _e472 = this._emulate(R, t.duration, o);\n            return this._preloadTiles(_e472), this;\n          }\n          return this._zooming = !0, this._rotating = A, this._pitching = z, this._padding = P, this._prepareEase(i, !1), this._ease(R(o), function () {\n            return _this136._afterEase(i);\n          }, t), this;\n        }\n      }, {\n        key: \"isEasing\",\n        value: function isEasing() {\n          return !!this._easeFrameId;\n        }\n      }, {\n        key: \"stop\",\n        value: function stop() {\n          return this._stop();\n        }\n      }, {\n        key: \"_stop\",\n        value: function _stop(e, t) {\n          if (this._easeFrameId && (this._cancelRenderFrame(this._easeFrameId), this._easeFrameId = void 0, this._onEaseFrame = void 0), this._onEaseEnd) {\n            var _e473 = this._onEaseEnd;\n            this._onEaseEnd = void 0, _e473.call(this, t);\n          }\n          if (!e) {\n            var _e474 = this.handlers;\n            _e474 && _e474.stop(!1);\n          }\n          return this;\n        }\n      }, {\n        key: \"_ease\",\n        value: function _ease(t, i, o) {\n          !1 === o.animate || 0 === o.duration ? (t(1), i()) : (this._easeStart = e.exported.now(), this._easeOptions = o, this._onEaseFrame = t, this._onEaseEnd = i, this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback));\n        }\n      }, {\n        key: \"_renderFrameCallback\",\n        value: function _renderFrameCallback() {\n          var t = Math.min((e.exported.now() - this._easeStart) / this._easeOptions.duration, 1),\n            i = this._onEaseFrame;\n          i && i(this._easeOptions.easing(t)), t < 1 ? this._easeFrameId = this._requestRenderFrame(this._renderFrameCallback) : this.stop();\n        }\n      }, {\n        key: \"_normalizeBearing\",\n        value: function _normalizeBearing(t, i) {\n          t = e.wrap(t, -180, 180);\n          var o = Math.abs(t - i);\n          return Math.abs(t - 360 - i) < o && (t -= 360), Math.abs(t + 360 - i) < o && (t += 360), t;\n        }\n      }, {\n        key: \"_normalizeCenter\",\n        value: function _normalizeCenter(e) {\n          var t = this.transform;\n          if (!t.renderWorldCopies || t.maxBounds) return;\n          var i = e.lng - t.center.lng;\n          e.lng += i > 180 ? -360 : i < -180 ? 360 : 0;\n        }\n      }, {\n        key: \"_emulate\",\n        value: function _emulate(e, t, i) {\n          var o = Math.ceil(15 * t / 1e3),\n            r = [],\n            n = e(i.clone());\n          for (var _e475 = 0; _e475 <= o; _e475++) {\n            var _t466 = n(_e475 / o);\n            r.push(_t466.clone());\n          }\n          return r;\n        }\n      }]);\n      return Yr;\n    }(e.Evented);\n    var Kr = /*#__PURE__*/function () {\n      function Kr() {\n        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        _classCallCheck(this, Kr);\n        this.options = t, e.bindAll([\"_toggleAttribution\", \"_updateEditLink\", \"_updateData\", \"_updateCompact\"], this);\n      }\n      _createClass(Kr, [{\n        key: \"getDefaultPosition\",\n        value: function getDefaultPosition() {\n          return \"bottom-right\";\n        }\n      }, {\n        key: \"onAdd\",\n        value: function onAdd(e) {\n          var t = this.options && this.options.compact;\n          return this._map = e, this._container = n(\"div\", \"mapboxgl-ctrl mapboxgl-ctrl-attrib\"), this._compactButton = n(\"button\", \"mapboxgl-ctrl-attrib-button\", this._container), n(\"span\", \"mapboxgl-ctrl-icon\", this._compactButton).setAttribute(\"aria-hidden\", \"true\"), this._compactButton.type = \"button\", this._compactButton.addEventListener(\"click\", this._toggleAttribution), this._setElementTitle(this._compactButton, \"ToggleAttribution\"), this._innerContainer = n(\"div\", \"mapboxgl-ctrl-attrib-inner\", this._container), this._innerContainer.setAttribute(\"role\", \"list\"), t && this._container.classList.add(\"mapboxgl-compact\"), this._updateAttributions(), this._updateEditLink(), this._map.on(\"styledata\", this._updateData), this._map.on(\"sourcedata\", this._updateData), this._map.on(\"moveend\", this._updateEditLink), void 0 === t && (this._map.on(\"resize\", this._updateCompact), this._updateCompact()), this._container;\n        }\n      }, {\n        key: \"onRemove\",\n        value: function onRemove() {\n          this._container.remove(), this._map.off(\"styledata\", this._updateData), this._map.off(\"sourcedata\", this._updateData), this._map.off(\"moveend\", this._updateEditLink), this._map.off(\"resize\", this._updateCompact), this._map = void 0, this._attribHTML = void 0;\n        }\n      }, {\n        key: \"_setElementTitle\",\n        value: function _setElementTitle(e, t) {\n          var i = this._map._getUIString(\"AttributionControl.\".concat(t));\n          e.setAttribute(\"aria-label\", i), e.removeAttribute(\"title\"), e.firstElementChild && e.firstElementChild.setAttribute(\"title\", i);\n        }\n      }, {\n        key: \"_toggleAttribution\",\n        value: function _toggleAttribution() {\n          this._container.classList.contains(\"mapboxgl-compact-show\") ? (this._container.classList.remove(\"mapboxgl-compact-show\"), this._compactButton.setAttribute(\"aria-expanded\", \"false\")) : (this._container.classList.add(\"mapboxgl-compact-show\"), this._compactButton.setAttribute(\"aria-expanded\", \"true\"));\n        }\n      }, {\n        key: \"_updateEditLink\",\n        value: function _updateEditLink() {\n          var t = this._editLink;\n          t || (t = this._editLink = this._container.querySelector(\".mapbox-improve-map\"));\n          var i = [{\n            key: \"owner\",\n            value: this.styleOwner\n          }, {\n            key: \"id\",\n            value: this.styleId\n          }, {\n            key: \"access_token\",\n            value: this._map._requestManager._customAccessToken || e.config.ACCESS_TOKEN\n          }];\n          if (t) {\n            var _o178 = i.reduce(function (e, t, o) {\n              return t.value && (e += \"\".concat(t.key, \"=\").concat(t.value).concat(o < i.length - 1 ? \"&\" : \"\")), e;\n            }, \"?\");\n            t.href = \"\".concat(e.config.FEEDBACK_URL, \"/\").concat(_o178, \"#\").concat(er(this._map, !0)), t.rel = \"noopener nofollow\", this._setElementTitle(t, \"MapFeedback\");\n          }\n        }\n      }, {\n        key: \"_updateData\",\n        value: function _updateData(e) {\n          !e || \"metadata\" !== e.sourceDataType && \"visibility\" !== e.sourceDataType && \"style\" !== e.dataType || (this._updateAttributions(), this._updateEditLink());\n        }\n      }, {\n        key: \"_updateAttributions\",\n        value: function _updateAttributions() {\n          if (!this._map.style) return;\n          var e = [];\n          if (this._map.style.stylesheet) {\n            var _e476 = this._map.style.stylesheet;\n            this.styleOwner = _e476.owner, this.styleId = _e476.id;\n          }\n          var t = this._map.style._sourceCaches;\n          for (var _i318 in t) {\n            var _o179 = t[_i318];\n            if (_o179.used) {\n              var _t467 = _o179.getSource();\n              _t467.attribution && e.indexOf(_t467.attribution) < 0 && e.push(_t467.attribution);\n            }\n          }\n          e.sort(function (e, t) {\n            return e.length - t.length;\n          }), e = e.filter(function (t, i) {\n            for (var _o180 = i + 1; _o180 < e.length; _o180++) if (e[_o180].indexOf(t) >= 0) return !1;\n            return !0;\n          }), this.options.customAttribution && (Array.isArray(this.options.customAttribution) ? e = [].concat(_toConsumableArray(this.options.customAttribution), _toConsumableArray(e)) : e.unshift(this.options.customAttribution));\n          var i = e.join(\" | \");\n          i !== this._attribHTML && (this._attribHTML = i, e.length ? (this._innerContainer.innerHTML = i, this._container.classList.remove(\"mapboxgl-attrib-empty\")) : this._container.classList.add(\"mapboxgl-attrib-empty\"), this._editLink = null);\n        }\n      }, {\n        key: \"_updateCompact\",\n        value: function _updateCompact() {\n          this._map.getCanvasContainer().offsetWidth <= 640 ? this._container.classList.add(\"mapboxgl-compact\") : this._container.classList.remove(\"mapboxgl-compact\", \"mapboxgl-compact-show\");\n        }\n      }]);\n      return Kr;\n    }();\n    var Jr = /*#__PURE__*/function () {\n      function Jr() {\n        _classCallCheck(this, Jr);\n        e.bindAll([\"_updateLogo\", \"_updateCompact\"], this);\n      }\n      _createClass(Jr, [{\n        key: \"onAdd\",\n        value: function onAdd(e) {\n          this._map = e, this._container = n(\"div\", \"mapboxgl-ctrl\");\n          var t = n(\"a\", \"mapboxgl-ctrl-logo\");\n          return t.target = \"_blank\", t.rel = \"noopener nofollow\", t.href = \"https://www.mapbox.com/\", t.setAttribute(\"aria-label\", this._map._getUIString(\"LogoControl.Title\")), t.setAttribute(\"rel\", \"noopener nofollow\"), this._container.appendChild(t), this._container.style.display = \"none\", this._map.on(\"sourcedata\", this._updateLogo), this._updateLogo(), this._map.on(\"resize\", this._updateCompact), this._updateCompact(), this._container;\n        }\n      }, {\n        key: \"onRemove\",\n        value: function onRemove() {\n          this._container.remove(), this._map.off(\"sourcedata\", this._updateLogo), this._map.off(\"resize\", this._updateCompact);\n        }\n      }, {\n        key: \"getDefaultPosition\",\n        value: function getDefaultPosition() {\n          return \"bottom-left\";\n        }\n      }, {\n        key: \"_updateLogo\",\n        value: function _updateLogo(e) {\n          e && \"metadata\" !== e.sourceDataType || (this._container.style.display = this._logoRequired() ? \"block\" : \"none\");\n        }\n      }, {\n        key: \"_logoRequired\",\n        value: function _logoRequired() {\n          if (!this._map.style) return !0;\n          var e = this._map.style._sourceCaches;\n          if (0 === Object.entries(e).length) return !0;\n          for (var _t468 in e) {\n            var _i319 = e[_t468].getSource();\n            if (_i319.hasOwnProperty(\"mapbox_logo\") && !_i319.mapbox_logo) return !1;\n          }\n          return !0;\n        }\n      }, {\n        key: \"_updateCompact\",\n        value: function _updateCompact() {\n          var e = this._container.children;\n          if (e.length) {\n            var _t469 = e[0];\n            this._map.getCanvasContainer().offsetWidth < 250 ? _t469.classList.add(\"mapboxgl-compact\") : _t469.classList.remove(\"mapboxgl-compact\");\n          }\n        }\n      }]);\n      return Jr;\n    }();\n    var Qr = /*#__PURE__*/function () {\n      function Qr() {\n        _classCallCheck(this, Qr);\n        this._queue = [], this._id = 0, this._cleared = !1, this._currentlyRunning = !1;\n      }\n      _createClass(Qr, [{\n        key: \"add\",\n        value: function add(e) {\n          var t = ++this._id;\n          return this._queue.push({\n            callback: e,\n            id: t,\n            cancelled: !1\n          }), t;\n        }\n      }, {\n        key: \"remove\",\n        value: function remove(e) {\n          var t = this._currentlyRunning,\n            i = t ? this._queue.concat(t) : this._queue;\n          var _iterator281 = _createForOfIteratorHelper(i),\n            _step281;\n          try {\n            for (_iterator281.s(); !(_step281 = _iterator281.n()).done;) {\n              var _t470 = _step281.value;\n              if (_t470.id === e) return void (_t470.cancelled = !0);\n            }\n          } catch (err) {\n            _iterator281.e(err);\n          } finally {\n            _iterator281.f();\n          }\n        }\n      }, {\n        key: \"run\",\n        value: function run() {\n          var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n          var t = this._currentlyRunning = this._queue;\n          this._queue = [];\n          var _iterator282 = _createForOfIteratorHelper(t),\n            _step282;\n          try {\n            for (_iterator282.s(); !(_step282 = _iterator282.n()).done;) {\n              var _i320 = _step282.value;\n              if (!_i320.cancelled && (_i320.callback(e), this._cleared)) break;\n            }\n          } catch (err) {\n            _iterator282.e(err);\n          } finally {\n            _iterator282.f();\n          }\n          this._cleared = !1, this._currentlyRunning = !1;\n        }\n      }, {\n        key: \"clear\",\n        value: function clear() {\n          this._currentlyRunning && (this._cleared = !0), this._queue = [];\n        }\n      }]);\n      return Qr;\n    }();\n    function en(t, i, o) {\n      if (t = new e.LngLat(t.lng, t.lat), i) {\n        var _r307 = new e.LngLat(t.lng - 360, t.lat),\n          _n217 = new e.LngLat(t.lng + 360, t.lat),\n          _s171 = 360 * Math.ceil(Math.abs(t.lng - o.center.lng) / 360),\n          _a140 = o.locationPoint(t).distSqr(i),\n          _l86 = i.x < 0 || i.y < 0 || i.x > o.width || i.y > o.height;\n        o.locationPoint(_r307).distSqr(i) < _a140 && (_l86 || Math.abs(_r307.lng - o.center.lng) < _s171) ? t = _r307 : o.locationPoint(_n217).distSqr(i) < _a140 && (_l86 || Math.abs(_n217.lng - o.center.lng) < _s171) && (t = _n217);\n      }\n      for (; Math.abs(t.lng - o.center.lng) > 180;) {\n        var _e477 = o.locationPoint(t);\n        if (_e477.x >= 0 && _e477.y >= 0 && _e477.x <= o.width && _e477.y <= o.height) break;\n        t.lng > o.center.lng ? t.lng -= 360 : t.lng += 360;\n      }\n      return t;\n    }\n    var tn = {\n      center: \"translate(-50%,-50%)\",\n      top: \"translate(-50%,0)\",\n      \"top-left\": \"translate(0,0)\",\n      \"top-right\": \"translate(-100%,0)\",\n      bottom: \"translate(-50%,-100%)\",\n      \"bottom-left\": \"translate(0,-100%)\",\n      \"bottom-right\": \"translate(-100%,-100%)\",\n      left: \"translate(0,-50%)\",\n      right: \"translate(-100%,-50%)\"\n    };\n    var on = /*#__PURE__*/function (_e$Evented12) {\n      _inherits(on, _e$Evented12);\n      function on(t, i) {\n        var _this137;\n        _classCallCheck(this, on);\n        if (_this137 = _possibleConstructorReturn(this, _getPrototypeOf(on).call(this)), (t instanceof e.window.HTMLElement || i) && (t = e.extend({\n          element: t\n        }, i)), e.bindAll([\"_update\", \"_onMove\", \"_onUp\", \"_addDragHandler\", \"_onMapClick\", \"_onKeyPress\", \"_clearFadeTimer\"], _assertThisInitialized(_assertThisInitialized(_this137))), _this137._anchor = t && t.anchor || \"center\", _this137._color = t && t.color || \"#3FB1CE\", _this137._scale = t && t.scale || 1, _this137._draggable = t && t.draggable || !1, _this137._clickTolerance = t && t.clickTolerance || 0, _this137._isDragging = !1, _this137._state = \"inactive\", _this137._rotation = t && t.rotation || 0, _this137._rotationAlignment = t && t.rotationAlignment || \"auto\", _this137._pitchAlignment = t && t.pitchAlignment && t.pitchAlignment || \"auto\", _this137._updateMoving = function () {\n          return _this137._update(!0);\n        }, _this137._occludedOpacity = t && t.occludedOpacity || .2, t && t.element) _this137._element = t.element, _this137._offset = e.pointGeometry.convert(t && t.offset || [0, 0]);else {\n          _this137._defaultMarker = !0, _this137._element = n(\"div\");\n          var _i321 = 41,\n            _o181 = 27,\n            _r308 = s(\"svg\", {\n              display: \"block\",\n              height: _i321 * _this137._scale + \"px\",\n              width: _o181 * _this137._scale + \"px\",\n              viewBox: \"0 0 \".concat(_o181, \" \").concat(_i321)\n            }, _this137._element),\n            _a141 = s(\"radialGradient\", {\n              id: \"shadowGradient\"\n            }, s(\"defs\", {}, _r308));\n          s(\"stop\", {\n            offset: \"10%\",\n            \"stop-opacity\": .4\n          }, _a141), s(\"stop\", {\n            offset: \"100%\",\n            \"stop-opacity\": .05\n          }, _a141), s(\"ellipse\", {\n            cx: 13.5,\n            cy: 34.8,\n            rx: 10.5,\n            ry: 5.25,\n            fill: \"url(#shadowGradient)\"\n          }, _r308), s(\"path\", {\n            fill: _this137._color,\n            d: \"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z\"\n          }, _r308), s(\"path\", {\n            opacity: .25,\n            d: \"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z\"\n          }, _r308), s(\"circle\", {\n            fill: \"white\",\n            cx: 13.5,\n            cy: 13.5,\n            r: 5.5\n          }, _r308), _this137._offset = e.pointGeometry.convert(t && t.offset || [0, -14]);\n        }\n        _this137._element.hasAttribute(\"aria-label\") || _this137._element.setAttribute(\"aria-label\", \"Map marker\"), _this137._element.classList.add(\"mapboxgl-marker\"), _this137._element.addEventListener(\"dragstart\", function (e) {\n          e.preventDefault();\n        }), _this137._element.addEventListener(\"mousedown\", function (e) {\n          e.preventDefault();\n        });\n        var o = _this137._element.classList;\n        for (var _e478 in tn) o.remove(\"mapboxgl-marker-anchor-\".concat(_e478));\n        o.add(\"mapboxgl-marker-anchor-\".concat(_this137._anchor)), _this137._popup = null;\n        return _possibleConstructorReturn(_this137);\n      }\n      _createClass(on, [{\n        key: \"addTo\",\n        value: function addTo(e) {\n          return e === this._map || (this.remove(), this._map = e, e.getCanvasContainer().appendChild(this._element), e.on(\"move\", this._updateMoving), e.on(\"moveend\", this._update), e.on(\"remove\", this._clearFadeTimer), e._addMarker(this), this.setDraggable(this._draggable), this._update(), e.on(\"click\", this._onMapClick)), this;\n        }\n      }, {\n        key: \"remove\",\n        value: function remove() {\n          var e = this._map;\n          return e && (e.off(\"click\", this._onMapClick), e.off(\"move\", this._updateMoving), e.off(\"moveend\", this._update), e.off(\"mousedown\", this._addDragHandler), e.off(\"touchstart\", this._addDragHandler), e.off(\"mouseup\", this._onUp), e.off(\"touchend\", this._onUp), e.off(\"mousemove\", this._onMove), e.off(\"touchmove\", this._onMove), e.off(\"remove\", this._clearFadeTimer), e._removeMarker(this), this._map = void 0), this._clearFadeTimer(), this._element.remove(), this._popup && this._popup.remove(), this;\n        }\n      }, {\n        key: \"getLngLat\",\n        value: function getLngLat() {\n          return this._lngLat;\n        }\n      }, {\n        key: \"setLngLat\",\n        value: function setLngLat(t) {\n          return this._lngLat = e.LngLat.convert(t), this._pos = null, this._popup && this._popup.setLngLat(this._lngLat), this._update(!0), this;\n        }\n      }, {\n        key: \"getElement\",\n        value: function getElement() {\n          return this._element;\n        }\n      }, {\n        key: \"setPopup\",\n        value: function setPopup(e) {\n          if (this._popup && (this._popup.remove(), this._popup = null, this._element.removeAttribute(\"role\"), this._element.removeEventListener(\"keypress\", this._onKeyPress), this._originalTabIndex || this._element.removeAttribute(\"tabindex\")), e) {\n            if (!(\"offset\" in e.options)) {\n              var _t471 = 38.1,\n                _i322 = 13.5,\n                _o182 = Math.sqrt(Math.pow(_i322, 2) / 2);\n              e.options.offset = this._defaultMarker ? {\n                top: [0, 0],\n                \"top-left\": [0, 0],\n                \"top-right\": [0, 0],\n                bottom: [0, -_t471],\n                \"bottom-left\": [_o182, -1 * (_t471 - _i322 + _o182)],\n                \"bottom-right\": [-_o182, -1 * (_t471 - _i322 + _o182)],\n                left: [_i322, -1 * (_t471 - _i322)],\n                right: [-_i322, -1 * (_t471 - _i322)]\n              } : this._offset;\n            }\n            this._popup = e, e._marker = this, this._lngLat && this._popup.setLngLat(this._lngLat), this._element.setAttribute(\"role\", \"button\"), this._originalTabIndex = this._element.getAttribute(\"tabindex\"), this._originalTabIndex || this._element.setAttribute(\"tabindex\", \"0\"), this._element.addEventListener(\"keypress\", this._onKeyPress), this._element.setAttribute(\"aria-expanded\", \"false\");\n          }\n          return this;\n        }\n      }, {\n        key: \"_onKeyPress\",\n        value: function _onKeyPress(e) {\n          var t = e.code,\n            i = e.charCode || e.keyCode;\n          \"Space\" !== t && \"Enter\" !== t && 32 !== i && 13 !== i || this.togglePopup();\n        }\n      }, {\n        key: \"_onMapClick\",\n        value: function _onMapClick(e) {\n          var t = e.originalEvent.target,\n            i = this._element;\n          this._popup && (t === i || i.contains(t)) && this.togglePopup();\n        }\n      }, {\n        key: \"getPopup\",\n        value: function getPopup() {\n          return this._popup;\n        }\n      }, {\n        key: \"togglePopup\",\n        value: function togglePopup() {\n          var e = this._popup;\n          return e ? (e.isOpen() ? (e.remove(), this._element.setAttribute(\"aria-expanded\", \"false\")) : this._map && (e.addTo(this._map), this._element.setAttribute(\"aria-expanded\", \"true\")), this) : this;\n        }\n      }, {\n        key: \"_behindTerrain\",\n        value: function _behindTerrain() {\n          var e = this._map,\n            t = this._pos;\n          if (!e || !t) return !1;\n          var i = e.unproject(t),\n            o = e.getFreeCameraOptions();\n          if (!o.position) return !1;\n          var r = o.position.toLngLat();\n          return r.distanceTo(i) < .9 * r.distanceTo(this._lngLat);\n        }\n      }, {\n        key: \"_evaluateOpacity\",\n        value: function _evaluateOpacity() {\n          var t = this._map;\n          if (!t) return;\n          var i = this._pos;\n          if (!i || i.x < 0 || i.x > t.transform.width || i.y < 0 || i.y > t.transform.height) return void this._clearFadeTimer();\n          var o = t.unproject(i);\n          var r;\n          t._showingGlobe() && e.isLngLatBehindGlobe(t.transform, this._lngLat) ? r = 0 : (r = 1 - t._queryFogOpacity(o), t.transform._terrainEnabled() && t.getTerrain() && this._behindTerrain() && (r *= this._occludedOpacity)), this._element.style.opacity = \"\".concat(r), this._element.style.pointerEvents = r > 0 ? \"auto\" : \"none\", this._popup && this._popup._setOpacity(r), this._fadeTimer = null;\n        }\n      }, {\n        key: \"_clearFadeTimer\",\n        value: function _clearFadeTimer() {\n          this._fadeTimer && (clearTimeout(this._fadeTimer), this._fadeTimer = null);\n        }\n      }, {\n        key: \"_updateDOM\",\n        value: function _updateDOM() {\n          var e = this._pos;\n          if (!e || !this._map) return;\n          var t = this._offset.mult(this._scale);\n          this._element.style.transform = \"\\n            translate(\".concat(e.x, \"px,\").concat(e.y, \"px)\\n            \").concat(tn[this._anchor], \"\\n            \").concat(this._calculateXYTransform(), \" \").concat(this._calculateZTransform(), \"\\n            translate(\").concat(t.x, \"px,\").concat(t.y, \"px)\\n        \");\n        }\n      }, {\n        key: \"_calculateXYTransform\",\n        value: function _calculateXYTransform() {\n          var t = this._pos,\n            i = this._map,\n            o = this.getPitchAlignment();\n          if (!i || !t || \"map\" !== o) return \"\";\n          if (!i._showingGlobe()) {\n            var _e479 = i.getPitch();\n            return _e479 ? \"rotateX(\".concat(_e479, \"deg)\") : \"\";\n          }\n          var r = e.radToDeg(e.globeTiltAtLngLat(i.transform, this._lngLat)),\n            n = t.sub(e.globeCenterToScreenPoint(i.transform)),\n            s = Math.abs(n.x) + Math.abs(n.y);\n          if (0 === s) return \"\";\n          var a = r / s;\n          return \"rotateX(\".concat(-n.y * a, \"deg) rotateY(\").concat(n.x * a, \"deg)\");\n        }\n      }, {\n        key: \"_calculateZTransform\",\n        value: function _calculateZTransform() {\n          var t = this._pos,\n            i = this._map;\n          if (!i || !t) return \"\";\n          var o = 0;\n          var r = this.getRotationAlignment();\n          if (\"map\" === r) {\n            if (i._showingGlobe()) {\n              var _t472 = i.project(new e.LngLat(this._lngLat.lng, this._lngLat.lat + .001)),\n                _r309 = i.project(new e.LngLat(this._lngLat.lng, this._lngLat.lat - .001)).sub(_t472);\n              o = e.radToDeg(Math.atan2(_r309.y, _r309.x)) - 90;\n            } else o = -i.getBearing();\n          } else if (\"horizon\" === r) {\n            var _r310 = e.smoothstep(4, 6, i.getZoom()),\n              _n218 = e.globeCenterToScreenPoint(i.transform);\n            _n218.y += _r310 * i.transform.height;\n            var _s172 = t.sub(_n218),\n              _a142 = e.radToDeg(Math.atan2(_s172.y, _s172.x));\n            o = (_a142 > 90 ? _a142 - 270 : _a142 + 90) * (1 - _r310);\n          }\n          return o += this._rotation, o ? \"rotateZ(\".concat(o, \"deg)\") : \"\";\n        }\n      }, {\n        key: \"_update\",\n        value: function _update(t) {\n          var _this138 = this;\n          e.window.cancelAnimationFrame(this._updateFrameId);\n          var i = this._map;\n          i && (i.transform.renderWorldCopies && (this._lngLat = en(this._lngLat, this._pos, i.transform)), this._pos = i.project(this._lngLat), !0 === t ? this._updateFrameId = e.window.requestAnimationFrame(function () {\n            _this138._element && _this138._pos && _this138._anchor && (_this138._pos = _this138._pos.round(), _this138._updateDOM());\n          }) : this._pos = this._pos.round(), i._requestDomTask(function () {\n            _this138._map && (_this138._element && _this138._pos && _this138._anchor && _this138._updateDOM(), (i._showingGlobe() || i.getTerrain() || i.getFog()) && !_this138._fadeTimer && (_this138._fadeTimer = setTimeout(_this138._evaluateOpacity.bind(_this138), 60)));\n          }));\n        }\n      }, {\n        key: \"getOffset\",\n        value: function getOffset() {\n          return this._offset;\n        }\n      }, {\n        key: \"setOffset\",\n        value: function setOffset(t) {\n          return this._offset = e.pointGeometry.convert(t), this._update(), this;\n        }\n      }, {\n        key: \"_onMove\",\n        value: function _onMove(t) {\n          var i = this._map;\n          if (!i) return;\n          var o = this._pointerdownPos,\n            r = this._positionDelta;\n          if (o && r) {\n            if (!this._isDragging) {\n              var _e480 = this._clickTolerance || i._clickTolerance;\n              if (t.point.dist(o) < _e480) return;\n              this._isDragging = !0;\n            }\n            this._pos = t.point.sub(r), this._lngLat = i.unproject(this._pos), this.setLngLat(this._lngLat), this._element.style.pointerEvents = \"none\", \"pending\" === this._state && (this._state = \"active\", this.fire(new e.Event(\"dragstart\"))), this.fire(new e.Event(\"drag\"));\n          }\n        }\n      }, {\n        key: \"_onUp\",\n        value: function _onUp() {\n          this._element.style.pointerEvents = \"auto\", this._positionDelta = null, this._pointerdownPos = null, this._isDragging = !1;\n          var t = this._map;\n          t && (t.off(\"mousemove\", this._onMove), t.off(\"touchmove\", this._onMove)), \"active\" === this._state && this.fire(new e.Event(\"dragend\")), this._state = \"inactive\";\n        }\n      }, {\n        key: \"_addDragHandler\",\n        value: function _addDragHandler(e) {\n          var t = this._map,\n            i = this._pos;\n          t && i && this._element.contains(e.originalEvent.target) && (e.preventDefault(), this._positionDelta = e.point.sub(i), this._pointerdownPos = e.point, this._state = \"pending\", t.on(\"mousemove\", this._onMove), t.on(\"touchmove\", this._onMove), t.once(\"mouseup\", this._onUp), t.once(\"touchend\", this._onUp));\n        }\n      }, {\n        key: \"setDraggable\",\n        value: function setDraggable(e) {\n          this._draggable = !!e;\n          var t = this._map;\n          return t && (e ? (t.on(\"mousedown\", this._addDragHandler), t.on(\"touchstart\", this._addDragHandler)) : (t.off(\"mousedown\", this._addDragHandler), t.off(\"touchstart\", this._addDragHandler))), this;\n        }\n      }, {\n        key: \"isDraggable\",\n        value: function isDraggable() {\n          return this._draggable;\n        }\n      }, {\n        key: \"setRotation\",\n        value: function setRotation(e) {\n          return this._rotation = e || 0, this._update(), this;\n        }\n      }, {\n        key: \"getRotation\",\n        value: function getRotation() {\n          return this._rotation;\n        }\n      }, {\n        key: \"setRotationAlignment\",\n        value: function setRotationAlignment(e) {\n          return this._rotationAlignment = e || \"auto\", this._update(), this;\n        }\n      }, {\n        key: \"getRotationAlignment\",\n        value: function getRotationAlignment() {\n          return \"auto\" === this._rotationAlignment || \"horizon\" === this._rotationAlignment && this._map && !this._map._showingGlobe() ? \"viewport\" : this._rotationAlignment;\n        }\n      }, {\n        key: \"setPitchAlignment\",\n        value: function setPitchAlignment(e) {\n          return this._pitchAlignment = e || \"auto\", this._update(), this;\n        }\n      }, {\n        key: \"getPitchAlignment\",\n        value: function getPitchAlignment() {\n          return \"auto\" === this._pitchAlignment ? this.getRotationAlignment() : this._pitchAlignment;\n        }\n      }, {\n        key: \"setOccludedOpacity\",\n        value: function setOccludedOpacity(e) {\n          return this._occludedOpacity = e || .2, this._update(), this;\n        }\n      }, {\n        key: \"getOccludedOpacity\",\n        value: function getOccludedOpacity() {\n          return this._occludedOpacity;\n        }\n      }]);\n      return on;\n    }(e.Evented);\n    var rn = {\n        closeButton: !0,\n        closeOnClick: !0,\n        focusAfterOpen: !0,\n        className: \"\",\n        maxWidth: \"240px\"\n      },\n      nn = [\"a[href]\", \"[tabindex]:not([tabindex='-1'])\", \"[contenteditable]:not([contenteditable='false'])\", \"button:not([disabled])\", \"input:not([disabled])\", \"select:not([disabled])\", \"textarea:not([disabled])\"].join(\", \");\n    function sn() {\n      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new e.pointGeometry(0, 0);\n      var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"bottom\";\n      if (\"number\" == typeof t) {\n        var _o183 = Math.round(Math.sqrt(.5 * Math.pow(t, 2)));\n        switch (i) {\n          case \"top\":\n            return new e.pointGeometry(0, t);\n          case \"top-left\":\n            return new e.pointGeometry(_o183, _o183);\n          case \"top-right\":\n            return new e.pointGeometry(-_o183, _o183);\n          case \"bottom\":\n            return new e.pointGeometry(0, -t);\n          case \"bottom-left\":\n            return new e.pointGeometry(_o183, -_o183);\n          case \"bottom-right\":\n            return new e.pointGeometry(-_o183, -_o183);\n          case \"left\":\n            return new e.pointGeometry(t, 0);\n          case \"right\":\n            return new e.pointGeometry(-t, 0);\n        }\n        return new e.pointGeometry(0, 0);\n      }\n      return t instanceof e.pointGeometry || Array.isArray(t) ? e.pointGeometry.convert(t) : e.pointGeometry.convert(t[i] || [0, 0]);\n    }\n    var an = /*#__PURE__*/function () {\n      function an(e) {\n        _classCallCheck(this, an);\n        this.jumpTo(e);\n      }\n      _createClass(an, [{\n        key: \"getValue\",\n        value: function getValue(t) {\n          if (t <= this._startTime) return this._start;\n          if (t >= this._endTime) return this._end;\n          var i = e.easeCubicInOut((t - this._startTime) / (this._endTime - this._startTime));\n          return this._start * (1 - i) + this._end * i;\n        }\n      }, {\n        key: \"isEasing\",\n        value: function isEasing(e) {\n          return e >= this._startTime && e <= this._endTime;\n        }\n      }, {\n        key: \"jumpTo\",\n        value: function jumpTo(e) {\n          this._startTime = -1 / 0, this._endTime = -1 / 0, this._start = e, this._end = e;\n        }\n      }, {\n        key: \"easeTo\",\n        value: function easeTo(e, t, i) {\n          this._start = this.getValue(t), this._end = e, this._startTime = t, this._endTime = t + i;\n        }\n      }]);\n      return an;\n    }();\n    var ln = {\n        \"AttributionControl.ToggleAttribution\": \"Toggle attribution\",\n        \"AttributionControl.MapFeedback\": \"Map feedback\",\n        \"FullscreenControl.Enter\": \"Enter fullscreen\",\n        \"FullscreenControl.Exit\": \"Exit fullscreen\",\n        \"GeolocateControl.FindMyLocation\": \"Find my location\",\n        \"GeolocateControl.LocationNotAvailable\": \"Location not available\",\n        \"LogoControl.Title\": \"Mapbox logo\",\n        \"Map.Title\": \"Map\",\n        \"NavigationControl.ResetBearing\": \"Reset bearing to north\",\n        \"NavigationControl.ZoomIn\": \"Zoom in\",\n        \"NavigationControl.ZoomOut\": \"Zoom out\",\n        \"ScrollZoomBlocker.CtrlMessage\": \"Use ctrl + scroll to zoom the map\",\n        \"ScrollZoomBlocker.CmdMessage\": \"Use â + scroll to zoom the map\",\n        \"TouchPanBlocker.Message\": \"Use two fingers to move the map\"\n      },\n      cn = {\n        center: [0, 0],\n        zoom: 0,\n        bearing: 0,\n        pitch: 0,\n        minZoom: -2,\n        maxZoom: 22,\n        minPitch: 0,\n        maxPitch: 85,\n        interactive: !0,\n        scrollZoom: !0,\n        boxZoom: !0,\n        dragRotate: !0,\n        dragPan: !0,\n        keyboard: !0,\n        doubleClickZoom: !0,\n        touchZoomRotate: !0,\n        touchPitch: !0,\n        cooperativeGestures: !1,\n        performanceMetricsCollection: !0,\n        bearingSnap: 7,\n        clickTolerance: 3,\n        pitchWithRotate: !0,\n        hash: !1,\n        attributionControl: !0,\n        failIfMajorPerformanceCaveat: !1,\n        preserveDrawingBuffer: !1,\n        trackResize: !0,\n        optimizeForTerrain: !0,\n        renderWorldCopies: !0,\n        refreshExpiredTiles: !0,\n        minTileCacheSize: null,\n        maxTileCacheSize: null,\n        localIdeographFontFamily: \"sans-serif\",\n        localFontFamily: null,\n        transformRequest: null,\n        accessToken: null,\n        fadeDuration: 300,\n        crossSourceCollisions: !0\n      },\n      hn = {\n        showCompass: !0,\n        showZoom: !0,\n        visualizePitch: !1\n      };\n    var un = /*#__PURE__*/function () {\n      function un(t, i) {\n        var o = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n        _classCallCheck(this, un);\n        this._clickTolerance = 10, this.element = i, this.mouseRotate = new wr({\n          clickTolerance: t.dragRotate._mouseRotate._clickTolerance\n        }), this.map = t, o && (this.mousePitch = new Tr({\n          clickTolerance: t.dragRotate._mousePitch._clickTolerance\n        })), e.bindAll([\"mousedown\", \"mousemove\", \"mouseup\", \"touchstart\", \"touchmove\", \"touchend\", \"reset\"], this), i.addEventListener(\"mousedown\", this.mousedown), i.addEventListener(\"touchstart\", this.touchstart, {\n          passive: !1\n        }), i.addEventListener(\"touchmove\", this.touchmove), i.addEventListener(\"touchend\", this.touchend), i.addEventListener(\"touchcancel\", this.reset);\n      }\n      _createClass(un, [{\n        key: \"down\",\n        value: function down(e, t) {\n          this.mouseRotate.mousedown(e, t), this.mousePitch && this.mousePitch.mousedown(e, t), h();\n        }\n      }, {\n        key: \"move\",\n        value: function move(e, t) {\n          var i = this.map,\n            o = this.mouseRotate.mousemoveWindow(e, t),\n            r = o && o.bearingDelta;\n          if (r && i.setBearing(i.getBearing() + r), this.mousePitch) {\n            var _o184 = this.mousePitch.mousemoveWindow(e, t),\n              _r311 = _o184 && _o184.pitchDelta;\n            _r311 && i.setPitch(i.getPitch() + _r311);\n          }\n        }\n      }, {\n        key: \"off\",\n        value: function off() {\n          var e = this.element;\n          e.removeEventListener(\"mousedown\", this.mousedown), e.removeEventListener(\"touchstart\", this.touchstart, {\n            passive: !1\n          }), e.removeEventListener(\"touchmove\", this.touchmove), e.removeEventListener(\"touchend\", this.touchend), e.removeEventListener(\"touchcancel\", this.reset), this.offTemp();\n        }\n      }, {\n        key: \"offTemp\",\n        value: function offTemp() {\n          u(), e.window.removeEventListener(\"mousemove\", this.mousemove), e.window.removeEventListener(\"mouseup\", this.mouseup);\n        }\n      }, {\n        key: \"mousedown\",\n        value: function mousedown(t) {\n          this.down(e.extend({}, t, {\n            ctrlKey: !0,\n            preventDefault: function preventDefault() {\n              return t.preventDefault();\n            }\n          }), p(this.element, t)), e.window.addEventListener(\"mousemove\", this.mousemove), e.window.addEventListener(\"mouseup\", this.mouseup);\n        }\n      }, {\n        key: \"mousemove\",\n        value: function mousemove(e) {\n          this.move(e, p(this.element, e));\n        }\n      }, {\n        key: \"mouseup\",\n        value: function mouseup(e) {\n          this.mouseRotate.mouseupWindow(e), this.mousePitch && this.mousePitch.mouseupWindow(e), this.offTemp();\n        }\n      }, {\n        key: \"touchstart\",\n        value: function touchstart(e) {\n          1 !== e.targetTouches.length ? this.reset() : (this._startPos = this._lastPos = m(this.element, e.targetTouches)[0], this.down({\n            type: \"mousedown\",\n            button: 0,\n            ctrlKey: !0,\n            preventDefault: function preventDefault() {\n              return e.preventDefault();\n            }\n          }, this._startPos));\n        }\n      }, {\n        key: \"touchmove\",\n        value: function touchmove(e) {\n          1 !== e.targetTouches.length ? this.reset() : (this._lastPos = m(this.element, e.targetTouches)[0], this.move({\n            preventDefault: function preventDefault() {\n              return e.preventDefault();\n            }\n          }, this._lastPos));\n        }\n      }, {\n        key: \"touchend\",\n        value: function touchend(e) {\n          0 === e.targetTouches.length && this._startPos && this._lastPos && this._startPos.dist(this._lastPos) < this._clickTolerance && this.element.click(), this.reset();\n        }\n      }, {\n        key: \"reset\",\n        value: function reset() {\n          this.mouseRotate.reset(), this.mousePitch && this.mousePitch.reset(), delete this._startPos, delete this._lastPos, this.offTemp();\n        }\n      }]);\n      return un;\n    }();\n    var _n = {\n        positionOptions: {\n          enableHighAccuracy: !1,\n          maximumAge: 0,\n          timeout: 6e3\n        },\n        fitBoundsOptions: {\n          maxZoom: 15\n        },\n        trackUserLocation: !1,\n        showAccuracyCircle: !0,\n        showUserLocation: !0,\n        showUserHeading: !1\n      },\n      dn = {\n        maxWidth: 100,\n        unit: \"metric\"\n      };\n    function pn(e, t, i) {\n      var _this139 = this;\n      var o = mn(t),\n        r = o / t,\n        n = {\n          kilometer: \"km\",\n          meter: \"m\",\n          mile: \"mi\",\n          foot: \"ft\",\n          \"nautical-mile\": \"nm\"\n        }[i];\n      this._map._requestDomTask(function () {\n        _this139._container.style.width = e * r + \"px\", _this139._container.innerHTML = \"\".concat(o, \"&nbsp;\").concat(n);\n      });\n    }\n    function mn(e) {\n      var t = Math.pow(10, \"\".concat(Math.floor(e)).length - 1);\n      var i = e / t;\n      return i = i >= 10 ? 10 : i >= 5 ? 5 : i >= 3 ? 3 : i >= 2 ? 2 : i >= 1 ? 1 : function (e) {\n        var t = Math.pow(10, Math.ceil(-Math.log(e) / Math.LN10));\n        return Math.round(e * t) / t;\n      }(i), t * i;\n    }\n    var fn = {\n      version: e.version,\n      supported: i,\n      setRTLTextPlugin: e.setRTLTextPlugin,\n      getRTLTextPluginStatus: e.getRTLTextPluginStatus,\n      Map: /*#__PURE__*/function (_Yr) {\n        _inherits(Map, _Yr);\n        function Map(t) {\n          var _this140;\n          _classCallCheck(this, Map);\n          if (e.LivePerformanceUtils.mark(e.PerformanceMarkers.create), null != (t = e.extend({}, cn, t)).minZoom && null != t.maxZoom && t.minZoom > t.maxZoom) throw new Error(\"maxZoom must be greater than or equal to minZoom\");\n          if (null != t.minPitch && null != t.maxPitch && t.minPitch > t.maxPitch) throw new Error(\"maxPitch must be greater than or equal to minPitch\");\n          if (null != t.minPitch && t.minPitch < 0) throw new Error(\"minPitch must be greater than or equal to 0\");\n          if (null != t.maxPitch && t.maxPitch > 85) throw new Error(\"maxPitch must be less than or equal to 85\");\n          if (t.antialias && e.isSafariWithAntialiasingBug(e.window) && (t.antialias = !1, e.warnOnce(\"Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609\")), _this140 = _possibleConstructorReturn(this, _getPrototypeOf(Map).call(this, new Ko(t.minZoom, t.maxZoom, t.minPitch, t.maxPitch, t.renderWorldCopies), t)), _this140._interactive = t.interactive, _this140._minTileCacheSize = t.minTileCacheSize, _this140._maxTileCacheSize = t.maxTileCacheSize, _this140._failIfMajorPerformanceCaveat = t.failIfMajorPerformanceCaveat, _this140._preserveDrawingBuffer = t.preserveDrawingBuffer, _this140._antialias = t.antialias, _this140._useWebGL2 = t.useWebGL2, _this140._trackResize = t.trackResize, _this140._bearingSnap = t.bearingSnap, _this140._refreshExpiredTiles = t.refreshExpiredTiles, _this140._fadeDuration = t.fadeDuration, _this140._isInitialLoad = !0, _this140._crossSourceCollisions = t.crossSourceCollisions, _this140._collectResourceTiming = t.collectResourceTiming, _this140._optimizeForTerrain = t.optimizeForTerrain, _this140._language = _this140._parseLanguage(t.language), _this140._worldview = t.worldview, _this140._renderTaskQueue = new Qr(), _this140._domRenderTaskQueue = new Qr(), _this140._controls = [], _this140._markers = [], _this140._popups = [], _this140._mapId = e.uniqueId(), _this140._locale = e.extend({}, ln, t.locale), _this140._clickTolerance = t.clickTolerance, _this140._cooperativeGestures = t.cooperativeGestures, _this140._performanceMetricsCollection = t.performanceMetricsCollection, _this140._containerWidth = 0, _this140._containerHeight = 0, _this140._averageElevationLastSampledAt = -1 / 0, _this140._averageElevationExaggeration = 0, _this140._averageElevation = new an(0), _this140._interactionRange = [1 / 0, -1 / 0], _this140._visibilityHidden = 0, _this140._useExplicitProjection = !1, _this140._requestManager = new e.RequestManager(t.transformRequest, t.accessToken, t.testMode), _this140._silenceAuthErrors = !!t.testMode, \"string\" == typeof t.container) {\n            if (_this140._container = e.window.document.getElementById(t.container), !_this140._container) throw new Error(\"Container '\".concat(t.container, \"' not found.\"));\n          } else {\n            if (!(t.container instanceof e.window.HTMLElement)) throw new Error(\"Invalid type: 'container' must be a String or HTMLElement.\");\n            _this140._container = t.container;\n          }\n          if (_this140._container.childNodes.length > 0 && e.warnOnce(\"The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead.\"), t.maxBounds && _this140.setMaxBounds(t.maxBounds), e.bindAll([\"_onWindowOnline\", \"_onWindowResize\", \"_onVisibilityChange\", \"_onMapScroll\", \"_contextLost\", \"_contextRestored\"], _assertThisInitialized(_assertThisInitialized(_this140))), _this140._setupContainer(), _this140._setupPainter(), void 0 === _this140.painter) throw new Error(\"Failed to initialize WebGL.\");\n          _this140.on(\"move\", function () {\n            return _this140._update(!1);\n          }), _this140.on(\"moveend\", function () {\n            return _this140._update(!1);\n          }), _this140.on(\"zoom\", function () {\n            return _this140._update(!0);\n          }), void 0 !== e.window && (e.window.addEventListener(\"online\", _this140._onWindowOnline, !1), e.window.addEventListener(\"resize\", _this140._onWindowResize, !1), e.window.addEventListener(\"orientationchange\", _this140._onWindowResize, !1), e.window.addEventListener(\"webkitfullscreenchange\", _this140._onWindowResize, !1), e.window.addEventListener(\"visibilitychange\", _this140._onVisibilityChange, !1)), _this140.handlers = new $r(_assertThisInitialized(_assertThisInitialized(_this140)), t), _this140._localFontFamily = t.localFontFamily, _this140._localIdeographFontFamily = t.localIdeographFontFamily, t.style && _this140.setStyle(t.style, {\n            localFontFamily: _this140._localFontFamily,\n            localIdeographFontFamily: _this140._localIdeographFontFamily\n          }), t.projection && _this140.setProjection(t.projection), _this140._hash = t.hash && new Qo(\"string\" == typeof t.hash && t.hash || void 0).addTo(_assertThisInitialized(_assertThisInitialized(_this140))), _this140._hash && _this140._hash._onHashChange() || (_this140.jumpTo({\n            center: t.center,\n            zoom: t.zoom,\n            bearing: t.bearing,\n            pitch: t.pitch\n          }), t.bounds && (_this140.resize(), _this140.fitBounds(t.bounds, e.extend({}, t.fitBoundsOptions, {\n            duration: 0\n          })))), _this140.resize(), t.attributionControl && _this140.addControl(new Kr({\n            customAttribution: t.customAttribution\n          })), _this140._logoControl = new Jr(), _this140.addControl(_this140._logoControl, t.logoPosition), _this140.on(\"style.load\", function () {\n            _this140.transform.unmodified && _this140.jumpTo(_this140.style.stylesheet);\n          }), _this140.on(\"data\", function (t) {\n            _this140._update(\"style\" === t.dataType), _this140.fire(new e.Event(\"\".concat(t.dataType, \"data\"), t));\n          }), _this140.on(\"dataloading\", function (t) {\n            _this140.fire(new e.Event(\"\".concat(t.dataType, \"dataloading\"), t));\n          });\n          return _possibleConstructorReturn(_this140);\n        }\n        _createClass(Map, [{\n          key: \"_getMapId\",\n          value: function _getMapId() {\n            return this._mapId;\n          }\n        }, {\n          key: \"addControl\",\n          value: function addControl(t, i) {\n            if (void 0 === i && (i = t.getDefaultPosition ? t.getDefaultPosition() : \"top-right\"), !t || !t.onAdd) return this.fire(new e.ErrorEvent(new Error(\"Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.\")));\n            var o = t.onAdd(this);\n            this._controls.push(t);\n            var r = this._controlPositions[i];\n            return -1 !== i.indexOf(\"bottom\") ? r.insertBefore(o, r.firstChild) : r.appendChild(o), this;\n          }\n        }, {\n          key: \"removeControl\",\n          value: function removeControl(t) {\n            if (!t || !t.onRemove) return this.fire(new e.ErrorEvent(new Error(\"Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.\")));\n            var i = this._controls.indexOf(t);\n            return i > -1 && this._controls.splice(i, 1), t.onRemove(this), this;\n          }\n        }, {\n          key: \"hasControl\",\n          value: function hasControl(e) {\n            return this._controls.indexOf(e) > -1;\n          }\n        }, {\n          key: \"getContainer\",\n          value: function getContainer() {\n            return this._container;\n          }\n        }, {\n          key: \"getCanvasContainer\",\n          value: function getCanvasContainer() {\n            return this._canvasContainer;\n          }\n        }, {\n          key: \"getCanvas\",\n          value: function getCanvas() {\n            return this._canvas;\n          }\n        }, {\n          key: \"resize\",\n          value: function resize(t) {\n            if (this._updateContainerDimensions(), this._containerWidth === this.transform.width && this._containerHeight === this.transform.height) return this;\n            this._resizeCanvas(this._containerWidth, this._containerHeight), this.transform.resize(this._containerWidth, this._containerHeight), this.painter.resize(Math.ceil(this._containerWidth), Math.ceil(this._containerHeight));\n            var i = !this._moving;\n            return i && this.fire(new e.Event(\"movestart\", t)).fire(new e.Event(\"move\", t)), this.fire(new e.Event(\"resize\", t)), i && this.fire(new e.Event(\"moveend\", t)), this;\n          }\n        }, {\n          key: \"getBounds\",\n          value: function getBounds() {\n            return this.transform.getBounds();\n          }\n        }, {\n          key: \"getMaxBounds\",\n          value: function getMaxBounds() {\n            return this.transform.getMaxBounds() || null;\n          }\n        }, {\n          key: \"setMaxBounds\",\n          value: function setMaxBounds(t) {\n            return this.transform.setMaxBounds(e.LngLatBounds.convert(t)), this._update();\n          }\n        }, {\n          key: \"setMinZoom\",\n          value: function setMinZoom(t) {\n            if ((t = null == t ? -2 : t) >= -2 && t <= this.transform.maxZoom) return this.transform.minZoom = t, this._update(), this.getZoom() < t ? this.setZoom(t) : this.fire(new e.Event(\"zoomstart\")).fire(new e.Event(\"zoom\")).fire(new e.Event(\"zoomend\")), this;\n            throw new Error(\"minZoom must be between -2 and the current maxZoom, inclusive\");\n          }\n        }, {\n          key: \"getMinZoom\",\n          value: function getMinZoom() {\n            return this.transform.minZoom;\n          }\n        }, {\n          key: \"setMaxZoom\",\n          value: function setMaxZoom(t) {\n            if ((t = null == t ? 22 : t) >= this.transform.minZoom) return this.transform.maxZoom = t, this._update(), this.getZoom() > t ? this.setZoom(t) : this.fire(new e.Event(\"zoomstart\")).fire(new e.Event(\"zoom\")).fire(new e.Event(\"zoomend\")), this;\n            throw new Error(\"maxZoom must be greater than the current minZoom\");\n          }\n        }, {\n          key: \"getMaxZoom\",\n          value: function getMaxZoom() {\n            return this.transform.maxZoom;\n          }\n        }, {\n          key: \"setMinPitch\",\n          value: function setMinPitch(t) {\n            if ((t = null == t ? 0 : t) < 0) throw new Error(\"minPitch must be greater than or equal to 0\");\n            if (t >= 0 && t <= this.transform.maxPitch) return this.transform.minPitch = t, this._update(), this.getPitch() < t ? this.setPitch(t) : this.fire(new e.Event(\"pitchstart\")).fire(new e.Event(\"pitch\")).fire(new e.Event(\"pitchend\")), this;\n            throw new Error(\"minPitch must be between 0 and the current maxPitch, inclusive\");\n          }\n        }, {\n          key: \"getMinPitch\",\n          value: function getMinPitch() {\n            return this.transform.minPitch;\n          }\n        }, {\n          key: \"setMaxPitch\",\n          value: function setMaxPitch(t) {\n            if ((t = null == t ? 85 : t) > 85) throw new Error(\"maxPitch must be less than or equal to 85\");\n            if (t >= this.transform.minPitch) return this.transform.maxPitch = t, this._update(), this.getPitch() > t ? this.setPitch(t) : this.fire(new e.Event(\"pitchstart\")).fire(new e.Event(\"pitch\")).fire(new e.Event(\"pitchend\")), this;\n            throw new Error(\"maxPitch must be greater than or equal to minPitch\");\n          }\n        }, {\n          key: \"getMaxPitch\",\n          value: function getMaxPitch() {\n            return this.transform.maxPitch;\n          }\n        }, {\n          key: \"getRenderWorldCopies\",\n          value: function getRenderWorldCopies() {\n            return this.transform.renderWorldCopies;\n          }\n        }, {\n          key: \"setRenderWorldCopies\",\n          value: function setRenderWorldCopies(e) {\n            return this.transform.renderWorldCopies = e, this.transform.renderWorldCopies || this._forceMarkerAndPopupUpdate(!0), this._update();\n          }\n        }, {\n          key: \"getLanguage\",\n          value: function getLanguage() {\n            return this._language;\n          }\n        }, {\n          key: \"_parseLanguage\",\n          value: function _parseLanguage(t) {\n            return \"auto\" === t ? e.window.navigator.language : Array.isArray(t) ? 0 === t.length ? void 0 : t.map(function (t) {\n              return \"auto\" === t ? e.window.navigator.language : t;\n            }) : t;\n          }\n        }, {\n          key: \"setLanguage\",\n          value: function setLanguage(e) {\n            var t = this._parseLanguage(e);\n            if (!this.style || t === this._language) return this;\n            this._language = t, this.style._reloadSources();\n            var _iterator283 = _createForOfIteratorHelper(this._controls),\n              _step283;\n            try {\n              for (_iterator283.s(); !(_step283 = _iterator283.n()).done;) {\n                var _e481 = _step283.value;\n                _e481._setLanguage && _e481._setLanguage(this._language);\n              }\n            } catch (err) {\n              _iterator283.e(err);\n            } finally {\n              _iterator283.f();\n            }\n            return this;\n          }\n        }, {\n          key: \"getWorldview\",\n          value: function getWorldview() {\n            return this._worldview;\n          }\n        }, {\n          key: \"setWorldview\",\n          value: function setWorldview(e) {\n            return this.style && e !== this._worldview ? (this._worldview = e, this.style._reloadSources(), this) : this;\n          }\n        }, {\n          key: \"getProjection\",\n          value: function getProjection() {\n            return this.transform.mercatorFromTransition ? {\n              name: \"globe\",\n              center: [0, 0]\n            } : this.transform.getProjection();\n          }\n        }, {\n          key: \"_showingGlobe\",\n          value: function _showingGlobe() {\n            return \"globe\" === this.transform.projection.name;\n          }\n        }, {\n          key: \"setProjection\",\n          value: function setProjection(e) {\n            return this._lazyInitEmptyStyle(), e ? \"string\" == typeof e && (e = {\n              name: e\n            }) : e = null, this._useExplicitProjection = !!e, this._prioritizeAndUpdateProjection(e, this.style.stylesheet ? this.style.stylesheet.projection : null);\n          }\n        }, {\n          key: \"_updateProjectionTransition\",\n          value: function _updateProjectionTransition() {\n            if (\"globe\" !== this.getProjection().name) return;\n            var t = this.transform,\n              i = t.projection.name;\n            var o;\n            \"globe\" === i && t.zoom >= e.GLOBE_ZOOM_THRESHOLD_MAX ? (t.setMercatorFromTransition(), o = !0) : \"mercator\" === i && t.zoom < e.GLOBE_ZOOM_THRESHOLD_MAX && (t.setProjection({\n              name: \"globe\"\n            }), o = !0), o && (this.style.applyProjectionUpdate(), this.style._forceSymbolLayerUpdate());\n          }\n        }, {\n          key: \"_prioritizeAndUpdateProjection\",\n          value: function _prioritizeAndUpdateProjection(e, t) {\n            return this._updateProjection(e || t || {\n              name: \"mercator\"\n            });\n          }\n        }, {\n          key: \"_updateProjection\",\n          value: function _updateProjection(t) {\n            var i;\n            if (i = \"globe\" === t.name && this.transform.zoom >= e.GLOBE_ZOOM_THRESHOLD_MAX ? this.transform.setMercatorFromTransition() : this.transform.setProjection(t), this.style.applyProjectionUpdate(), i) {\n              this.painter.clearBackgroundTiles();\n              for (var _e482 in this.style._sourceCaches) this.style._sourceCaches[_e482].clearTiles();\n              this._update(!0), this._forceMarkerAndPopupUpdate(!0);\n            }\n            return this;\n          }\n        }, {\n          key: \"project\",\n          value: function project(t) {\n            return this.transform.locationPoint3D(e.LngLat.convert(t));\n          }\n        }, {\n          key: \"unproject\",\n          value: function unproject(t) {\n            return this.transform.pointLocation3D(e.pointGeometry.convert(t));\n          }\n        }, {\n          key: \"isMoving\",\n          value: function isMoving() {\n            return this._moving || this.handlers && this.handlers.isMoving() || !1;\n          }\n        }, {\n          key: \"isZooming\",\n          value: function isZooming() {\n            return this._zooming || this.handlers && this.handlers.isZooming() || !1;\n          }\n        }, {\n          key: \"isRotating\",\n          value: function isRotating() {\n            return this._rotating || this.handlers && this.handlers.isRotating() || !1;\n          }\n        }, {\n          key: \"_isDragging\",\n          value: function _isDragging() {\n            return this.handlers && this.handlers._isDragging() || !1;\n          }\n        }, {\n          key: \"_createDelegatedListener\",\n          value: function _createDelegatedListener(e, t, i) {\n            var _this141 = this;\n            if (\"mouseenter\" === e || \"mouseover\" === e) {\n              var _o185 = !1;\n              var _r312 = function _r312(r) {\n                  var n = t.filter(function (e) {\n                      return _this141.getLayer(e);\n                    }),\n                    s = n.length ? _this141.queryRenderedFeatures(r.point, {\n                      layers: n\n                    }) : [];\n                  s.length ? _o185 || (_o185 = !0, i.call(_this141, new cr(e, _this141, r.originalEvent, {\n                    features: s\n                  }))) : _o185 = !1;\n                },\n                _n219 = function _n219() {\n                  _o185 = !1;\n                };\n              return {\n                layers: new Set(t),\n                listener: i,\n                delegates: {\n                  mousemove: _r312,\n                  mouseout: _n219\n                }\n              };\n            }\n            if (\"mouseleave\" === e || \"mouseout\" === e) {\n              var _o186 = !1;\n              var _r313 = function _r313(r) {\n                  var n = t.filter(function (e) {\n                    return _this141.getLayer(e);\n                  });\n                  (n.length ? _this141.queryRenderedFeatures(r.point, {\n                    layers: n\n                  }) : []).length ? _o186 = !0 : _o186 && (_o186 = !1, i.call(_this141, new cr(e, _this141, r.originalEvent)));\n                },\n                _n220 = function _n220(t) {\n                  _o186 && (_o186 = !1, i.call(_this141, new cr(e, _this141, t.originalEvent)));\n                };\n              return {\n                layers: new Set(t),\n                listener: i,\n                delegates: {\n                  mousemove: _r313,\n                  mouseout: _n220\n                }\n              };\n            }\n            {\n              var _o187 = function _o187(e) {\n                var o = t.filter(function (e) {\n                    return _this141.getLayer(e);\n                  }),\n                  r = o.length ? _this141.queryRenderedFeatures(e.point, {\n                    layers: o\n                  }) : [];\n                r.length && (e.features = r, i.call(_this141, e), delete e.features);\n              };\n              return {\n                layers: new Set(t),\n                listener: i,\n                delegates: _defineProperty({}, e, _o187)\n              };\n            }\n          }\n        }, {\n          key: \"on\",\n          value: function on(e, t, i) {\n            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), \"on\", this).call(this, e, t);\n            Array.isArray(t) || (t = [t]);\n            var o = this._createDelegatedListener(e, t, i);\n            this._delegatedListeners = this._delegatedListeners || {}, this._delegatedListeners[e] = this._delegatedListeners[e] || [], this._delegatedListeners[e].push(o);\n            for (var _e483 in o.delegates) this.on(_e483, o.delegates[_e483]);\n            return this;\n          }\n        }, {\n          key: \"once\",\n          value: function once(e, t, i) {\n            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), \"once\", this).call(this, e, t);\n            Array.isArray(t) || (t = [t]);\n            var o = this._createDelegatedListener(e, t, i);\n            for (var _e484 in o.delegates) this.once(_e484, o.delegates[_e484]);\n            return this;\n          }\n        }, {\n          key: \"off\",\n          value: function off(e, t, i) {\n            var _this142 = this;\n            if (void 0 === i) return _get(_getPrototypeOf(Map.prototype), \"off\", this).call(this, e, t);\n            t = new Set(Array.isArray(t) ? t : [t]);\n            var o = function o(e, t) {\n                if (e.size !== t.size) return !1;\n                var _iterator284 = _createForOfIteratorHelper(e),\n                  _step284;\n                try {\n                  for (_iterator284.s(); !(_step284 = _iterator284.n()).done;) {\n                    var _i323 = _step284.value;\n                    if (!t.has(_i323)) return !1;\n                  }\n                } catch (err) {\n                  _iterator284.e(err);\n                } finally {\n                  _iterator284.f();\n                }\n                return !0;\n              },\n              r = this._delegatedListeners ? this._delegatedListeners[e] : void 0;\n            return r && function (e) {\n              for (var _r314 = 0; _r314 < e.length; _r314++) {\n                var _n221 = e[_r314];\n                if (_n221.listener === i && o(_n221.layers, t)) {\n                  for (var _e485 in _n221.delegates) _this142.off(_e485, _n221.delegates[_e485]);\n                  return e.splice(_r314, 1), _this142;\n                }\n              }\n            }(r), this;\n          }\n        }, {\n          key: \"queryRenderedFeatures\",\n          value: function queryRenderedFeatures(t, i) {\n            return this.style ? (void 0 !== i || void 0 === t || t instanceof e.pointGeometry || Array.isArray(t) || (i = t, t = void 0), this.style.queryRenderedFeatures(t = t || [[0, 0], [this.transform.width, this.transform.height]], i = i || {}, this.transform)) : [];\n          }\n        }, {\n          key: \"querySourceFeatures\",\n          value: function querySourceFeatures(e, t) {\n            return this.style.querySourceFeatures(e, t);\n          }\n        }, {\n          key: \"setStyle\",\n          value: function setStyle(t, i) {\n            return !1 !== (i = e.extend({}, {\n              localIdeographFontFamily: this._localIdeographFontFamily,\n              localFontFamily: this._localFontFamily\n            }, i)).diff && i.localIdeographFontFamily === this._localIdeographFontFamily && i.localFontFamily === this._localFontFamily && this.style && t ? (this._diffStyle(t, i), this) : (this._localIdeographFontFamily = i.localIdeographFontFamily, this._localFontFamily = i.localFontFamily, this._updateStyle(t, i));\n          }\n        }, {\n          key: \"_getUIString\",\n          value: function _getUIString(e) {\n            var t = this._locale[e];\n            if (null == t) throw new Error(\"Missing UI string '\".concat(e, \"'\"));\n            return t;\n          }\n        }, {\n          key: \"_updateStyle\",\n          value: function _updateStyle(e, t) {\n            return this.style && (this.style.setEventedParent(null), this.style._remove(), this.style = void 0), e && (this.style = new Qt(this, t || {}), this.style.setEventedParent(this, {\n              style: this.style\n            }), \"string\" == typeof e ? this.style.loadURL(e) : this.style.loadJSON(e)), this._updateTerrain(), this;\n          }\n        }, {\n          key: \"_lazyInitEmptyStyle\",\n          value: function _lazyInitEmptyStyle() {\n            this.style || (this.style = new Qt(this, {}), this.style.setEventedParent(this, {\n              style: this.style\n            }), this.style.loadEmpty());\n          }\n        }, {\n          key: \"_diffStyle\",\n          value: function _diffStyle(t, i) {\n            var _this143 = this;\n            if (\"string\" == typeof t) {\n              var _o188 = this._requestManager.normalizeStyleURL(t),\n                _r315 = this._requestManager.transformRequest(_o188, e.ResourceType.Style);\n              e.getJSON(_r315, function (t, o) {\n                t ? _this143.fire(new e.ErrorEvent(t)) : o && _this143._updateDiff(o, i);\n              });\n            } else \"object\" == typeof t && this._updateDiff(t, i);\n          }\n        }, {\n          key: \"_updateDiff\",\n          value: function _updateDiff(t, i) {\n            try {\n              this.style.setState(t) && this._update(!0);\n            } catch (o) {\n              e.warnOnce(\"Unable to perform style diff: \".concat(o.message || o.error || o, \".  Rebuilding the style from scratch.\")), this._updateStyle(t, i);\n            }\n          }\n        }, {\n          key: \"getStyle\",\n          value: function getStyle() {\n            if (this.style) return this.style.serialize();\n          }\n        }, {\n          key: \"isStyleLoaded\",\n          value: function isStyleLoaded() {\n            return this.style ? this.style.loaded() : (e.warnOnce(\"There is no style added to the map.\"), !1);\n          }\n        }, {\n          key: \"addSource\",\n          value: function addSource(e, t) {\n            return this._lazyInitEmptyStyle(), this.style.addSource(e, t), this._update(!0);\n          }\n        }, {\n          key: \"isSourceLoaded\",\n          value: function isSourceLoaded(e) {\n            return !!this.style && this.style._isSourceCacheLoaded(e);\n          }\n        }, {\n          key: \"areTilesLoaded\",\n          value: function areTilesLoaded() {\n            var e = this.style && this.style._sourceCaches;\n            for (var _t473 in e) {\n              var _i324 = e[_t473]._tiles;\n              for (var _e486 in _i324) {\n                var _t474 = _i324[_e486];\n                if (\"loaded\" !== _t474.state && \"errored\" !== _t474.state) return !1;\n              }\n            }\n            return !0;\n          }\n        }, {\n          key: \"addSourceType\",\n          value: function addSourceType(e, t, i) {\n            this._lazyInitEmptyStyle(), this.style.addSourceType(e, t, i);\n          }\n        }, {\n          key: \"removeSource\",\n          value: function removeSource(e) {\n            return this.style.removeSource(e), this._updateTerrain(), this._update(!0);\n          }\n        }, {\n          key: \"getSource\",\n          value: function getSource(e) {\n            return this.style.getSource(e);\n          }\n        }, {\n          key: \"addImage\",\n          value: function addImage(t, i) {\n            var _ref151 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n              _ref151$pixelRatio = _ref151.pixelRatio,\n              o = _ref151$pixelRatio === void 0 ? 1 : _ref151$pixelRatio,\n              _ref151$sdf = _ref151.sdf,\n              r = _ref151$sdf === void 0 ? !1 : _ref151$sdf,\n              n = _ref151.stretchX,\n              s = _ref151.stretchY,\n              a = _ref151.content;\n            if (this._lazyInitEmptyStyle(), i instanceof e.window.HTMLImageElement || e.window.ImageBitmap && i instanceof e.window.ImageBitmap) {\n              var _e$exported$getImageD = e.exported.getImageData(i),\n                _l87 = _e$exported$getImageD.width,\n                _c72 = _e$exported$getImageD.height,\n                _h51 = _e$exported$getImageD.data;\n              this.style.addImage(t, {\n                data: new e.RGBAImage({\n                  width: _l87,\n                  height: _c72\n                }, _h51),\n                pixelRatio: o,\n                stretchX: n,\n                stretchY: s,\n                content: a,\n                sdf: r,\n                version: 0\n              });\n            } else if (void 0 === i.width || void 0 === i.height) this.fire(new e.ErrorEvent(new Error(\"Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`\")));else {\n              var _l88 = i.width,\n                _c73 = i.height,\n                _h52 = i;\n              this.style.addImage(t, {\n                data: new e.RGBAImage({\n                  width: _l88,\n                  height: _c73\n                }, new Uint8Array(_h52.data)),\n                pixelRatio: o,\n                stretchX: n,\n                stretchY: s,\n                content: a,\n                sdf: r,\n                version: 0,\n                userImage: _h52\n              }), _h52.onAdd && _h52.onAdd(this, t);\n            }\n          }\n        }, {\n          key: \"updateImage\",\n          value: function updateImage(t, i) {\n            var o = this.style.getImage(t);\n            if (!o) return void this.fire(new e.ErrorEvent(new Error(\"The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.\")));\n            var r = i instanceof e.window.HTMLImageElement || e.window.ImageBitmap && i instanceof e.window.ImageBitmap ? e.exported.getImageData(i) : i,\n              n = r.width,\n              s = r.height;\n            void 0 !== n && void 0 !== s ? n === o.data.width && s === o.data.height ? (o.data.replace(r.data, !(i instanceof e.window.HTMLImageElement || e.window.ImageBitmap && i instanceof e.window.ImageBitmap)), this.style.updateImage(t, o)) : this.fire(new e.ErrorEvent(new Error(\"The width and height of the updated image (\".concat(n, \", \").concat(s, \")\\n                must be that same as the previous version of the image\\n                (\").concat(o.data.width, \", \").concat(o.data.height, \")\")))) : this.fire(new e.ErrorEvent(new Error(\"Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`\")));\n          }\n        }, {\n          key: \"hasImage\",\n          value: function hasImage(t) {\n            return t ? !!this.style.getImage(t) : (this.fire(new e.ErrorEvent(new Error(\"Missing required image id\"))), !1);\n          }\n        }, {\n          key: \"removeImage\",\n          value: function removeImage(e) {\n            this.style.removeImage(e);\n          }\n        }, {\n          key: \"loadImage\",\n          value: function loadImage(t, i) {\n            e.getImage(this._requestManager.transformRequest(t, e.ResourceType.Image), function (t, o) {\n              i(t, o instanceof e.window.HTMLImageElement ? e.exported.getImageData(o) : o);\n            });\n          }\n        }, {\n          key: \"listImages\",\n          value: function listImages() {\n            return this.style.listImages();\n          }\n        }, {\n          key: \"addLayer\",\n          value: function addLayer(e, t) {\n            return this._lazyInitEmptyStyle(), this.style.addLayer(e, t), this._update(!0);\n          }\n        }, {\n          key: \"moveLayer\",\n          value: function moveLayer(e, t) {\n            return this.style.moveLayer(e, t), this._update(!0);\n          }\n        }, {\n          key: \"removeLayer\",\n          value: function removeLayer(e) {\n            return this.style.removeLayer(e), this._update(!0);\n          }\n        }, {\n          key: \"getLayer\",\n          value: function getLayer(e) {\n            return this.style.getLayer(e);\n          }\n        }, {\n          key: \"setLayerZoomRange\",\n          value: function setLayerZoomRange(e, t, i) {\n            return this.style.setLayerZoomRange(e, t, i), this._update(!0);\n          }\n        }, {\n          key: \"setFilter\",\n          value: function setFilter(e, t) {\n            var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n            return this.style.setFilter(e, t, i), this._update(!0);\n          }\n        }, {\n          key: \"getFilter\",\n          value: function getFilter(e) {\n            return this.style.getFilter(e);\n          }\n        }, {\n          key: \"setPaintProperty\",\n          value: function setPaintProperty(e, t, i) {\n            var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n            return this.style.setPaintProperty(e, t, i, o), this._update(!0);\n          }\n        }, {\n          key: \"getPaintProperty\",\n          value: function getPaintProperty(e, t) {\n            return this.style.getPaintProperty(e, t);\n          }\n        }, {\n          key: \"setLayoutProperty\",\n          value: function setLayoutProperty(e, t, i) {\n            var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n            return this.style.setLayoutProperty(e, t, i, o), this._update(!0);\n          }\n        }, {\n          key: \"getLayoutProperty\",\n          value: function getLayoutProperty(e, t) {\n            return this.style.getLayoutProperty(e, t);\n          }\n        }, {\n          key: \"setLight\",\n          value: function setLight(e) {\n            var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n            return this._lazyInitEmptyStyle(), this.style.setLight(e, t), this._update(!0);\n          }\n        }, {\n          key: \"getLight\",\n          value: function getLight() {\n            return this.style.getLight();\n          }\n        }, {\n          key: \"setTerrain\",\n          value: function setTerrain(e) {\n            return this._lazyInitEmptyStyle(), !e && this.transform.projection.requiresDraping ? this.style.setTerrainForDraping() : this.style.setTerrain(e), this._averageElevationLastSampledAt = -1 / 0, this._update(!0);\n          }\n        }, {\n          key: \"getTerrain\",\n          value: function getTerrain() {\n            return this.style ? this.style.getTerrain() : null;\n          }\n        }, {\n          key: \"setFog\",\n          value: function setFog(e) {\n            return this._lazyInitEmptyStyle(), this.style.setFog(e), this._update(!0);\n          }\n        }, {\n          key: \"getFog\",\n          value: function getFog() {\n            return this.style ? this.style.getFog() : null;\n          }\n        }, {\n          key: \"_queryFogOpacity\",\n          value: function _queryFogOpacity(t) {\n            return this.style && this.style.fog ? this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t), this.transform) : 0;\n          }\n        }, {\n          key: \"setFeatureState\",\n          value: function setFeatureState(e, t) {\n            return this.style.setFeatureState(e, t), this._update();\n          }\n        }, {\n          key: \"removeFeatureState\",\n          value: function removeFeatureState(e, t) {\n            return this.style.removeFeatureState(e, t), this._update();\n          }\n        }, {\n          key: \"getFeatureState\",\n          value: function getFeatureState(e) {\n            return this.style.getFeatureState(e);\n          }\n        }, {\n          key: \"_updateContainerDimensions\",\n          value: function _updateContainerDimensions() {\n            if (!this._container) return;\n            var t = this._container.getBoundingClientRect().width || 400,\n              i = this._container.getBoundingClientRect().height || 300;\n            var o,\n              r,\n              n,\n              s = this._container;\n            for (; s && (!r || !n);) {\n              var _t475 = e.window.getComputedStyle(s).transform;\n              _t475 && \"none\" !== _t475 && (o = _t475.match(/matrix.*\\((.+)\\)/)[1].split(\", \"), o[0] && \"0\" !== o[0] && \"1\" !== o[0] && (r = o[0]), o[3] && \"0\" !== o[3] && \"1\" !== o[3] && (n = o[3])), s = s.parentElement;\n            }\n            this._containerWidth = r ? Math.abs(t / r) : t, this._containerHeight = n ? Math.abs(i / n) : i;\n          }\n        }, {\n          key: \"_detectMissingCSS\",\n          value: function _detectMissingCSS() {\n            \"rgb(250, 128, 114)\" !== e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue(\"background-color\") && e.warnOnce(\"This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.\");\n          }\n        }, {\n          key: \"_setupContainer\",\n          value: function _setupContainer() {\n            var e = this._container;\n            e.classList.add(\"mapboxgl-map\"), (this._missingCSSCanary = n(\"div\", \"mapboxgl-canary\", e)).style.visibility = \"hidden\", this._detectMissingCSS();\n            var t = this._canvasContainer = n(\"div\", \"mapboxgl-canvas-container\", e);\n            this._interactive && t.classList.add(\"mapboxgl-interactive\"), this._canvas = n(\"canvas\", \"mapboxgl-canvas\", t), this._canvas.addEventListener(\"webglcontextlost\", this._contextLost, !1), this._canvas.addEventListener(\"webglcontextrestored\", this._contextRestored, !1), this._canvas.setAttribute(\"tabindex\", \"0\"), this._canvas.setAttribute(\"aria-label\", this._getUIString(\"Map.Title\")), this._canvas.setAttribute(\"role\", \"region\"), this._updateContainerDimensions(), this._resizeCanvas(this._containerWidth, this._containerHeight);\n            var i = this._controlContainer = n(\"div\", \"mapboxgl-control-container\", e),\n              o = this._controlPositions = {};\n            [\"top-left\", \"top-right\", \"bottom-left\", \"bottom-right\"].forEach(function (e) {\n              o[e] = n(\"div\", \"mapboxgl-ctrl-\".concat(e), i);\n            }), this._container.addEventListener(\"scroll\", this._onMapScroll, !1);\n          }\n        }, {\n          key: \"_resizeCanvas\",\n          value: function _resizeCanvas(t, i) {\n            var o = e.exported.devicePixelRatio || 1;\n            this._canvas.width = o * Math.ceil(t), this._canvas.height = o * Math.ceil(i), this._canvas.style.width = \"\".concat(t, \"px\"), this._canvas.style.height = \"\".concat(i, \"px\");\n          }\n        }, {\n          key: \"_addMarker\",\n          value: function _addMarker(e) {\n            this._markers.push(e);\n          }\n        }, {\n          key: \"_removeMarker\",\n          value: function _removeMarker(e) {\n            var t = this._markers.indexOf(e);\n            -1 !== t && this._markers.splice(t, 1);\n          }\n        }, {\n          key: \"_addPopup\",\n          value: function _addPopup(e) {\n            this._popups.push(e);\n          }\n        }, {\n          key: \"_removePopup\",\n          value: function _removePopup(e) {\n            var t = this._popups.indexOf(e);\n            -1 !== t && this._popups.splice(t, 1);\n          }\n        }, {\n          key: \"_setupPainter\",\n          value: function _setupPainter() {\n            var _this144 = this;\n            var t = e.extend({}, i.webGLContextAttributes, {\n                failIfMajorPerformanceCaveat: this._failIfMajorPerformanceCaveat,\n                preserveDrawingBuffer: this._preserveDrawingBuffer,\n                antialias: this._antialias || !1\n              }),\n              o = this._useWebGL2 && this._canvas.getContext(\"webgl2\", t),\n              r = o || this._canvas.getContext(\"webgl\", t) || this._canvas.getContext(\"experimental-webgl\", t);\n            r ? (this._useWebGL2 && !o && e.warnOnce(\"Failed to create WebGL 2 context. Using WebGL 1.\"), e.storeAuthState(r, !0), this.painter = new Fo(r, this.transform, !!o), this.on(\"data\", function (e) {\n              \"source\" === e.dataType && _this144.painter.setTileLoadedFlag(!0);\n            }), e.exported$1.testSupport(r)) : this.fire(new e.ErrorEvent(new Error(\"Failed to initialize WebGL\")));\n          }\n        }, {\n          key: \"_contextLost\",\n          value: function _contextLost(t) {\n            t.preventDefault(), this._frame && (this._frame.cancel(), this._frame = null), this.fire(new e.Event(\"webglcontextlost\", {\n              originalEvent: t\n            }));\n          }\n        }, {\n          key: \"_contextRestored\",\n          value: function _contextRestored(t) {\n            this._setupPainter(), this.resize(), this._update(), this.fire(new e.Event(\"webglcontextrestored\", {\n              originalEvent: t\n            }));\n          }\n        }, {\n          key: \"_onMapScroll\",\n          value: function _onMapScroll(e) {\n            if (e.target === this._container) return this._container.scrollTop = 0, this._container.scrollLeft = 0, !1;\n          }\n        }, {\n          key: \"loaded\",\n          value: function loaded() {\n            return !this._styleDirty && !this._sourcesDirty && !!this.style && this.style.loaded();\n          }\n        }, {\n          key: \"_update\",\n          value: function _update(e) {\n            return this.style ? (this._styleDirty = this._styleDirty || e, this._sourcesDirty = !0, this.triggerRepaint(), this) : this;\n          }\n        }, {\n          key: \"_requestRenderFrame\",\n          value: function _requestRenderFrame(e) {\n            return this._update(), this._renderTaskQueue.add(e);\n          }\n        }, {\n          key: \"_cancelRenderFrame\",\n          value: function _cancelRenderFrame(e) {\n            this._renderTaskQueue.remove(e);\n          }\n        }, {\n          key: \"_requestDomTask\",\n          value: function _requestDomTask(e) {\n            !this.loaded() || this.loaded() && !this.isMoving() ? e() : this._domRenderTaskQueue.add(e);\n          }\n        }, {\n          key: \"_render\",\n          value: function _render(t) {\n            var _this145 = this;\n            var i;\n            var o = this.painter.context.extTimerQuery,\n              r = e.exported.now();\n            if (this.listens(\"gpu-timing-frame\") && (i = o.createQueryEXT(), o.beginQueryEXT(o.TIME_ELAPSED_EXT, i)), this.painter.context.setDirty(), this.painter.setBaseState(), (this.isMoving() || this.isRotating() || this.isZooming()) && (this._interactionRange[0] = Math.min(this._interactionRange[0], e.window.performance.now()), this._interactionRange[1] = Math.max(this._interactionRange[1], e.window.performance.now())), this._renderTaskQueue.run(t), this._domRenderTaskQueue.run(t), this._removed) return;\n            this._updateProjectionTransition();\n            var n = this._isInitialLoad ? 0 : this._fadeDuration;\n            if (this.style && this._styleDirty) {\n              this._styleDirty = !1;\n              var _t476 = this.transform.zoom,\n                _i325 = this.transform.pitch,\n                _o189 = e.exported.now(),\n                _r316 = new e.EvaluationParameters(_t476, {\n                  now: _o189,\n                  fadeDuration: n,\n                  pitch: _i325,\n                  transition: this.style.getTransition()\n                });\n              this.style.update(_r316);\n            }\n            this.style && this.style.fog && this.style.fog.hasTransition() && (this.style._markersNeedUpdate = !0, this._sourcesDirty = !0);\n            var s = !1;\n            if (this.style && this._sourcesDirty ? (this._sourcesDirty = !1, this.painter._updateFog(this.style), this._updateTerrain(), s = this._updateAverageElevation(r), this.style._updateSources(this.transform), this._forceMarkerAndPopupUpdate()) : s = this._updateAverageElevation(r), this._placementDirty = this.style && this.style._updatePlacement(this.painter.transform, this.showCollisionBoxes, n, this._crossSourceCollisions), this.style && this.painter.render(this.style, {\n              showTileBoundaries: this.showTileBoundaries,\n              showTerrainWireframe: this.showTerrainWireframe,\n              showOverdrawInspector: this._showOverdrawInspector,\n              showQueryGeometry: !!this._showQueryGeometry,\n              showTileAABBs: this.showTileAABBs,\n              rotating: this.isRotating(),\n              zooming: this.isZooming(),\n              moving: this.isMoving(),\n              fadeDuration: n,\n              isInitialLoad: this._isInitialLoad,\n              showPadding: this.showPadding,\n              gpuTiming: !!this.listens(\"gpu-timing-layer\"),\n              gpuTimingDeferredRender: !!this.listens(\"gpu-timing-deferred-render\"),\n              speedIndexTiming: this.speedIndexTiming\n            }), this.fire(new e.Event(\"render\")), this.loaded() && !this._loaded && (this._loaded = !0, this.fire(new e.Event(\"load\"))), this.style && this.style.hasTransitions() && (this._styleDirty = !0), this.style && !this._placementDirty && this.style._releaseSymbolFadeTiles(), i) {\n              var _t477 = e.exported.now() - r;\n              o.endQueryEXT(o.TIME_ELAPSED_EXT, i), setTimeout(function () {\n                var n = o.getQueryObjectEXT(i, o.QUERY_RESULT_EXT) / 1e6;\n                o.deleteQueryEXT(i), _this145.fire(new e.Event(\"gpu-timing-frame\", {\n                  cpuTime: _t477,\n                  gpuTime: n\n                })), e.window.performance.mark(\"frame-gpu\", {\n                  startTime: r,\n                  detail: {\n                    gpuTime: n\n                  }\n                });\n              }, 50);\n            }\n            if (this.listens(\"gpu-timing-layer\")) {\n              var _t478 = this.painter.collectGpuTimers();\n              setTimeout(function () {\n                var i = _this145.painter.queryGpuTimers(_t478);\n                _this145.fire(new e.Event(\"gpu-timing-layer\", {\n                  layerTimes: i\n                }));\n              }, 50);\n            }\n            if (this.listens(\"gpu-timing-deferred-render\")) {\n              var _t479 = this.painter.collectDeferredRenderGpuQueries();\n              setTimeout(function () {\n                var i = _this145.painter.queryGpuTimeDeferredRender(_t479);\n                _this145.fire(new e.Event(\"gpu-timing-deferred-render\", {\n                  gpuTime: i\n                }));\n              }, 50);\n            }\n            var a = this._sourcesDirty || this._styleDirty || this._placementDirty || s;\n            if (a || this._repaint) this.triggerRepaint();else {\n              var _t480 = !this.isMoving() && this.loaded();\n              if (_t480 && (s = this._updateAverageElevation(r, !0)), s) this.triggerRepaint();else if (this._triggerFrame(!1), _t480 && (this.fire(new e.Event(\"idle\")), this._isInitialLoad = !1, this.speedIndexTiming)) {\n                var _t481 = this._calculateSpeedIndex();\n                this.fire(new e.Event(\"speedindexcompleted\", {\n                  speedIndex: _t481\n                })), this.speedIndexTiming = !1;\n              }\n            }\n            !this._loaded || this._fullyLoaded || a || (this._fullyLoaded = !0, e.LivePerformanceUtils.mark(e.PerformanceMarkers.fullLoad), this._performanceMetricsCollection && e.postPerformanceEvent(this._requestManager._customAccessToken, {\n              width: this.painter.width,\n              height: this.painter.height,\n              interactionRange: this._interactionRange,\n              visibilityHidden: this._visibilityHidden,\n              terrainEnabled: !!this.painter.style.getTerrain(),\n              fogEnabled: !!this.painter.style.getFog(),\n              projection: this.getProjection().name,\n              zoom: this.transform.zoom,\n              renderer: this.painter.context.renderer,\n              vendor: this.painter.context.vendor\n            }), this._authenticate());\n          }\n        }, {\n          key: \"_forceMarkerAndPopupUpdate\",\n          value: function _forceMarkerAndPopupUpdate(e) {\n            var _iterator285 = _createForOfIteratorHelper(this._markers),\n              _step285;\n            try {\n              for (_iterator285.s(); !(_step285 = _iterator285.n()).done;) {\n                var _t482 = _step285.value;\n                e && !this.getRenderWorldCopies() && (_t482._lngLat = _t482._lngLat.wrap()), _t482._update();\n              }\n            } catch (err) {\n              _iterator285.e(err);\n            } finally {\n              _iterator285.f();\n            }\n            var _iterator286 = _createForOfIteratorHelper(this._popups),\n              _step286;\n            try {\n              for (_iterator286.s(); !(_step286 = _iterator286.n()).done;) {\n                var _t483 = _step286.value;\n                !e || this.getRenderWorldCopies() || _t483._trackPointer || (_t483._lngLat = _t483._lngLat.wrap()), _t483._update();\n              }\n            } catch (err) {\n              _iterator286.e(err);\n            } finally {\n              _iterator286.f();\n            }\n          }\n        }, {\n          key: \"_updateAverageElevation\",\n          value: function _updateAverageElevation(e) {\n            var _this146 = this;\n            var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n            var i = function i(e) {\n              return _this146.transform.averageElevation = e, _this146._update(!1), !0;\n            };\n            if (!this.painter.averageElevationNeedsEasing()) return 0 !== this.transform.averageElevation && i(0);\n            if ((t || e - this._averageElevationLastSampledAt > 500) && !this._averageElevation.isEasing(e)) {\n              var _t484 = this.transform.averageElevation;\n              var _o190 = this.transform.sampleAverageElevation(),\n                _r317 = !1;\n              this.transform.elevation && (_r317 = this.transform.elevation.exaggeration() !== this._averageElevationExaggeration, this._averageElevationExaggeration = this.transform.elevation.exaggeration()), isNaN(_o190) ? _o190 = 0 : this._averageElevationLastSampledAt = e;\n              var _n222 = Math.abs(_t484 - _o190);\n              if (_n222 > 1) {\n                if (this._isInitialLoad || _r317) return this._averageElevation.jumpTo(_o190), i(_o190);\n                this._averageElevation.easeTo(_o190, e, 300);\n              } else if (_n222 > 1e-4) return this._averageElevation.jumpTo(_o190), i(_o190);\n            }\n            return !!this._averageElevation.isEasing(e) && i(this._averageElevation.getValue(e));\n          }\n        }, {\n          key: \"_authenticate\",\n          value: function _authenticate() {\n            var _this147 = this;\n            e.getMapSessionAPI(this._getMapId(), this._requestManager._skuToken, this._requestManager._customAccessToken, function (t) {\n              if (t && (t.message === e.AUTH_ERR_MSG || 401 === t.status)) {\n                var _t485 = _this147.painter.context.gl;\n                e.storeAuthState(_t485, !1), _this147._logoControl instanceof Jr && _this147._logoControl._updateLogo(), _t485 && _t485.clear(_t485.DEPTH_BUFFER_BIT | _t485.COLOR_BUFFER_BIT | _t485.STENCIL_BUFFER_BIT), _this147._silenceAuthErrors || _this147.fire(new e.ErrorEvent(new Error(\"A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/\")));\n              }\n            }), e.postMapLoadEvent(this._getMapId(), this._requestManager._skuToken, this._requestManager._customAccessToken, function () {});\n          }\n        }, {\n          key: \"_updateTerrain\",\n          value: function _updateTerrain() {\n            var e = this._isDragging();\n            this.painter.updateTerrain(this.style, e);\n          }\n        }, {\n          key: \"_calculateSpeedIndex\",\n          value: function _calculateSpeedIndex() {\n            var e = this.painter.canvasCopy(),\n              t = this.painter.getCanvasCopiesAndTimestamps();\n            t.timeStamps.push(performance.now());\n            var i = this.painter.context.gl,\n              o = i.createFramebuffer();\n            function r(e) {\n              i.framebufferTexture2D(i.FRAMEBUFFER, i.COLOR_ATTACHMENT0, i.TEXTURE_2D, e, 0);\n              var t = new Uint8Array(i.drawingBufferWidth * i.drawingBufferHeight * 4);\n              return i.readPixels(0, 0, i.drawingBufferWidth, i.drawingBufferHeight, i.RGBA, i.UNSIGNED_BYTE, t), t;\n            }\n            return i.bindFramebuffer(i.FRAMEBUFFER, o), this._canvasPixelComparison(r(e), t.canvasCopies.map(r), t.timeStamps);\n          }\n        }, {\n          key: \"_canvasPixelComparison\",\n          value: function _canvasPixelComparison(e, t, i) {\n            var o = i[1] - i[0];\n            var r = e.length / 4;\n            for (var _n223 = 0; _n223 < t.length; _n223++) {\n              var _s173 = t[_n223];\n              var _a143 = 0;\n              for (var _t486 = 0; _t486 < _s173.length; _t486 += 4) _s173[_t486] === e[_t486] && _s173[_t486 + 1] === e[_t486 + 1] && _s173[_t486 + 2] === e[_t486 + 2] && _s173[_t486 + 3] === e[_t486 + 3] && (_a143 += 1);\n              o += (i[_n223 + 2] - i[_n223 + 1]) * (1 - _a143 / r);\n            }\n            return o;\n          }\n        }, {\n          key: \"remove\",\n          value: function remove() {\n            this._hash && this._hash.remove();\n            var _iterator287 = _createForOfIteratorHelper(this._controls),\n              _step287;\n            try {\n              for (_iterator287.s(); !(_step287 = _iterator287.n()).done;) {\n                var _e487 = _step287.value;\n                _e487.onRemove(this);\n              }\n            } catch (err) {\n              _iterator287.e(err);\n            } finally {\n              _iterator287.f();\n            }\n            this._controls = [], this._frame && (this._frame.cancel(), this._frame = null), this._renderTaskQueue.clear(), this._domRenderTaskQueue.clear(), this.style && this.style.destroy(), this.painter.destroy(), this.handlers && this.handlers.destroy(), this.handlers = void 0, this.setStyle(null), void 0 !== e.window && (e.window.removeEventListener(\"resize\", this._onWindowResize, !1), e.window.removeEventListener(\"orientationchange\", this._onWindowResize, !1), e.window.removeEventListener(\"webkitfullscreenchange\", this._onWindowResize, !1), e.window.removeEventListener(\"online\", this._onWindowOnline, !1), e.window.removeEventListener(\"visibilitychange\", this._onVisibilityChange, !1));\n            var t = this.painter.context.gl.getExtension(\"WEBGL_lose_context\");\n            t && t.loseContext(), this._canvas.removeEventListener(\"webglcontextlost\", this._contextLost, !1), this._canvas.removeEventListener(\"webglcontextrestored\", this._contextRestored, !1), this._canvasContainer.remove(), this._controlContainer.remove(), this._missingCSSCanary.remove(), this._canvas = void 0, this._canvasContainer = void 0, this._controlContainer = void 0, this._missingCSSCanary = void 0, this._container.classList.remove(\"mapboxgl-map\"), this._container.removeEventListener(\"scroll\", this._onMapScroll, !1), e.removeAuthState(this.painter.context.gl), this._removed = !0, this.fire(new e.Event(\"remove\"));\n          }\n        }, {\n          key: \"triggerRepaint\",\n          value: function triggerRepaint() {\n            this._triggerFrame(!0);\n          }\n        }, {\n          key: \"_triggerFrame\",\n          value: function _triggerFrame(t) {\n            var _this148 = this;\n            this._renderNextFrame = this._renderNextFrame || t, this.style && !this._frame && (this._frame = e.exported.frame(function (e) {\n              var t = !!_this148._renderNextFrame;\n              _this148._frame = null, _this148._renderNextFrame = null, t && _this148._render(e);\n            }));\n          }\n        }, {\n          key: \"_preloadTiles\",\n          value: function _preloadTiles(t) {\n            var _this149 = this;\n            var i = this.style ? Object.values(this.style._sourceCaches) : [];\n            return e.asyncAll(i, function (e, i) {\n              return e._preloadTiles(t, i);\n            }, function () {\n              _this149.triggerRepaint();\n            }), this;\n          }\n        }, {\n          key: \"_onWindowOnline\",\n          value: function _onWindowOnline() {\n            this._update();\n          }\n        }, {\n          key: \"_onWindowResize\",\n          value: function _onWindowResize(e) {\n            this._trackResize && this.resize({\n              originalEvent: e\n            })._update();\n          }\n        }, {\n          key: \"_onVisibilityChange\",\n          value: function _onVisibilityChange() {\n            \"hidden\" === e.window.document.visibilityState && this._visibilityHidden++;\n          }\n        }, {\n          key: \"_setCacheLimits\",\n          value: function _setCacheLimits(t, i) {\n            e.setCacheLimits(t, i);\n          }\n        }, {\n          key: \"showTileBoundaries\",\n          get: function get() {\n            return !!this._showTileBoundaries;\n          },\n          set: function set(e) {\n            this._showTileBoundaries !== e && (this._showTileBoundaries = e, this._update());\n          }\n        }, {\n          key: \"showTerrainWireframe\",\n          get: function get() {\n            return !!this._showTerrainWireframe;\n          },\n          set: function set(e) {\n            this._showTerrainWireframe !== e && (this._showTerrainWireframe = e, this._update());\n          }\n        }, {\n          key: \"speedIndexTiming\",\n          get: function get() {\n            return !!this._speedIndexTiming;\n          },\n          set: function set(e) {\n            this._speedIndexTiming !== e && (this._speedIndexTiming = e, this._update());\n          }\n        }, {\n          key: \"showPadding\",\n          get: function get() {\n            return !!this._showPadding;\n          },\n          set: function set(e) {\n            this._showPadding !== e && (this._showPadding = e, this._update());\n          }\n        }, {\n          key: \"showCollisionBoxes\",\n          get: function get() {\n            return !!this._showCollisionBoxes;\n          },\n          set: function set(e) {\n            this._showCollisionBoxes !== e && (this._showCollisionBoxes = e, e ? this.style._generateCollisionBoxes() : this._update());\n          }\n        }, {\n          key: \"showOverdrawInspector\",\n          get: function get() {\n            return !!this._showOverdrawInspector;\n          },\n          set: function set(e) {\n            this._showOverdrawInspector !== e && (this._showOverdrawInspector = e, this._update());\n          }\n        }, {\n          key: \"repaint\",\n          get: function get() {\n            return !!this._repaint;\n          },\n          set: function set(e) {\n            this._repaint !== e && (this._repaint = e, this.triggerRepaint());\n          }\n        }, {\n          key: \"vertices\",\n          get: function get() {\n            return !!this._vertices;\n          },\n          set: function set(e) {\n            this._vertices = e, this._update();\n          }\n        }, {\n          key: \"showTileAABBs\",\n          get: function get() {\n            return !!this._showTileAABBs;\n          },\n          set: function set(e) {\n            this._showTileAABBs !== e && (this._showTileAABBs = e, e && this._update());\n          }\n        }, {\n          key: \"version\",\n          get: function get() {\n            return e.version;\n          }\n        }]);\n        return Map;\n      }(Yr),\n      NavigationControl: /*#__PURE__*/function () {\n        function NavigationControl(t) {\n          var _this150 = this;\n          _classCallCheck(this, NavigationControl);\n          this.options = e.extend({}, hn, t), this._container = n(\"div\", \"mapboxgl-ctrl mapboxgl-ctrl-group\"), this._container.addEventListener(\"contextmenu\", function (e) {\n            return e.preventDefault();\n          }), this.options.showZoom && (e.bindAll([\"_setButtonTitle\", \"_updateZoomButtons\"], this), this._zoomInButton = this._createButton(\"mapboxgl-ctrl-zoom-in\", function (e) {\n            _this150._map && _this150._map.zoomIn({}, {\n              originalEvent: e\n            });\n          }), n(\"span\", \"mapboxgl-ctrl-icon\", this._zoomInButton).setAttribute(\"aria-hidden\", \"true\"), this._zoomOutButton = this._createButton(\"mapboxgl-ctrl-zoom-out\", function (e) {\n            _this150._map && _this150._map.zoomOut({}, {\n              originalEvent: e\n            });\n          }), n(\"span\", \"mapboxgl-ctrl-icon\", this._zoomOutButton).setAttribute(\"aria-hidden\", \"true\")), this.options.showCompass && (e.bindAll([\"_rotateCompassArrow\"], this), this._compass = this._createButton(\"mapboxgl-ctrl-compass\", function (e) {\n            var t = _this150._map;\n            t && (_this150.options.visualizePitch ? t.resetNorthPitch({}, {\n              originalEvent: e\n            }) : t.resetNorth({}, {\n              originalEvent: e\n            }));\n          }), this._compassIcon = n(\"span\", \"mapboxgl-ctrl-icon\", this._compass), this._compassIcon.setAttribute(\"aria-hidden\", \"true\"));\n        }\n        _createClass(NavigationControl, [{\n          key: \"_updateZoomButtons\",\n          value: function _updateZoomButtons() {\n            var e = this._map;\n            if (!e) return;\n            var t = e.getZoom(),\n              i = t === e.getMaxZoom(),\n              o = t === e.getMinZoom();\n            this._zoomInButton.disabled = i, this._zoomOutButton.disabled = o, this._zoomInButton.setAttribute(\"aria-disabled\", i.toString()), this._zoomOutButton.setAttribute(\"aria-disabled\", o.toString());\n          }\n        }, {\n          key: \"_rotateCompassArrow\",\n          value: function _rotateCompassArrow() {\n            var _this151 = this;\n            var e = this._map;\n            if (!e) return;\n            var t = this.options.visualizePitch ? \"scale(\".concat(1 / Math.pow(Math.cos(e.transform.pitch * (Math.PI / 180)), .5), \") rotateX(\").concat(e.transform.pitch, \"deg) rotateZ(\").concat(e.transform.angle * (180 / Math.PI), \"deg)\") : \"rotate(\".concat(e.transform.angle * (180 / Math.PI), \"deg)\");\n            e._requestDomTask(function () {\n              _this151._compassIcon && (_this151._compassIcon.style.transform = t);\n            });\n          }\n        }, {\n          key: \"onAdd\",\n          value: function onAdd(e) {\n            return this._map = e, this.options.showZoom && (this._setButtonTitle(this._zoomInButton, \"ZoomIn\"), this._setButtonTitle(this._zoomOutButton, \"ZoomOut\"), e.on(\"zoom\", this._updateZoomButtons), this._updateZoomButtons()), this.options.showCompass && (this._setButtonTitle(this._compass, \"ResetBearing\"), this.options.visualizePitch && e.on(\"pitch\", this._rotateCompassArrow), e.on(\"rotate\", this._rotateCompassArrow), this._rotateCompassArrow(), this._handler = new un(e, this._compass, this.options.visualizePitch)), this._container;\n          }\n        }, {\n          key: \"onRemove\",\n          value: function onRemove() {\n            var e = this._map;\n            e && (this._container.remove(), this.options.showZoom && e.off(\"zoom\", this._updateZoomButtons), this.options.showCompass && (this.options.visualizePitch && e.off(\"pitch\", this._rotateCompassArrow), e.off(\"rotate\", this._rotateCompassArrow), this._handler && this._handler.off(), this._handler = void 0), this._map = void 0);\n          }\n        }, {\n          key: \"_createButton\",\n          value: function _createButton(e, t) {\n            var i = n(\"button\", e, this._container);\n            return i.type = \"button\", i.addEventListener(\"click\", t), i;\n          }\n        }, {\n          key: \"_setButtonTitle\",\n          value: function _setButtonTitle(e, t) {\n            if (!this._map) return;\n            var i = this._map._getUIString(\"NavigationControl.\".concat(t));\n            e.setAttribute(\"aria-label\", i), e.firstElementChild && e.firstElementChild.setAttribute(\"title\", i);\n          }\n        }]);\n        return NavigationControl;\n      }(),\n      GeolocateControl: /*#__PURE__*/function (_e$Evented13) {\n        _inherits(GeolocateControl, _e$Evented13);\n        function GeolocateControl(t) {\n          var _this152;\n          _classCallCheck(this, GeolocateControl);\n          _this152 = _possibleConstructorReturn(this, _getPrototypeOf(GeolocateControl).call(this)), _this152.options = e.extend({\n            geolocation: e.window.navigator.geolocation\n          }, _n, t), e.bindAll([\"_onSuccess\", \"_onError\", \"_onZoom\", \"_finish\", \"_setupUI\", \"_updateCamera\", \"_updateMarker\", \"_updateMarkerRotation\", \"_onDeviceOrientation\"], _assertThisInitialized(_assertThisInitialized(_this152))), _this152._updateMarkerRotationThrottled = Jo(_this152._updateMarkerRotation, 20), _this152._numberOfWatches = 0;\n          return _this152;\n        }\n        _createClass(GeolocateControl, [{\n          key: \"onAdd\",\n          value: function onAdd(e) {\n            return this._map = e, this._container = n(\"div\", \"mapboxgl-ctrl mapboxgl-ctrl-group\"), this._checkGeolocationSupport(this._setupUI), this._container;\n          }\n        }, {\n          key: \"onRemove\",\n          value: function onRemove() {\n            void 0 !== this._geolocationWatchID && (this.options.geolocation.clearWatch(this._geolocationWatchID), this._geolocationWatchID = void 0), this.options.showUserLocation && this._userLocationDotMarker && this._userLocationDotMarker.remove(), this.options.showAccuracyCircle && this._accuracyCircleMarker && this._accuracyCircleMarker.remove(), this._container.remove(), this._map.off(\"zoom\", this._onZoom), this._map = void 0, this._numberOfWatches = 0, this._noTimeout = !1;\n          }\n        }, {\n          key: \"_checkGeolocationSupport\",\n          value: function _checkGeolocationSupport(t) {\n            var _this153 = this;\n            var i = function i() {\n              var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !!_this153.options.geolocation;\n              _this153._supportsGeolocation = e, t(e);\n            };\n            void 0 !== this._supportsGeolocation ? t(this._supportsGeolocation) : void 0 !== e.window.navigator.permissions ? e.window.navigator.permissions.query({\n              name: \"geolocation\"\n            }).then(function (e) {\n              return i(\"denied\" !== e.state);\n            }).catch(function () {\n              return i();\n            }) : i();\n          }\n        }, {\n          key: \"_isOutOfMapMaxBounds\",\n          value: function _isOutOfMapMaxBounds(e) {\n            var t = this._map.getMaxBounds(),\n              i = e.coords;\n            return !!t && (i.longitude < t.getWest() || i.longitude > t.getEast() || i.latitude < t.getSouth() || i.latitude > t.getNorth());\n          }\n        }, {\n          key: \"_setErrorState\",\n          value: function _setErrorState() {\n            switch (this._watchState) {\n              case \"WAITING_ACTIVE\":\n                this._watchState = \"ACTIVE_ERROR\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-active-error\");\n                break;\n              case \"ACTIVE_LOCK\":\n                this._watchState = \"ACTIVE_ERROR\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-active-error\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-waiting\");\n                break;\n              case \"BACKGROUND\":\n                this._watchState = \"BACKGROUND_ERROR\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-background\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-background-error\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-waiting\");\n            }\n          }\n        }, {\n          key: \"_onSuccess\",\n          value: function _onSuccess(t) {\n            if (this._map) {\n              if (this._isOutOfMapMaxBounds(t)) return this._setErrorState(), this.fire(new e.Event(\"outofmaxbounds\", t)), this._updateMarker(), void this._finish();\n              if (this.options.trackUserLocation) switch (this._lastKnownPosition = t, this._watchState) {\n                case \"WAITING_ACTIVE\":\n                case \"ACTIVE_LOCK\":\n                case \"ACTIVE_ERROR\":\n                  this._watchState = \"ACTIVE_LOCK\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active-error\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-active\");\n                  break;\n                case \"BACKGROUND\":\n                case \"BACKGROUND_ERROR\":\n                  this._watchState = \"BACKGROUND\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-background-error\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-background\");\n              }\n              this.options.showUserLocation && \"OFF\" !== this._watchState && this._updateMarker(t), this.options.trackUserLocation && \"ACTIVE_LOCK\" !== this._watchState || this._updateCamera(t), this.options.showUserLocation && this._dotElement.classList.remove(\"mapboxgl-user-location-dot-stale\"), this.fire(new e.Event(\"geolocate\", t)), this._finish();\n            }\n          }\n        }, {\n          key: \"_updateCamera\",\n          value: function _updateCamera(t) {\n            var i = new e.LngLat(t.coords.longitude, t.coords.latitude),\n              o = t.coords.accuracy,\n              r = this._map.getBearing(),\n              n = e.extend({\n                bearing: r\n              }, this.options.fitBoundsOptions);\n            this._map.fitBounds(i.toBounds(o), n, {\n              geolocateSource: !0\n            });\n          }\n        }, {\n          key: \"_updateMarker\",\n          value: function _updateMarker(t) {\n            if (t) {\n              var _i326 = new e.LngLat(t.coords.longitude, t.coords.latitude);\n              this._accuracyCircleMarker.setLngLat(_i326).addTo(this._map), this._userLocationDotMarker.setLngLat(_i326).addTo(this._map), this._accuracy = t.coords.accuracy, this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();\n            } else this._userLocationDotMarker.remove(), this._accuracyCircleMarker.remove();\n          }\n        }, {\n          key: \"_updateCircleRadius\",\n          value: function _updateCircleRadius() {\n            var t = this._map.transform,\n              i = e.mercatorZfromAltitude(1, t._center.lat) * t.worldSize,\n              o = Math.ceil(2 * this._accuracy * i);\n            this._circleElement.style.width = \"\".concat(o, \"px\"), this._circleElement.style.height = \"\".concat(o, \"px\");\n          }\n        }, {\n          key: \"_onZoom\",\n          value: function _onZoom() {\n            this.options.showUserLocation && this.options.showAccuracyCircle && this._updateCircleRadius();\n          }\n        }, {\n          key: \"_updateMarkerRotation\",\n          value: function _updateMarkerRotation() {\n            this._userLocationDotMarker && \"number\" == typeof this._heading ? (this._userLocationDotMarker.setRotation(this._heading), this._dotElement.classList.add(\"mapboxgl-user-location-show-heading\")) : (this._dotElement.classList.remove(\"mapboxgl-user-location-show-heading\"), this._userLocationDotMarker.setRotation(0));\n          }\n        }, {\n          key: \"_onError\",\n          value: function _onError(t) {\n            if (this._map) {\n              if (this.options.trackUserLocation) if (1 === t.code) {\n                this._watchState = \"OFF\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active-error\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-background\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-background-error\"), this._geolocateButton.disabled = !0;\n                var _e488 = this._map._getUIString(\"GeolocateControl.LocationNotAvailable\");\n                this._geolocateButton.setAttribute(\"aria-label\", _e488), this._geolocateButton.firstElementChild && this._geolocateButton.firstElementChild.setAttribute(\"title\", _e488), void 0 !== this._geolocationWatchID && this._clearWatch();\n              } else {\n                if (3 === t.code && this._noTimeout) return;\n                this._setErrorState();\n              }\n              \"OFF\" !== this._watchState && this.options.showUserLocation && this._dotElement.classList.add(\"mapboxgl-user-location-dot-stale\"), this.fire(new e.Event(\"error\", t)), this._finish();\n            }\n          }\n        }, {\n          key: \"_finish\",\n          value: function _finish() {\n            this._timeoutId && clearTimeout(this._timeoutId), this._timeoutId = void 0;\n          }\n        }, {\n          key: \"_setupUI\",\n          value: function _setupUI(t) {\n            var _this154 = this;\n            if (void 0 !== this._map) {\n              if (this._container.addEventListener(\"contextmenu\", function (e) {\n                return e.preventDefault();\n              }), this._geolocateButton = n(\"button\", \"mapboxgl-ctrl-geolocate\", this._container), n(\"span\", \"mapboxgl-ctrl-icon\", this._geolocateButton).setAttribute(\"aria-hidden\", \"true\"), this._geolocateButton.type = \"button\", !1 === t) {\n                e.warnOnce(\"Geolocation support is not available so the GeolocateControl will be disabled.\");\n                var _t487 = this._map._getUIString(\"GeolocateControl.LocationNotAvailable\");\n                this._geolocateButton.disabled = !0, this._geolocateButton.setAttribute(\"aria-label\", _t487), this._geolocateButton.firstElementChild && this._geolocateButton.firstElementChild.setAttribute(\"title\", _t487);\n              } else {\n                var _e489 = this._map._getUIString(\"GeolocateControl.FindMyLocation\");\n                this._geolocateButton.setAttribute(\"aria-label\", _e489), this._geolocateButton.firstElementChild && this._geolocateButton.firstElementChild.setAttribute(\"title\", _e489);\n              }\n              this.options.trackUserLocation && (this._geolocateButton.setAttribute(\"aria-pressed\", \"false\"), this._watchState = \"OFF\"), this.options.showUserLocation && (this._dotElement = n(\"div\", \"mapboxgl-user-location\"), this._dotElement.appendChild(n(\"div\", \"mapboxgl-user-location-dot\")), this._dotElement.appendChild(n(\"div\", \"mapboxgl-user-location-heading\")), this._userLocationDotMarker = new on({\n                element: this._dotElement,\n                rotationAlignment: \"map\",\n                pitchAlignment: \"map\"\n              }), this._circleElement = n(\"div\", \"mapboxgl-user-location-accuracy-circle\"), this._accuracyCircleMarker = new on({\n                element: this._circleElement,\n                pitchAlignment: \"map\"\n              }), this.options.trackUserLocation && (this._watchState = \"OFF\"), this._map.on(\"zoom\", this._onZoom)), this._geolocateButton.addEventListener(\"click\", this.trigger.bind(this)), this._setup = !0, this.options.trackUserLocation && this._map.on(\"movestart\", function (t) {\n                t.geolocateSource || \"ACTIVE_LOCK\" !== _this154._watchState || t.originalEvent && \"resize\" === t.originalEvent.type || (_this154._watchState = \"BACKGROUND\", _this154._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-background\"), _this154._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active\"), _this154.fire(new e.Event(\"trackuserlocationend\")));\n              });\n            }\n          }\n        }, {\n          key: \"_onDeviceOrientation\",\n          value: function _onDeviceOrientation(e) {\n            this._userLocationDotMarker && (e.webkitCompassHeading ? this._heading = e.webkitCompassHeading : !0 === e.absolute && (this._heading = -1 * e.alpha), this._updateMarkerRotationThrottled());\n          }\n        }, {\n          key: \"trigger\",\n          value: function trigger() {\n            if (!this._setup) return e.warnOnce(\"Geolocate control triggered before added to a map\"), !1;\n            if (this.options.trackUserLocation) {\n              switch (this._watchState) {\n                case \"OFF\":\n                  this._watchState = \"WAITING_ACTIVE\", this.fire(new e.Event(\"trackuserlocationstart\"));\n                  break;\n                case \"WAITING_ACTIVE\":\n                case \"ACTIVE_LOCK\":\n                case \"ACTIVE_ERROR\":\n                case \"BACKGROUND_ERROR\":\n                  this._numberOfWatches--, this._noTimeout = !1, this._watchState = \"OFF\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-active-error\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-background\"), this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-background-error\"), this.fire(new e.Event(\"trackuserlocationend\"));\n                  break;\n                case \"BACKGROUND\":\n                  this._watchState = \"ACTIVE_LOCK\", this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-background\"), this._lastKnownPosition && this._updateCamera(this._lastKnownPosition), this.fire(new e.Event(\"trackuserlocationstart\"));\n              }\n              switch (this._watchState) {\n                case \"WAITING_ACTIVE\":\n                  this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-active\");\n                  break;\n                case \"ACTIVE_LOCK\":\n                  this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-active\");\n                  break;\n                case \"ACTIVE_ERROR\":\n                  this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-active-error\");\n                  break;\n                case \"BACKGROUND\":\n                  this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-background\");\n                  break;\n                case \"BACKGROUND_ERROR\":\n                  this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-background-error\");\n              }\n              if (\"OFF\" === this._watchState && void 0 !== this._geolocationWatchID) this._clearWatch();else if (void 0 === this._geolocationWatchID) {\n                var _e490;\n                this._geolocateButton.classList.add(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.setAttribute(\"aria-pressed\", \"true\"), this._numberOfWatches++, this._numberOfWatches > 1 ? (_e490 = {\n                  maximumAge: 6e5,\n                  timeout: 0\n                }, this._noTimeout = !0) : (_e490 = this.options.positionOptions, this._noTimeout = !1), this._geolocationWatchID = this.options.geolocation.watchPosition(this._onSuccess, this._onError, _e490), this.options.showUserHeading && this._addDeviceOrientationListener();\n              }\n            } else this.options.geolocation.getCurrentPosition(this._onSuccess, this._onError, this.options.positionOptions), this._timeoutId = setTimeout(this._finish, 1e4);\n            return !0;\n          }\n        }, {\n          key: \"_addDeviceOrientationListener\",\n          value: function _addDeviceOrientationListener() {\n            var _this155 = this;\n            var t = function t() {\n              e.window.addEventListener(\"ondeviceorientationabsolute\" in e.window ? \"deviceorientationabsolute\" : \"deviceorientation\", _this155._onDeviceOrientation);\n            };\n            void 0 !== e.window.DeviceMotionEvent && \"function\" == typeof e.window.DeviceMotionEvent.requestPermission ? DeviceOrientationEvent.requestPermission().then(function (e) {\n              \"granted\" === e && t();\n            }).catch(console.error) : t();\n          }\n        }, {\n          key: \"_clearWatch\",\n          value: function _clearWatch() {\n            this.options.geolocation.clearWatch(this._geolocationWatchID), e.window.removeEventListener(\"deviceorientation\", this._onDeviceOrientation), e.window.removeEventListener(\"deviceorientationabsolute\", this._onDeviceOrientation), this._geolocationWatchID = void 0, this._geolocateButton.classList.remove(\"mapboxgl-ctrl-geolocate-waiting\"), this._geolocateButton.setAttribute(\"aria-pressed\", \"false\"), this.options.showUserLocation && this._updateMarker(null);\n          }\n        }]);\n        return GeolocateControl;\n      }(e.Evented),\n      AttributionControl: Kr,\n      ScaleControl: /*#__PURE__*/function () {\n        function ScaleControl(t) {\n          _classCallCheck(this, ScaleControl);\n          this.options = e.extend({}, dn, t), function () {\n            try {\n              return new Intl.NumberFormat(\"en\", {\n                style: \"unit\",\n                unitDisplay: \"narrow\",\n                unit: \"meter\"\n              }), !0;\n            } catch (e) {\n              return !1;\n            }\n          }() || (this._setScale = pn.bind(this)), e.bindAll([\"_update\", \"_setScale\", \"setUnit\"], this);\n        }\n        _createClass(ScaleControl, [{\n          key: \"getDefaultPosition\",\n          value: function getDefaultPosition() {\n            return \"bottom-left\";\n          }\n        }, {\n          key: \"_update\",\n          value: function _update() {\n            var e = this.options.maxWidth || 100,\n              t = this._map,\n              i = t._containerHeight / 2,\n              o = t._containerWidth / 2 - e / 2,\n              r = t.unproject([o, i]),\n              n = t.unproject([o + e, i]),\n              s = r.distanceTo(n);\n            if (\"imperial\" === this.options.unit) {\n              var _t488 = 3.2808 * s;\n              _t488 > 5280 ? this._setScale(e, _t488 / 5280, \"mile\") : this._setScale(e, _t488, \"foot\");\n            } else \"nautical\" === this.options.unit ? this._setScale(e, s / 1852, \"nautical-mile\") : s >= 1e3 ? this._setScale(e, s / 1e3, \"kilometer\") : this._setScale(e, s, \"meter\");\n          }\n        }, {\n          key: \"_setScale\",\n          value: function _setScale(e, t, i) {\n            var _this156 = this;\n            var o = mn(t),\n              r = o / t;\n            this._map._requestDomTask(function () {\n              _this156._container.style.width = e * r + \"px\", _this156._container.innerHTML = \"nautical-mile\" !== i ? new Intl.NumberFormat(_this156._language, {\n                style: \"unit\",\n                unitDisplay: \"narrow\",\n                unit: i\n              }).format(o) : \"\".concat(o, \"&nbsp;nm\");\n            });\n          }\n        }, {\n          key: \"onAdd\",\n          value: function onAdd(e) {\n            return this._map = e, this._language = e.getLanguage(), this._container = n(\"div\", \"mapboxgl-ctrl mapboxgl-ctrl-scale\", e.getContainer()), this._container.dir = \"auto\", this._map.on(\"move\", this._update), this._update(), this._container;\n          }\n        }, {\n          key: \"onRemove\",\n          value: function onRemove() {\n            this._container.remove(), this._map.off(\"move\", this._update), this._map = void 0;\n          }\n        }, {\n          key: \"_setLanguage\",\n          value: function _setLanguage(e) {\n            this._language = e, this._update();\n          }\n        }, {\n          key: \"setUnit\",\n          value: function setUnit(e) {\n            this.options.unit = e, this._update();\n          }\n        }]);\n        return ScaleControl;\n      }(),\n      FullscreenControl: /*#__PURE__*/function () {\n        function FullscreenControl(t) {\n          _classCallCheck(this, FullscreenControl);\n          this._fullscreen = !1, t && t.container && (t.container instanceof e.window.HTMLElement ? this._container = t.container : e.warnOnce(\"Full screen control 'container' must be a DOM element.\")), e.bindAll([\"_onClickFullscreen\", \"_changeIcon\"], this), \"onfullscreenchange\" in e.window.document ? this._fullscreenchange = \"fullscreenchange\" : \"onwebkitfullscreenchange\" in e.window.document && (this._fullscreenchange = \"webkitfullscreenchange\");\n        }\n        _createClass(FullscreenControl, [{\n          key: \"onAdd\",\n          value: function onAdd(t) {\n            return this._map = t, this._container || (this._container = this._map.getContainer()), this._controlContainer = n(\"div\", \"mapboxgl-ctrl mapboxgl-ctrl-group\"), this._checkFullscreenSupport() ? this._setupUI() : (this._controlContainer.style.display = \"none\", e.warnOnce(\"This device does not support fullscreen mode.\")), this._controlContainer;\n          }\n        }, {\n          key: \"onRemove\",\n          value: function onRemove() {\n            this._controlContainer.remove(), this._map = null, e.window.document.removeEventListener(this._fullscreenchange, this._changeIcon);\n          }\n        }, {\n          key: \"_checkFullscreenSupport\",\n          value: function _checkFullscreenSupport() {\n            return !(!e.window.document.fullscreenEnabled && !e.window.document.webkitFullscreenEnabled);\n          }\n        }, {\n          key: \"_setupUI\",\n          value: function _setupUI() {\n            var t = this._fullscreenButton = n(\"button\", \"mapboxgl-ctrl-fullscreen\", this._controlContainer);\n            n(\"span\", \"mapboxgl-ctrl-icon\", t).setAttribute(\"aria-hidden\", \"true\"), t.type = \"button\", this._updateTitle(), this._fullscreenButton.addEventListener(\"click\", this._onClickFullscreen), e.window.document.addEventListener(this._fullscreenchange, this._changeIcon);\n          }\n        }, {\n          key: \"_updateTitle\",\n          value: function _updateTitle() {\n            var e = this._getTitle();\n            this._fullscreenButton.setAttribute(\"aria-label\", e), this._fullscreenButton.firstElementChild && this._fullscreenButton.firstElementChild.setAttribute(\"title\", e);\n          }\n        }, {\n          key: \"_getTitle\",\n          value: function _getTitle() {\n            return this._map._getUIString(this._isFullscreen() ? \"FullscreenControl.Exit\" : \"FullscreenControl.Enter\");\n          }\n        }, {\n          key: \"_isFullscreen\",\n          value: function _isFullscreen() {\n            return this._fullscreen;\n          }\n        }, {\n          key: \"_changeIcon\",\n          value: function _changeIcon() {\n            (e.window.document.fullscreenElement || e.window.document.webkitFullscreenElement) === this._container !== this._fullscreen && (this._fullscreen = !this._fullscreen, this._fullscreenButton.classList.toggle(\"mapboxgl-ctrl-shrink\"), this._fullscreenButton.classList.toggle(\"mapboxgl-ctrl-fullscreen\"), this._updateTitle());\n          }\n        }, {\n          key: \"_onClickFullscreen\",\n          value: function _onClickFullscreen() {\n            this._isFullscreen() ? e.window.document.exitFullscreen ? e.window.document.exitFullscreen() : e.window.document.webkitCancelFullScreen && e.window.document.webkitCancelFullScreen() : this._container.requestFullscreen ? this._container.requestFullscreen() : this._container.webkitRequestFullscreen && this._container.webkitRequestFullscreen();\n          }\n        }]);\n        return FullscreenControl;\n      }(),\n      Popup: /*#__PURE__*/function (_e$Evented14) {\n        _inherits(Popup, _e$Evented14);\n        function Popup(t) {\n          var _this157;\n          _classCallCheck(this, Popup);\n          _this157 = _possibleConstructorReturn(this, _getPrototypeOf(Popup).call(this)), _this157.options = e.extend(Object.create(rn), t), e.bindAll([\"_update\", \"_onClose\", \"remove\", \"_onMouseEvent\"], _assertThisInitialized(_assertThisInitialized(_this157))), _this157._classList = new Set(t && t.className ? t.className.trim().split(/\\s+/) : []);\n          return _this157;\n        }\n        _createClass(Popup, [{\n          key: \"addTo\",\n          value: function addTo(t) {\n            return this._map && this.remove(), this._map = t, this.options.closeOnClick && t.on(\"preclick\", this._onClose), this.options.closeOnMove && t.on(\"move\", this._onClose), t.on(\"remove\", this.remove), this._update(), t._addPopup(this), this._focusFirstElement(), this._trackPointer ? (t.on(\"mousemove\", this._onMouseEvent), t.on(\"mouseup\", this._onMouseEvent), t._canvasContainer.classList.add(\"mapboxgl-track-pointer\")) : t.on(\"move\", this._update), this.fire(new e.Event(\"open\")), this;\n          }\n        }, {\n          key: \"isOpen\",\n          value: function isOpen() {\n            return !!this._map;\n          }\n        }, {\n          key: \"remove\",\n          value: function remove() {\n            this._content && this._content.remove(), this._container && (this._container.remove(), this._container = void 0);\n            var t = this._map;\n            return t && (t.off(\"move\", this._update), t.off(\"move\", this._onClose), t.off(\"preclick\", this._onClose), t.off(\"click\", this._onClose), t.off(\"remove\", this.remove), t.off(\"mousemove\", this._onMouseEvent), t.off(\"mouseup\", this._onMouseEvent), t.off(\"drag\", this._onMouseEvent), t._canvasContainer && t._canvasContainer.classList.remove(\"mapboxgl-track-pointer\"), t._removePopup(this), this._map = void 0), this.fire(new e.Event(\"close\")), this;\n          }\n        }, {\n          key: \"getLngLat\",\n          value: function getLngLat() {\n            return this._lngLat;\n          }\n        }, {\n          key: \"setLngLat\",\n          value: function setLngLat(t) {\n            this._lngLat = e.LngLat.convert(t), this._pos = null, this._trackPointer = !1, this._update();\n            var i = this._map;\n            return i && (i.on(\"move\", this._update), i.off(\"mousemove\", this._onMouseEvent), i._canvasContainer.classList.remove(\"mapboxgl-track-pointer\")), this;\n          }\n        }, {\n          key: \"trackPointer\",\n          value: function trackPointer() {\n            this._trackPointer = !0, this._pos = null, this._update();\n            var e = this._map;\n            return e && (e.off(\"move\", this._update), e.on(\"mousemove\", this._onMouseEvent), e.on(\"drag\", this._onMouseEvent), e._canvasContainer.classList.add(\"mapboxgl-track-pointer\")), this;\n          }\n        }, {\n          key: \"getElement\",\n          value: function getElement() {\n            return this._container;\n          }\n        }, {\n          key: \"setText\",\n          value: function setText(t) {\n            return this.setDOMContent(e.window.document.createTextNode(t));\n          }\n        }, {\n          key: \"setHTML\",\n          value: function setHTML(t) {\n            var i = e.window.document.createDocumentFragment(),\n              o = e.window.document.createElement(\"body\");\n            var r;\n            for (o.innerHTML = t; r = o.firstChild, r;) i.appendChild(r);\n            return this.setDOMContent(i);\n          }\n        }, {\n          key: \"getMaxWidth\",\n          value: function getMaxWidth() {\n            return this._container && this._container.style.maxWidth;\n          }\n        }, {\n          key: \"setMaxWidth\",\n          value: function setMaxWidth(e) {\n            return this.options.maxWidth = e, this._update(), this;\n          }\n        }, {\n          key: \"setDOMContent\",\n          value: function setDOMContent(e) {\n            var t = this._content;\n            if (t) for (; t.hasChildNodes();) t.firstChild && t.removeChild(t.firstChild);else t = this._content = n(\"div\", \"mapboxgl-popup-content\", this._container || void 0);\n            if (t.appendChild(e), this.options.closeButton) {\n              var _e491 = this._closeButton = n(\"button\", \"mapboxgl-popup-close-button\", t);\n              _e491.type = \"button\", _e491.setAttribute(\"aria-label\", \"Close popup\"), _e491.setAttribute(\"aria-hidden\", \"true\"), _e491.innerHTML = \"&#215;\", _e491.addEventListener(\"click\", this._onClose);\n            }\n            return this._update(), this._focusFirstElement(), this;\n          }\n        }, {\n          key: \"addClassName\",\n          value: function addClassName(e) {\n            return this._classList.add(e), this._updateClassList(), this;\n          }\n        }, {\n          key: \"removeClassName\",\n          value: function removeClassName(e) {\n            return this._classList.delete(e), this._updateClassList(), this;\n          }\n        }, {\n          key: \"setOffset\",\n          value: function setOffset(e) {\n            return this.options.offset = e, this._update(), this;\n          }\n        }, {\n          key: \"toggleClassName\",\n          value: function toggleClassName(e) {\n            var t;\n            return this._classList.delete(e) ? t = !1 : (this._classList.add(e), t = !0), this._updateClassList(), t;\n          }\n        }, {\n          key: \"_onMouseEvent\",\n          value: function _onMouseEvent(e) {\n            this._update(e.point);\n          }\n        }, {\n          key: \"_getAnchor\",\n          value: function _getAnchor(e) {\n            if (this.options.anchor) return this.options.anchor;\n            var t = this._map,\n              i = this._container,\n              o = this._pos;\n            if (!t || !i || !o) return \"bottom\";\n            var r = i.offsetWidth,\n              n = i.offsetHeight,\n              s = o.x < r / 2,\n              a = o.x > t.transform.width - r / 2;\n            if (o.y + e < n) return s ? \"top-left\" : a ? \"top-right\" : \"top\";\n            if (o.y > t.transform.height - n) {\n              if (s) return \"bottom-left\";\n              if (a) return \"bottom-right\";\n            }\n            return s ? \"left\" : a ? \"right\" : \"bottom\";\n          }\n        }, {\n          key: \"_updateClassList\",\n          value: function _updateClassList() {\n            var e = this._container;\n            if (!e) return;\n            var t = _toConsumableArray(this._classList);\n            t.push(\"mapboxgl-popup\"), this._anchor && t.push(\"mapboxgl-popup-anchor-\".concat(this._anchor)), this._trackPointer && t.push(\"mapboxgl-popup-track-pointer\"), e.className = t.join(\" \");\n          }\n        }, {\n          key: \"_update\",\n          value: function _update(t) {\n            var _this158 = this;\n            var i = this._map,\n              o = this._content;\n            if (!i || !this._lngLat && !this._trackPointer || !o) return;\n            var r = this._container;\n            if (r || (r = this._container = n(\"div\", \"mapboxgl-popup\", i.getContainer()), this._tip = n(\"div\", \"mapboxgl-popup-tip\", r), r.appendChild(o)), this.options.maxWidth && r.style.maxWidth !== this.options.maxWidth && (r.style.maxWidth = this.options.maxWidth), i.transform.renderWorldCopies && !this._trackPointer && (this._lngLat = en(this._lngLat, this._pos, i.transform)), !this._trackPointer || t) {\n              var _e492 = this._pos = this._trackPointer && t ? t : i.project(this._lngLat),\n                _o191 = sn(this.options.offset),\n                _r318 = this._anchor = this._getAnchor(_o191.y),\n                _n224 = sn(this.options.offset, _r318),\n                _s174 = _e492.add(_n224).round();\n              i._requestDomTask(function () {\n                _this158._container && _r318 && (_this158._container.style.transform = \"\".concat(tn[_r318], \" translate(\").concat(_s174.x, \"px,\").concat(_s174.y, \"px)\"));\n              });\n            }\n            if (!this._marker && i._showingGlobe()) {\n              var _t489 = e.isLngLatBehindGlobe(i.transform, this._lngLat) ? 0 : 1;\n              this._setOpacity(_t489);\n            }\n            this._updateClassList();\n          }\n        }, {\n          key: \"_focusFirstElement\",\n          value: function _focusFirstElement() {\n            if (!this.options.focusAfterOpen || !this._container) return;\n            var e = this._container.querySelector(nn);\n            e && e.focus();\n          }\n        }, {\n          key: \"_onClose\",\n          value: function _onClose() {\n            this.remove();\n          }\n        }, {\n          key: \"_setOpacity\",\n          value: function _setOpacity(e) {\n            this._container && (this._container.style.opacity = \"\".concat(e)), this._content && (this._content.style.pointerEvents = e ? \"auto\" : \"none\");\n          }\n        }]);\n        return Popup;\n      }(e.Evented),\n      Marker: on,\n      Style: Qt,\n      LngLat: e.LngLat,\n      LngLatBounds: e.LngLatBounds,\n      Point: e.pointGeometry,\n      MercatorCoordinate: e.MercatorCoordinate,\n      FreeCameraOptions: Zo,\n      Evented: e.Evented,\n      config: e.config,\n      prewarm: function prewarm() {\n        je().acquire(Ue);\n      },\n      clearPrewarmedResources: function clearPrewarmedResources() {\n        var e = Ge;\n        e && (e.isPreloaded() && 1 === e.numActive() ? (e.release(Ue), Ge = null) : console.warn(\"Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()\"));\n      },\n      get accessToken() {\n        return e.config.ACCESS_TOKEN;\n      },\n      set accessToken(t) {\n        e.config.ACCESS_TOKEN = t;\n      },\n      get baseApiUrl() {\n        return e.config.API_URL;\n      },\n      set baseApiUrl(t) {\n        e.config.API_URL = t;\n      },\n      get workerCount() {\n        return Ne.workerCount;\n      },\n      set workerCount(e) {\n        Ne.workerCount = e;\n      },\n      get maxParallelImageRequests() {\n        return e.config.MAX_PARALLEL_IMAGE_REQUESTS;\n      },\n      set maxParallelImageRequests(t) {\n        e.config.MAX_PARALLEL_IMAGE_REQUESTS = t;\n      },\n      clearStorage: function clearStorage(t) {\n        e.clearTileCache(t);\n      },\n      workerUrl: \"\",\n      workerClass: null,\n      setNow: e.exported.setNow,\n      restoreNow: e.exported.restoreNow\n    };\n    return fn;\n  });\n\n  //\n\n  var mapboxgl$1 = mapboxgl;\n  return mapboxgl$1;\n});","map":null,"metadata":{},"sourceType":"script"}